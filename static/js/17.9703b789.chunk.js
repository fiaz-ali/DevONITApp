webpackJsonp([17],{1103:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),n(600)),o=n(655),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function l(e){try{s(a.next(e))}catch(e){o(e)}}function r(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(l,r)}s((a=a.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,a,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={inspectionVisibility:Object(),otherNotes:"",otherCompleted:!1,otherInspectionOntology:[],otherInspectionOntologies:"",entityName:""},n.handleWorkflowChange=n.handleWorkflowChange.bind(n),n.handleOtherCompletion=n.handleOtherCompletion.bind(n),n.handleNotes=n.handleNotes.bind(n),n}return l(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this;e.inspectionVisibility&&e.entityName&&this.setState({inspectionVisibility:e.inspectionVisibility,entityName:e.entityName},function(){return r(t,void 0,void 0,function(){return s(this,function(e){return[2]})})})},t.prototype.componentDidMount=function(){return r(this,void 0,void 0,function(){var e=this;return s(this,function(t){return this.props.inspectionVisibility&&this.props.entityName&&this.setState({inspectionVisibility:this.props.inspectionVisibility,entityName:this.props.entityName},function(){return r(e,void 0,void 0,function(){return s(this,function(e){return[2]})})}),[2]})})},t.prototype.handleWorkflowChange=function(e){this.state.otherCompleted;e.target.checked?document.getElementById("btnOtherNotes_"+this.props.entityName).click():document.getElementById("btnOtherNotesCancel_"+this.props.entityName).click()},t.prototype.handleNotes=function(e){var t=this.state.otherNotes;t=e.target.value,this.setState({otherNotes:t})},t.prototype.handleOtherCompletion=function(e){return r(this,void 0,void 0,function(){var t,n,a,i,l,r=this;return s(this,function(s){switch(s.label){case 0:return t=this.state,n=t.otherInspectionOntology,a=t.inspectionVisibility,i=t.otherNotes,e?this.props.inspectionOntology&&this.props.entityName?(!!n.find(function(e){return e==r.props.inspectionOntology})||n.push(this.props.inspectionOntology),[4,Object(o.j)(this.props.entityName,n,i,e)]):[3,2]:[3,3];case 1:s.sent(),s.label=2;case 2:return a.OtherCompleted=e,this.setState({otherInspectionOntology:n,inspectionVisibility:a,otherCompleted:!0}),[3,5];case 3:if(!this.props.inspectionOntology)return[3,5];if(!(n&&n.length>0))return[3,5];for(l=0;l<n.length;l++)n[l]==this.props.inspectionOntology&&n.splice(l,1);return[4,Object(o.b)(this.props.entityName,n,i,e)];case 4:s.sent(),a.OtherCompleted=e,this.setState({otherInspectionOntology:n,inspectionVisibility:a,otherCompleted:!1}),s.label=5;case 5:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props.workflow,n=this.state.inspectionVisibility;return a.createElement(a.Fragment,null,a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Inspections"),t.ecm&&n&&a.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12"},a.createElement("div",{className:"col-md-6 col-sm-3 col-xs-6 padding-5"},"ECM:"),t.ecm&&n.showECM&&a.createElement("div",{className:"col-md-3 col-sm-7 col-xs-3"},a.createElement("label",{className:"switch-container pull-right"},a.createElement("input",{name:"ecm",className:"switch1",onChange:function(e){},checked:n.ECMCompleted,type:"checkbox"}),a.createElement("div",null,a.createElement("div",null))))),t.rcx&&n&&a.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12"},a.createElement("div",{className:"col-md-6 col-sm-3 col-xs-6 padding-5"},"RCX:"),t.rcx&&n.showRCX&&a.createElement("div",{className:"col-md-3 col-sm-7 col-xs-3"},a.createElement("label",{className:"switch-container pull-right"},a.createElement("input",{name:"rcx",className:"switch1",onChange:function(e){},checked:n.RCXCompleted,type:"checkbox"}),a.createElement("div",null,a.createElement("div",null))))),t.ca&&n&&a.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12"},a.createElement("div",{className:"col-md-6 col-sm-3 col-xs-6 padding-5"},"CA:"),t.ca&&n.showCA&&a.createElement("div",{className:"col-md-3 col-sm-7 col-xs-3"},a.createElement("label",{className:"switch-container pull-right"},a.createElement("input",{name:"ca",className:"switch1",onChange:function(e){},checked:n.CACompleted,type:"checkbox"}),a.createElement("div",null,a.createElement("div",null))))),t.other&&a.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12"},a.createElement("div",{className:"col-md-6 col-sm-3 col-xs-6 padding-5"},t.otherName?t.otherName:"Other",":"),t.other&&a.createElement("div",{className:"col-md-3 col-sm-7 col-xs-3"},a.createElement("label",{className:"switch-container pull-right"},a.createElement("input",{name:"otherCompleted",className:"switch1",onChange:function(t){e.handleWorkflowChange(t)},checked:n.OtherCompleted,type:"checkbox"}),a.createElement("div",null,a.createElement("div",null))))),a.createElement("button",{id:"btnOtherNotes_"+this.props.entityName,style:{display:"none"},"data-toggle":"modal","data-target":"#OtherNotesDialog"+this.props.entityName},"."),a.createElement(i.a,{id:"OtherNotesDialog"+this.props.entityName,onSaveButtonClick:function(){e.props.entityName&&e.handleOtherCompletion(!0)},saveButtonText:"Save",showCancelButton:!0,showSaveButton:!0,cancelButtonText:"Cancel",heading:"Notes"},a.createElement("textarea",{className:"form-control",name:"otherNotes",onChange:function(t){e.handleNotes(t)}})," "),a.createElement("button",{id:"btnOtherNotesCancel_"+this.props.entityName,style:{display:"none"},"data-toggle":"modal","data-target":"#OtherNotesDialogCancel"+this.props.entityName},"."),a.createElement(i.a,{id:"OtherNotesDialogCancel"+this.props.entityName,onSaveButtonClick:function(){e.props.entityName&&e.handleOtherCompletion(!1)},saveButtonText:"Yes",showCancelButton:!0,showSaveButton:!0,cancelButtonText:"Cancel",heading:"Confirm"},a.createElement("label",{htmlFor:""},"Are you sure to cancel this completion")))},t}(a.Component);t.a=c},1104:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){this.props,this.state;return a.createElement(a.Fragment,null,a.createElement("div",{className:"content"},a.createElement("div",{className:"row thumbnail no-margin"},a.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6 center"},a.createElement("div",{className:"col-md-8 col-sm-8 col-xs-8 no-padding"},a.createElement("label",{style:{color:"#B0B0B0"}},"Inspection Complete")),a.createElement("div",{className:"col-md-2 col-sm-4 col-xs-4 no-padding"},a.createElement("label",{className:"switch-container pull-right"},a.createElement("input",{name:"ecm",className:"switch1",onChange:function(e){},checked:!0,type:"checkbox"}),a.createElement("div",null,a.createElement("div",null))))),a.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6 center"},a.createElement("div",{className:"col-md-8 col-sm-8 col-xs-8 no-padding"},a.createElement("label",{style:{color:"#B0B0B0"}}," Not Complete")),a.createElement("div",{className:"col-md-2 col-sm-4 col-xs-4 no-padding"},a.createElement("label",{className:"switch-container pull-right"},a.createElement("input",{name:"ecm",className:"switch1",onChange:function(e){},checked:!1,type:"checkbox"}),a.createElement("div",null,a.createElement("div",null))))))))},t}(a.Component);t.a=o},1740:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i,o=n(3),l=(n.n(o),n(101)),r=n(612),s=n(600),c=n(606),u=n(29),m=n(21),p=n(1741),d=n(614),h=n(22),f=n(695),g=n(1103),b=n(99),v=n(10),E=n(1104),y=n(1742),w=n(741),N=n(906),x=n(907),C=n(908),O=n(605),q=n(750),S=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),_=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function l(e){try{s(a.next(e))}catch(e){o(e)}}function r(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(l,r)}s((a=a.apply(e,t||[])).next())})},k=this&&this.__generator||function(e,t){var n,a,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},T=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],l=0,r=o.length;l<r;l++,i++)a[i]=o[l];return a},j=function(e){function t(t){var n=e.call(this,t)||this;return n.state={sortOrder:1,_equipments:[],filteredEquipments:[],columns:[{name:"Equipment",selected:!0},{name:"Floor",selected:!0},{name:"Space",selected:!0},{name:"Equipment Type",selected:!0},{name:"Virtual BIM",selected:!0},{name:"CAD BIM",selected:!0},{name:"Inspections",selected:!0}],equipmentToDelete:Object(),workFlowSpaceList:[],inspectionOntology:"",workflow:Object(),equipmentSweeps:[],addCurrentSweep:!1,selectedVirtualBIM:"",selectEquipFloor:"",selectEquipSpace:"",selectEquipName:"",showMatterportDialog:!0,refreshMatterportDialog:!1,equipmentTemplates:[],solutionTemplates:[],equipmentTemplatesName:"",solutionTemplatesName:"",currentView:"Equipments",solutionEquipments:[],completedSolutionEquipments:[],deleteOntology:"",selectedEquipmentState:"",Search:"",equipmentList1:Object()},a=n,n.onDeleteEquipment=n.onDeleteEquipment.bind(n),n.deleteEquipment=n.deleteEquipment.bind(n),n._fetchEquipments=n._fetchEquipments.bind(n),n.handleColumnFilters=n.handleColumnFilters.bind(n),n.sortEquipment=n.sortEquipment.bind(n),n.populateInspectionsList=n.populateInspectionsList.bind(n),n.unpopulateInspectionsList=n.unpopulateInspectionsList.bind(n),n.fetchWorkflow=n.fetchWorkflow.bind(n),n.handleMatterport=n.handleMatterport.bind(n),n.onDialogCancelButton=n.onDialogCancelButton.bind(n),n.handleRefreshMatterport=n.handleRefreshMatterport.bind(n),n.handleSweepChange=n.handleSweepChange.bind(n),n.openEquipmentWithTemplate=n.openEquipmentWithTemplate.bind(n),n._fetchEquipmentTemplate=n._fetchEquipmentTemplate.bind(n),n._fetchSolutionTemplate=n._fetchSolutionTemplate.bind(n),n.fetchIncompleteSolutions=n.fetchIncompleteSolutions.bind(n),n.removeIncompleteSolution=n.removeIncompleteSolution.bind(n),n}return S(t,e),t.prototype.componentWillUnmount=function(){return _(this,void 0,void 0,function(){return k(this,function(e){return clearInterval(i),[2]})})},t.prototype.componentDidMount=function(){return _(this,void 0,void 0,function(){var e=this;return k(this,function(t){switch(t.label){case 0:return this.props.buildingName?[4,this._fetchEquipments()]:[3,2];case 1:t.sent(),i=setInterval(function(){var t=Object(q.a)("inspectionOntology"),n=Object(q.a)("spacesWorkFlows");n&&n.length?e.state.inspectionOntology!=t&&e.setState({workFlowSpaceList:n,inspectionOntology:t},function(){return _(e,void 0,void 0,function(){return k(this,function(e){switch(e.label){case 0:return[4,this.fetchWorkflow()];case 1:return e.sent(),this.populateInspectionsList(),[2]}})})}):e.setState({workFlowSpaceList:n},function(){e.unpopulateInspectionsList()})},1e3),t.label=2;case 2:return[4,this._fetchEquipmentTemplate()];case 3:return t.sent(),[4,this._fetchSolutionTemplate()];case 4:return t.sent(),[2]}})})},t.prototype.fetchIncompleteSolutions=function(){return _(this,void 0,void 0,function(){var e;return k(this,function(t){switch(t.label){case 0:return e=[],[4,Object(C.h)()];case 1:return e=t.sent(),this.setState({solutionEquipments:e}),[2]}})})},t.prototype.fetchCompletedSolutions=function(){return _(this,void 0,void 0,function(){var e,t,n,a,i;return k(this,function(o){switch(o.label){case 0:return e=[],t=[],[4,Object(C.g)(this.props.buildingName,"",!1)];case 1:if(e=o.sent())for(n=0;n<e.length;n++)a=e[n],i={createdBy:Object(m.g)(a.createdBy),equipmentTemplatesOntology:Object(m.g)(a.equipmentTemplatesOntology),isCompleted:!0,equipmentsOntology:Object(m.g)(a.equipmentsOntology),ontology:Object(m.g)(a.ontology),rdfsLabel:Object(m.g)(a.rdfsLabel),templateOntology:Object(m.g)(a.templateOntology),timestamp:a.timestamp&&Object(m.g)(a.timestamp)?new Date(Object(m.g)(a.timestamp)):void 0,equipmentByTemplate:[],isDeleted:!1},t.push(i);return this.setState({completedSolutionEquipments:t}),[2]}})})},t.prototype.fetchWorkflow=function(){return _(this,void 0,void 0,function(){var e,t,n,a=this;return k(this,function(i){switch(i.label){case 0:return e=this.state,t=e.workflow,n=e.inspectionOntology,this.props.buildingName&&n?[4,Object(f.k)(this.props.buildingName,n).then(function(e){return _(a,void 0,void 0,function(){var n,a,i;return k(this,function(o){return e&&e.length&&Object(m.g)(e[0].ontology)&&(n=e[0],a=Object(m.g)(n.dateOfStart),i=Object(m.g)(n.finishDate),t.ca="true"==Object(m.g)(n.ca),t.ecm="true"==Object(m.g)(n.ecm),t.rcx="true"==Object(m.g)(n.rcx),t.other="true"==Object(m.g)(n.other),t.dateOfStart=a,t.description=Object(m.g)(n.description),t.finishDate=i,t.lead=Object(m.g)(n.lead),t.ontology=Object(m.g)(n.ontology),t.otherName=Object(m.g)(n.otherName)),this.setState({workflow:t}),[2]})})})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.handleColumnFilters=function(e){var t=e.target.checked,n=this.state.columns;n[n.findIndex(function(t){return t.name===e.target.value})].selected=t,this.setState({columns:n})},t.prototype.sortEquipment=function(e,t){var n=this.state._equipments,a=this.state.sortOrder,i=n.sort(function(t,n){if(t&&n){var i="",o="";switch(e){case"Equipment":t.equipRdfsLabel&&n.equipRdfsLabel&&(i=t.equipRdfsLabel.value,o=n.equipRdfsLabel.value);break;case"Floor":t.floorRdfsLabel&&n.floorRdfsLabel&&(i=t.floorRdfsLabel.value,o=n.floorRdfsLabel.value);break;case"Space":t.spaceRdfsLabel&&n.spaceRdfsLabel&&(i=t.spaceRdfsLabel.value,o=n.spaceRdfsLabel.value);break;case"Equipment Type":t.type&&n.type&&(i=t.type.value,o=n.type.value)}var l=0;return i.toLocaleLowerCase()<o.toLocaleLowerCase()?l=-1:i.toLocaleLowerCase()>o.toLocaleLowerCase()&&(l=1),l*a}});this.setState({_equipments:i,sortOrder:-1*a})},t.prototype.onDeleteEquipment=function(e){return _(this,void 0,void 0,function(){return k(this,function(t){return this.setState({equipmentToDelete:e}),document.getElementById("btnConfirm").click(),[2]})})},t.prototype.deleteEquipment=function(){return _(this,void 0,void 0,function(){var e;return k(this,function(t){switch(t.label){case 0:return e=this.state.equipmentToDelete,[4,Object(u.e)(e.equip.value,h.b.EQUIP)];case 1:return t.sent(),[4,this._fetchEquipments()];case 2:return t.sent(),[2]}})})},t.prototype._fetchEquipments=function(){return _(this,void 0,void 0,function(){var e=this;return k(this,function(t){switch(t.label){case 0:return Object(b.a)(!0),[4,Object(c.g)(this.props.buildingName).then(function(t){return _(e,void 0,void 0,function(){var e=this;return k(this,function(n){return t||(t=[]),a.setState({_equipments:t,filteredEquipments:t},function(){return _(e,void 0,void 0,function(){var e,n;return k(this,function(a){for(e=0;e<t.length;e++)n=t[e],Object(m.g)(n.equip)&&Object(m.g)(n.equipRdfsLabel)&&Object(u.y)(Object(m.g)(n.equip),Object(m.g)(n.equipRdfsLabel));return[2]})})}),[2]})})}).catch(function(e){return e})];case 1:return t.sent(),Object(b.a)(!1),[2]}})})},t.prototype.populateInspectionsList=function(){return _(this,void 0,void 0,function(){var e,t,n,a,i;return k(this,function(o){switch(o.label){case 0:return e=this.state,t=e._equipments,n=e.workFlowSpaceList,a=e.inspectionOntology,Object(b.a)(!0),[4,Object(f.c)(n,t,a)];case 1:return i=o.sent(),this.setState({_equipments:T(i)},function(){Object(b.a)(!1)}),[2]}})})},t.prototype.handleMatterport=function(e,t){var n=this,a=this.props.buildingName,i=Object(m.g)(e.equip);Object(c.p)(a,i).then(function(a){if(a&&a.length>0){var o=a[0],l=Object(m.g)(o.sweep);if(l){var r=[],s=Object();s.uuid=l,r.push(s);var c=!(r&&r.length>0)&&(t&&t.includes("camera_position")),u=t;n.setState({equipmentSweeps:r,addCurrentSweep:c,selectedVirtualBIM:u,selectEquipFloor:Object(m.g)(e.floor),selectEquipSpace:Object(m.g)(e.space),showMatterportDialog:!0},function(){document.getElementById("btnVirtualBIMDialog").click()})}else n.setState({selectEquipName:i}),document.getElementById("btnNoStepsFound").click()}else n.setState({selectEquipName:i}),document.getElementById("btnNoStepsFound").click()})},t.prototype.unpopulateInspectionsList=function(){return _(this,void 0,void 0,function(){var e,t;return k(this,function(n){if(e=this.state._equipments){for(t=0;t<e.length;t++)e[t].inspectionVisibility={CACompleted:!1,ECMCompleted:!1,RCXCompleted:!1,showCA:!1,showECM:!1,showRCX:!1,ECMinspectionOntology:!1,RCXinspectionOntology:!1,CAinspectionOntology:!1};this.setState({_equipments:e})}return[2]})})},t.prototype.onDialogCancelButton=function(e){this.setState({showMatterportDialog:e})},t.prototype.handleSweepChange=function(e,t){this.setState({equipmentSweeps:e})},t.prototype.handleRefreshMatterport=function(e){this.setState({refreshMatterportDialog:e})},t.prototype.openEquipmentWithTemplate=function(e){var t=this.state,n=t.equipmentTemplatesName,a=t.solutionTemplatesName;window.location.hash=e?this.props.instance+"/"+this.props.buildingName+"/NewEquipment/Template/"+n:this.props.instance+"/"+this.props.buildingName+"/NewEquipment/SolutionTemplate/"+a},t.prototype.handleEquipmentTemplateChange=function(e){var t=this.state.equipmentTemplatesName;t=e.value,this.setState({equipmentTemplatesName:t})},t.prototype.handleSolutionTemplateChange=function(e){var t=this.state.solutionTemplatesName;t=e.value,this.setState({solutionTemplatesName:t})},t.prototype._fetchEquipmentTemplate=function(){return _(this,void 0,void 0,function(){var e,t,n,a;return k(this,function(i){switch(i.label){case 0:return Object(b.a)(!0),[4,Object(N.e)()];case 1:if(e=i.sent(),t=this.state.equipmentTemplates,t=[],e){for(n=0;n<e.length;n++)a=e[n],t.push({label:Object(m.g)(a.equipmentName),value:Object(m.g)(a.ontology)});this.setState({equipmentTemplates:t})}return Object(b.a)(!1),[2]}})})},t.prototype._fetchSolutionTemplate=function(){return _(this,void 0,void 0,function(){var e,t,n,a;return k(this,function(i){switch(i.label){case 0:return Object(b.a)(!0),[4,Object(x.e)()];case 1:if(e=i.sent(),t=this.state.solutionTemplates,t=[],e){for(n=0;n<e.length;n++)a=e[n],t.push({label:Object(m.g)(a.rdfsLabel),value:Object(m.g)(a.ontology)});this.setState({solutionTemplates:t})}return Object(b.a)(!1),[2]}})})},t.prototype.removeIncompleteSolution=function(){return _(this,void 0,void 0,function(){var e,t=this;return k(this,function(n){switch(n.label){case 0:return(e=this.state.deleteOntology)?[4,Object(C.b)(e).then(function(){t.fetchIncompleteSolutions(),t.setState({deleteOntology:""})})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.search_filter=function(e){return _(this,void 0,void 0,function(){var t,n;return k(this,function(a){switch(a.label){case 0:return t=e.target.value,n=(n=this.state._equipments).filter(function(e){return e.equipRdfsLabel.value.toLowerCase().includes(t.toLowerCase().trim())}),[4,this.setState({filteredEquipments:n})];case 1:return a.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t._equipments,a=t.columns,i=t.inspectionOntology,c=t.workflow,u=t.equipmentSweeps,h=t.addCurrentSweep,f=t.selectedVirtualBIM,b=t.selectEquipFloor,N=t.showMatterportDialog,x=t.selectEquipSpace,C=t.selectEquipName,q=t.equipmentTemplates,S=t.equipmentTemplatesName,_=t.solutionTemplates,k=t.solutionTemplatesName,T=t.currentView,j=t.solutionEquipments,I=t.completedSolutionEquipments,B=t.selectedEquipmentState,D=t.filteredEquipments,L=this.props,R=L.instance,M=L.buildingName,F=JSON.parse(v.a.getItem("user")),V=Object(d.b)(F,"info-equip","write"),A=!(!i||"Equipments"!=T),P=a.find(function(e){return"Inspections"==e.name&&1==e.selected})&&i;return o.createElement(l.a.Consumer,null,function(t){return o.createElement("div",{className:"content"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12"},o.createElement(s.a,{id:"filtercolumnsModal",heading:"Table Column Preferences",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},a&&a.length>0&&a.map(function(t,n){return!0===t.selected?o.createElement("div",{key:n},o.createElement("input",{checked:!0,type:"checkbox",value:t.name,onChange:e.handleColumnFilters})," ",o.createElement("label",null,t.name)):o.createElement("div",{key:n},o.createElement("input",{type:"checkbox",value:t.name,onChange:e.handleColumnFilters})," ",o.createElement("label",null,t.name))})),o.createElement("div",{className:"row padding-5"},o.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12 p-0",style:{display:"inline-flex"}},o.createElement("button",{type:"button",className:"btn btn-primary btn-fill","data-toggle":"modal",style:{marginRight:"3px"},"data-target":"#filtercolumnsModal"},o.createElement("i",{className:"fa fa-bookmark-o"}),o.createElement("span",{className:"hidden-xs"},"Quick Filters"))),o.createElement("div",{className:"col-md-3 col-sm-12 col-xs-12 p-0",style:{display:"inline-flex"}},o.createElement("label",{htmlFor:"Search Filter",style:{lineHeight:"30px"}},"Filter : \xa0 "),o.createElement("input",{style:{width:"200px",height:"34px",outline:"green"},className:"form-control pull-right margin-left-right-5",onChange:function(t){e.search_filter(t)},id:"myInput",type:"text",placeholder:"Search.."})),F&&F.role&&("1"==F.role||"2"==F.role)&&o.createElement("div",{className:"col-md-7 col-sm-12 col-xs-12 pull-right p-0"},o.createElement(p.a,{instance:R,filename:"EquipmentsList",buildingName:M,ElementID:"EquipmentsList"}),o.createElement("div",{className:"padding-10 visible-xs col-xs-12"}),V&&o.createElement(o.Fragment,null," ",o.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){window.location.hash=R+"/"+M+"/NewEquipment"}},o.createElement("i",{className:"fa fa-plus"}),o.createElement("span",null,"Create New Equipment"))),o.createElement("button",{type:"button",className:"btn btn-success btn-fill pull-right",style:{marginRight:"3px"},onClick:function(){window.location.hash=R+"/"+M+"/Templates"}}," ",o.createElement("span",null,"Templates")))))),o.createElement("br",null),o.createElement("div",{className:"row padding-5 margin-5"},o.createElement("div",{className:"col-md-6 col-sm-12 col-xs-12 no-padding"},o.createElement("div",{className:"col-md-4 col-xs-12 px-0"},o.createElement("h6",{style:{marginTop:"10px"}},"Equipment State:")),o.createElement("div",{className:"col-md-8 col-xs-12"},o.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(t){e.setState({selectedEquipmentState:t.target.value,filteredEquipments:t.target.value?n.filter(function(e){return Object(m.g)(e.equipmentState)==t.target.value}):n})},value:B||""},o.createElement("option",{value:""},"Select Equipment State"),o.createElement("option",{value:"Planned"},"Planned"),o.createElement("option",{value:"Ordered"},"Ordered"),o.createElement("option",{value:"InInventory"},"In Inventory"),o.createElement("option",{value:"ReleasedFor\r\n                                                    Install"},"Released for Install"),o.createElement("option",{value:"Installed"},"Installed"),o.createElement("option",{value:"Testing"},"Testing"),o.createElement("option",{value:"Existing"},"Existing"),o.createElement("option",{value:"Retired"},"Retired"),o.createElement("option",{value:"CommittedToSell"},"Committed to Sell"),o.createElement("option",{value:"Sold"},"Sold")))),A&&o.createElement("div",{className:"col-md-6 col-sm-12 col-xs-12 no-padding"},o.createElement(E.a,null))),o.createElement("div",{className:"card  padding-10",id:"EquipmentsList",style:{paddingTop:"0px"}},"Equipments"==T&&o.createElement("div",{className:"content",style:{paddingTop:"10px"}},o.createElement("div",{className:"dataCard"},o.createElement("div",{className:"row hidden-xs no-padding"},o.createElement("div",{className:"col-md-10 no-padding"},o.createElement("div",{className:"col-md-12 dataCard"},a.find(function(e){return"Equipment"==e.name&&1==e.selected})&&o.createElement("div",{className:P?"col-md-2":"col-md-3 col-sm-12 small grid-header-left",onClick:function(){return e.sortEquipment("Equipment")}},o.createElement("i",{className:"fa fas fa-sort"})," Equipment  "),a.find(function(e){return"Floor"==e.name&&1==e.selected})&&o.createElement("div",{className:P?"col-md-2":"col-md-3 col-sm-12 small grid-header",onClick:function(){return e.sortEquipment("Floor")}}," ",o.createElement("i",{className:"fa fas fa-sort"}),"Floor "),a.find(function(e){return"Space"==e.name&&1==e.selected})&&o.createElement("div",{className:P?"col-md-2":"col-md-3 col-sm-12 small grid-header",onClick:function(){return e.sortEquipment("Space")}},o.createElement("i",{className:"fa fas fa-sort"}),"Space "),a.find(function(e){return"Equipment Type"==e.name&&1==e.selected})&&o.createElement("div",{className:P?"col-md-2":"col-md-3 small col-sm-12 grid-header",onClick:function(){return e.sortEquipment("Equipment Type")}},o.createElement("i",{className:"fa fas fa-sort"}),"Equipment Type "),i&&o.createElement("div",{className:"col-md-4 col-sm-12 small grid-header"},"\xa0 \xa0Inspections"))),o.createElement("div",{className:"col-md-2"})),D&&D.length>0&&D.map(function(n,l){var r=Object(m.g)(n.virtualBIM),s=Object(m.g)(n.cadBIM);return o.createElement("div",{key:l,className:"row clickable no-padding"},o.createElement("div",{className:"col-md-10 no-padding"},o.createElement("div",{className:"col-md-12 no-padding"},a.find(function(e){return"Equipment"==e.name&&1==e.selected})&&o.createElement("div",{className:(P?"col-md-2":"col-md-3")+" col-sm-12 padding-5 trim-data small grid-left margin-top"},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Equipment"),o.createElement("a",{href:"#"+R+"/"+M+"/Equip/Profile/"+n.equip.value,title:Object(m.g)(n.equipRdfsLabel)},Object(m.g)(n.equipRdfsLabel))),a.find(function(e){return"Floor"==e.name&&1==e.selected})&&o.createElement("div",{className:(P?"col-md-2":"col-md-3")+" col-sm-12 padding-5 small grid margin-top",title:Object(m.g)(n.floorRdfsLabel)},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Floor"),Object(m.g)(n.floorRdfsLabel)),a.find(function(e){return"Space"==e.name&&1==e.selected})&&o.createElement("div",{className:(P?"col-md-2":"col-md-3")+" col-sm-12 padding-5 small grid margin-top trim-data",title:Object(m.g)(n.spaceRdfsLabel)},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Space"),Object(m.g)(n.spaceRdfsLabel)),a.find(function(e){return"Equipment Type"==e.name&&1==e.selected})&&o.createElement("div",{className:(P?"col-md-2":"col-md-3")+" col-sm-12 padding-5 small grid margin-top",title:Object(m.g)(n.type).replace(new RegExp("MiscAndProcess","g"),"Misc & Process")},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Equipment Type"),Object(m.g)(n.type).replace(new RegExp("MiscAndProcess","g"),"Misc & Process")),a.find(function(e){return"Inspections"==e.name&&1==e.selected})&&i&&o.createElement("div",{className:"col-md-4 col-sm-12 padding-5 grid margin-top trim-data"},o.createElement(g.a,{entityName:Object(m.g)(n.equip),inspectionVisibility:n.inspectionVisibility,workflow:c,inspectionOntology:i})))),V&&o.createElement("div",{"data-html2canvas-ignore":"true",className:"col-md-2 col-xs-2 pull-right",style:{paddingLeft:"0px"}},o.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Edit",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(e){t.onChangeEquipmentList([]),t.onChangeEquipment(n.equip.value),setTimeout(function(){window.location.hash=R+"/"+M+"/EditEquipment/"+n.equip.value},500)}},o.createElement("i",{style:{width:16},className:"fa fa-edit"})," "),o.createElement("a",{className:"pull-right equipspeclbtn","data-toggle":"collapse",href:"#equipDropdown"+l,title:"Click Me..."}," ",o.createElement("i",{style:{width:13,marginTop:4},className:"fa fa-bars"})),o.createElement("div",{id:"equipDropdown"+l,className:"equipDropdown panel-collapse collapse"},o.createElement(y.a,{instance:R,i:l,buildingName:M,columns:a,cadBIM:s,n:n,virtualBIM:r,handleMatterport:e.handleMatterport}))))}))),"Solutions"==T&&o.createElement("div",{className:"content",style:{paddingTop:"10px"}},o.createElement("div",{className:"dataCard"},o.createElement("div",{className:"row hidden-xs no-padding"},o.createElement("div",{className:"col-md-10 no-padding"},o.createElement("div",{className:"col-md-12 dataCard"},o.createElement("div",{className:P?"col-md-10":"col-md-10 col-sm-12 small grid-header-left"},o.createElement("i",{className:"fa fas fa-sort"})," Solution Template Name  "),o.createElement("div",{className:P?"col-md-2":"col-md-2 col-sm-12 small grid-header"}," ",o.createElement("i",{className:"fa fas fa-sort"}),"Last Updated At ")))),j&&j.length>0&&j.map(function(t,n){var a=new Date(t.timestamp).toLocaleString();return o.createElement("div",{key:n,className:"row clickable no-padding"},o.createElement("div",{className:"col-md-10 no-padding"},o.createElement("div",{className:"col-md-12 no-padding"},o.createElement("div",{className:"col-md-10 col-sm-12 padding-5 trim-data small grid-left margin-top"},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Equipment"),o.createElement("a",{href:"#"+R+"/"+M+"/NewEquipment/SolutionTemplate/Edit/"+t.ontology,title:t.rdfsLabel},t.rdfsLabel)),o.createElement("div",{className:"col-md-2 col-sm-12 padding-5 small grid margin-top",title:t.ontology},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Floor"),a))),V&&o.createElement("div",{"data-html2canvas-ignore":"true",className:"col-md-2 col-xs-2 pull-right",style:{paddingLeft:"0px"}},o.createElement("a",{className:"btn-sm btn-danger active pull-right",title:"Edit",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(n){document.getElementById("btnConfirmDeleteDialog").click(),e.setState({deleteOntology:t._id})}},o.createElement("i",{className:"fa fa-trash"})," "),o.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Edit",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(e){setTimeout(function(){window.location.hash=R+"/"+M+"/NewEquipment/SolutionTemplate/Edit/"+t.ontology},500)}},o.createElement("i",{className:"fa fa-edit"})," ")))}))),"CompletedSolutions"==T&&o.createElement("div",{className:"content",style:{paddingTop:"10px"}},o.createElement("div",{className:"dataCard"},o.createElement("div",{className:"row hidden-xs no-padding"},o.createElement("div",{className:"col-md-10 no-padding"},o.createElement("div",{className:"col-md-12 dataCard"},o.createElement("div",{className:P?"col-md-10":"col-md-10 col-sm-12 small grid-header-left"},o.createElement("i",{className:"fa fas fa-sort"})," Solution Template Name  "),o.createElement("div",{className:P?"col-md-2":"col-md-2 col-sm-12 small grid-header"}," ",o.createElement("i",{className:"fa fas fa-sort"}),"Last Updated At ")))),I&&I.length>0&&I.map(function(e,t){var n=new Date(e.timestamp).toLocaleString();return o.createElement("div",{key:t,className:"row clickable no-padding"},o.createElement("div",{className:"col-md-10 no-padding"},o.createElement("div",{className:"col-md-12 no-padding"},o.createElement("div",{className:"col-md-10 col-sm-12 padding-5 trim-data small grid-left margin-top"},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Equipment"),o.createElement("a",{onClick:function(){window.location.hash=R+"/"+M+"/CompleteSolutionView/"+e.ontology},title:e.rdfsLabel},e.rdfsLabel)),o.createElement("div",{className:"col-md-2 col-sm-12 padding-5 small grid margin-top",title:e.ontology},o.createElement("span",{className:"hidden visible-xs-inline headingText"},"Floor"),n))),V&&o.createElement("div",{"data-html2canvas-ignore":"true",className:"col-md-2 col-xs-2 pull-right",style:{paddingLeft:"0px"}},o.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Diagram",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(t){window.location.hash=R+"/"+M+"/SolutionTemplates/Diagram/"+e.ontology}},o.createElement("i",{className:"fa fa-bar-chart"})),o.createElement("a",{className:"btn-sm btn-success active pull-right",title:"View Complete Solution",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(t){window.location.hash=R+"/"+M+"/CompleteSolutionView/"+e.ontology}},o.createElement("i",{className:"fa fa-list"}))))}))),o.createElement("button",{id:"btnVirtualBIMDialog",className:"hidden","data-toggle":"modal","data-target":"#virtualBIMDialog",title:"Add"},". "),N&&o.createElement(w.a,{id:"virtualBIMDialog",heading:"Virtual BIM Equipment View",showSaveButton:!1,sweeps:u,bimURL:f,isViewForm:!0,addCurrentSweep:h,buildingName:e.props.buildingName,isRefreshDialog:!1,isSweepChangeable:!1,showFloorMap:!0,floor:b,onDialogCancelButton:e.onDialogCancelButton,showInBuildingRoutes:!0,space:x}),o.createElement("button",{id:"btnNoStepsFound",className:"hidden","data-toggle":"modal","data-target":"#NoStepsFound",title:"Add"},". "),o.createElement(s.a,{id:"NoStepsFound",heading:"Virtual BIM Equipment View",showSaveButton:!1,showCancelButton:!0},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("h4",{className:"modal-title",style:{textAlign:"center"}},"No Virtual Equipment View"),o.createElement("div",{className:"text-center"},o.createElement("br",null),o.createElement("a",{className:"modal-title","data-dismiss":"modal",style:{color:"black"},onClick:function(){window.location.href="#"+R+"/"+M+"/EditEquipment/"+C}},"Click here to add virtual equipment view"))))),o.createElement("button",{type:"button",id:"btnEquipmentTemplateDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#equipmentTemplateDialog"}," ."),o.createElement(s.a,{id:"equipmentTemplateDialog",heading:"Select Equipment Template",saveButtonText:"Create Equipment",cancelButtonText:"Cancel",disableSaveButton:!S,showCancelButton:!0,showSaveButton:!0,onSaveButtonClick:function(){e.openEquipmentWithTemplate(!0)}},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("label",{htmlFor:"point"},"Equipment Templates"),o.createElement("div",{className:"form-group"},o.createElement(r.a,{closeMenuOnSelect:!0,isMulti:!1,onChange:function(t){e.handleEquipmentTemplateChange(t)},placeholder:"Select Equipment Template",options:q}))))),o.createElement("button",{type:"button",id:"btnSolutionTemplateDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#solutionTemplateDialog"}," ."),o.createElement(s.a,{id:"solutionTemplateDialog",heading:"Select Solution Template",saveButtonText:"Create Equipment",cancelButtonText:"Cancel",disableSaveButton:!k,showCancelButton:!0,showSaveButton:!0,onSaveButtonClick:function(){e.openEquipmentWithTemplate(!1)}},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("label",{htmlFor:"point"},"Solution Templates"),o.createElement("div",{className:"form-group"},o.createElement(r.a,{closeMenuOnSelect:!0,isMulti:!1,onChange:function(t){e.handleSolutionTemplateChange(t)},placeholder:"Select Solution Template",options:_}))))),o.createElement("button",{type:"button",id:"btnConfirmDeleteDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"}," ."),o.createElement(O.a,{instance:"",id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete inprogress solution template?",heading:"Confirm...",onConfirmButtonClick:function(){e.removeIncompleteSolution()}}))))))})},t}(o.Component);t.default=j},1741:function(e,t,n){"use strict";var a,i=n(3),o=(n.n(i),n(99)),l=n(606),r=n(21),s=n(632),c=n(1173),u=(n.n(c),n(1174)),m=(n.n(u),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function l(e){try{s(a.next(e))}catch(e){o(e)}}function r(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(l,r)}s((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return a=n,n.state={data:Object()},n.convertArrayOfObjectsToCSV=n.convertArrayOfObjectsToCSV.bind(n),n.downloadCSV=n.downloadCSV.bind(n),n._fetchEquipmentExportData=n._fetchEquipmentExportData.bind(n),n.exportToPdf=n.exportToPdf.bind(n),n}return m(t,e),t.prototype.convertArrayOfObjectsToCSV=function(e){var t,n,i,o,l,r;if(r=e.data||null,o=e.columnDelimiter||",",l=e.lineDelimiter||"\n",null==r)return null;if(t="",r.equipments||r.thermostats)r.equipments&&r.equipments.length&&(t+=l,t+="Equipments",t+=l,t+=this.convertArrayOfObjectsToCSV({data:r.equipments})),r.thermostats&&r.thermostats.length&&(t+=l,t+="Thermostats",t+=l,t+=this.convertArrayOfObjectsToCSV({data:r.thermostats}));else{if(!r||!r.length)return null;var s=(i=Object.keys(r[0]).sort(function(e,t){if(e&&t)return e<t?-1:e>t?1:0})).join(o).replace(new RegExp(",zz_components","g"),"").replace(new RegExp(",zz_fixtures","g"),"").replace(new RegExp("z_","g"),"").replace(new RegExp("aa_","g"),"").replace(new RegExp("ab_","g"),"").replace(new RegExp("ac_","g"),"");r[0].aa_equip||(t+=l,t+=s,t+=l),r.forEach(function(e){e.aa_equip&&(t+=l,t+=s,t+=l),n=0,i.forEach(function(i){if(e[i]&&void 0!==e[i])if(n>0&&(t+=o),"zz_components"==i)null!=e[i]&&e[i].length&&(t+=a.convertArrayOfObjectsToCSV({data:e[i],lineDelimiter:" \n, "}));else if("zz_fixtures"==i)null!=e[i]&&e[i].length&&(t+=a.convertArrayOfObjectsToCSV({data:e[i],lineDelimiter:" \n, "}));else{var l=e[i].value.trim().replace(new RegExp(",","g"),"*");t+="z_powerSource"==i?e[i]&&l.length<100?l:"":l}else n>0&&(t+=o),t+="";n++}),t+=l})}return t},t.prototype._fetchEquipmentExportData=function(e){return p(this,void 0,void 0,function(){var t=this;return d(this,function(n){switch(n.label){case 0:return Object(o.a)(!0),[4,Object(l.e)(this.props.buildingName).then(function(n){return p(t,void 0,void 0,function(){var t,i=this;return d(this,function(c){switch(c.label){case 0:return n.map(function(e){Object(l.n)(i.props.buildingName,e.aa_equip.value).then(function(t){var n=[];t.map(function(e){var t=Object();t.z_ampere=e.ampere,t.ac_description=e.description,t.z_inputCapacity=e.inputCapacity,t.z_inputCapacityUnits=e.inputCapacityUnits,t.ab_location=e.location,t.ab_manufacturer=e.manufacturer,t.ab_model=e.model,t.aa_component=e.name,t.z_notes=e.notes,t.z_outputCapacity=e.outputCapacity,t.z_outputCapacityUnits=e.outputCapacityUnits,t.z_phase=e.phase,t.z_profile=e.profile,t.aa_label=e.rdfsLabel,t.aa_type=e.type,t.z_volts=e.volts,n.push(t)}),e.zz_components=n}),-1!=Object(r.g)(e.aa_type).indexOf("Lighting")?Object(l.r)(i.props.buildingName,e.aa_equip.value).then(function(t){var n=[];t.map(function(e){var t=Object();t.ab_ballast=e.ballast,t.z_color=e.color,t.z_control=e.control,t.z_description=e.description,t.aa_fixture=e.fixture,t.ab_fixtureQuantity=e.fixtureQuantity,t.aa_fixtureType=e.fixtureType,t.ab_lampType=e.lampType,t.ab_lensType=e.lensType,t.z_numberOfLampFixtures=e.numberOfLampFixtures,t.ab_switchType=e.switchType,t.z_wattsPerLamp=e.wattsPerLamp,n.push(t)}),e.zz_fixtures=n}):e.zz_fixtures=void 0}),[4,Object(s.t)(this.props.buildingName)];case 1:return t=c.sent(),setTimeout(function(){var i=n.filter(function(e){return-1==Object(r.g)(e.aa_type).indexOf("Lighting")});i.push.apply(i,n.filter(function(e){return-1!=Object(r.g)(e.aa_type).indexOf("Lighting")})),a.setState({data:{equipments:i,Insights:t}},function(){a.downloadCSV({filename:e}),Object(o.a)(!1)})},2500),[2]}})})}).catch(function(e){return e})];case 1:return n.sent(),[2]}})})},t.prototype.downloadCSV=function(e){return p(this,void 0,void 0,function(){var t,n,a,i,l,r;return d(this,function(s){return a=this.state.data,null==(i=this.convertArrayOfObjectsToCSV({data:a}))?(Object(o.a)(!1),[2]):(i=i.replace(new RegExp("null","g"),"None.").replace(new RegExp("undefined","g"),""),t=e.filename||"export.csv",l=new Blob([i],{type:"text/csv;charset=utf-8;"}),navigator.msSaveBlob?navigator.msSaveBlob(l,t):void 0!==(n=document.createElement("a")).download&&(r=URL.createObjectURL(l),n.setAttribute("href",r),n.setAttribute("download",t),n.style="visibility:hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)),[2])})})},t.prototype.exportToPdf=function(){return p(this,void 0,void 0,function(){var e=this;return d(this,function(t){return Object(o.a)(!0),$("*[id*=btn-detailSpace]")||$("*[id*=btn-detailEquip]"),setTimeout(function(){return p(e,void 0,void 0,function(){var e,t,n=this;return d(this,function(a){switch(a.label){case 0:return e=document.getElementById(this.props.ElementID),1!=(t=window.innerWidth/window.outerWidth)&&(document.body.style.zoom=t.toString()),[4,u(e,{scale:1}).then(function(t){return p(n,void 0,void 0,function(){var n,a,i,l,r,s,u,m,p,h,f,g,b,v,E,y,w;return d(this,function(d){for(n=new c("p","pt","a4"),a=e.clientWidth,i=1120/(850/a),l=0;l<=Math.abs(e.clientHeight/i);l++)r=t,s=0,u=i*l,m=a,p=i,h=0,f=0,g=a,b=i,(v=document.createElement("canvas")).setAttribute("width",a.toString()),v.setAttribute("height",i.toString()),v.getContext("2d").drawImage(r,s,u,m,p,h,f,g,b),E=v.toDataURL("image/png"),y=v.width,w=v.clientHeight,l>0&&n.addPage([595,842]),n.setPage(l+1),n.addImage(E,"PNG",0,20,y*(580/a),w*(400/a),void 0,"FAST");return n.save(this.props.filename+".pdf"),Object(o.a)(!1),[2]})})}).catch(function(e){Object(o.a)(!1)})];case 1:return a.sent(),[2]}})})},1500),[2]})})},t.prototype.render=function(){var e=this,t=this.props.filename+(new Date).getTime().toString()+".csv";return i.createElement(i.Fragment,null,i.createElement("button",{style:{marginLeft:3},className:"btn btn-dark btn-fill dropdown-toggle pull-right",type:"button","data-toggle":"dropdown"},i.createElement("span",null," Export"),i.createElement("b",{className:"caret"})),i.createElement("ul",{className:"dropdown-menu pull-right"},i.createElement("li",{onClick:function(){return e.exportToPdf()}},i.createElement("a",{href:"javascript:void(0)"},i.createElement("i",{className:"fa fa-file"})," PDF")),i.createElement("li",{onClick:function(){return e._fetchEquipmentExportData(t)}},i.createElement("a",{href:"javascript:void(0)"},i.createElement("i",{className:"fa fa-file"})," CSV"))))},t}(i.Component);t.a=h},1742:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),n(21)),o=n(932),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function l(e){try{s(a.next(e))}catch(e){o(e)}}function r(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(l,r)}s((a=a.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,a,i,o,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.checkInventory=n.checkInventory.bind(n),n}return l(t,e),t.prototype.checkInventory=function(e){return r(this,void 0,void 0,function(){var t,n,a,l;return s(this,function(r){switch(r.label){case 0:return t=this.props,n=t.instance,a=t.buildingName,[4,Object(o.g)("",e)];case 1:return(l=r.sent())&&l.length>0&&l[0]&&l[0].ontology?window.location.hash=n+"/"+a+"/ViewEquipmentInventory/"+Object(i.g)(l[0].ontology):window.location.hash=n+"/"+a+"/NewEquipmentInventory",[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,o=t.buildingName,l=t.columns,r=t.virtualBIM,s=t.cadBIM,c=t.n,u=t.i;this.state;return a.createElement(a.Fragment,null,a.createElement("a",{className:"pull-right equipspeclbtn","data-toggle":"collapse",href:"#equipDropdown"+u,title:"Click Me..."}," ",a.createElement("i",{style:{width:13,marginTop:4},className:"fa fa-ellipsis-h"})," "),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Inventory",onClick:function(t){e.checkInventory(Object(i.g)(c.equip))},style:{border:"1px solid transparent",backgroundColor:"#ef5a26"}},a.createElement("img",{className:"icon-img",src:"assets/img/inventory.png"})),l.find(function(e){return"Virtual BIM"==e.name&&1==e.selected})&&r&&a.createElement("button",{className:"btn-sm btn-success active pull-right custom-icon-btn",title:"Virtual BIM",style:{border:"1px solid transparent",backgroundColor:"#A69888"},onClick:function(){e.props.handleMatterport(c,r)}},a.createElement("img",{className:"icon-img",src:"assets/img/virtual-bim.png"})),l.find(function(e){return"CAD BIM"==e.name&&1==e.selected})&&s&&a.createElement("a",{className:"btn-sm btn-success active pull-right custom-icon-btn",title:"Digital Twin",href:s&&s.indexOf("ttp")>0?s:"http://"+s,target:"_blank",style:{border:"1px solid transparent",backgroundColor:"#963D5A"}},a.createElement("img",{className:"icon-img",src:"assets/img/digital-twin.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Points",onClick:function(e){window.location.hash=n+"/"+o+"/Points/Equip/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#FFC857"}},a.createElement("img",{className:"icon-img",src:"assets/img/points.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Devices",onClick:function(e){window.location.hash=n+"/"+o+"/Devices/Equip/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#399E5A"}},a.createElement("img",{className:"icon-img",src:"assets/img/devices.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Zones",onClick:function(e){window.location.hash=n+"/"+o+"/Zones/Equip/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#6A0136"}},a.createElement("img",{className:"icon-img",src:"assets/img/zones.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Work",onClick:function(e){window.location.hash=n+"/"+o+"/WorkOrders/Equip/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#5A5353"}},a.createElement("img",{className:"icon-img",src:"assets/img/work2.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Tasks",onClick:function(e){window.location.hash=n+"/"+o+"/Tasks/Equip/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#28AFB0"}},a.createElement("img",{className:"icon-img padding-5",src:"assets/img/Tasks2.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Space Insights",onClick:function(e){window.location.hash=n+"/"+o+"/Insights/EquipmentInsights/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#01BAEF"}},a.createElement("img",{className:"icon-img",src:"assets/img/insight.png"})),a.createElement("a",{className:"btn-sm btn-success pull-right custom-icon-btn",title:"Alarms",onClick:function(e){window.location.hash=n+"/"+o+"/Alarms/OperationalAlarms/Equip/"+c.equip.value},style:{border:"1px solid transparent",backgroundColor:"#D80C09"}},a.createElement("img",{className:"icon-img",src:"assets/img/alarm.png"})))},t}(a.Component);t.a=c}});