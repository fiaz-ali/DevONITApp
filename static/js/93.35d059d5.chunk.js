webpackJsonp([93],{1861:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(2),c=(n.n(i),n(649)),l=n(20),o=n(116),r=n(803),s=n(10),d=n(31),m=n(652),u=n(53),f=n(715),p=n(11),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),b=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,c){function l(e){try{r(a.next(e))}catch(e){c(e)}}function o(e){try{r(a.throw(e))}catch(e){c(e)}}function r(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(l,o)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,i,c,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function o(c){return function(o){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(i=2&c[0]?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return l.label++,{value:c[1],done:!1};case 5:l.label++,a=c[1],c=[0];continue;case 7:c=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){l=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){l.label=c[1];break}if(6===c[0]&&l.label<i[1]){l.label=i[1],i=c;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(c);break}i[2]&&l.ops.pop(),l.trys.pop();continue}c=t.call(e,l)}catch(e){c=[6,e],a=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,o])}}},y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isEdit:!1,documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},Documents:[],DocumentTypes:f.c,itemToDelete:Object(),files:[]},a=n,n.handleTypeFilters=n.handleTypeFilters.bind(n),n.handleDocumentForm=n.handleDocumentForm.bind(n),n.saveDocument=n.saveDocument.bind(n),n.fetchDocuments=n.fetchDocuments.bind(n),n.onDeleteDocument=n.onDeleteDocument.bind(n),n.deleteDocument=n.deleteDocument.bind(n),n}return h(t,e),t.prototype.componentDidMount=function(){return b(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this.fetchDocuments()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.fetchDocuments=function(){return b(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,Object(r.b)(this.props.buildingName).then(function(e){a.setState({Documents:e})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.handleTypeFilters=function(e){var t=e.target.checked,n=this.state.DocumentTypes;n[n.findIndex(function(t){return t.Type===e.target.value})].visible=t,this.setState({DocumentTypes:n});var a=[],i=f.d;if(i){for(var c=0;c<i.length;c++)for(var l=0;l<n.length;l++)n[l].Type==i[c].Type&&1==n[l].visible&&a.push(i[c]);this.setState({Documents:a})}},t.prototype.saveDocument=function(){return b(this,void 0,void 0,function(){var e,t,n,i,c,s,d,m,f,h=this;return v(this,function(y){switch(y.label){case 0:return e=this.state,t=e.documentObject,n=e.isEdit,i=e.itemToDelete,t&&t.infoEntity?(Object(o.a)(!0),1!=n?[3,2]:[4,Object(r.e)(this.props.buildingName,t,this.state.isEdit,i)]):[3,5];case 1:return y.sent(),[3,4];case 2:return c=JSON.parse(p.a.getItem("user")),t.enteredBy=c.contact,[4,Object(r.e)(this.props.buildingName,t,this.state.isEdit)];case 3:y.sent(),y.label=4;case 4:if(s=new u.b,(d=Object(l.d)())&&d.length)for(m=0;m<d.length;m++)(f=d[m])||(f=d[m].file),f&&s.UploadFile(u.a.COMMUNITYDOCS(),t.s3FileName[m],f,function(e,t){e?console.log(e):console.log(t)});this.setState({documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},files:[],isEdit:!1},function(){return b(h,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,a.fetchDocuments()];case 1:return e.sent(),[2]}})})}),Object(o.a)(!1),y.label=5;case 5:return[2]}})})},t.prototype.onDeleteDocument=function(e){return b(this,void 0,void 0,function(){return v(this,function(t){return this.setState({itemToDelete:e}),[2]})})},t.prototype.deleteDocument=function(){return b(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=this.state.itemToDelete).documentName.value?[4,Object(d.e)(e.documentName.value,l.b.DOCS)]:[3,3];case 1:return t.sent(),[4,this.fetchDocuments()];case 2:t.sent(),Object(r.c)(e.rdfsLabel.value).then(function(t){t&&0==t.length&&(new u.b).DeleteFile(u.a.COMMUNITYDOCS(),e.rdfsLabel.value)}),t.label=3;case 3:return[2]}})})},t.prototype.onEditDocument=function(e){return b(this,void 0,void 0,function(){var t;return v(this,function(n){return(t=this.state.documentObject).infoEntity=[],t.documentType=e.documentType&&e.documentType.value,t.rdfsLabel=e.rdfsLabel&&e.rdfsLabel.value,t.documentName=e.documentName&&e.documentName.value,t.enteredBy=e.enteredBy&&e.enteredBy.value,t.enteredByName=e.enteredByName&&e.enteredByName.value,this.setState({documentObject:t,isEdit:!0,itemToDelete:e}),document.getElementById("btnDocumentForm").click(),[2]})})},t.prototype.handleDocumentForm=function(e,t){this.setState({documentObject:e,files:t})},t.prototype.render=function(){var e=this,t=this.state,n=t.Documents,a=t.DocumentTypes,o=t.documentObject,r=(this.props,Object(l.c)()),d=o.rdfsLabel&&(o.s3FileName&&r||o.linkToDocument)&&!0;return i.createElement("div",{className:"content"},i.createElement("div",{className:"container-fluid"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement(c.a,{id:"filterDocumentsModal",heading:"Filter Documents",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},a&&a.length>0&&a.map(function(t,n){return!0===t.visible?i.createElement("div",{key:t+"-"+n},i.createElement("input",{checked:!0,type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",i.createElement("label",null,t.Type)):i.createElement("div",null,i.createElement("input",{type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",i.createElement("label",null,t.Type))})),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement("button",{type:"button",className:"btn btn-dark pull-right","data-toggle":"modal","data-target":"#documentFormDialog",onClick:function(){e.setState({isEdit:!1,files:[],documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""}})}},i.createElement("i",{className:"fa fa-plus"})," Add "))),i.createElement("br",null),i.createElement("div",{className:"card padding-10"},i.createElement("div",{className:""},i.createElement("h4",{className:"title"},"Community Documents")),i.createElement("div",{className:"content"},i.createElement("div",{className:"dataCard"},i.createElement("div",{className:"row hidden-sm hidden-xs no-padding"},i.createElement("div",{className:"col-md-10 col-sm-12  no-padding dataCard"},i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header-left"},"Name"),i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header"},"Link"),i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header"},"Date"),i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header"},"Entered By")),i.createElement("div",{className:"col-md-1 col-sm-12 headingText"})),n&&n.length>0&&n.map(function(t,n){var a=Object(s.g)(t.linkToDocument);a=a?a.indexOf("ttp")>0?a:"http://"+a:"";var c=new u.b;return i.createElement("div",{key:t.documentName+"-"+n,className:"row no-padding"},""!=Object(s.g)(t.rdfsLabel)&&i.createElement("div",{className:"no-padding"},i.createElement("div",{className:"col-md-10 col-sm-12  no-padding"},i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.rdfsLabel)},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Name"),i.createElement("a",{href:""+c.GetSignedURL(u.a.COMMUNITYDOCS(),encodeURIComponent(Object(s.g)(t.s3FileName?t.s3FileName:t.rdfsLabel))),target:"_blank"},Object(s.g)(t.rdfsLabel))),i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.linkToDocument)},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Link"),i.createElement("a",{href:a,target:"_blank"},a)),i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.date)?new Date(Object(s.g)(t.date)).YYMMDDHHMM():""},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Date"),Object(s.g)(t.date)?new Date(Object(s.g)(t.date)).YYMMDDHHMM():""),i.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.enteredByName)},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Entered By"),Object(s.g)(t.enteredByName))),i.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12",style:{paddingTop:"3px"}},i.createElement("button",{className:"btn-sm btn-danger active pull-right","data-toggle":"modal","data-target":"#ConfirmDeleteDialog",onClick:function(n){e.onDeleteDocument(t)}},i.createElement("i",{className:"fa fa-trash"})," Delete "))))}),i.createElement("button",{type:"button",id:"btnDocumentForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#documentFormDialog"}," ."),i.createElement(c.a,{id:"documentFormDialog",onSaveButtonClick:function(){e.saveDocument()},saveButtonText:"Save",disableSaveButton:!d}),i.createElement(m.a,{instance:this.props.instance,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this item?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteDocument()}}))))))))},t}(i.Component);t.default=y}});