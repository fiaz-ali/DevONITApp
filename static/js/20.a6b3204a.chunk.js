webpackJsonp([20],{1012:function(e,t,n){"use strict";t.g=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.f)(e,i.a.TICKETS.AddNewTicket,s.b.TICKET).then(function(){Object(a.b)("Ticket Added")}).catch(function(e){Object(a.a)("Error occured while saving Ticket.")})];case 1:return[2,t.sent()]}})})},t.h=function(e,t){return o(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(i.f)({ticketType:e},i.a.TICKETS.AddNewTicketType,s.b.TICKET).then(function(){Object(a.b)("Ticket Type "+(t?"Updated":"Added"))}).catch(function(e){Object(a.a)("Error occured while saving Ticket Type.")})];case 1:return[2,n.sent()]}})})},t.b=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({ticketTypeOntology:e},i.a.TICKETS.DeleteTicketType,s.b.TICKET).then(function(){Object(a.b)("Ticket Type Deleted")}).catch(function(e){Object(a.a)("Error occured while deleting Ticket Type.")})];case 1:return[2,t.sent()]}})})},t.f=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,Object(i.e)({},i.a.TICKETS.GetAllTickets,s.b.TICKET,!0)];case 1:return[2,e.sent()]}})})},t.d=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,Object(i.e)({},i.a.TICKETS.GetTicketTypes,s.b.TICKET)];case 1:return[2,e.sent()]}})})},t.c=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({ticketTypeOntology:e},i.a.TICKETS.GetTicketTypeUsingOntology,s.b.TICKET,!0)];case 1:return[2,t.sent()]}})})},t.e=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({ticketOntology:e},i.a.TICKETS.GetTicketUsingOntology,s.b.TICKET,!0)];case 1:return[2,t.sent()]}})})},t.a=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({ticketOntology:e},i.a.TICKETS.DeleteTicket,s.b.TICKET).then(function(){Object(a.b)("Ticket Deleted")}).catch(function(e){Object(a.a)("Error occured while deleting Ticket.")})];case 1:return[2,t.sent()]}})})};var a=n(30),s=n(20),i=n(12),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,r)}c((a=a.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}}},2119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),s=(n.n(a),n(30)),i=n(101),o=n(937),r=n(20),c=n(10),l=n(649),u=n(624),d=n(609),m=n(756),g=n(606),p=n(29),f=n(706),b=n(610),h=n(11),v=n(104),y=n(642),T=n(1012),k=n(697),O=n(622),E=n(671),w=n(2120),j=n(614),S=n(52),N=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),D=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,r)}c((a=a.apply(e,t||[])).next())})},A=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},x="",C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={building:"Select Building",ticketType:"",_buildings:[],_floors:[],_spaces:[],_assets:[],_components:[],_ticketType:[],ticketObject:{customerName:"",timeStamp:"",customerEmail:"",ticketTypeOntology:"",componentOntology:"",enteredBy:"",acutalFindFix:"",assetOntology:"",buildingOntology:"",ticketIssue:"",criticalityOntology:"",facilatatorOntology:"",floorOntology:"",imageUrl:"",ontology:(new Date).Ticket_Number(),spaceOntology:"",suggestionFix:""},phaseTemplateDetailList:[],emailsList:[],peopleList:[],actions:[],isTicketSaved:!1,departments:[],StageOntology:"",subTaskOntology:"",wfOntology:""},n.ticketTypeChangeHandler=n.ticketTypeChangeHandler.bind(n),n.buildingChangeHandler=n.buildingChangeHandler.bind(n),n.getFloorBasesOnBuildingHandler=n.getFloorBasesOnBuildingHandler.bind(n),n.floorChangeHandler=n.floorChangeHandler.bind(n),n.getSpacesBasedOnFloorHandler=n.getSpacesBasedOnFloorHandler.bind(n),n.spaceChangeHandler=n.spaceChangeHandler.bind(n),n.getAssetsHandler=n.getAssetsHandler.bind(n),n.assetChangeHandler=n.assetChangeHandler.bind(n),n.getComponentsHandler=n.getComponentsHandler.bind(n),n.checkingValidations=n.checkingValidations.bind(n),n.saveTicketHandler=n.saveTicketHandler.bind(n),n.handleActivateStage=n.handleActivateStage.bind(n),n._fetchDepartmentOrGroup=n._fetchDepartmentOrGroup.bind(n),n.handleAssignTo=n.handleAssignTo.bind(n),n}return N(t,e),t.prototype.componentDidMount=function(){return D(this,void 0,void 0,function(){var e,t,n,a;return A(this,function(s){switch(s.label){case 0:return[4,this._fetchBuildings()];case 1:return s.sent(),[4,this._fetchTicketTypes()];case 2:return s.sent(),[4,this._fetchPhaseTemplateDetails()];case 3:return s.sent(),[4,this._fetchContact()];case 4:return s.sent(),[4,this._fetchDepartmentOrGroup()];case 5:return s.sent(),this.props.ticketOntology?[4,Object(T.e)(this.props.ticketOntology)]:[3,10];case 6:return e=s.sent(),[4,Object(b.g)(e.floorOntology,e.buildingOntology)];case 7:return t=s.sent(),[4,Object(l.g)(e.buildingOntology,r.b.POINT,e.floorOntology,e.spaceOntology)];case 8:return n=s.sent(),[4,Object(g.o)(e.buildingOntology,e.assetOntology)];case 9:return a=s.sent(),this.setState({ticketObject:e,_spaces:t,_assets:n,_components:a}),[3,11];case 10:this.setState({building:this.props.buildingName}),s.label=11;case 11:return[2]}})})},t.prototype.componentWillUnmount=function(){return D(this,void 0,void 0,function(){return A(this,function(e){return this.setState({ticketObject:Object(),_spaces:[],_assets:[],_components:[]}),[2]})})},t.prototype._fetchBuildings=function(){return D(this,void 0,void 0,function(){var e=this;return A(this,function(t){switch(t.label){case 0:return[4,Object(u.d)().then(function(t){e.setState({_buildings:t}),e.buildingChangeHandler(t[0].building.value,t[0].rdfsLabel.value)}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._fetchTicketTypes=function(){return D(this,void 0,void 0,function(){var e=this;return A(this,function(t){switch(t.label){case 0:return[4,Object(T.d)().then(function(t){e.setState({_ticketType:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._fetchPhaseTemplateDetails=function(){return D(this,void 0,void 0,function(){var e=this;return A(this,function(t){switch(t.label){case 0:return[4,Object(k.j)(this.props.buildingName).then(function(t){e.setState({phaseTemplateDetailList:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._fetchContact=function(){return D(this,void 0,void 0,function(){var e;return A(this,function(t){switch(t.label){case 0:return[4,Object(d.p)(this.props.buildingName)];case 1:return(e=t.sent())&&this.setState({peopleList:e}),[2]}})})},t.prototype._fetchDepartmentOrGroup=function(){return D(this,void 0,void 0,function(){var e=this;return A(this,function(t){switch(t.label){case 0:return[4,Object(d.f)().then(function(t){t&&t.length>0&&e.setState({departments:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype.ticketTypeChangeHandler=function(e){return D(this,void 0,void 0,function(){var t;return A(this,function(n){return t=this.state.ticketObject,this.setState({ticketType:e}),t.ticketTypeOntology=e,[2]})})},t.prototype.buildingChangeHandler=function(e,t){return D(this,void 0,void 0,function(){var n;return A(this,function(a){return(n=this.state.ticketObject).buildingOntology=e,n.buildingLabel=t,this.setState({ticketObject:n,building:e}),this.getFloorBasesOnBuildingHandler(e),[2]})})},t.prototype.getFloorBasesOnBuildingHandler=function(e){return D(this,void 0,void 0,function(){var t;return A(this,function(n){switch(n.label){case 0:return[4,Object(O.f)(e)];case 1:return t=n.sent(),this.setState({_floors:t,_spaces:[],_assets:[],_components:[]}),[2]}})})},t.prototype.floorChangeHandler=function(e,t){return D(this,void 0,void 0,function(){var n;return A(this,function(a){return(n=this.state.ticketObject).floorOntology=e,n.floorLabel=t,this.setState({ticketObject:n}),this.getSpacesBasedOnFloorHandler(e),[2]})})},t.prototype.getSpacesBasedOnFloorHandler=function(e){return D(this,void 0,void 0,function(){var t;return A(this,function(n){switch(n.label){case 0:return[4,Object(b.g)(e,this.state.building)];case 1:return t=n.sent(),this.setState({_spaces:t,_assets:[],_components:[]}),[2]}})})},t.prototype.spaceChangeHandler=function(e,t){return D(this,void 0,void 0,function(){var n;return A(this,function(a){return(n=this.state.ticketObject).spaceOntology=e,n.spaceLabel=t,this.setState({ticketObject:n}),this.getAssetsHandler(e),[2]})})},t.prototype.getAssetsHandler=function(e){return D(this,void 0,void 0,function(){var t;return A(this,function(n){switch(n.label){case 0:return""==e?(this.setState({_assets:[],_components:[]}),[2]):[4,Object(l.g)(this.state.building,r.b.POINT,this.state.ticketObject.floorOntology,e)];case 1:return t=n.sent(),this.setState({_assets:t,_components:[]}),[2]}})})},t.prototype.assetChangeHandler=function(e,t){return D(this,void 0,void 0,function(){var n;return A(this,function(a){return(n=this.state.ticketObject).assetOntology=e,n.assetLabel=t,this.setState({ticketObject:n}),this.getComponentsHandler(e),[2]})})},t.prototype.getComponentsHandler=function(e){return D(this,void 0,void 0,function(){var t;return A(this,function(n){switch(n.label){case 0:return[4,Object(g.o)(this.state.building,e)];case 1:return t=n.sent(),this.setState({_components:t}),[2]}})})},t.prototype.componentChangeHandler=function(e,t){return D(this,void 0,void 0,function(){var n;return A(this,function(a){return(n=this.state.ticketObject).componentOntology=e,n.componentLabel=t,this.setState({ticketObject:n}),[2]})})},t.prototype.checkingValidations=function(e,t){document.getElementById(e).classList.add("text-success"),document.getElementById(t).classList.add("is-valid")},t.prototype.saveTicketHandler=function(){return D(this,void 0,void 0,function(){var e,t,n,a,s,o,r,l,u,d,g,b,v,k,O,E,w=this;return A(this,function(j){switch(j.label){case 0:return Object(i.a)(!0),e=this.props.buildingName,t=this.state,n=t.ticketObject,a=t._ticketType,s=t.wfOntology,o=t.StageOntology,r=t.subTaskOntology,document.getElementById("btnSave").setAttribute("disabled","disabled"),l=JSON.parse(h.a.getItem("user")),n.enteredBy=l.contact,u=n.ticketTypeOntology,d=a.find(function(e){return e.ontology==u}).notifyManager,[4,Object(T.c)(u)];case 1:g=j.sent(),b=g.split(","),v=function(t){var a,i,l,u,g,h,v,T,O,E,j,S,N,x;return A(this,function(C){switch(C.label){case 0:for(a=k.state.phaseTemplateDetailList.find(function(e){return e.ontology===b[t]}),i="Dynamic"==a.behaviour,l=[],u=0;u<a.stageTemplates.length;u++)(l=a.stageTemplates[u].subTasks.map(function(e){return e.ontology})).push.apply(l,l);return[4,Object(f.c)(k.props.buildingName,l)];case 1:g=C.sent(),(h=Object()).ontology=Object(p.p)(7),s=s+h.ontology+",",h.description=a.description,h.module=a.module,h.status="Planned",h.phaseID=Object(p.n)(7).toString(),h.templateID=a.templateID,h.templateType=a.templateType,h.stageTemplateOnology=[],h.ticketOntology=n.ontology,h.stages=[],h.estimatedStartTime=a.estimatedStartTime,h.estimatedEndTime=a.estimatedEndTime,v=[],T=a.facilitatorAssigned,v[0]=Object(),v[0].label=T,v[0].value=T,h.facilitatorAssigned=v[0],h.notifyManager=d,O=[],E=[],j=function(t){var s,l,u,d,f,b,v,y,T,w,j;return A(this,function(S){switch(S.label){case 0:for(s=a.stageTemplates[t],l=Object(),u=Object(p.p)(7),l.task=u,d="",d+=Object(p.o)(),l.color=d,o=o+u+",",l.wfOntology=h.ontology,l.taskNumber=Object(p.n)(7).toString(),l.description=s.description,l.action=s.action,l.enteredBy=s.enteredBy,l.enteredByName=s.enteredByName,l.assignedTo=s.assignedTo,s.assignedDepartment&&""!=s.assignedDepartment&&(f=k.state.peopleList&&k.state.peopleList.find(function(e){return Object(c.g)(e.departmentsAndGroups).includes(s.assignedDepartment)&&Object(c.g)(e.assignedTo).includes(s.building)&&"2"==Object(c.g)(e.role)}),l.assignedTo=void 0!==f?[{label:Object(c.g)(f.name),value:Object(c.g)(f.contact)}]:s.assignedTo),l.hasChat=!0,l.entryTimeStamp=s.entryTimeStamp,l.criticality=s.criticality,l.equipSubject=s.equipSubject,l.equipRdfsLabel=s.equipRdfsLabel,l.spaceSubject=s.spaceSubject,l.spaceRdfsLabel=s.spaceRdfsLabel,l.floor=s.floor,l.building=s.building,l.workOrder=s.workOrder,l.status="Pending",l.acknowledged=!0,l.archived=!1,l.startTime="",l.note="",l.isSequence=!0,l.QRTag=s.QRTag,l.isQRTask=s.isQRTask,l.subTasks=[],l.workflowType=s.workflowType,l.redirectionLink=s.redirectionLink,l.isStage=!0,l.isActivated=!1,l.estimatedStartTime=new Date,l.workflowDescription=a.description,b=0,v=0;v<s.subTasks.length;v++)y=s.subTasks[v],b+=parseInt(y.duration);T=l.subTasks.length>0?new Date(l.subTasks[0].estimatedStartTime):new Date,l.estimatedEndTime=new Date(T.setHours(T.getHours()+b)),l.ticketOntology=n.ontology,l.subTasks=[],w=function(t){var a,o,u,f,b,v,y,T,k,w,j,S;return A(this,function(N){switch(N.label){case 0:return a=s.subTasks[t],(o=Object()).subTask=Object(p.p)(7),o.color=d,r=r+o.subTask+",",[4,Object(m.d)(e,["TaskTemplate"],[a.ontology])];case 1:if((u=N.sent())&&u.length>0&&u[0].entityOntology)for(f=0;f<u.length;f++)b=Object(),v=u[f],b.docOntology=o.subTask+Object(p.t)()+f,b.building=Object(c.g)(v.building),b.documentType=Object(c.g)(v.documentType),b.enteredBy=Object(c.g)(v.enteredBy),b.entityOntology=[{label:o.subTask,value:o.subTask}],b.entityType="Task",b.entryTimeStamp=(new Date).toString(),b.rdfsLabel=Object(c.g)(v.rdfsLabel),b.s3FileName=Object(c.g)(v.s3FileName),E.push(b);for(o.taskNumber=Object(p.n)(7).toString(),o.description=a.description,o.action=a.action,o.enteredBy=a.enteredBy,o.enteredByName=a.enteredByName,o.assignedTo=a.assignedTo,o.assignedDepartment=a.assignedDepartment,o.hasChat=!0,o.entryTimeStamp=a.entryTimeStamp,o.criticality=a.criticality,o.equipSubject=l.equipSubject,o.equipRdfsLabel=l.equipRdfsLabel,o.spaceSubject=l.spaceSubject,o.spaceRdfsLabel=l.spaceRdfsLabel,o.building=l.building,o.workOrder=a.workOrder,o.status="Planned",o.acknowledged=!0,o.archived=!1,o.index=a.index,o.parentTask=l.task,o.note=a.note,o.relatedLink=a.relatedLink,o.duration=a.duration,o.durationUnit=a.durationUnit,o.workerDuration=a.workerDuration,o.workerDurationUnit=a.workerDurationUnit,o.fileName=a.fileName,o.oldFileName=a.oldFileName,o.startTime="",o.workType=a.workType,o.checklistID=a.checklistID,o.isQRTask=a.isQRTask,o.QRTag=a.QRTag,o.notifyViaEmail=a.notifyViaEmail,o.notifyViaSMS=a.notifyViaSMS,o.estimatedStartTime=a.estimatedStartTime,o.estimatedEndTime=a.estimatedEndTime,o.workflowType=a.workflowType,o.redirectionLink=a.redirectionLink,o.isStage=!0,o.isActivated=!1,o.acknowledged=!0,o.archived=!1,o.ticketOntology=n.ontology,o.wfOntology=h.ontology,l.subTasks.push(o),y=g.filter(function(e){return e.taskOntology==a.ontology}),T=0;T<y.length;T++)k=y[T],(w=Object()).ontology=Object(p.p)(10),w.directive=k.directive,w.directiveType=k.directiveType,w.floorOntology=i?n.floorOntology:k.floorOntology,w.spaceOntology=i?n.spaceOntology:k.spaceOntology,w.componentOntology=i?n.componentOntology:k.componentOntology,w.assetOntology=i?n.assetOntology:k.assetOntology,w.pointOntology=i?"":k.pointOntology,w.unit=k.unit,w.taskOntology=o.subTask,w.taskDescription=k.taskDescription,w.isTemplate=!1,w.objectTemplateReferenceID=k.ontology,w.isQrCodeVerified=!1,w.qrCode=k.qrCode,w.visibleObjectFormActions=[],O.push(w);for(j=function(e){var t=O[e],n=g.find(function(e){return e.ontology==t.objectTemplateReferenceID});if(n.visibleObjectFormActions&&n.visibleObjectFormActions.length>0)for(var a=function(e){var a=n.visibleObjectFormActions[e];if(""!=a){var s=g.find(function(e){return e.ontology==a}),i=O.find(function(e){return e.objectTemplateReferenceID==s.ontology});-1==t.visibleObjectFormActions.findIndex(function(e){return e==i.ontology})&&t.visibleObjectFormActions.push(i.ontology)}},s=0;s<n.visibleObjectFormActions.length;s++)a(s)},S=0;S<O.length;S++)j(S);return[2]}})},j=0,S.label=1;case 1:return j<s.subTasks.length?[5,w(j)]:[3,4];case 2:S.sent(),S.label=3;case 3:return j++,[3,1];case 4:return h&&h.stages&&h.stages.push(l),[2]}})},S=0,C.label=2;case 2:return S<a.stageTemplates.length?[5,j(S)]:[3,5];case 3:C.sent(),C.label=4;case 4:return S++,[3,2];case 5:return N=Object(y.d)(new Date,h),E.length>0&&E.map(function(e){return D(w,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return[4,Object(m.f)(e)];case 1:return t.sent(),[2]}})})}),[4,Object(f.d)(e,O)];case 6:return C.sent(),[4,Object(y.e)(e,N,!1,!0).then(function(e){return D(w,void 0,void 0,function(){return A(this,function(e){return[2]})})}).catch(function(e){return e})];case 7:return C.sent(),a.stageTemplateOnology&&a.stageTemplateOnology.length>0?(x=a.uses?a.uses+1:1,[4,Object(y.f)(e,a.ontology,x.toString()).then(function(e){}).catch(function(e){return e})]):[3,9];case 8:C.sent(),C.label=9;case 9:return[2]}})},k=this,O=0,j.label=2;case 2:return O<b.length?[5,v(O)]:[3,5];case 3:j.sent(),j.label=4;case 4:return O++,[3,2];case 5:return s=s.substr(0,s.length-1),o=o.substr(0,o.length-1),r=r.substr(0,r.length-1),n.deployedWFOntology=s,n.stageOntology=o,n.subTasksOntology=r,""===n.customerEmail?[3,7]:((E=Object()).subject="Ticket Creation Notification",E.to=n.customerEmail,E.text="A new ticket having case# <b>"+n.ontology+'</b> having issue <br>"'+n.ticketIssue.replace(/\n/g,"<br>")+'"<br>For Building: "'+n.buildingLabel+'"'+(""!==n.floorOntology?', Floor: "'+n.floorLabel+'"':"")+(""!==n.spaceOntology?', Space: "'+n.spaceLabel+'"':"")+(""!==n.assetOntology?', Asset: "'+n.assetLabel+'"':"")+(""!==n.componentOntology?', Component: "'+n.componentLabel+'"':"")+" has been created.",[4,Object(S.a)(E,!0)]);case 6:j.sent(),j.label=7;case 7:return[4,Object(T.g)(n)];case 8:return j.sent(),Object(i.a)(!1),this.setState({isTicketSaved:!0}),[2]}})})},t.prototype.handleAssignTo=function(e){var t=this.state.ticketObject;t.notifyPeople=e,this.setState({ticketObject:t})},t.prototype.handleActivateStage=function(e,t,n){return D(this,void 0,void 0,function(){var a,o,r,l,u,d;return A(this,function(m){switch(m.label){case 0:if(a=this.props.buildingName,o=this.state.peopleList,r=this.state.emailsList,e.startTime=n&&null!=n?0==n?new Date(Date.now()).toString():"":new Date(Date.now()).toString(),e.startTaskCondition=n&&null!=n?0==n?"daytime":"completionof":"daytime",e.conditionalTasks=n&&null!=n?0==n?[]:[{label:x,value:x}]:[],e.status=n&&null!=n?0==n?"Assigned":"Pending":"Assigned",e.acknowledged=!0,e.isSequence=!0,e.archived=!1,e.isDeleted=!1,e.isActivated=!0,e.workflowType=e.workflowType?e.workflowType:t,e.assignedTo&&e.assignedTo.length>0)for(l=function(t){if(e.assignedTo[t]&&e.assignedTo[t].value){var n=o&&o.find(function(n){return Object(c.g)(n.contact)==e.assignedTo[t].value});if(r||(r=[]),n&&n.email)r.find(function(e){return e==Object(c.g)(n.email)})||r.push(Object(c.g)(n.email))}},d=0;d<e.assignedTo.length;d++)l(d);for(e.hasChat=!0,u=function(a){if(e.subTasks[a].workflowType=e.workflowType?e.workflowType:t,e.subTasks[a].isActivated=!0,e.subTasks[a].assignedTo&&e.subTasks[a].assignedTo.length>0){var s=o&&o.find(function(t){return Object(c.g)(t.contact)==e.subTasks[a].assignedTo});if(r||(r=[]),s&&s.email)r.find(function(e){return e==Object(c.g)(s.email)})||r.push(Object(c.g)(s.email))}e.subTasks[a].startTime=n&&null!=n?0==n&&0==a?new Date(Date.now()).toString():"":0==a?new Date(Date.now()).toString():"",e.subTasks[a].status=n&&null!=n?0==n&&0==a?"Assigned":"Pending":0==a?"Assigned":"Pending",e.subTasks[a].acknowledged=!0,e.subTasks[a].isDeleted=!1,e.subTasks[a].startTaskCondition=n&&null!=n?0==n&&0==a?"daytime":"completionof":0==a?"daytime":"completionof",e.subTasks[a].conditionalTasks=n&&null!=n?0==n&&0==a?[]:n>0&&0==a?[{label:x,value:x}]:[{label:e.subTasks[a-1].subTask,value:e.subTasks[a-1].subTask}]:a>0?[{label:e.subTasks[a-1].subTask,value:e.subTasks[a-1].subTask}]:[],x=e.task},d=0;d<e.subTasks.length;d++)u(d);return Object(i.a)(!0),"Contract"!=t?[3,2]:[4,Object(v.z)(r,["read"],e.contractFileName).then(function(t){if(t.link){var n=t.link[0].link.webUrl;e.contractFileUrl=n;for(var o=0;o<e.subTasks.length;o++){e.subTasks[o].contractFileUrl=n}Object(v.x)(a,e,!0),Object(y.g)("","Assigned",!0).then(function(){}),Object(i.a)(!1)}else console.log(t),Object(s.a)("Error occured while requesting permissions for Contract File.")})];case 1:return m.sent(),[3,5];case 2:return[4,Object(v.x)(a,e,!0)];case 3:return m.sent(),[4,Object(y.g)("","Assigned",!0).then(function(){})];case 4:m.sent(),Object(i.a)(!1),m.label=5;case 5:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,s=t.buildingName,i=t.isView,l=this.state,u=l._buildings,d=l._floors,m=l._spaces,g=l._assets,f=l._components,b=l._ticketType,h=l.ticketObject,v=l.departments,y=l.peopleList,T=this.props.isView?"none":"block",k=this.state.isTicketSaved?"block":"none",O=y&&y.length>0?y.map(function(e){return{value:Object(c.g)(e.contact),label:e.name?Object(c.g)(e.name)+" ("+r.e[Object(c.g)(e.role)]+")":Object(c.g)(e.contact)+" ("+Object(c.g)(e.qualifications)+")"}}).filter(function(e){return Object(c.g)(e)!=(h.notifyPeople&&h.notifyPeople.find(function(t){return Object(c.g)(t)==Object(c.g)(e)})?Object(c.g)(h.notifyPeople.find(function(t){return Object(c.g)(t)==Object(c.g)(e)})):"")}):[],S=""!==h.ticketTypeOntology&&""!==h.ticketIssue,N=h.deployedWFOntology&&h.deployedWFOntology.split(",");return a.createElement(a.Fragment,null,a.createElement("div",{className:""},a.createElement("div",{className:""},a.createElement("div",{className:""},a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid small"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-lg-6 col-md-12 col-sm-12 col-xs-12 no-padding"},a.createElement("div",{className:"card p-2 no-margin"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row no-margin p-2"},a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"ONIT Case Type: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{name:"ticketType",id:"ticketType",className:"form-control",value:h.ticketTypeOntology,disabled:i,onChange:function(t){e.ticketTypeChangeHandler(t.target.value)}},a.createElement("option",{value:""},"Select Case Type "),b&&b.length>0&&b.map(function(e,t){return a.createElement("option",{key:t,value:e.ontology},e.ticketType," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{id:"issueLabel",className:"col-md-3 py-2 px-0 headingText"}," Describe the Issue:"),a.createElement("div",{className:"col-md-9 no-padding "},a.createElement("textarea",{id:"issue",rows:6,className:"form-control",value:h.ticketIssue,disabled:i,style:{width:"422px !important",resize:"none"},onChange:function(t){h.ticketIssue=t.target.value,e.setState({ticketObject:h})}}))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Building: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{className:"form-control",name:"building",disabled:i,value:h.buildingOntology,id:"building",onChange:function(t){var n=t.target.selectedIndex,a=t.nativeEvent.target[n].text;e.buildingChangeHandler(t.target.value,a)}},u&&u.length>0&&u.map(function(e,t){return a.createElement("option",{key:t,value:Object(c.g)(e.building)},Object(c.g)(e.rdfsLabel)," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Floor: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{className:"form-control",id:"floor",name:"floor",disabled:i,value:h.floorOntology,onChange:function(t){var n=t.target.selectedIndex,a=t.nativeEvent.target[n].text;e.floorChangeHandler(t.target.value,a)}},a.createElement("option",{value:""},"Select Floor"),d&&d.length>0&&d.map(function(e,t){return a.createElement("option",{value:Object(c.g)(e.ontology),key:t},e.rdfsLabel.value," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Space: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{className:"form-control",id:"space",name:"space",value:h.spaceOntology,disabled:i,onChange:function(t){var n=t.target.selectedIndex,a=t.nativeEvent.target[n].text;e.spaceChangeHandler(t.target.value,a)}},a.createElement("option",{value:""},"Select Space"),m&&m.length>0&&m.map(function(e,t){return a.createElement("option",{value:Object(c.g)(e.ontology),key:t},e.rdfsLabel.value," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Asset: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{className:"form-control",id:"asset",name:"asset",value:h.assetOntology,disabled:i,onChange:function(t){var n=t.target.selectedIndex,a=t.nativeEvent.target[n].text;e.assetChangeHandler(t.target.value,a)}},a.createElement("option",{value:""},"Select Assets"),g&&g.length>0&&g.map(function(e,t){return a.createElement("option",{value:Object(c.g)(e.ontology),key:t},e.rdfsLabel.value," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Component: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{className:"form-control",id:"component",name:"component",value:h.componentOntology,disabled:i,onChange:function(t){var n=t.target.selectedIndex,a=t.nativeEvent.target[n].text;e.componentChangeHandler(t.target.value,a)}},a.createElement("option",{value:""},"Select Component"),f&&f.length>0&&f.map(function(e,t){return a.createElement("option",{value:Object(c.g)(e.name),key:t},e.rdfsLabel.value," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Concern: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{name:"ticketType",id:"ticketType",className:"form-control",value:h.criticalityOntology,disabled:i,onChange:function(t){h.criticalityOntology=t.target.value,e.setState({ticketObject:h})}},a.createElement("option",{value:""},"Select Concern"),o.c&&o.c.length>0&&o.c.map(function(e,t){return a.createElement("option",{key:t,value:e.id}," ",e.id," - ",e.name," ")})))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Suggest Fix: "),a.createElement("div",{className:"col-md-9 no-padding "},a.createElement("textarea",{rows:4,className:"form-control",value:h.suggestionFix,disabled:i,onChange:function(t){h.suggestionFix=t.target.value,e.setState({ticketObject:h})}})))))))),a.createElement("div",{className:"col-lg-6 col-md-12 col-sm-12 col-xs-12 no-padding"},a.createElement("div",{className:"card p-2 no-margin"},a.createElement("div",{className:"container-fluid p-1"},a.createElement("div",{className:"content p-1"},a.createElement("div",{className:"row no-margin p-2"},a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Customer Name: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("input",{className:"form-control",name:"customerName",id:"customerName",type:"text",value:h.customerName,disabled:i,onChange:function(t){h.customerName=t.target.value,e.setState({ticketObject:h})}}))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Customer Email: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("input",{className:"form-control",name:"customerEmail",id:"customerEmail",value:h.customerEmail,disabled:i,onChange:function(t){h.customerEmail=t.target.value,e.setState({ticketObject:h})}}))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Notify People: "),a.createElement("div",{className:"col-md-9 no-padding"},h.notifyPeople&&h.notifyPeople.length>0?a.createElement(j.a,{id:"assignTo",isMulti:!0,closeMenuOnSelect:!1,isDisabled:i,value:h.notifyPeople,onChange:this.handleAssignTo,placeholder:"Select Person(s)",options:O}):a.createElement(j.a,{id:"assignTo",isMulti:!0,closeMenuOnSelect:!1,isDisabled:i,value:[],onChange:this.handleAssignTo,placeholder:"Select Person(s)",options:O}))),a.createElement("div",{className:"col-md-12 px-0 py-2"},a.createElement("div",{className:"col-md-3 py-2 px-0  headingText"},"Department Assigned: "),a.createElement("div",{className:"col-md-9 no-padding"},a.createElement("select",{className:"form-control",name:"department",id:"department",value:h.departmentAssigned,disabled:i,onChange:function(t){h.departmentAssigned=t.target.value,e.setState({ticketObject:h})}},a.createElement("option",{value:""},"Select Department"),v&&v.length>0&&v.map(function(e,t){return a.createElement("option",{key:t,value:e},e)}))))))))),a.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12 no-padding"},a.createElement("div",{className:"card p-2"},a.createElement("div",{className:"row py-0 no-margin p-2"},a.createElement(E.a,{showUploader:!0,buildingName:this.props.buildingName,assetOntology:this.props.ticketOntology?this.props.ticketOntology:h.ontology,entityType:"Tickets",uploaderID:this.props.ticketOntology?this.props.ticketOntology:h.ontology})))),N&&a.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12 no-padding"},a.createElement("div",{className:"card p-2"},a.createElement("h3",{className:"text-center"},"WorkFlow Status"),N&&N.map(function(t,n){return a.createElement("div",{key:n,className:"card p-2"},a.createElement("div",{className:"row py-0 no-margin p-2"},t&&a.createElement(w.a,{instance:e.props.instance,buildingName:e.props.buildingName,ontology:t})))}))),a.createElement("br",null),a.createElement("div",{className:"col-md-12 inline-block"},a.createElement("div",{className:"form-inline"},a.createElement("button",{disabled:!S,style:{display:T},id:"btnSave",className:"btn btn-primary btn-fill",type:"button",onClick:function(){return D(e,void 0,void 0,function(){return A(this,function(e){return this.saveTicketHandler(),window.history.back(),[2]})})}},a.createElement("i",{className:"fa fa-save"}),"Save"),h.deployedWFOntology&&N.map(function(t,i){return a.createElement("button",{key:i,style:{display:k},id:"btnSave",className:"btn btn-primary btn-fill",type:"button",onClick:function(){return D(e,void 0,void 0,function(){return A(this,function(e){return window.open("http://"+Object(p.l)()+"/#"+n+"/"+s+"/Deploy/WorkflowView/"+t,"_blank"),[2]})})}},a.createElement("i",{className:"fa fa-location-arrow"}),"Navigate to Deployed WF")}))))))))))},t}(a.Component);t.default=C},2120:function(e,t,n){"use strict";var a,s=n(3),i=(n.n(s),n(101)),o=n(642),r=n(10),c=n(30),l=n(104),u=n(609),d=n(29),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,r)}c((a=a.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},f="",b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={phase:Object(),emailsList:[],peopleList:[]},a=n,n.getPhaseDetail=n.getPhaseDetail.bind(n),n.handleActivateStage=n.handleActivateStage.bind(n),n.handleActivatePhase=n.handleActivatePhase.bind(n),n.validatePhaseAssignments=n.validatePhaseAssignments.bind(n),n.validateStageAssignments=n.validateStageAssignments.bind(n),n._fetchContact=n._fetchContact.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return this.props.buildingName?(Object(i.a)(!0),[4,this._fetchContact()]):[3,4];case 1:return e.sent(),this.props.ontology?[4,this.getPhaseDetail()]:[3,3];case 2:e.sent(),e.label=3;case 3:Object(i.a)(!1),e.label=4;case 4:return[2]}})})},t.prototype._fetchContact=function(){return g(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,Object(u.p)(this.props.buildingName)];case 1:return(e=t.sent())&&a.setState({peopleList:e}),[2]}})})},t.prototype.getPhaseDetail=function(){return g(this,void 0,void 0,function(){var e=this;return p(this,function(t){switch(t.label){case 0:return[4,Object(o.b)(this.props.buildingName,this.props.ontology).then(function(t){if(t.length){if("Completed"!==t[0].status)t[0].stages.every(function(e){return"Completed"==e.status})&&Object(o.g)(t[0].ontology,"Completed",!0);e.setState({phase:t[0]})}})];case 1:return t.sent(),[2]}})})},t.prototype.handleActivatePhase=function(e){return g(this,void 0,void 0,function(){var t,n;return p(this,function(a){switch(a.label){case 0:t=0,a.label=1;case 1:return t<e.stages.length?(n=e.stages[t],[4,this.handleActivateStage(n,e.templateType,t)]):[3,4];case 2:a.sent(),a.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},t.prototype.handleActivateStage=function(e,t,n){return g(this,void 0,void 0,function(){var a,s,c,u,d,m,g=this;return p(this,function(p){switch(p.label){case 0:if(a=this.props.buildingName,s=this.state.peopleList,c=this.state.emailsList,e.startTime=n&&null!=n?0==n?new Date(Date.now()).toString():"":new Date(Date.now()).toString(),e.startTaskCondition=n&&null!=n?0==n?"daytime":"completionof":"daytime",e.conditionalTasks=n&&null!=n?0==n?[]:[{label:f,value:f}]:[],e.status=n&&null!=n?0==n?"Assigned":"Pending":"Assigned",e.acknowledged=!0,e.isSequence=!0,e.archived=!1,e.isDeleted=!1,e.isActivated=!0,e.workflowType=e.workflowType?e.workflowType:t,e.assignedTo&&e.assignedTo.length>0)for(u=function(t){if(e.assignedTo[t]&&e.assignedTo[t].value){var n=s&&s.find(function(n){return Object(r.g)(n.contact)==e.assignedTo[t].value});if(c||(c=[]),n&&n.email)c.find(function(e){return e==Object(r.g)(n.email)})||c.push(Object(r.g)(n.email))}},m=0;m<e.assignedTo.length;m++)u(m);for(e.hasChat=!0,d=function(a){if(e.subTasks[a].workflowType=e.workflowType?e.workflowType:t,e.subTasks[a].isActivated=!0,e.subTasks[a].assignedTo&&e.subTasks[a].assignedTo.length>0){var i=s&&s.find(function(t){return Object(r.g)(t.contact)==e.subTasks[a].assignedTo});if(c||(c=[]),i&&i.email)c.find(function(e){return e==Object(r.g)(i.email)})||c.push(Object(r.g)(i.email))}e.subTasks[a].startTime=n&&null!=n?0==n&&0==a?new Date(Date.now()).toString():"":0==a?new Date(Date.now()).toString():"",e.subTasks[a].status=n&&null!=n?0==n&&0==a?"Assigned":"Pending":0==a?"Assigned":"Pending",e.subTasks[a].acknowledged=!0,e.subTasks[a].isDeleted=!1,e.subTasks[a].startTaskCondition=n&&null!=n?0==n&&0==a?"daytime":"completionof":0==a?"daytime":"completionof",e.subTasks[a].conditionalTasks=n&&null!=n?0==n&&0==a?[]:n>0&&0==a?[{label:f,value:f}]:[{label:e.subTasks[a-1].subTask,value:e.subTasks[a-1].subTask}]:a>0?[{label:e.subTasks[a-1].subTask,value:e.subTasks[a-1].subTask}]:[],f=e.task},m=0;m<e.subTasks.length;m++)d(m);return Object(i.a)(!0),[4,Object(l.x)(a,e,!0)];case 1:return p.sent(),[4,Object(o.g)("","Assigned",!0).then(function(){g.getPhaseDetail()})];case 2:return p.sent(),Object(i.a)(!1),[2]}})})},t.prototype.validatePhaseAssignments=function(e){var t=!0;if(e.stages&&e.stages.length>0)for(var n=0;n<e.stages.length;n++){var a=e.stages[n];if(a.assignedTo&&a.assignedTo.length>0){if(-1!=a.subTasks.findIndex(function(e){return""==e.assignedTo})){t=!1;break}t=!0}else t=!1}t?document.getElementById("btnActivatePhase").click():Object(c.a)("Not all Tasks have assignments, please assign all tasks.")},t.prototype.validateStageAssignments=function(e,t){var n=!0;e.assignedTo&&e.assignedTo.length>0?n=-1==e.subTasks.findIndex(function(e){return""==e.assignedTo}):n=!1;n?document.getElementById("btnActivateStage"+t).click():Object(c.a)("Not all Tasks have assignments, please assign all tasks.")},t.prototype.render=function(){var e=this,t=this.props,n=t.showGraphOnly,a=t.instance,i=t.buildingName,o=this.state.phase;return s.createElement("div",{className:n?"col-md-12":"content"},s.createElement("div",{className:n?"row padding-10":"container-fluid"},s.createElement("div",{className:"row"}),s.createElement("br",null),s.createElement("div",null,s.createElement("div",{className:"content"},s.createElement("div",{className:"container-fluid"},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12  img-thumbnail",style:{background:"#b8d8f9"}},s.createElement("div",{style:{display:"flex"}},s.createElement("div",{className:"col-md-11"},s.createElement("div",{style:{display:"grid"}},s.createElement("label",{style:{cursor:"default"}}," ",s.createElement("h5",{style:{color:"black",marginBottom:"9px"}}," ",s.createElement("b",null,o&&o.description," "))," "),s.createElement("span",{style:{color:"#666666"}},"Workflow ID: ",o.phaseID))),s.createElement("a",{style:{textAlign:"center",alignSelf:"center"},onClick:function(){return g(e,void 0,void 0,function(){return p(this,function(e){return window.open("http://"+Object(d.l)()+"/#"+a+"/"+i+"/Deploy/WorkflowView/"+o.ontology,"_blank"),[2]})})}},s.createElement("div",{className:"col-md-1",style:{cursor:"pointer"}},s.createElement("i",{className:"fa fa-arrow-right",style:{fontSize:"25px",color:"#6a87a5"}})))))),o&&o.stages&&o.stages.map(function(e,t){return s.createElement("div",{key:t,className:"row"},s.createElement("div",{className:"col-md-12 row.match-my-cols"},s.createElement("div",{className:"col-md-3 col-sm-3 col-xs-4"},s.createElement("div",{className:"card no-margin left-side-card",id:"discriptionCard"},s.createElement("div",{className:"content no-paddingLR"},s.createElement("div",{className:"container-fluid no-paddingLR"},s.createElement("div",{className:"row no-paddingLR"},s.createElement("div",{className:" "},s.createElement("div",{className:"timeline-item-content left-side-card"},s.createElement("h4",{style:{marginTop:"auto",marginBottom:"auto"}},"Stage ",t+1),s.createElement("label",{className:"headingText"},e.description),e.taskNumber&&s.createElement("label",{className:"small"},"Stage ID: "+e.taskNumber)))))))),e.task&&s.createElement("div",{className:"col-md-9 col-sm-9 col-xs-8"},s.createElement("div",{className:"card no-margin right-side-card",id:"taskCard"},s.createElement("div",{className:"content"},s.createElement("div",{className:"container-fluid"},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12"},s.createElement("div",{className:"timeline-item"},s.createElement("div",{className:"timeline-item-content no-padding"},s.createElement("span",{className:"no-margin"},s.createElement("ul",null,e&&e.subTasks&&e.subTasks.map(function(e,t){return s.createElement("div",{key:t},e.description&&s.createElement(s.Fragment,null,s.createElement("li",null,s.createElement("label",{title:(e.assignedTo?"Assigned to : "+e.assignedTo:e.assignedTo?"Assigned to : "+e.assignedTo+"  ":"No Assignment")+" "},e.description," \xa0 \xa0 ","Pending"!=e.status&&s.createElement("div",{className:"badge ml-2 stage-task-"+e.status,style:{fontSize:"85%"}},e.status),e.checklistID&&s.createElement("a",{style:{color:"#174b54"},"data-toggle":"collapse","data-target":"#checklist"+t},s.createElement("i",{className:"fa fa-check"}))))))}))),s.createElement("span",{className:"circle stage-"+e.status,title:e&&e.status,style:{top:"50%"}}))))))))),!e.equipSubject&&s.createElement("div",{className:"col-md-9 col-sm-9 col-xs-8"},s.createElement("div",{className:"card no-margin right-side-card",id:"taskCard"},s.createElement("div",{className:"content"},s.createElement("div",{className:"container-fluid"},s.createElement("div",{className:"row"},s.createElement("label",{style:{color:"red"}}," STAGE MIGHT HAVE DELETED"))))))))}))))))},t}(s.Component);t.a=b},642:function(e,t,n){"use strict";t.f=function(e,t,n){return c(this,void 0,void 0,function(){return l(this,function(o){switch(o.label){case 0:return[4,Object(a.f)({buildingName:e,ontology:t,uses:n},a.a.TASKTEMPLATE.UPDATESTAGETEMPLATEUSES,s.b.TASK).then(function(){Object(i.b)('Stage Template Uses "Updated"  Successfully.')}).catch(function(e){Object(i.a)("Error occured while saving Stage Template Uses.")})];case 1:return[2,o.sent()]}})})},t.e=function(e,t,n,o){return c(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,Object(a.f)({buildingName:e,model:t,isEdit:n,saveStages:o},a.a.TASKTEMPLATE.SAVEPHASE,s.b.TASK).then(function(){Object(i.b)("Workflow "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Workflow.")})];case 1:return[2,r.sent()]}})})},t.b=function(e,t,n){void 0===n&&(n=!0);return c(this,void 0,void 0,function(){return l(this,function(i){switch(i.label){case 0:return[4,Object(a.e)({buildingName:e,ontology:t},a.a.TASKTEMPLATE.GETPHASEDETAILLIST,s.b.TASK,n)];case 1:return[2,i.sent()]}})})},t.c=function(e,t,n){void 0===n&&(n=!0);return c(this,void 0,void 0,function(){return l(this,function(i){switch(i.label){case 0:return[4,Object(a.e)({buildingName:e,ontology:t},a.a.TASKTEMPLATE.GETPHASETEMPLATEDETAIL,s.b.TASK,n)];case 1:return[2,i.sent()]}})})},t.g=function(e,t,n){return c(this,void 0,void 0,function(){return l(this,function(o){switch(o.label){case 0:return[4,Object(a.f)({taskID:e,status:t},a.a.TASKTEMPLATE.UPDATETASKORSTAGESTATUS,s.b.TASK).then(function(){n||Object(i.b)("Status Updated Successfully.")}).catch(function(e){Object(i.a)("Error occured while update Status.")})];case 1:return[2,o.sent()]}})})},t.a=function(e,t){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(a.e)({buildingName:e,ontology:t},a.a.DEPENDENCY.GETDEPENDENCY,s.b.TASK,!0)];case 1:return[2,n.sent()]}})})},t.d=function(e,t){var n=[];if(!(t.stages&&t.stages.length&&t.stages.length>0))return void Object(i.a)("Error finding Stages");for(var a=r({},t),s=0;s<a.stages.length;s++){for(var c=[],l=a.stages[s],u=0;u<l.subTasks.length;u++){var d=l.subTasks[u];if(!d.estimatedStartTime||void 0==d.estimatedStartTime)return void Object(i.a)("Not all Template Tasks have Estimate Start Time, To Normalise, provide dates first ");c.push(d.estimatedStartTime)}n.push(c)}for(var s=0;s<n.length;s++)for(var c=n[s],u=0;u<c.length;u++)if(0==s&&0==u)t.stages[s].estimatedStartTime=e,t.stages[s].subTasks[u].estimatedStartTime=e;else if(s>0&&0==u){var m=Object(o.g)(new Date(n[s-1][n[s-1].length-1]),new Date(n[s][u])),g=new Date(t.stages[s-1].subTasks[t.stages[s-1].subTasks.length-1].estimatedStartTime);g.setDate(new Date(t.stages[s-1].subTasks[t.stages[s-1].subTasks.length-1].estimatedStartTime).getDate()+m),t.stages[s].subTasks[u].estimatedStartTime=g,t.stages[s].estimatedStartTime=g}else{var m=Object(o.g)(new Date(n[s][u-1]),new Date(n[s][u])),g=new Date(t.stages[s].subTasks[u-1].estimatedStartTime);g.setDate(new Date(t.stages[s].subTasks[u-1].estimatedStartTime).getDate()+m),t.stages[s].subTasks[u].estimatedStartTime=g}var p=Object(o.g)(new Date(t.estimatedEndTime),new Date(t.estimatedStartTime));t.estimatedStartTime=e;var f=new Date(e);return f.setDate(f.getDate()+p),t.estimatedEndTime=f,t};var a=n(12),s=n(20),i=n(30),o=n(29),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,i){function o(e){try{c(a.next(e))}catch(e){i(e)}}function r(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,r)}c((a=a.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var n,a,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(s=2&i[0]?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}}}});