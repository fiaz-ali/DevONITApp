webpackJsonp([21],{1024:function(e,t,n){"use strict";var a=n(3),r=(n.n(a),n(578)),o=n(582),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),l=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function s(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,a,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={tenantObj:Object(),_Groups:[],groupsDropDownList:[]},n.handleTenantForm=n.handleTenantForm.bind(n),n.handleMultiGroupChange=n.handleMultiGroupChange.bind(n),n}return s(t,e),t.prototype.componentDidMount=function(){return l(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchContactGroupList()]:[3,2];case 1:e.sent(),this.props.isEdit||this.setState({tenantObj:{name:"",userName:"",mobile:"",email:"",password:"",role:"4",space:"",group:"",groups:[]}}),e.label=2;case 2:return[2]}})})},t.prototype._fetchContactGroupList=function(){return l(this,void 0,void 0,function(){var e=this;return i(this,function(t){switch(t.label){case 0:return[4,Object(r.l)().then(function(t){var n=t.filter(function(e){return"AddtlContact"==e.value||"Tenant"==e.value}).map(function(e){return{value:e.value,label:e.value.replace(new RegExp("Tenant","g"),"Customer")}});e.setState({groupsDropDownList:n})})];case 1:return t.sent(),[2]}})})},t.prototype.handleTenantForm=function(e){var t=this.state.tenantObj;t[""+e.target.name]=e.target.value,this.setState({tenantObj:t}),this.props.handleTenantChange(t)},t.prototype.handleMultiGroupChange=function(e){var t=this.state.tenantObj;t.groups=e,this.setState({tenantObj:t}),this.props.handleTenantChange(t)},t.prototype.componentWillReceiveProps=function(e){e.tenant.userName?this.setState({tenantObj:e.tenant}):this.setState({tenantObj:{name:"",userName:"",mobile:"",email:"",password:"",role:"4",space:"",group:"",groups:[]}})},t.prototype.render=function(){var e=this,t=(this.props,this.state),n=t.tenantObj,r=t.groupsDropDownList;return a.createElement("div",{className:"content"},a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"username"},"User Name:")),a.createElement("div",{className:"col-md-9"},a.createElement("input",{type:"text",disabled:this.props.isEdit,id:"username",name:"userName",className:"form-control col-md-6",value:n.userName,onChange:function(t){return e.handleTenantForm(t)}})))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"name"},"Name:")),a.createElement("div",{className:"col-md-9"},a.createElement("input",{type:"text",id:"name",name:"name",className:"form-control col-md-6",value:n.name,onChange:function(t){return e.handleTenantForm(t)}})))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"email"},"Email:")),a.createElement("div",{className:"col-md-9"},a.createElement("input",{type:"text",id:"email",name:"email",className:"form-control col-md-6",value:n.email,onChange:function(t){return e.handleTenantForm(t)}})))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"mobile"},"Mobile:")),a.createElement("div",{className:"col-md-9"},a.createElement("input",{type:"text",id:"mobile",name:"mobile",className:"form-control col-md-6",value:n.mobile,onChange:function(t){return e.handleTenantForm(t)}})))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"group"},"Group:")),a.createElement("div",{className:"col-md-9"},a.createElement(o.a,{isDisabled:!1,closeMenuOnSelect:!1,isMulti:!0,value:n.groups,onChange:this.handleMultiGroupChange,placeholder:"Select Groups(s)",options:r})))))},t}(a.Component);t.a=c},1025:function(e,t,n){"use strict";var a=n(3),r=(n.n(a),n(582)),o=n(578),s=n(17),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function s(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,a,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={tenantAlertObj:Object(),tenantDropDownList:[],zonesDropDownList:[],zonesList:[],tenantsList:[],contactList:[]},n.onRadioRoleChange=n.onRadioRoleChange.bind(n),n.onMessageChange=n.onMessageChange.bind(n),n.handleMultiTenantChange=n.handleMultiTenantChange.bind(n),n.handleMultiZoneChange=n.handleMultiZoneChange.bind(n),n._fetchTenantList=n._fetchTenantList.bind(n),n._fetchZonesList=n._fetchZonesList.bind(n),n.handleIncludeSecondaryContactChange=n.handleIncludeSecondaryContactChange.bind(n),n.filterZoneContactsList=n.filterZoneContactsList.bind(n),n}return l(t,e),t.prototype.componentDidMount=function(){return i(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchTenantList()]:[3,3];case 1:return e.sent(),[4,this._fetchZonesList()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.componentWillReceiveProps=function(e){return i(this,void 0,void 0,function(){var t,n;return c(this,function(a){switch(a.label){case 0:return t=this.props.refresh,n=this.state.tenantAlertObj,e.refresh==t?[3,2]:[4,this._fetchTenantList()];case 1:a.sent(),a.label=2;case 2:return e.message&&(n.message=e.message,this.setState({tenantAlertObj:n})),[2]}})})},t.prototype.onRadioRoleChange=function(e){var t=this,n=this.state.tenantAlertObj;n.role=e,this.setState({tenantAlertObj:n},function(){t.filterZoneContactsList()}),this.props.handleTenantAlerts(n)},t.prototype.handleMultiTenantChange=function(e){var t=this.state,n=t.contactList,a=t.tenantsList,r=this.state.tenantAlertObj,o=r.contactNumbers?r.contactNumbers:[];e.map(function(e){var t=Object(s.g)(a.find(function(t){return t.userName.value==e.value}).mobile);o.find(function(e){return e==t})||o.push(t)}),r.additionalContacts=e,r.contactNumbers=o,this.setState({tenantAlertObj:r,contactList:n}),this.props.handleTenantAlerts(r)},t.prototype.handleMultiZoneChange=function(e){var t=this,n=this.state.tenantAlertObj;n.zones=e,this.setState({tenantAlertObj:n},function(){t.filterZoneContactsList()}),this.props.handleTenantAlerts(n)},t.prototype.handleIncludeSecondaryContactChange=function(e){var t=this,n=this.state.tenantAlertObj;n.includeSecondaryContacts=e,this.setState({tenantAlertObj:n},function(){t.filterZoneContactsList()}),this.props.handleTenantAlerts(n)},t.prototype.onMessageChange=function(e){var t=this.state.tenantAlertObj;t.message=e,this.setState({tenantAlertObj:t}),this.props.handleTenantAlerts(t)},t.prototype._fetchTenantList=function(){return i(this,void 0,void 0,function(){var e=this;return c(this,function(t){switch(t.label){case 0:return[4,Object(o.r)(this.props.buildingName).then(function(t){var n=t.map(function(e){return{value:e.userName.value,label:e.name.value}});e.setState({tenantDropDownList:n,tenantsList:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._fetchZonesList=function(){return i(this,void 0,void 0,function(){var e=this;return c(this,function(t){switch(t.label){case 0:return[4,Object(o.f)(this.props.buildingName).then(function(t){var n=[];t.map(function(e){n.find(function(t){return t.value==e.zone.value})||n.push({value:e.zone.value,label:e.rdfsLabel.value})}),e.setState({zonesDropDownList:n,zonesList:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype.filterZoneContactsList=function(){var e=this.state,t=e.zonesList,n=e.tenantAlertObj,a=n.contactNumbers?n.contactNumbers:[],r=n.role?n.role:"both",o=!!n.includeSecondaryContacts&&n.includeSecondaryContacts;n.zones&&n.zones.map(function(e){("owns"==r&&1==o?t.filter(function(t){return("owns"==t.role.value||"owns2"==t.role.value)&&e.value==t.zone.value}):"owns"==r&&0==o?t.filter(function(t){return"owns"==t.role.value&&e.value==t.zone.value}):"occupies"==r&&1==o?t.filter(function(t){return("occupies"==t.role.value||"occupies2"==t.role.value)&&e.value==t.zone.value}):"occupies"==r&&0==o?t.filter(function(t){return"occupies"==t.role.value&&e.value==t.zone.value}):"both"==r&&1==o?t.filter(function(t){return e.value==t.zone.value}):"both"==r&&0==o?t.filter(function(t){return"occupies2"!=t.role.value&&"owns2"!=t.role.value&&e.value==t.zone.value}):t).map(function(e){a.find(function(t){return t==Object(s.g)(e.mobile)})||a.push(Object(s.g)(e.mobile))})}),n.contactNumbers=a,this.setState({tenantAlertObj:n}),this.props.handleTenantAlerts(n)},t.prototype.render=function(){var e=this,t=(this.props,this.state),n=t.tenantAlertObj,o=t.tenantDropDownList,s=t.zonesDropDownList;return a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-4"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"zones"},"Select Affected Zones:"))),a.createElement("div",{className:"col-md-8"},a.createElement("div",{className:"form-group"},a.createElement(r.a,{closeMenuOnSelect:!1,isMulti:!0,value:n.zones,onChange:this.handleMultiZoneChange,placeholder:"Select Affected Zones",options:s}))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-4"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"spaces"},"Select Additional Contacts:"))),a.createElement("div",{className:"col-md-8"},a.createElement("div",{className:"form-group"},a.createElement(r.a,{closeMenuOnSelect:!1,isMulti:!0,value:n.additionalContacts,onChange:this.handleMultiTenantChange,placeholder:"Select Additional Contacts",options:o}))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-4"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:""},"Contact Role:"))),a.createElement("div",{className:"col-md-8"},a.createElement("div",{className:"form-group"},a.createElement("label",{className:"radio-inline"}," ",a.createElement("input",{type:"radio",name:"rdOwner",value:"owns",checked:"owns"==n.role,onChange:function(t){e.onRadioRoleChange(t.target.value)}}),"Owners"),a.createElement("label",{className:"radio-inline"}," ",a.createElement("input",{type:"radio",name:"rdOccupant",value:"occupies",checked:"occupies"==n.role,onChange:function(t){e.onRadioRoleChange(t.target.value)}}),"Occupants"),a.createElement("label",{className:"radio-inline"}," ",a.createElement("input",{type:"radio",name:"rdBoth",value:"both",checked:"both"==n.role,onChange:function(t){e.onRadioRoleChange(t.target.value)}}),"Both"))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-4"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"include"},"Include secondary contacts:"))),a.createElement("div",{className:"col-md-1"},a.createElement("div",{className:"form-group"},a.createElement("input",{id:"include",type:"checkbox",className:"form-control",checked:n.includeSecondaryContacts,onChange:function(t){return e.handleIncludeSecondaryContactChange(t.target.checked)}}))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-4"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"message"},"Message:"))),a.createElement("div",{className:"col-md-8"},a.createElement("div",{className:"form-group"},a.createElement("textarea",{className:"form-control",id:"message",value:n.message,rows:5,onChange:function(t){e.onMessageChange(t.target.value)}}))))))},t}(a.Component);t.a=u},1466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(3),o=(n.n(r),n(577)),s=n(87),l=n(17),i=n(45),c=n(569),u=n(1024),m=n(578),d=n(18),h=n(1025),p=n(697),f=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),b=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function s(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_tenantList:[],sortOrder:1,isEdit:!1,tenantToDelete:Object(),tenantObj:Object(),tenantAlertObj:Object(),TenantAlertLog:[],refreshChild:!1},a=n,n.s3=new i.b,n.sortTenantList=n.sortTenantList.bind(n),n._fetchTenantList=n._fetchTenantList.bind(n),n.onDeleteTenant=n.onDeleteTenant.bind(n),n.deleteTenant=n.deleteTenant.bind(n),n._saveTenant=n._saveTenant.bind(n),n.handleTenantChange=n.handleTenantChange.bind(n),n.onEditTenant=n.onEditTenant.bind(n),n.saveAlertLog=n.saveAlertLog.bind(n),n.handleTenantAlerts=n.handleTenantAlerts.bind(n),n.getAllAlertLogs=n.getAllAlertLogs.bind(n),n}return f(t,e),t.prototype.componentDidMount=function(){return b(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchTenantList()]:[3,3];case 1:return e.sent(),[4,this.getAllAlertLogs()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype._fetchTenantList=function(){return b(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return Object(s.a)(!0),[4,Object(m.r)(this.props.buildingName).then(function(t){t.length>0&&t[0].userName||(t=[]),e.setState({_tenantList:t})}).catch(function(e){return e})];case 1:return t.sent(),Object(s.a)(!1),[2]}})})},t.prototype.getAllAlertLogs=function(){return b(this,void 0,void 0,function(){return v(this,function(e){return Object(s.a)(!0),this.s3.GetObject(i.a.DOCUMENT,"AlertLog.json",function(e,t){if(e)console.log("Get Object Error Returned",e);else{var n=Object(d.c)(t.Body);if(n){var r=JSON.parse(n);r.length>0&&a.setState({TenantAlertLog:r})}}}),Object(s.a)(!1),[2]})})},t.prototype.sortTenantList=function(e,t){var n=this.state._tenantList,a=this.state.sortOrder,r=n.sort(function(n,r){if(n&&r){var o="",s="";switch(e){case"Name":n.name&&r.name&&(o=n.name.value,s=r.name.value,a=t||1);break;case"User Name":n.userName&&r.userName&&(o=n.userName.value,s=r.userName.value);break;case"Group":n.group&&r.group&&(o=n.group.value,s=r.group.value);break;case"Email":n.email&&r.email&&(o=n.email.value,s=r.email.value);break;case"Mobile":n.mobile&&r.mobile&&(o=n.mobile.value,s=r.mobile.value)}var l=0;return o.toLocaleLowerCase()<s.toLocaleLowerCase()?l=-1:o.toLocaleLowerCase()>s.toLocaleLowerCase()&&(l=1),l*a}});this.setState({_tenantList:r,sortOrder:-1*a})},t.prototype.onDeleteTenant=function(e){this.setState({tenantToDelete:e},function(){document.getElementById("btnConfirm").click()})},t.prototype.deleteTenant=function(){return b(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=this.state.tenantToDelete,Object(s.a)(!0),e&&e.userName?[4,Object(m.k)(e.userName.value)]:[3,3];case 1:return t.sent(),[4,this._fetchTenantList()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.handleTenantChange=function(e){this.setState({tenantObj:e})},t.prototype._saveTenant=function(){return b(this,void 0,void 0,function(){var e,t,n,a,r;return v(this,function(o){switch(o.label){case 0:return e=this.state,t=e.tenantObj,n=e.isEdit,t.role="4",a=t.groups.map(function(e){return e.value}),[4,Object(d.p)(Object(d.s)(t.userName),a)];case 1:return o.sent()&&!n?[3,5]:t?(Object(s.a)(!0),[4,Object(m.h)(this.props.buildingName,t,n)]):[3,4];case 2:return o.sent(),[4,this._fetchTenantList()];case 3:o.sent(),r=!this.state.refreshChild,this.setState({refreshChild:r}),Object(s.a)(!1),o.label=4;case 4:return[3,6];case 5:alert("user already exists, please change user name"),o.label=6;case 6:return[2]}})})},t.prototype.onEditTenant=function(e){var t=this.state.tenantObj;t.userName=Object(l.g)(e.userName),t.email=Object(l.g)(e.email),t.name=Object(l.g)(e.name),t.mobile=Object(l.g)(e.mobile);var n=e.group.value.indexOf(",")>0?e.group.value.split(","):[e.group.value];t.groups=e.group&&n.map(function(e,t){return{label:e.replace(new RegExp("Tenant","g"),"Customer"),value:e}}),this.setState({isEdit:!0,tenantObj:t},function(){document.getElementById("btnOpenTenantForm").click()})},t.prototype.handleTenantAlerts=function(e){this.setState({tenantAlertObj:e})},t.prototype.sendAlertsToTenants=function(){return b(this,void 0,void 0,function(){var e,t,n=this;return v(this,function(a){switch(a.label){case 0:e=this.state.tenantAlertObj,t=new p.a,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.SendSMS_Multiple(e.contactNumbers,e.message,this.props.instance,!1,function(){n.saveAlertLog()})];case 2:return a.sent(),[3,4];case 3:return a.sent(),Object(s.a)(!1),[3,4];case 4:return[2]}})})},t.prototype.saveAlertLog=function(){return b(this,void 0,void 0,function(){var e,t,n,a,r,o=this;return v(this,function(c){return e=this.state,t=e.tenantAlertObj,n=e._tenantList,a=e.TenantAlertLog,r=a,t.contactNumbers&&t.contactNumbers.length&&(Object(s.a)(!0),t.contactNumbers.map(function(e){n.map(function(n){Object(l.g)(n.mobile)==e&&r.push({alertMessage:t.message,group:Object(l.g)(n.group),date:(new Date).toString(),contact:e,site:o.props.buildingName})})}),this.setState({TenantAlertLog:r},function(){o.s3.PutObject(i.a.DOCUMENT,"AlertLog.json",JSON.stringify(o.state.TenantAlertLog))}),Object(s.a)(!1)),[2]})})},t.prototype.render=function(){var e=this,t=this.state,n=t._tenantList,a=t.isEdit,s=t.tenantObj,i=t.refreshChild,m=this.props,d=m.buildingName,p=m.instance,f=""!=s.userName;return r.createElement("div",{className:"content",id:"chats",style:{paddingTop:"0px"}},r.createElement("div",{className:"container-fluid"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12 "},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12"},r.createElement("div",{className:"dropdown pull-right"},r.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){e.setState({isEdit:!1,tenantObj:Object()},function(){document.getElementById("btnOpenTenantForm").click()})}},r.createElement("i",{className:"fa fa-plus"}),r.createElement("span",{className:"hidden-xs"},"Add Customer")),r.createElement("button",{type:"button",style:{marginRight:3},className:"btn btn-dark btn-fill pull-right","data-toggle":"modal","data-target":"#sendAlertModal"},r.createElement("i",{className:"fa fa-bell"}),r.createElement("span",{className:"hidden-xs"},"Send Alerts")),r.createElement(c.a,{id:"sendAlertModal",heading:"Send Alert To Customers",saveButtonText:"Send",onSaveButtonClick:function(){e.sendAlertsToTenants()},disableSaveButton:!1},r.createElement(h.a,{instance:p,buildingName:d,handleTenantAlerts:this.handleTenantAlerts,refresh:i})),r.createElement("button",{type:"button",className:"btn btn-dark pull-right",style:{marginRight:3},onClick:function(){window.location.hash="/"+p+"/"+d+"/Space/AssignSpaceCustomer"}},r.createElement("i",{className:"fa fa-building"}),r.createElement("span",{className:"hidden-xs"},"Assign Space(s) To Customer"))))),r.createElement("br",null),r.createElement("div",{className:"card padding-10",id:"TenantList",style:{paddingTop:"0px"}},r.createElement("div",{className:"content",style:{paddingTop:"10px"}},r.createElement("div",{className:"dataCard"},r.createElement("button",{type:"button",id:"btnOpenTenantForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#tenantFormDialog"}," ."),r.createElement(c.a,{id:"tenantFormDialog",onSaveButtonClick:function(){e._saveTenant()},saveButtonText:"Save",disableSaveButton:!f},r.createElement(u.a,{instance:p,buildingName:d,isEdit:a,tenant:s,handleTenantChange:this.handleTenantChange})),r.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),r.createElement(o.a,{instance:p,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Customer?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteTenant()}}),r.createElement("div",{className:"row hidden-xs no-padding"},r.createElement("div",{className:"col-md-10 col-sm-12  no-padding dataCard"},r.createElement("div",{className:"col-md-3 col-sm-12 small grid-header-left",onClick:function(){return e.sortTenantList("Name")}},r.createElement("i",{className:"fa fas fa-sort"}),"Name"),r.createElement("div",{className:"col-md-3 col-sm-12 small grid-header",onClick:function(){return e.sortTenantList("Group")}},r.createElement("i",{className:"fa fas fa-sort"}),"Group"),r.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortTenantList("Mobile")}},r.createElement("i",{className:"fa fas fa-sort"}),"Mobile"),r.createElement("div",{className:"col-md-3 col-sm-12 small grid-header",onClick:function(){return e.sortTenantList("Email")}},r.createElement("i",{className:"fa fas fa-sort"}),"Email")),r.createElement("div",{className:"col-md-2 col-sm-12  headingText"})),n.map(function(t,n){return r.createElement("div",{key:n,className:"row clickable"},r.createElement("div",{className:"col-md-10 col-sm-12 "},r.createElement("div",{className:"col-md-3 col-sm-12 padding-10 small trim-data",title:Object(l.g)(t.name)},r.createElement("span",{className:"hidden visible-xs-inline headingText"},"Name"),Object(l.g)(t.name)),r.createElement("div",{className:"col-md-3 col-sm-12 padding-10 small trim-data",title:Object(l.g)(t.group)},r.createElement("span",{className:"hidden visible-xs-inline headingText"},"Group"),Object(l.g)(t.group).replace(new RegExp("Tenant","g"),"Customer")),r.createElement("div",{className:"col-md-2 col-sm-12 padding-10 small trim-data",title:Object(l.g)(t.mobile)},r.createElement("span",{className:"hidden visible-xs-inline headingText"},"Mobile"),Object(l.g)(t.mobile)),r.createElement("div",{className:"col-md-3 col-sm-12 padding-10 small trim-data",title:Object(l.g)(t.email)},r.createElement("span",{className:"hidden visible-xs-inline headingText"},"Email"),Object(l.g)(t.email))),r.createElement("div",{className:"col-md-2 col-sm-12 no-padding col-xs-12",style:{display:"inline-flex"}},r.createElement("button",{className:"btn-sm btn-danger active pull-right custom-outline-btn",onClick:function(n){e.onDeleteTenant(t)}},r.createElement("i",{className:"fa fa-trash"})," Delete"),r.createElement("button",{className:"btn-sm btn-success active pull-right custom-outline-btn",onClick:function(){e.onEditTenant(t)}},r.createElement("i",{className:"fa fa-edit"})," Edit")))}))))))))},t}(r.Component);t.default=g},697:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(17),r=n(19),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function s(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,l)}i((a=a.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,a,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},l=function(){function e(){}return e.prototype.SendSMS=function(e,t,n,l){return o(this,void 0,void 0,function(){var o;return s(this,function(s){switch(s.label){case 0:return t+=", To Unsubscribe SMS Alerts: "+window.location.origin+"/#"+n+"/UnsubscribeSMSAlerts/FullScreen",o={to:e,body:t},[4,fetch(r.g+"SendSMS",{mode:"cors",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/sparql-results+json"},body:Object(a.i)(o)})];case 1:return[2,s.sent()]}})})},e.prototype.SendSMS_Multiple=function(e,t,n,l,i){return o(this,void 0,void 0,function(){var o;return s(this,function(s){switch(s.label){case 0:return l&&(t+=", To Unsubscribe SMS Alerts: "+window.location.origin+"/#"+n+"/UnsubscribeSMSAlerts/FullScreen"),o={to:e,body:t},[4,fetch(r.g+"SendMultipleSMS",{mode:"cors",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/sparql-results+json"},body:Object(a.i)(o)})];case 1:return[2,s.sent()]}})})},e}()}});