webpackJsonp([35],{1009:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=(a.n(n),a(118)),i=a(1010),c=a(21),s=a(682),l=a(8),o=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),d=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,i){function c(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(c,s)}l((n=n.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var a,n,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{a=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=a(1079),u=p.CardNumberElement,h=p.CardExpiryElement,f=p.CardCvcElement,g=p.injectStripe,b=function(e){function t(t){var a=e.call(this,t)||this;return a.state={payment:Object(),card:Object(),selectedPricingPackage:Object()},a.handleChange=a.handleChange.bind(a),a.handlePayment=a.handlePayment.bind(a),a.getStripeToken=a.getStripeToken.bind(a),a.getPayment=a.getPayment.bind(a),a.onDeletePayment=a.onDeletePayment.bind(a),a.deletePayment=a.deletePayment.bind(a),a.handleSubscription=a.handleSubscription.bind(a),a.handleSpacePayment=a.handleSpacePayment.bind(a),a}return o(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e,t;return m(this,function(a){switch(a.label){case 0:return e=JSON.parse(l.a.getItem("user")),[4,this.getPayment()];case 1:return a.sent(),(t=this.state.payment).name=e.name,t.email=e.email,t.phoneNo=e.mobile,t.postalCode=e.zipcode,this.setState({payment:t,selectedPricingPackage:this.props.selectedPricingPackage?this.props.selectedPricingPackage:Object()}),[2]}})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.selectedPricingPackage&&this.props.selectedPricingPackage.stripePlanId&&this.setState({selectedPricingPackage:this.props.selectedPricingPackage})},t.prototype.handleChange=function(e){var t=this.state.payment;t[e.target.name]=e.target.value,this.setState({payment:t})},t.prototype.getPayment=function(){return d(this,void 0,void 0,function(){var e,t,a,n;return m(this,function(r){switch(r.label){case 0:return e=JSON.parse(l.a.getItem("user")),(t=e.stripePaymentMethodId)?(a=this.state.card,[4,Object(i.b)(t)]):[3,2];case 1:return n=r.sent(),a.last4=n.card.last4,a.exp_month=n.card.exp_month,a.exp_year=n.card.exp_year,a.brand=n.card.brand,a.paymentId=n.id,this.setState({card:a}),[3,3];case 2:this.setState({card:Object()}),r.label=3;case 3:return[2]}})})},t.prototype.onDeletePayment=function(){document.getElementById("btnConfirm").click()},t.prototype.deletePayment=function(){return d(this,void 0,void 0,function(){var e,t,a,n;return m(this,function(r){switch(r.label){case 0:return e=JSON.parse(l.a.getItem("user")),t=e.stripePaymentMethodId,[4,Object(i.a)(t,e)];case 1:return a=r.sent(),n="",e.stripePaymentMethodId=n,l.a.setItem("user",JSON.stringify(e)),a&&(Object(c.b)("Successfully Deleted"),window.location.reload()),this.getPayment(),[2]}})})},t.prototype.handleSpacePayment=function(e){return d(this,void 0,void 0,function(){var e,t,a,n,r,s;return m(this,function(l){switch(l.label){case 0:return e=this.state.payment,t=e.postalCode,a=e.name,n=this.props.totalPrice,r=this.props.spaceName,t||!isNaN(parseInt(t))?[3,1]:(Object(c.a)("Please enter a valid zipcode"),[3,4]);case 1:return[4,this.props.stripe.createToken({name:a,address_zip:t})];case 2:return s=l.sent(),[4,Object(i.d)(n,r,e,s)];case 3:l.sent(),l.label=4;case 4:return this.props.saveReservation(),[2]}})})},t.prototype.handlePayment=function(e){this.getStripeToken(e)},t.prototype.getStripeToken=function(e){return d(this,void 0,void 0,function(){var e,t,a,n,s,o,d,p,u,h,f;return m(this,function(m){switch(m.label){case 0:return e=JSON.parse(l.a.getItem("user")),Object(r.a)(!0),t=this.state.payment,(a=t.postalCode)||!isNaN(parseInt(a))?[3,1]:(Object(c.a)("Please enter a valid zipcode"),[3,21]);case 1:return[4,this.props.stripe.createToken({name:this.state.payment.name,address_zip:a})];case 2:return(n=m.sent())?n.token&&n.token.id?[4,Object(i.c)(e,t,n)]:[3,17]:[3,19];case 3:return(s=m.sent())?s.id?(o=s.id,e.stripePaymentMethodId=o,[4,Object(i.e)(o,e)]):[3,13]:[3,15];case 4:return(d=m.sent())?d.error?[3,9]:(p=d,e.stripeCustomerId=p,u=this.props.selectedPricingPackage,1==this.props.selectedPricingPackage.autoRenewal&&this.props.buildingName?[4,Object(i.f)(u,p,e,this.props.buildingName)]:[3,6]):[3,11];case 5:return(h=m.sent())&&h.error?Object(c.a)(h.message):(e.stripeSubscriptionId=h,h?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!")),[3,8];case 6:return[4,Object(i.g)(this.props.selectedPricingPackage,p,e,this.props.buildingName)];case 7:(f=m.sent())&&f.error?Object(c.a)(f.message):f?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!"),m.label=8;case 8:return l.a.setItem("user",JSON.stringify(e)),this.getPayment(),[3,10];case 9:d.error&&d.message?Object(c.a)(d.message):Object(c.a)("Customer verificaion failed. Try again!"),m.label=10;case 10:return[3,12];case 11:Object(c.a)("Customer verificaion failed. Try again!"),m.label=12;case 12:return[3,14];case 13:s.error&&s.message?Object(c.a)(s.message):Object(c.a)("Payment method id verificaion failed. Try again!"),m.label=14;case 14:return[3,16];case 15:Object(c.a)("Payment method id verificaion failed. Try again!"),m.label=16;case 16:return[3,18];case 17:n.error&&n.error.message?Object(c.a)(n.error.message):Object(c.a)("Token verificaion failed. Try again!"),m.label=18;case 18:return[3,20];case 19:Object(c.a)("Token verificaion failed. Try again!"),m.label=20;case 20:Object(r.a)(!1),m.label=21;case 21:return[2]}})})},t.prototype.handleSubscription=function(){return d(this,void 0,void 0,function(){var e,t,a,n,r;return m(this,function(s){switch(s.label){case 0:return e=JSON.parse(l.a.getItem("user")),t=e.stripeCustomerId,a=this.props.selectedPricingPackage,1==this.props.selectedPricingPackage.autoRenewal&&this.props.buildingName?[4,Object(i.f)(a,t,e,this.props.buildingName)]:[3,2];case 1:return(n=s.sent())&&n.error?Object(c.a)(n.message):(e.stripeSubscriptionId=n,n?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!")),[3,4];case 2:return[4,Object(i.g)(this.props.selectedPricingPackage,t,e,this.props.buildingName)];case 3:(r=s.sent())&&r.error?Object(c.a)(r.message):r?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!"),s.label=4;case 4:return l.a.setItem("user",JSON.stringify(e)),[2]}})})},t.prototype.render=function(){var e=this,t=this.props.id,a=this.props.entityName,r=this.props.totalPrice,i=this.state,c=i.payment,o=i.card,d=JSON.parse(l.a.getItem("user"));return n.createElement(n.Fragment,null,n.createElement("div",{id:t,className:"content"},n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"card"},n.createElement("div",{className:"content",style:{textAlign:"center"}},n.createElement("div",{className:""},n.createElement("br",null),n.createElement("br",null),n.createElement("br",null),n.createElement("div",{className:"dataCard"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px",marginLeft:"10px"}}," Name: "),n.createElement("div",{className:"col-md-5 headingText"},n.createElement("input",{type:"text",name:"name",value:c.name,className:"form-control",style:{border:"1px solid gray"},onChange:function(t){e.handleChange(t)}})))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px",marginLeft:"10px"}}," Email: "),n.createElement("div",{className:"col-md-5 headingText"},n.createElement("input",{type:"text",name:"email",value:c.email,className:"form-control",style:{border:"1px solid gray"},onChange:function(t){e.handleChange(t)}})))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Phone: "),n.createElement("div",{className:"col-md-5 headingText"},n.createElement("input",{type:"text",name:"phoneNo",value:c.phoneNo,className:"form-control",style:{border:"1px solid gray",marginLeft:"10px"},onChange:function(t){e.handleChange(t)}})))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Postal code: "),n.createElement("div",{className:"col-md-5 headingText"},n.createElement("input",{type:"text",name:"postalCode",value:c.postalCode,className:"form-control",style:{border:"1px solid gray",marginLeft:"10px"},onChange:function(t){e.handleChange(t)}})))),a?n.createElement("div",null,n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Card Number: "),n.createElement("div",{className:"col-md-5 "},n.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},n.createElement(u,null))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Expiry date: "),n.createElement("div",{className:"col-md-5 "},n.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},n.createElement(h,null))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Cvc: "),n.createElement("div",{className:"col-md-5 "},n.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},n.createElement(f,null))))),n.createElement("div",{className:"row",style:{marginTop:"50px"}},n.createElement("div",{className:"col-md-12"},n.createElement("button",{className:"btn btn-success btn-fill center",style:{paddingRight:"60px",paddingLeft:"60px"},onClick:function(t){e.handleSpacePayment(t)}}," $",r," ")))):n.createElement(n.Fragment,null,d.stripePaymentMethodId&&n.createElement("div",null,n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Last 4 Digit: ",o.last4," "),n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Exp_Month:  ",o.exp_month," "),n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Exp_Year:  ",o.exp_year," "),n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Brand:  ",o.brand," "),n.createElement("div",{className:"col-md-1 headingText",style:{paddingTop:"10px"}},n.createElement("button",{className:"btn-sm btn-danger active pull-right custom-outline-btn",title:"Delete",onClick:function(){e.onDeletePayment()}},n.createElement("i",{className:"fa fa-trash"}))))),n.createElement("div",{className:"row padding-10"},n.createElement("div",{className:"col-md-offset-3"},n.createElement("div",{className:"col-md-2 col-md-offset-2 col-xs-12 headingText",style:{textAlign:"center",paddingLeft:"63px"}},n.createElement("button",{className:"btn btn-success btn-fill",onClick:function(){e.handleSubscription()}}," \xa0 \xa0 \xa0 Subscribe \xa0 \xa0 \xa0 ")))),n.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),n.createElement(s.a,{instance:"",id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Card?",heading:"Confirm...",onConfirmButtonClick:function(){e.deletePayment()}})),!d.stripePaymentMethodId&&n.createElement("div",null,n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Card Number: "),n.createElement("div",{className:"col-md-5 "},n.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},n.createElement(u,null))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Expiry date: "),n.createElement("div",{className:"col-md-5 "},n.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},n.createElement(h,null))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-9 col-md-offset-3"},n.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Cvc: "),n.createElement("div",{className:"col-md-5 "},n.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},n.createElement(f,null))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-offset-3"},n.createElement("div",{className:"col-md-2 col-md-offset-2 col-xs-12 headingText",style:{textAlign:"center",paddingLeft:"63px"}},n.createElement("button",{className:"btn btn-success btn-fill",onClick:function(t){e.handlePayment(t)}}," \xa0 \xa0 \xa0 Subscribe \xa0 \xa0 \xa0 ")))))))))))))},t}(n.Component);t.default=g(b)},1010:function(e,t,a){"use strict";t.c=function(e,t,a){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(n.e)({user:e,payment:t,token:a},n.a.Stripe.PaymentMethod,"")];case 1:return[2,r.sent()]}})})},t.e=function(e,t){return r(this,void 0,void 0,function(){return i(this,function(a){switch(a.label){case 0:return[4,Object(n.e)({pmId:e,user:t},n.a.Stripe.StripeCustomer,"")];case 1:return[2,a.sent()]}})})},t.f=function(e,t,a,c){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(n.e)({planItem:e,customerId:t,user:a,buildingName:c},n.a.Stripe.StripeSubscription,"")];case 1:return[2,r.sent()]}})})},t.b=function(e){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,Object(n.e)({pmId:e},n.a.Stripe.GetPaymentMethod,"")];case 1:return[2,t.sent()]}})})},t.a=function(e,t){return r(this,void 0,void 0,function(){return i(this,function(a){switch(a.label){case 0:return[4,Object(n.e)({pmId:e,user:t},n.a.Stripe.DeletePaymentMethod,"")];case 1:return[2,a.sent()]}})})},t.g=function(e,t,a,c){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(n.e)({planItem:e,customerId:t,user:a,buildingName:c},n.a.Stripe.StripeCreateInvoice,"")];case 1:return[2,r.sent()]}})})},t.d=function(e,t,a,c){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(n.e)({totalPrice:e,spaceName:t,payment:a,token:c},n.a.Stripe.SpaceReservatioCharges,"")];case 1:return[2,r.sent()]}})})};var n=a(12),r=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,i){function c(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(c,s)}l((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var a,n,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{a=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}}});