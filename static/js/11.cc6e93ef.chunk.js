webpackJsonp([11],{2964:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),l=(n.n(a),n(127)),i=n(1290),o=n(11),s=n(707),r=n(2965),u=n(20),c=n(2966),m=n(2967),h=n(2968),d=n(2969),p=n(2970),g=n(2971),f=n(2972),v=n(2973),x=n(2974),w=n(2975),E=n(1679),b=(n.n(E),n(744)),V=n(2976),y=n(725),L=n(124),H=n(8),A=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),N=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},D=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},P=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),l=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,l++)a[l]=i[o];return a},_=function(e){function t(t){var n=e.call(this,t)||this,a=new Date(new Date(Date.now()).setMinutes(new Date(Date.now()).getMinutes()-30)),l=new Date(Date.now());return n.state={from:a,to:l,dashboardURL:"",insights:[],templatesList:[],selectedTemplate:"",loadingDevices:!0,liveGraphRange:30,filteredInsights:[],showInsights:[],selectedTemplateGraphs:{},showAlarmPoints:!1,insightsLoaded:0,verifyList:[],insightPoints:[]},n}return A(t,e),t.prototype.componentDidMount=function(){return N(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:return e=JSON.parse(H.a.getItem("user")),[4,Object(L.b)(e.contact)];case 1:return t.sent(),[4,this._fetchInsights()];case 2:return t.sent(),[2]}})})},t.prototype.moreInsights=function(){var e=this.state,t=e.showInsights,n=e.filteredInsights.slice(t.length-1,t.length+4),a=P(t,n);this.setState({showInsights:a},function(){window.dispatchEvent(new Event("reLoadGraph"))})},t.prototype.loadNextInsight=function(){var e=this.state,t=e.showInsights,n=e.insightsLoaded;n<t.length&&this.setState({insightsLoaded:n+1})},t.prototype._fetchInsights=function(){return N(this,void 0,void 0,function(){var e,t,n,a,l,r,u=this;return D(this,function(c){switch(c.label){case 0:return e=this.props.buildingName,t=[],n=[],[4,Object(b.o)(e)];case 1:return a=(a=c.sent()).filter(function(e){return"Measure"==e.verifyType}),e?[4,Object(s.w)(e)]:[3,6];case 2:return(l=(l=c.sent()).filter(function(e){var t,n,a,l,i,s,r;return-1!=(null===(t=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===t?void 0:t.toLowerCase().indexOf("thermostat"))||-1!=(null===(n=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===n?void 0:n.toLowerCase().indexOf("ceiling"))||-1!=(null===(a=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===a?void 0:a.toLowerCase().indexOf("intesis"))||-1!=(null===(l=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===l?void 0:l.toLowerCase().indexOf("ats"))||-1!=(null===(i=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("generator"))||"CBW406"==Object(o.g)(null===e||void 0===e?void 0:e.moncontype)||"CBW418"==Object(o.g)(null===e||void 0===e?void 0:e.moncontype)||-1!=(null===(s=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===s?void 0:s.toLowerCase().indexOf("relayv4"))||-1!=(null===(r=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===r?void 0:r.toLowerCase().indexOf("relayi1"))||"WattNode"==Object(o.g)(null===e||void 0===e?void 0:e.moncontype)}))&&l.length?(r=l.map(function(e){return Object(o.g)(e.moncondevice)}),[4,Object(y.k)(e,"Sensed",r)]):[3,4];case 3:n=c.sent(),c.label=4;case 4:return[4,Object(i.b)(e).then(function(e){if(e&&e.length>0)e.map(function(e){t.push({ontology:Object(o.g)(e.ontology),label:Object(o.g)(e.label),deviceGraphs:Object(o.g)(e.deviceGraphs)})}),u.setState({insightPoints:n,templatesList:t,insights:l,selectedTemplate:(t.length-1).toString(),filteredInsights:[],showInsights:[]},function(){var e=JSON.parse(t[t.length-1].deviceGraphs),n=Object.keys(e),i=null===l||void 0===l?void 0:l.filter(function(e){return n.indexOf(Object(o.g)(e.moncondevice))>-1}),s=i.slice(0,10);u.setState({filteredInsights:i,showInsights:s,selectedTemplateGraphs:e,verifyList:a,loadingDevices:!1})});else{var i=null===l||void 0===l?void 0:l.filter(function(e){return e.moncondevice}),s=i.slice(0,10);u.setState({insightPoints:n,insights:l,filteredInsights:i,showInsights:s,verifyList:a,loadingDevices:!1})}})];case 5:c.sent(),c.label=6;case 6:return[2]}})})},t.prototype.changeAlarmStatus=function(){this.setState({showAlarmPoints:!this.state.showAlarmPoints}),window.dispatchEvent(new Event("ShowAlarms"))},t.prototype.liveGraphRangeChange=function(e){var t=this,n=new Date,a=new Date;a.setMinutes(a.getMinutes()-+e),this.setState({from:a,to:n,liveGraphRange:+e,loadingDevices:!0,insightsLoaded:0},function(){t.setState({loadingDevices:!1})})},t.prototype.selectTemplate=function(e){var t=this,n=this.state,a=n.templatesList,l=n.insights,i=n.verifyList;if(isNaN(+e))if("default"==e){var s=l,r=s.slice(0,10);this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0},function(){t.setState({selectedTemplate:e,filteredInsights:s,showInsights:r,loadingDevices:!1})})}else if("equipmentGraphs"==e)this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0},function(){t.setState({loadingDevices:!1,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],liveGraphRange:1})});else{if(!i.find(function(t){return t._id==e}))return;this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0},function(){t.setState({loadingDevices:!1,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],liveGraphRange:1})})}else this.setState({loadingDevices:!0,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],insightsLoaded:0},function(){var n=JSON.parse(a[+e].deviceGraphs),i=Object.keys(n),s=l.filter(function(e){return i.indexOf(Object(o.g)(e.moncondevice))>-1}),r=s.slice(0,10);t.setState({showInsights:r,filteredInsights:s,loadingDevices:!1,selectedTemplateGraphs:n})})},t.prototype.render=function(){var e,t=this,n=this.state,i=n.verifyList,s=n.from,E=n.to,b=n.showInsights,y=n.filteredInsights,L=n.templatesList,H=n.selectedTemplate,A=n.loadingDevices,N=n.liveGraphRange,D=n.selectedTemplateGraphs,P=n.showAlarmPoints,_=n.insightsLoaded,O=n.insightPoints,S=this.props,j=S.buildingName,k=S.instance;return a.createElement("div",{className:"dashboard"},a.createElement("div",{className:"dashboard-header sticky"},!A&&a.createElement("div",{className:"col-md-4 float-left"},a.createElement("div",{className:"col-md-8 no-padding"},a.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(e){t.selectTemplate(e.target.value)},value:H,placeholder:"Select Template"},0==L.length&&a.createElement("option",{value:""},"Select Template"),a.createElement("option",{value:"default"},"All Graphs"),a.createElement("option",{value:"equipmentGraphs"},"Equipment Graphs"),(null===L||void 0===L?void 0:L.length)>0&&L.map(function(e,t){return a.createElement("option",{value:t,key:t},e.label)}),(null===i||void 0===i?void 0:i.length)>0&&i.map(function(e,t){return a.createElement("option",{value:e._id,key:t},e.projectName)}))),a.createElement(l.b,{target:"_blank",to:"/"+k+"/"+j+"/Dashboard/Templates",className:"btn btn-fill btn-secondary btn-secondary-dark margin-left-20 btn-fix-height"},"Create Template")),a.createElement("h3",{className:"dashboard-title"},Object(u.A)(j)),!A&&a.createElement("div",{className:"col-md-4 float-right margin-top-10"},_===b.length&&!i.find(function(e){return e._id==H})&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-3 padding-5"},a.createElement("label",{style:{color:"#fff",cursor:"default"}},"Show Alarm: \xa0")),a.createElement("div",{className:"padding-5"},a.createElement("label",null,a.createElement("input",{name:"showError",onChange:function(e){t.changeAlarmStatus()},className:"switchDashboard",type:"checkbox",checked:P}),a.createElement("div",null,a.createElement("div",null))))),a.createElement("div",{className:"col-md-5 padding-5 margin-left-20"},a.createElement("label",{style:{color:"#fff",cursor:"default"}},"Graph Range: \xa0")),a.createElement("div",{className:"col-md-6 no-padding"},a.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(e){t.liveGraphRangeChange(e.target.value)},value:N},i.find(function(e){return e._id==H})?a.createElement(a.Fragment,null,a.createElement("option",{value:1},"1 Month"),a.createElement("option",{value:2},"2 Months"),a.createElement("option",{value:3},"3 Months"),a.createElement("option",{value:4},"4 Months"),a.createElement("option",{value:5},"5 Months"),a.createElement("option",{value:6},"6 Months")):a.createElement(a.Fragment,null,a.createElement("option",{value:5},"5 Minutes"),a.createElement("option",{value:15},"15 Minutes"),a.createElement("option",{value:30},"30 Minutes"),a.createElement("option",{value:60},"1 Hour"),a.createElement("option",{value:180},"3 Hours"),a.createElement("option",{value:360},"6 Hours"),a.createElement("option",{value:720},"12 Hours"),a.createElement("option",{value:1440},"24 Hours")))))),A||""!=H||0!=L.length?A?a.createElement("div",{className:"graph-box-loader full-screen"},a.createElement("div",{className:"center-object loader"})):i.find(function(e){return e._id==H})?a.createElement("div",{className:""},a.createElement(V.a,{instance:k,buildingName:j,from:s,to:E,projectName:H,measureAnalysis:i.find(function(e){return e._id==H}).measureAnalysis})):a.createElement(c.a,{dataLength:b.length,className:"graph-boxes",next:function(){return t.moreInsights()},hasMore:b.length<y.length,loader:a.createElement("div",{className:"graph-box-loader full-screen"},a.createElement("div",{className:"center-object loader"}))},null===(e=null===b||void 0===b?void 0:b.slice(0,_+1))||void 0===e?void 0:e.map(function(e,n){for(var l,i,u,c,b,V,y,L=-1!=(null===(l=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===l?void 0:l.toLowerCase().indexOf("thermostat")),H=-1!=(null===(i=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("ceiling")),A=-1!=(null===(u=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===u?void 0:u.toLowerCase().indexOf("intesis")),_=-1!=(null===(c=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===c?void 0:c.toLowerCase().indexOf("ats")),S=-1!=(null===(b=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===b?void 0:b.toLowerCase().indexOf("generator")),q="CBW406"==Object(o.g)(null===e||void 0===e?void 0:e.moncontype),F="CBW418"==Object(o.g)(null===e||void 0===e?void 0:e.moncontype),R=-1!=(null===(V=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===V?void 0:V.toLowerCase().indexOf("relayv4")),M=-1!=(null===(y=Object(o.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===y?void 0:y.toLowerCase().indexOf("relayi1")),C="WattNode"==Object(o.g)(null===e||void 0===e?void 0:e.moncontype),G=Object(o.g)(e.equipmentsRdfsLabel).split(","),T=Object(o.g)(e.relatedEquipmentsLabel).split(","),I=[],U=0;U<G.length;U++){var B=G[U],K=T&&T[U]?T[U]:"";I.push({ontology:B,rdfsLabel:K})}var W=null===O||void 0===O?void 0:O.filter(function(t){return Object(o.g)(t.monconDevice)==Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)});return a.createElement(a.Fragment,null,L&&a.createElement(r.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,equipment:I,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),H&&a.createElement(h.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Temp & Humidity","Pressure","Illuminance","Air Particles","Gas Resistance","Other Parameters"],equipment:I,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),A&&a.createElement(d.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,space:Object(o.g)(e.spaceRdfsLabel),zone:Object(o.g)(e.zoneRdfsLabel),floor:Object(o.g)(e.floorRdfsLabel),equipment:I,index:n,loadNextInsight:function(){return t.loadNextInsight()},device:e}),_&&a.createElement(p.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,equipment:I,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),S&&a.createElement(g.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Voltages","Currents","Powers","Power Factor","Other Parameters","Binary Parameters"],equipment:I,index:n,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),q&&a.createElement(f.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Refrigerator 1","Refrigerator 2"],equipment:I,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),F&&a.createElement(v.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Refrigerator 1","Refrigerator 2"],equipment:I,index:n,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),R&&a.createElement(x.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,equipment:I,index:n,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),M&&a.createElement(m.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Totalized Energy","Frequency and Voltage","Current and Power","State and Power Factor"],equipment:I,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),C&&a.createElement(w.a,{buildingName:j,instance:k,from:s,to:E,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(o.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Power","Phase Voltage","Voltage","Frequency","Energy Sum Resettable","Positive Energy Sum Non-resettable"],equipment:I,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}))}),0==(null===b||void 0===b?void 0:b.length)&&a.createElement("div",{className:"full-screen"},a.createElement("h1",{className:"no-graph-heading"}," No Graphs "))):a.createElement("div",{className:"full-screen"},a.createElement("h1",{className:"no-graph-heading"}," No Template Created ")))},t}(a.Component);t.default=_},2965:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(11),s=n(707),r=n(802),u=n(20),c=n(875),m=n(803),h=n(122),d=n(736),p=n(124),g=n(760),f=(n.n(g),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},x=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},w=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No data",deviceAlarms:[],alarmSensedPoints:[],graphDataAlarmPoint:{},selectedAlarmPoint:c.a,indicateAlarm:!1,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return f(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){var e=this;return x(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return v(this,void 0,void 0,function(){var e,t=this;return x(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(o.g)(e)&&Object(p.g)(Object(o.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return v(this,void 0,void 0,function(){var t,n,a,l,i,s,r,u,c,p,g,f=this;return x(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint,l=this.props,i=l.buildingName,s=l.devicePoints,r=l.showAlarmPoints,u=l.device,Object(h.a)(!0),r&&!e?[3,2]:(c=[],s&&s.length&&s.forEach(function(e){c.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(o.g)(e.ifMaximumExtremeValue)||"true"!=Object(o.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(o.g)(e.ifMaximumNormalValue)||"true"!=Object(o.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(o.g)(e.ifMinimumExtremeValue)||"true"!=Object(o.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(o.g)(e.ifMinimumNormalValue)||"true"!=Object(o.g)(e.ifMinimumNormalValue))})}),[4,Object(m.e)(d.a.OperationalAlarm,i,!1,0,50,null,null,[Object(o.g)(u.moncondevice)],null)]);case 1:return p=v.sent(),g=new Date(n.columns[0][1]),p=p.filter(function(e){return new Date(e.timeofalarm)>g}),this.setState({alarmSensedPoints:c,deviceAlarms:p},function(){if((null===c||void 0===c?void 0:c.length)>0&&n.columns.length>1){var e=a.sensedValue.length>1?a.sensedValue:c[c.length-1].sensedValue;f.selectAlarmPoint(e)}}),[3,3];case 2:this.selectAlarmPoint(""),v.label=3;case 3:return Object(h.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{},axes:{}};if(o){if("cooltemp"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"grey",Low:"grey","Cool setpoint":"red",High:"grey","High-High":"grey"}}}else if("heattemp"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},colors:{"Low-Low":"red",Low:"grey","Heat setpoint":"#e3e3e3",High:"grey","High-High":"red"}}}else if("spacetemp"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Space Temp":"#e3e3e3",High:"grey","High-High":"red"},axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"}}}else if("fan"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Fan 0: Auto 1: On":"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","Fan 0: Auto 1: On":"#e3e3e3",High:"grey","High-High":"red"}}}else if("fanstate"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Fan State 1: On":"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","Fan State 1: On":"#e3e3e3",High:"grey","High-High":"red"}}}else if("mode"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Mode 0: Heat 1: Cool 2: Auto":"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","Mode 0: Heat 1: Cool 2: Auto":"#e3e3e3",High:"grey","High-High":"red"}}}else if("state"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{state:"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","State 1: Heat 2: Cool":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint:o,graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint:c.a,graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})})},t.prototype.callLiveUpdate=function(e){return v(this,void 0,void 0,function(){var t,n,a,l,i,o,s,r,c,m,h=this;return x(this,function(d){return t=this.state,n=t.graphData,a=t.axis1,l=t.grid,i=t.alarmSensedPoints,o=t.selectedAlarmPoint,s=this.props.showAlarmPoints,e["@timestamp"]&&(r=new Date(e["@timestamp"]),r=new Date(r.setHours(r.getHours()+10))),c=this.props.liveGraphRange,n.columns.length>1&&r&&(n.columns[0].push(r),1==(null===e||void 0===e?void 0:e.tempunits)?(n.columns[1].push(Object(u.a)(null===e||void 0===e?void 0:e.cooltemp).toFixed(1)),n.columns[2].push(Object(u.a)(null===e||void 0===e?void 0:e.heattemp).toFixed(1)),n.columns[3].push(Object(u.a)(null===e||void 0===e?void 0:e.spacetemp).toFixed(1))):(n.columns[1].push(null===e||void 0===e?void 0:e.cooltemp),n.columns[2].push(null===e||void 0===e?void 0:e.heattemp),n.columns[3].push(null===e||void 0===e?void 0:e.spacetemp)),n.columns[4].push(null===e||void 0===e?void 0:e.fan),n.columns[5].push(null===e||void 0===e?void 0:e.fanstate),n.columns[6].push(null===e||void 0===e?void 0:e.mode),n.columns[7].push(null===e||void 0===e?void 0:e.state),(r.getTime()-n.columns[0][2].getTime())/6e4>c&&n.columns[0].splice(1,1),a.x.tick.values[2]&&a.x.tick.values[1].getTime()&&a.x.tick.values[2].getTime()-a.x.tick.values[1].getTime()<r.getTime()-a.x.tick.values[a.x.tick.values.length-1]&&(a.x.tick.values.splice(0,1),l.x.lines.splice(0,1),r.setSeconds(0),c>10&&r.setMinutes(r.getMinutes()-r.getMinutes()%5),a.x.tick.values.push(r),l.x.lines.push({value:r,class:"grid4"})),m=null===r||void 0===r?void 0:r.toLocaleString(),s?this.setState({grid:l,axis1:a,graphData:n,lastUpdatedAt:m},function(){var e=o.sensedValue.length>1?o.sensedValue:i[i.length-1].sensedValue;h.selectAlarmPoint(e)}):this.setState({grid:l,axis1:a,graphData:n,lastUpdatedAt:m})),[2]})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(o.g)(e.sensedValue)==a});!i||!Object(o.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(o.g)(i.relatedEquipment)})||l.push({value:Object(o.g)(i.relatedEquipment),label:Object(o.g)(i.relatedEquipmentLabel),space:Object(o.g)(i.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)i(s);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return v(this,void 0,void 0,function(){var t,n,a,l,i,c,m,h,d,g,f,v,w,E,b,V,y,L,H,A,N,D,P,_,O=this;return x(this,function(x){switch(x.label){case 0:return t=this.props,n=t.from,a=t.to,l=t.device,i=t.showAlarmPoints,c=this.state,m=c.grid,h=c.axis1,d=c.graphData,g=c.lastUpdatedAt,l&&l.moncondevice?(f=Object(o.g)(l.topic),[4,Object(s.I)(f,n,a,d.columns.length>1)]):[3,2];case 1:v=x.sent(),E=["Heat setpoint"],b=["Space Temp"],V=["Fan 0: Auto 1: On"],y=["Fan State 1: On"],L=["Mode 0: Heat 1: Cool 2: Auto"],H=["State 1: Heat 2: Cool"],A=["x"],(w=["Cool setpoint"]).push(null),E.push(null),b.push(null),V.push(null),y.push(null),L.push(null),H.push(null),A.push(new Date(n)),v.length>0&&(null===v||void 0===v||v.forEach(function(e){(null===e||void 0===e?void 0:e.cooltemp)&&(1==e.tempunits?(w.push(Object(u.a)(e.cooltemp).toFixed(1)),E.push(Object(u.a)(e.heattemp).toFixed(1)),b.push(Object(u.a)(e.spacetemp).toFixed(1))):(w.push(e.cooltemp),E.push(e.heattemp),b.push(e.spacetemp)),V.push(e.fan),y.push(e.fanstate),L.push(e.mode),H.push(e.state),A.push(new Date(e.timestamp)))})),g=v.length>0?null===(e=A[A.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",(d.columns.length>1||0===v.length)&&(w.push(null),E.push(null),b.push(null),V.push(null),y.push(null),L.push(null),H.push(null),A.push(new Date(a))),h.y.label="\xb0C",N=Object(r.a)(5,n,a),D="",N.length>1?(P=((new Date).getTime()-N[0].getTime())/1e3,D=(P/=3600)>24?"%m-%d %H:%M":P<.3?"%H:%M:%S":"%H:%M"):D="%H:%M:%S",m.x.lines=[],N.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),(_=[]).push(this.fetchEquipmentFromPoints("thermostat",["cooltemp","heattemp","spacetemp","fan","fanstate","mode","state"])),d={x:"x",columns:[A,w,E,b,V,y,L,H],axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},colors:{"Cool setpoint":"yellow","Heat setpoint":"green","Space Temp":"blue","Fan 0: Auto 1: On":"pink","Fan State 1: On":"yellow","Mode 0: Heat 1: Cool 2: Auto":"magenta","State 1: Heat 2: Cool":"#06cfa4"},types:{"Cool setpoint":"line","Heat setpoint":"line","Space Temp":"line","Fan 0: Auto 1: On":"step","Fan State 1: On":"step","Mode 0: Heat 1: Cool 2: Auto":"step","State 1: Heat 2: Cool":"step"}},h={x:{type:"timeseries",tick:{fit:!1,count:5,values:N,format:D}},y:{label:{text:"Temperature \xb0F",position:"outer-middle"},tick:{fit:!0,values:[0,20,40,60,80,100],count:6,format:function(e){return parseFloat(e).toFixed(1)}},max:100,min:0},y2:{show:!0,label:{text:"State, Mode, Fan, Fan State",position:"outer-middle"},tick:{fit:!0,values:[0,1,2,3],count:6,format:function(e){return parseFloat(e).toFixed(0)}},max:3,min:0}},this.props.loadNextInsight(),Object(p.h)(f,this.callLiveUpdate),this.setState({grid:m,axis1:h,graphData:d,loading:!1,lastUpdatedAt:g,graphEquipment:_},function(){i&&O.changeAlarmStatus(!0)}),x.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t=this,n=this.state,l=n.loading,s=n.graphData,r=n.axis1,u=n.grid,c=n.lastUpdatedAt,m=n.alarmSensedPoints,h=n.selectedAlarmPoint,d=n.graphDataAlarmPoint,p=n.indicateAlarm,g=n.graphEquipment,f=this.props,v=f.instance,x=f.buildingName,w=f.device,E=f.showAlarmPoints,b=f.equipment;return a.createElement("div",{className:"row col-md-12 device-graphs "+(p&&E?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),E&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",m&&m.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:h.sensedValue,onChange:function(e){t.selectAlarmPoint(e.target.value)}},m.map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),p&&a.createElement("a",{href:"#"+v+"/"+x+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(w.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+v+"/"+x+"/Insights/Equipment/Graphs/InsightControl/"+Object(o.g)(w.moncondevice),target:"_blank",rel:"noreferrer noopener"},g&&g.length&&g.find(function(e){return"thermostat"==e.graph})&&g.find(function(e){return"thermostat"==e.graph}).pointEquip.length?g.find(function(e){return"thermostat"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Space: ",Object(o.g)(w.spaceRdfsLabel)),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",g&&g.length&&g.find(function(e){return"thermostat"==e.graph})&&g.find(function(e){return"thermostat"==e.graph}).pointEquip.length?g.find(function(e){return"thermostat"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",g&&g.length&&g.find(function(e){return"thermostat"==e.graph})&&g.find(function(e){return"thermostat"==e.graph}).pointEquip.length?g.find(function(e){return"thermostat"==e.graph}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(w.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(w.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",b.map(function(e,t){return e.rdfsLabel+(t<b.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(w.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(w.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",c)),l?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:E&&(null===(e=d.columns)||void 0===e?void 0:e.length)>1?d:s,size:{height:300},axis:r,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}}))},t}(a.Component);t.a=w},2966:function(e,t,n){"use strict";var a=n(2),l=n.n(a),i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var o=function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)};var s={Pixel:"Pixel",Percent:"Percent"},r={unit:s.Percent,value:.8};function u(e){return"number"===typeof e?{unit:s.Percent,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:s.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:s.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),r):(console.warn("scrollThreshold should be string or number"),r)}var c=function(e){function t(t){var n=e.call(this,t)||this;return n.lastScrollTop=0,n.actionTriggered=!1,n.startY=0,n.currentY=0,n.dragging=!1,n.maxPullDownDistance=0,n.getScrollableTarget=function(){return n.props.scrollableTarget instanceof HTMLElement?n.props.scrollableTarget:"string"===typeof n.props.scrollableTarget?document.getElementById(n.props.scrollableTarget):(null===n.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},n.onStart=function(e){n.lastScrollTop||(n.dragging=!0,e instanceof MouseEvent?n.startY=e.pageY:e instanceof TouchEvent&&(n.startY=e.touches[0].pageY),n.currentY=n.startY,n._infScroll&&(n._infScroll.style.willChange="transform",n._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},n.onMove=function(e){n.dragging&&(e instanceof MouseEvent?n.currentY=e.pageY:e instanceof TouchEvent&&(n.currentY=e.touches[0].pageY),n.currentY<n.startY||(n.currentY-n.startY>=Number(n.props.pullDownToRefreshThreshold)&&n.setState({pullToRefreshThresholdBreached:!0}),n.currentY-n.startY>1.5*n.maxPullDownDistance||n._infScroll&&(n._infScroll.style.overflow="visible",n._infScroll.style.transform="translate3d(0px, "+(n.currentY-n.startY)+"px, 0px)")))},n.onEnd=function(){n.startY=0,n.currentY=0,n.dragging=!1,n.state.pullToRefreshThresholdBreached&&(n.props.refreshFunction&&n.props.refreshFunction(),n.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){n._infScroll&&(n._infScroll.style.overflow="auto",n._infScroll.style.transform="none",n._infScroll.style.willChange="unset")})},n.onScrollListener=function(e){"function"===typeof n.props.onScroll&&setTimeout(function(){return n.props.onScroll&&n.props.onScroll(e)},0);var t=n.props.height||n._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;n.actionTriggered||((n.props.inverse?n.isElementAtTop(t,n.props.scrollThreshold):n.isElementAtBottom(t,n.props.scrollThreshold))&&n.props.hasMore&&(n.actionTriggered=!0,n.setState({showLoader:!0}),n.props.next&&n.props.next()),n.lastScrollTop=t.scrollTop)},n.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},n.throttledOnScrollListener=function(e,t,n,a){var l,i=!1,o=0;function s(){l&&clearTimeout(l)}function r(){var r=this,u=Date.now()-o,c=arguments;function m(){o=Date.now(),n.apply(r,c)}i||(a&&!l&&m(),s(),void 0===a&&u>e?m():!0!==t&&(l=setTimeout(a?function(){l=void 0}:m,void 0===a?e-u:e)))}return"boolean"!==typeof t&&(a=n,n=t,t=void 0),r.cancel=function(){s(),i=!0},r}(150,n.onScrollListener).bind(n),n.onStart=n.onStart.bind(n),n.onMove=n.onMove.bind(n),n.onEnd=n.onEnd.bind(n),n}return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?o(o({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,a=u(t);return a.unit===s.Pixel?e.scrollTop<=a.value+n-e.scrollHeight+1:e.scrollTop<=a.value/100+n-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,a=u(t);return a.unit===s.Pixel?e.scrollTop+n>=e.scrollHeight-a.value:e.scrollTop+n>=a.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=o({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),n=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),a=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return l.a.createElement("div",{style:a,className:"infinite-scroll-component__outerdiv"},l.a.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&l.a.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},l.a.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!n&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(a.Component);t.a=c},2967:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(11),s=n(707),r=n(802),u=n(875),c=n(803),m=n(122),h=n(736),d=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},selectedAlarmPoint1:u.a,selectedAlarmPoint2:u.a,selectedAlarmPoint3:u.a,selectedAlarmPoint4:u.a,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(o.g)(e)&&Object(d.g)(Object(o.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,s,r,u,d,p,g,f,x,w,E=this;return v(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,s=t.selectedAlarmPoint4,r=this.props,u=r.buildingName,d=r.devicePoints,p=r.showAlarmPoints,g=r.device,Object(m.a)(!0),p&&!e?[3,2]:(f=[],d&&d.length&&d.forEach(function(e){f.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(o.g)(e.ifMaximumExtremeValue)||"true"!=Object(o.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(o.g)(e.ifMaximumNormalValue)||"true"!=Object(o.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(o.g)(e.ifMinimumExtremeValue)||"true"!=Object(o.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(o.g)(e.ifMinimumNormalValue)||"true"!=Object(o.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(h.a.OperationalAlarm,u,!1,0,50,null,null,[Object(o.g)(g.moncondevice)],null)]);case 1:return x=v.sent(),w=new Date(n.columns[0][1]),x=x.filter(function(e){return new Date(e.timeofalarm)>w}),this.setState({alarmSensedPoints:f,deviceAlarms:x},function(){if((null===f||void 0===f?void 0:f.length)>0&&n.columns.length>1){var e=f.filter(function(e){return"import_active_energy_Wh"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";E.selectAlarmPoint1(t);var o=f.filter(function(e){return"frequency_Hz"==e.sensedValue||"voltage_volts"==e.sensedValue}),r=l.sensedValue.length>1?l.sensedValue:(null===o||void 0===o?void 0:o.length)>0?o[o.length-1].sensedValue:"";E.selectAlarmPoint2(r);var u=f.filter(function(e){return"active_power_Watts"==e.sensedValue||"current_Amperes"==e.sensedValue}),c=i.sensedValue.length>1?i.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";E.selectAlarmPoint3(c);var m=f.filter(function(e){return"relay_state"==e.sensedValue||"power_factor"==e.sensedValue}),h=s.sensedValue.length>1?s.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";E.selectAlarmPoint4(h)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),v.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,o,s=this;return v(this,function(r){return t=this.state,n=t.graphData,a=t.alarmSensedPoints,l=t.deviceAlarms,i=a.find(function(t){return t.sensedValue===e}),o=l.length>0&&l.findIndex(function(e){return"import_active_energy_Wh"==e.sensedValueKey})>-1,this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(i){if("import_active_energy_Wh"==i.sensedValue){for(var t=["Low-Low"],a=["Low"],l=["High"],r=["High-High"],c=0;c<n.columns[1].length-1;c++)t.push(i.minimumExtremeValue),a.push(i.minimumNormalValue),l.push(i.maximumNormalValue),r.push(i.maximumExtremeValue);e={x:"x",columns:[n.columns[0],t,a,n.columns[1],l,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Kilo Watt Hour":"#e3e3e3",High:"grey","High-High":"red"}},!i.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!i.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!i.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!i.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=n;s.setState({selectedAlarmPoint1:i,graphDataAlarmPoint1:e,indicateAlarm1:o,loading:!1})}else e=n,s.setState({selectedAlarmPoint1:u.a,indicateAlarm1:o,graphDataAlarmPoint1:e,loading:!1})}),[2]})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"frequency_Hz"==e.sensedValueKey||"voltage_volts"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("frequency_Hz"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Freq:"#e3e3e3",High:"grey","High-High":"red"}}}else if("voltage_volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Volts:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint2:o,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:u.a,indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"active_power_Watts"==e.sensedValueKey||"current_Amperes"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("active_power_Watts"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Watts:"#e3e3e3",High:"grey","High-High":"red"}}}else if("current_Amperes"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Amps:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint3:o,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:u.a,indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"relay_state"==e.sensedValueKey||"power_factor"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("relay_state"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",State:"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_factor"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Factor":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint4:o,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:u.a,indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,o=a.graphData3,s=a.graphData4,r=a.axis1,u=a.grid,c=a.alarmSensedPoints,m=a.selectedAlarmPoint1,h=a.selectedAlarmPoint2,d=a.selectedAlarmPoint3,p=a.selectedAlarmPoint4,g=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var f=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(+(null===e||void 0===e?void 0:e.import_active_energy_Wh)/1e3),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.frequency_Hz),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.voltage_volts),o.columns[1].splice(1,1),o.columns[1].push(null===e||void 0===e?void 0:e.active_power_Watts),o.columns[2].splice(1,1),o.columns[2].push(null===e||void 0===e?void 0:e.current_Amperes),s.columns[1].splice(1,1),s.columns[1].push(null===e||void 0===e?void 0:e.i1relay_state),s.columns[2].splice(1,1),s.columns[2].push(null===e||void 0===e?void 0:e.power_factor),r.x.tick.values[0]<l.columns[0][1]&&(r.x.tick.values.splice(0,1),u.x.lines.splice(0,1)),(t.getTime()-l.columns[0][2].getTime())/6e4>f&&l.columns[0].splice(1,1),r.x.tick.values[2]&&r.x.tick.values[1].getTime()&&r.x.tick.values[2].getTime()-r.x.tick.values[1].getTime()<t.getTime()-r.x.tick.values[r.x.tick.values.length-1]&&(r.x.tick.values.splice(0,1),u.x.lines.splice(0,1),t.setSeconds(0),f>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),r.x.tick.values.push(t),u.x.lines.push({value:t,class:"grid4"}));var v=null===t||void 0===t?void 0:t.toLocaleString();g?this.setState({grid:u,axis1:r,graphData:l,graphData2:i,graphData3:o,graphData4:s,lastUpdatedAt:v},function(){var e=c.filter(function(e){return"import_active_energy_Wh"==e.sensedValue}),t=m.sensedValue.length>1?m.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=c.filter(function(e){return"frequency_Hz"==e.sensedValue||"voltage_volts"==e.sensedValue}),l=h.sensedValue.length>1?h.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=c.filter(function(e){return"active_power_Watts"==e.sensedValue||"current_Amperes"==e.sensedValue}),o=d.sensedValue.length>1?d.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(o);var s=c.filter(function(e){return"relay_state"==e.sensedValue||"power_factor"==e.sensedValue}),r=p.sensedValue.length>1?p.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(r)}):this.setState({grid:u,axis1:r,graphData:l,graphData2:i,graphData3:o,graphData4:s,lastUpdatedAt:v})}},t.prototype.liveGraph=function(){var e,t,n,a,l,i,r,u,c;return f(this,void 0,void 0,function(){var m,h,d,p,g,f,x,w,E,b,V,y,L,H,A,N;return v(this,function(v){switch(v.label){case 0:return m=this.state,h=m.graphData,d=m.graphData2,p=m.graphData3,g=m.graphData4,f=m.axis1,x=m.grid,w=m.lastUpdatedAt,E=this.props,b=E.device,V=E.liveGraphRange,y=new Date,L=new Date,H=Object(o.g)(b.topic),L.setMinutes(L.getMinutes()-V),[4,Object(s.g)(H,L,y,!0)];case 1:return A=v.sent(),(N=new Date(null===(e=A[0])||void 0===e?void 0:e.timestamp))>h.columns[0][h.columns[0].length-1]&&(null===(t=A[0])||void 0===t?void 0:t.timestamp)&&(h.columns[0].splice(1,1),h.columns[0].push(N),h.columns[1].splice(1,1),h.columns[1].push(+(null===(n=A[0])||void 0===n?void 0:n.import_active_energy_Wh)/1e3),d.columns[1].splice(1,1),d.columns[1].push(null===(a=A[0])||void 0===a?void 0:a.frequency_Hz),d.columns[2].splice(1,1),d.columns[2].push(null===(l=A[0])||void 0===l?void 0:l.voltage_volts),p.columns[1].splice(1,1),p.columns[1].push(null===(i=A[0])||void 0===i?void 0:i.active_power_Watts),p.columns[2].splice(1,1),p.columns[2].push(null===(r=A[0])||void 0===r?void 0:r.current_Amperes),g.columns[1].splice(1,1),g.columns[1].push(null===(u=A[0])||void 0===u?void 0:u.i1relay_state),g.columns[2].splice(1,1),g.columns[2].push(null===(c=A[0])||void 0===c?void 0:c.power_factor),f.x.tick.values[0]<h.columns[0][1]&&(f.x.tick.values.splice(0,1),x.x.lines.splice(0,1)),(N.getTime()-h.columns[0][2].getTime())/6e4>V&&h.columns[0].splice(1,1),f.x.tick.values[0]<h.columns[0][1]&&(f.x.tick.values.splice(0,1),x.x.lines.splice(0,1)),f.x.tick.values[2]&&f.x.tick.values[1].getTime()&&f.x.tick.values[2].getTime()-f.x.tick.values[1].getTime()<N.getTime()-f.x.tick.values[f.x.tick.values.length-1]&&(N.setSeconds(0),V>10&&N.setMinutes(N.getMinutes()-N.getMinutes()%5),f.x.tick.values.push(N),x.x.lines.push({value:N,class:"grid4"})),w=null===N||void 0===N?void 0:N.toLocaleString(),this.setState({grid:x,axis1:f,graphData:h,graphData2:d,graphData3:p,graphData4:g,lastUpdatedAt:w})),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(o.g)(e.sensedValue)==a});!i||!Object(o.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(o.g)(i.relatedEquipment)})||l.push({value:Object(o.g)(i.relatedEquipment),label:Object(o.g)(i.relatedEquipmentLabel),space:Object(o.g)(i.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)i(s);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,u,c,m,h,p,g,f,x,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,c=this.state,m=c.grid,h=c.axis1,p=c.axis2,g=c.axis3,f=c.axis4,x=c.graphData,w=c.graphData2,E=c.graphData3,b=c.graphData4,V=c.lastUpdatedAt,n&&n.moncondevice?(y=Object(o.g)(n.topic),[4,Object(s.g)(y,a,l,x.columns.length>1)]):[3,2];case 1:L=v.sent(),A=["Watts"],N=["Amps"],D=["Freq"],P=["Kilo Watt Hour"],_=["Power Factor"],O=["Volts"],S=["x"],(H=["State"]).push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(new Date(a)),L.length>0&&L.forEach(function(e){(null===e||void 0===e?void 0:e.i1relay_state)&&(H.push(e.i1relay_state),A.push(e.active_power_Watts),N.push(e.current_Amperes),D.push(e.frequency_Hz),P.push(+e.import_active_energy_Wh/1e3),_.push(e.power_factor),O.push(e.voltage_volts),S.push(new Date(e.timestamp)))}),V=L.length>0?null===(e=S[S.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(new Date(l)),j=[],u&&u.length&&(j.push(this.fetchEquipmentFromPoints(u[0]||"Totalized Energy",["import_active_energy_Wh"])),j.push(this.fetchEquipmentFromPoints(u[1]||"Frequency and Voltage",["frequency_Hz","voltage_volts"])),j.push(this.fetchEquipmentFromPoints(u[2]||"Current and Power",["active_power_Watts","current_Amperes"])),j.push(this.fetchEquipmentFromPoints(u[3]||"State and Power Factor",["relay_state","power_factor"]))),x={x:"x",columns:[S,P]},w={x:"x",columns:[S,D,O]},E={x:"x",columns:[S,A,N]},b={x:"x",columns:[S,H,_]},h.y.label="kWh",p.y.label="Hz/Volts",g.y.label="Watts/Amps",f.y.label="",k=Object(r.a)(5,a,l),q="",k.length>1?(F=((new Date).getTime()-k[0].getTime())/1e3,q=(F/=3600)>24?"%m-%d %H:%M":F<.3?"%H:%M:%S":"%H:%M"):q="%H:%M:%S",m.x.lines=[],k.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(0)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(1)},f.y.tick.format=function(e){return parseFloat(e).toFixed(2)},h.y.tick.values=[0,10,20,30,40,50],p.y.tick.values=[0,50,100,150,200],g.y.tick.values=[0,20,40,60,80,100],f.y.tick.values=[-1,0,1,2],h.y.max=50,h.y.min=0,p.y.max=200,p.y.min=0,g.y.max=100,g.y.min=0,f.y.max=2,f.y.min=-1,h.x.tick.format=q,p.x.tick.format=q,g.x.tick.format=q,f.x.tick.format=q,h.x.tick.values=k,p.x.tick.values=k,g.x.tick.values=k,f.x.tick.values=k,this.props.loadNextInsight(),Object(d.h)(y,this.callLiveUpdate),this.setState({grid:m,axis1:h,axis2:p,axis3:g,axis4:f,graphData:x,graphData2:w,graphData3:E,graphData4:b,loading:!1,lastUpdatedAt:V,graphEquipment:j},function(){i&&R.changeAlarmStatus(!0)}),v.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n,l,s=this,r=this.state,u=r.loading,c=r.graphData,m=r.graphData2,h=r.graphData3,d=r.graphData4,p=r.graphDataAlarmPoint1,g=r.graphDataAlarmPoint2,f=r.graphDataAlarmPoint3,v=r.graphDataAlarmPoint4,x=r.axis1,w=r.axis2,E=r.axis3,b=r.axis4,V=r.grid,y=r.lastUpdatedAt,L=r.indicateAlarm1,H=r.indicateAlarm2,A=r.indicateAlarm3,N=r.indicateAlarm4,D=r.alarmSensedPoints,P=r.selectedAlarmPoint1,_=r.selectedAlarmPoint2,O=r.selectedAlarmPoint3,S=r.selectedAlarmPoint4,j=r.graphEquipment,k=this.props,q=k.graphsList,F=k.instance,R=k.buildingName,M=k.device,C=k.showAlarmPoints,G=k.equipment,T=q&&q.length&&q[0]?q[0]:"Totalized Energy",I=q&&q.length&&q[1]?q[1]:"Frequency and Voltage",U=q&&q.length&&q[2]?q[2]:"Current and Power",B=q&&q.length&&q[3]?q[3]:"State and Power Factor";return a.createElement(a.Fragment,null,q.indexOf("Totalized Energy")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(L&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",D&&D.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:P.sensedValue,onChange:function(e){s.selectAlarmPoint1(e.target.value)}},D.filter(function(e){return"import_active_energy_Wh"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),L&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==T})&&j.find(function(e){return e.graph==T}).pointEquip.length?j.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Totalized Energy"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==T})&&j.find(function(e){return e.graph==T}).pointEquip.length?j.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==T})&&j.find(function(e){return e.graph==T}).pointEquip.length?j.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",y)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:C&&(null===(e=p.columns)||void 0===e?void 0:e.length)>1?p:c,size:{height:300},axis:x,grid:V,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),q.indexOf("Frequency and Voltage")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(H&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",D&&D.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:_.sensedValue,onChange:function(e){s.selectAlarmPoint2(e.target.value)}},D.filter(function(e){return"frequency_Hz"==e.sensedValue||"voltage_volts"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),H&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==I})&&j.find(function(e){return e.graph==I}).pointEquip.length?j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Freq & Volts"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==I})&&j.find(function(e){return e.graph==I}).pointEquip.length?j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==I})&&j.find(function(e){return e.graph==I}).pointEquip.length?j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",y)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:C&&(null===(t=g.columns)||void 0===t?void 0:t.length)>1?g:m,size:{height:300},axis:w,grid:V,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Current and Power")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(A&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",a.createElement("select",{className:"alarm-points-list",id:"spaces",value:O.sensedValue,onChange:function(e){s.selectAlarmPoint3(e.target.value)}},D.filter(function(e){return"active_power_Watts"==e.sensedValue||"current_Amperes"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})),A&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==U})&&j.find(function(e){return e.graph==U}).pointEquip.length?j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Current and Power"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==U})&&j.find(function(e){return e.graph==U}).pointEquip.length?j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==U})&&j.find(function(e){return e.graph==U}).pointEquip.length?j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",y)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:C&&(null===(n=f.columns)||void 0===n?void 0:n.length)>1?f:h,size:{height:300},axis:E,grid:V,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("State and Power Factor")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(N&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",D&&D.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:S.sensedValue,onChange:function(e){s.selectAlarmPoint4(e.target.value)}},D.filter(function(e){return"relay_state"==e.sensedValue||"power_factor"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),N&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(o.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==B})&&j.find(function(e){return e.graph==B}).pointEquip.length?j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-4 sentence-break"}," ","State and Power Factor"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==B})&&j.find(function(e){return e.graph==B}).pointEquip.length?j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==B})&&j.find(function(e){return e.graph==B}).pointEquip.length?j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",y)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:C&&(null===(l=v.columns)||void 0===l?void 0:l.length)>1?v:d,size:{height:300},axis:b,grid:V,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=x},2968:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(707),s=n(1008),r=n(802),u=n(875),c=n(11),m=n(803),h=n(736),d=n(122),p=n(124),g=n(760),f=(n.n(g),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},x=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},w=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},graphData5:{x:"x",columns:[]},graphData6:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis5:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis6:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,indicateAlarm5:!1,indicateAlarm6:!1,alarmSensedPoints:[],graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},graphDataAlarmPoint5:{},graphDataAlarmPoint6:{},selectedAlarmPoint1:u.a,selectedAlarmPoint2:u.a,selectedAlarmPoint3:u.a,selectedAlarmPoint4:u.a,selectedAlarmPoint5:u.a,selectedAlarmPoint6:u.a,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return f(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){var e=this;return x(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return v(this,void 0,void 0,function(){var e,t=this;return x(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(c.g)(e)&&Object(p.g)(Object(c.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return v(this,void 0,void 0,function(){var t,n,a,l,i,o,s,r,u,p,g,f,v,w,E,b,V=this;return x(this,function(x){switch(x.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,o=t.selectedAlarmPoint4,s=t.selectedAlarmPoint5,r=t.selectedAlarmPoint6,u=this.props,p=u.buildingName,g=u.devicePoints,f=u.showAlarmPoints,v=u.device,Object(d.a)(!0),f&&!e?[3,2]:(w=[],g&&g.length&&g.forEach(function(e){w.push({sensedValue:Object(c.g)(e.sensedValue),maximumExtremeValue:Object(c.g)(e.maximumExtremeValue),maximumNormalValue:Object(c.g)(e.maximumNormalValue),minimumExtremeValue:Object(c.g)(e.minimumExtremeValue),minimumNormalValue:Object(c.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(c.g)(e.ifMaximumExtremeValue)||"true"!=Object(c.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(c.g)(e.ifMaximumNormalValue)||"true"!=Object(c.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(c.g)(e.ifMinimumExtremeValue)||"true"!=Object(c.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(c.g)(e.ifMinimumNormalValue)||"true"!=Object(c.g)(e.ifMinimumNormalValue))})}),[4,Object(m.e)(h.a.OperationalAlarm,p,!1,0,50,null,null,[Object(c.g)(v.moncondevice)],null)]);case 1:return E=x.sent(),n.columns.length>1&&(b=new Date(n.columns[0][1]),E=E.filter(function(e){return new Date(e.timeofalarm)>b})),this.setState({alarmSensedPoints:w,deviceAlarms:E},function(){if((null===w||void 0===w?void 0:w.length)>0&&n.columns.length>1){var e=w.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";V.selectAlarmPoint1(t);var u=w.filter(function(e){return"pressure_hPa"==e.sensedValue}),c=l.sensedValue.length>1?l.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";V.selectAlarmPoint2(c);var m=w.filter(function(e){return"illuminance_lux"==e.sensedValue}),h=i.sensedValue.length>1?i.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";V.selectAlarmPoint3(h);var d=w.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}),p=o.sensedValue.length>1?o.sensedValue:(null===d||void 0===d?void 0:d.length)>0?d[d.length-1].sensedValue:"";V.selectAlarmPoint4(p);var g=w.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}),f=s.sensedValue.length>1?s.sensedValue:(null===g||void 0===g?void 0:g.length)>0?g[g.length-1].sensedValue:"";V.selectAlarmPoint5(f);var v=w.filter(function(e){return"motion_sensed"==e.sensedValue||"num_BTdev"==e.sensedValue}),x=r.sensedValue.length>1?r.sensedValue:(null===v||void 0===v?void 0:v.length)>0?v[v.length-1].sensedValue:"";V.selectAlarmPoint6(x)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),this.selectAlarmPoint5(""),this.selectAlarmPoint6(""),x.label=3;case 3:return Object(d.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"relhumidity_pct"==e.sensedValueKey||"temp_celsius"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("temp_celsius"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[0].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Temp:"#e3e3e3",High:"grey","High-High":"red"}}}else if("relhumidity_pct"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[0].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Humidity:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint1:o,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:u.a,indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"pressure_hPa"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("pressure_hPa"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Pressure:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint2:o,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:u.a,indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"illuminance_lux"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("illuminance_lux"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Illuminance:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint3:o,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:u.a,indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"gasResistance_kOhm"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("gasResistance_kOhm"==o.sensedValue&&(o.generateMaximumExtremeValue||o.generateMaximumNormalValue||o.generateMinimumExtremeValue||o.generateMinimumNormalValue)){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gas Res":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint4:o,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:u.a,indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.selectAlarmPoint5=function(e){var t=this,n=this.state,a=n.graphData5,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"equiCO2_ppm"==e.sensedValueKey||"tvoc_ppm"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("equiCO2_ppm"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",CO2:"#e3e3e3",High:"grey","High-High":"red"}}}else if("tvoc_ppm"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",TVOC:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint5:o,graphDataAlarmPoint5:e,indicateAlarm5:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint5:u.a,indicateAlarm5:s,graphDataAlarmPoint5:e,loading:!1})})},t.prototype.selectAlarmPoint6=function(e){var t=this,n=this.state,a=n.graphData6,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"motion_sensed"==e.sensedValueKey||"num_BTdev"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("motion_sensed"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Motion:"#e3e3e3",High:"grey","High-High":"red"}}}else if("tvoc_ppm"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Blth Dev.":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint6:o,graphDataAlarmPoint6:e,indicateAlarm6:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint6:u.a,indicateAlarm6:s,graphDataAlarmPoint6:e,loading:!1})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(c.g)(e.sensedValue)==a});!i||!Object(c.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(c.g)(i.relatedEquipment)})||l.push({value:Object(c.g)(i.relatedEquipment),label:Object(c.g)(i.relatedEquipmentLabel),space:Object(c.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return v(this,void 0,void 0,function(){var t,n,a,l,i,u,m,h,d,g,f,v,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R,M,C,G,T,I,U,B,K,W,z=this;return x(this,function(x){switch(x.label){case 0:return t=this.props,n=t.from,a=t.to,l=t.device,i=t.showAlarmPoints,u=t.graphsList,m=this.state,h=m.grid,d=m.axis1,g=m.axis2,f=m.axis3,v=m.axis4,w=m.axis5,E=m.axis6,b=m.graphData,V=m.graphData2,y=m.graphData3,L=m.graphData4,H=m.graphData5,A=m.graphData6,N=m.lastUpdatedAt,l&&l.moncondevice?(D=Object(c.g)(l.topic),P=Object(c.g)(l.firmwareVersion),_=Object(c.g)(l.csbCallibration)?parseInt(Object(c.g)(l.csbCallibration)):0,[4,Object(o.d)(D,n,a,b.columns.length>1)]):[3,2];case 1:O=x.sent(),j=["Humidity"],k=["Alt."],q=["CO2"],F=["TVOC"],R=["Gas Res"],M=["Illuminance"],C=["Motion"],G=["Blth Dev."],T=["Pressure"],I=["x"],(S=["Temp"]).push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(null),G.push(null),T.push(null),I.push(new Date(n)),O.length>0&&O.forEach(function(e){e&&(S.push(Object(s.a)(e.temp_celsius,P||"",_)),j.push(e.relhumidity_pct),k.push(e.altitude_m),q.push(e.equiCO2_ppm),F.push(e.tvoc_ppm),T.push(e.pressure_hPa),R.push(e.gasResistance_kOhm),M.push(e.illuminance_lux),C.push(e.motion_sensed),G.push(e.num_BTdev),I.push(new Date(e.timestamp)))}),N=O.length>0?null===(e=I[I.length-1])||void 0===e?void 0:e.toLocaleString():"No data",0===O.length&&(S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(null),G.push(null),T.push(null),I.push(new Date(a))),d.y.label="\xb0F / %",g.y.label="hPa",f.y.label="Lux",v.y.label="kOhm",w.y.label="PPM",E.y.label="",I.length>1&&(U=Object(r.a)(5,n,a),B="",U.length>1?(K=((new Date).getTime()-U[0].getTime())/1e3,B=(K/=3600)>24?"%m-%d %H:%M":K<.3?"%H:%M:%S":"%H:%M"):B="%H:%M:%S",h.x.lines=[],U.forEach(function(e){h.x.lines.push({value:e,class:"grid4"})}),d.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(0)},f.y.tick.format=function(e){return parseFloat(e).toFixed(0)},v.y.tick.format=function(e){return parseFloat(e).toFixed(0)},w.y.tick.format=function(e){return parseFloat(e).toFixed(0)},E.y.tick.format=function(e){return parseFloat(e).toFixed(0)},d.y.tick.values=[0,20,40,60,80,100],g.y.tick.values=[0,400,800,1200],f.y.tick.values=[0,40,80,120,160,200,240],v.y.tick.values=[0,600,1200,1800,2400,3e3],w.y.tick.values=[0,4e3,8e3,12e3,16e3],E.y.tick.values=[0,10,20,30,40,50],d.y.max=100,d.y.min=0,g.y.max=1100,g.y.min=0,f.y.max=200,f.y.min=0,v.y.max=3e3,v.y.min=0,w.y.max=16e3,w.y.min=0,E.y.max=50,E.y.min=0,d.x.tick.format=B,g.x.tick.format=B,f.x.tick.format=B,v.x.tick.format=B,w.x.tick.format=B,E.x.tick.format=B,d.x.tick.values=U,g.x.tick.values=U,f.x.tick.values=U,v.x.tick.values=U,w.x.tick.values=U,E.x.tick.values=U,W=[],u&&u.length&&(W.push(this.fetchEquipmentFromPoints(u[0]||"Temp & Humidity",["temp_celsius","relhumidity_pct"])),W.push(this.fetchEquipmentFromPoints(u[1]||"Pressure",["pressure_hPa"])),W.push(this.fetchEquipmentFromPoints(u[2]||"Illuminance",["illuminance_lux"])),W.push(this.fetchEquipmentFromPoints(u[3]||"Gas Resistance",["gasResistance_kOhm"])),W.push(this.fetchEquipmentFromPoints(u[4]||"Air Particles",["equiCO2_ppm","tvoc_ppm"])),W.push(this.fetchEquipmentFromPoints(u[5]||"Other Parameters",["motion_sensed","num_BTdev"]))),b={x:"x",columns:[I,S,j]},V={x:"x",columns:[I,T]},y={x:"x",columns:[I,M]},L={x:"x",columns:[I,R]},H={x:"x",columns:[I,q,F]},A={x:"x",columns:[I,C,G]},this.props.loadNextInsight(),Object(p.h)(D,this.callLiveUpdate),this.setState({grid:h,axis1:d,axis2:g,axis3:f,axis4:v,axis5:w,axis6:E,graphData:b,graphData2:V,graphData3:y,graphData4:L,graphData5:H,graphData6:A,lastUpdatedAt:N,loading:!1,graphEquipment:W},function(){i&&z.changeAlarmStatus(!0)})),x.label=2;case 2:return[2]}})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,o=a.graphData3,r=a.graphData4,u=a.graphData5,m=a.graphData6,h=a.axis1,d=a.grid,p=a.alarmSensedPoints,g=a.selectedAlarmPoint1,f=a.selectedAlarmPoint2,v=a.selectedAlarmPoint3,x=a.selectedAlarmPoint4,w=a.selectedAlarmPoint5,E=a.selectedAlarmPoint6,b=this.props,V=b.device,y=b.showAlarmPoints,L=Object(c.g)(V.firmwareVersion),H=Object(c.g)(V.csbCallibration)?parseInt(Object(c.g)(V.csbCallibration)):0;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var A=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].push(t),l.columns[1].push(Object(s.a)(null===e||void 0===e?void 0:e.temp_celsius,L||"",H)),l.columns[2].push(null===e||void 0===e?void 0:e.relhumidity_pct),i.columns[1].push(null===e||void 0===e?void 0:e.pressure_hPa),o.columns[1].push(null===e||void 0===e?void 0:e.illuminance_lux),r.columns[1].push(null===e||void 0===e?void 0:e.gasResistance_kOhm),u.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.equiCO2_ppm)),u.columns[2].push(parseFloat(null===e||void 0===e?void 0:e.tvoc_ppm)),m.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.motion_sensed)),m.columns[2].push(parseFloat(null===e||void 0===e?void 0:e.num_BTdev)),(t.getTime()-l.columns[0][2].getTime())/6e4>A&&l.columns[0].splice(1,1),h.x.tick.values[2]&&h.x.tick.values[1].getTime()&&h.x.tick.values[2].getTime()-h.x.tick.values[1].getTime()<t.getTime()-h.x.tick.values[h.x.tick.values.length-1]&&(h.x.tick.values.splice(0,1),d.x.lines.splice(0,1),t.setSeconds(0),A>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),h.x.tick.values.push(t),d.x.lines.push({value:t,class:"grid4"}));var N=null===t||void 0===t?void 0:t.toLocaleString();y?this.setState({grid:d,axis1:h,graphData:l,graphData2:i,graphData3:o,graphData4:r,graphData5:u,graphData6:m,lastUpdatedAt:N},function(){var e=p.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=g.sensedValue.length>1?g.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=p.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=f.sensedValue.length>1?f.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=p.filter(function(e){return"illuminance_lux"==e.sensedValue}),o=v.sensedValue.length>1?v.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(o);var s=p.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}),r=x.sensedValue.length>1?x.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(r);var u=p.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}),c=w.sensedValue.length>1?w.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";n.selectAlarmPoint5(c);var m=p.filter(function(e){return"motion_sensed"==e.sensedValue||"num_BTdev"==e.sensedValue}),h=E.sensedValue.length>1?E.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";n.selectAlarmPoint6(h)}):this.setState({grid:d,axis1:h,graphData:l,graphData2:i,graphData3:o,graphData4:r,graphData5:u,graphData6:m,lastUpdatedAt:N})}},t.prototype.render=function(){var e,t,n,l,o,s,r=this,u=this.state,m=u.loading,h=u.graphData,d=u.graphData2,p=u.graphData3,g=u.graphData4,f=u.graphData5,v=u.graphData6,x=u.axis1,w=u.axis2,E=u.axis3,b=u.axis4,V=u.axis5,y=u.axis6,L=u.grid,H=u.lastUpdatedAt,A=u.graphDataAlarmPoint1,N=u.graphDataAlarmPoint2,D=u.graphDataAlarmPoint3,P=u.graphDataAlarmPoint4,_=u.graphDataAlarmPoint5,O=u.graphDataAlarmPoint6,S=u.indicateAlarm1,j=u.indicateAlarm2,k=u.indicateAlarm3,q=u.indicateAlarm4,F=u.indicateAlarm5,R=u.indicateAlarm6,M=u.alarmSensedPoints,C=u.selectedAlarmPoint1,G=u.selectedAlarmPoint2,T=u.selectedAlarmPoint3,I=u.selectedAlarmPoint4,U=u.selectedAlarmPoint5,B=u.selectedAlarmPoint6,K=u.graphEquipment,W=this.props,z=W.instance,Z=W.buildingName,Y=W.graphsList,$=W.device,J=W.showAlarmPoints,Q=W.equipment,X=Y&&Y.length&&Y[0]?Y[0]:"Temp & Humidity",ee=Y&&Y.length&&Y[1]?Y[1]:"Pressure",te=Y&&Y.length&&Y[2]?Y[1]:"Illuminance",ne=Y&&Y.length&&Y[3]?Y[1]:"Gas Resistance",ae=Y&&Y.length&&Y[4]?Y[1]:"Air Particles",le=Y&&Y.length&&Y[5]?Y[1]:"Other Parameters";return a.createElement(a.Fragment,null,Y.indexOf("Temp & Humidity")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(S&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:C.sensedValue,onChange:function(e){r.selectAlarmPoint1(e.target.value)}},M.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),S&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==X})&&K.find(function(e){return e.graph==X}).pointEquip.length?K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Temp & Humidity"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==X})&&K.find(function(e){return e.graph==X}).pointEquip.length?K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==X})&&K.find(function(e){return e.graph==X}).pointEquip.length?K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(e=A.columns)||void 0===e?void 0:e.length)>1?A:h,size:{height:300},axis:x,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),Y.indexOf("Pressure")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(j&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:G.sensedValue,onChange:function(e){r.selectAlarmPoint2(e.target.value)}},M.filter(function(e){return"pressure_hPa"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),j&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ee})&&K.find(function(e){return e.graph==ee}).pointEquip.length?K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," "," Pressure"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ee})&&K.find(function(e){return e.graph==ee}).pointEquip.length?K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ee})&&K.find(function(e){return e.graph==ee}).pointEquip.length?K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(t=N.columns)||void 0===t?void 0:t.length)>1?N:d,size:{height:300},axis:w,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Illuminance")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(k&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:T.sensedValue,onChange:function(e){r.selectAlarmPoint3(e.target.value)}},M.filter(function(e){return"illuminance_lux"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),k&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==te})&&K.find(function(e){return e.graph==te}).pointEquip.length?K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Illuminance"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==te})&&K.find(function(e){return e.graph==te}).pointEquip.length?K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==te})&&K.find(function(e){return e.graph==te}).pointEquip.length?K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(n=D.columns)||void 0===n?void 0:n.length)>1?D:p,size:{height:300},axis:E,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Gas Resistance")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(q&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:I.sensedValue,onChange:function(e){r.selectAlarmPoint4(e.target.value)}},M.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),q&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ne})&&K.find(function(e){return e.graph==ne}).pointEquip.length?K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Gas Resistance"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ne})&&K.find(function(e){return e.graph==ne}).pointEquip.length?K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ne})&&K.find(function(e){return e.graph==ne}).pointEquip.length?K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(l=P.columns)||void 0===l?void 0:l.length)>1?P:g,size:{height:300},axis:b,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Air Particles")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(F&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:U.sensedValue,onChange:function(e){r.selectAlarmPoint5(e.target.value)}},M.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),F&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ae})&&K.find(function(e){return e.graph==ae}).pointEquip.length?K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Air Particles"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ae})&&K.find(function(e){return e.graph==ae}).pointEquip.length?K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ae})&&K.find(function(e){return e.graph==ae}).pointEquip.length?K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(o=_.columns)||void 0===o?void 0:o.length)>1?_:f,size:{height:300},axis:V,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Other Parameters")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(R&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:B.sensedValue,onChange:function(e){r.selectAlarmPoint6(e.target.value)}},M.filter(function(e){return"num_BTdev"==e.sensedValue||"motion_sensed"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),R&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==le})&&K.find(function(e){return e.graph==le}).pointEquip.length?K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Other Parameters"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==le})&&K.find(function(e){return e.graph==le}).pointEquip.length?K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==le})&&K.find(function(e){return e.graph==le}).pointEquip.length?K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(s=O.columns)||void 0===s?void 0:s.length)>1?O:v,size:{height:300},axis:y,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=w},2969:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(707),s=n(802),r=n(124),u=n(760),c=(n.n(u),n(11)),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data"},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return h(this,void 0,void 0,function(){var e=this;return d(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return h(this,void 0,void 0,function(){var e,t=this;return d(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(c.g)(e)&&Object(r.g)(Object(c.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(){},t.prototype.callLiveUpdate=function(e){var t,n=this.state,a=n.graphData,l=n.axis1,i=n.grid;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var o=this.props.liveGraphRange;if(a.columns.length>1&&t){a.columns[0].splice(1,1),a.columns[0].push(t),a.columns[1].splice(1,1),a.columns[1].push(null===e||void 0===e?void 0:e.setpoint),a.columns[2].splice(1,1),a.columns[2].push(null===e||void 0===e?void 0:e.roomtemp),a.columns[3].splice(1,1),a.columns[3].push(null===e||void 0===e?void 0:e.fanspeed),a.columns[4].splice(1,1),a.columns[4].push(null===e||void 0===e?void 0:e.horizontalvans),a.columns[5].splice(1,1),a.columns[5].push(null===e||void 0===e?void 0:e.usermode),a.columns[6].splice(1,1),a.columns[6].push(null===e||void 0===e?void 0:e.verticalvans),a.columns[7].splice(1,1),a.columns[7].push(null===e||void 0===e?void 0:e.wifiSignal),(t.getTime()-a.columns[0][2].getTime())/6e4>o&&a.columns[0].splice(1,1),l.x.tick.values[2]&&l.x.tick.values[1].getTime()&&l.x.tick.values[2].getTime()-l.x.tick.values[1].getTime()<t.getTime()-l.x.tick.values[l.x.tick.values.length-1]&&(l.x.tick.values.splice(0,1),i.x.lines.splice(0,1),t.setSeconds(0),o>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),l.x.tick.values.push(t),i.x.lines.push({value:t,class:"grid4"}));var s=null===t||void 0===t?void 0:t.toLocaleString();this.setState({grid:i,axis1:l,graphData:a,lastUpdatedAt:s})}},t.prototype._fetchData=function(){var e;return h(this,void 0,void 0,function(){var t,n,a,l,i,u,m,h,p,g,f,v,x,w,E,b,V,y,L,H,A,N;return d(this,function(d){switch(d.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=this.state,u=i.grid,m=i.axis1,h=i.graphData,p=i.lastUpdatedAt,n&&n.moncondevice?(g=Object(c.g)(n.topic),[4,Object(o.e)(g,a,l,h.columns.length>1)]):[3,2];case 1:f=d.sent(),v=["setpoint"],w=["mode"],E=["fanspeed"],b=["horizontalvans"],V=["verticalvans"],y=["wifiSignal"],L=["x"],(x=["roomtemp"]).push(null),v.push(null),E.push(null),b.push(null),w.push(null),V.push(null),y.push(null),L.push(new Date(a)),f.length>0&&f.forEach(function(e){e&&(1!=isNaN(e.roomtemp)&&x.push(e.roomtemp),1!=isNaN(e.setpoint)&&v.push(e.setpoint),e.fanspeed?E.push(e.fanspeed):E.push("undefined"),e.horizontalvans?b.push(e.horizontalvans):b.push("undefined"),e.usermode?w.push(e.usermode):w.push("undefined"),e.verticalvans?V.push(e.verticalvans):V.push("undefined"),e.wifiSignal?y.push(e.wifiSignal):y.push("undefined"),L.push(new Date(e.timestamp)))}),p=f.length>0?null===(e=L[L.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",x.push(null),v.push(null),E.push(null),b.push(null),w.push(null),V.push(null),y.push(null),L.push(new Date(l)),h={x:"x",columns:[L,v,x,E,b,w,V,y]},m.y.label="\xb0F",H=Object(s.a)(5,a,l),A="",H.length>1?(N=((new Date).getTime()-H[0].getTime())/1e3,A=(N/=3600)>24?"%m-%d %H:%M":N<.3?"%H:%M:%S":"%H:%M"):A="%H:%M:%S",u.x.lines=[],H.forEach(function(e){u.x.lines.push({value:e,class:"grid4"})}),m.y.tick.format=function(e){return parseFloat(e).toFixed(2)},m.y.tick.values=[0,20,40,60,80,100],m.y.max=100,m.y.min=0,m.x.tick.format=A,m.x.tick.values=H,this.props.loadNextInsight(),Object(r.h)(g,this.callLiveUpdate),this.setState({grid:u,axis1:m,graphData:h,loading:!1,lastUpdatedAt:p}),d.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,n=e.graphData,l=e.axis1,o=e.grid,s=e.lastUpdatedAt,r=this.props,u=r.instance,m=r.buildingName,h=r.device,d=r.equipment;return a.createElement("div",{className:"row col-md-12 device-graphs",id:"divGraphs"},a.createElement("br",null),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-8 sentence-break",onClick:function(){window.location.hash=u+"/"+m+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(c.g)(h.moncondevice)}},d.length>0&&d[0].rdfsLabel?d[0].rdfsLabel:"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Space: ",Object(c.g)(h.spaceRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)(h.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)(h.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Equipment: ",null===d||void 0===d?void 0:d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)(h.rdfsLabel)||"No device assigned"," ")),a.createElement("span",{className:"lastUpdated"},"Last: ",s)),t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:n,size:{height:300},axis:l,grid:o,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}}))},t}(a.Component);t.a=p},2970:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(715),s=n(802),r=n(124),u=n(760),c=(n.n(u),n(11)),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",graphEquipment:Object()},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return h(this,void 0,void 0,function(){var e=this;return d(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return h(this,void 0,void 0,function(){var e,t=this;return d(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(c.g)(e)&&Object(r.g)(Object(c.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(){},t.prototype.callLiveUpdate=function(e){var t,n=this.state,a=n.graphData,l=n.axis1,i=n.grid;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var o=this.props.liveGraphRange;if(a.columns.length>1&&t){a.columns[0].splice(1,1),a.columns[0].push(t),a.columns[1].splice(1,1),a.columns[1].push(null===e||void 0===e?void 0:e.Normal_Frequency),a.columns[2].splice(1,1),a.columns[2].push(null===e||void 0===e?void 0:e.Emergency_Frequency),(t.getTime()-a.columns[0][2].getTime())/6e4>o&&a.columns[0].splice(1,1),l.x.tick.values[2]&&l.x.tick.values[1].getTime()&&l.x.tick.values[2].getTime()-l.x.tick.values[1].getTime()<t.getTime()-l.x.tick.values[l.x.tick.values.length-1]&&(l.x.tick.values.splice(0,1),i.x.lines.splice(0,1),t.setSeconds(0),o>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),l.x.tick.values.push(t),i.x.lines.push({value:t,class:"grid4"}));var s=null===t||void 0===t?void 0:t.toLocaleString();this.setState({grid:i,axis1:l,graphData:a,lastUpdatedAt:s})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(c.g)(e.sensedValue)==a});!i||!Object(c.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(c.g)(i.relatedEquipment)})||l.push({value:Object(c.g)(i.relatedEquipment),label:Object(c.g)(i.relatedEquipmentLabel),space:Object(c.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return h(this,void 0,void 0,function(){var t,n,a,l,i,u,m,h,p,g,f,v,x,w,E,b,V,y;return d(this,function(d){switch(d.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=this.state,u=i.grid,m=i.axis1,h=i.graphData,p=i.lastUpdatedAt,n&&n.moncondevice?(g=Object(c.g)(n.topic),[4,Object(o.j)(g,a,l,h.columns.length>1)]):[3,2];case 1:f=d.sent(),x=["Emergency Freq"],w=["x"],(v=["Normal Freq"]).push(null),x.push(null),w.push(new Date(a)),f.length>0&&f.forEach(function(e){e&&(v.push(e.Normal_Frequency),x.push(e.Emergency_Frequency),w.push(new Date(e.timestamp)))}),p=f.length>0?null===(e=w[w.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",v.push(null),x.push(null),w.push(new Date(l)),h={x:"x",xFormat:"%Y-%m-%dT%H:%M:%S.%LZ",columns:[w,v,x]},m.y.label="Hz",(E=[]).push(this.fetchEquipmentFromPoints("ATS graph",["Normal_Frequency","Emergency_Frequency"])),b=Object(s.a)(5,a,l),V="",b.length>1?(y=((new Date).getTime()-b[0].getTime())/1e3,V=(y/=3600)>24?"%m-%d %H:%M":y<.3?"%H:%M:%S":"%H:%M"):V="%H:%M:%S",u.x.lines=[],b.forEach(function(e){u.x.lines.push({value:e,class:"grid4"})}),m.y.tick.format=function(e){return parseFloat(e).toFixed(2)},m.y.tick.values=[0,20,40,60,80],m.y.max=80,m.y.min=0,m.x.tick.format=V,m.x.tick.values=b,this.props.loadNextInsight(),Object(r.h)(g,this.callLiveUpdate),this.setState({grid:u,axis1:m,graphData:h,loading:!1,lastUpdatedAt:p,graphEquipment:E}),d.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,n=e.graphData,l=e.axis1,o=e.grid,s=e.lastUpdatedAt,r=e.graphEquipment,u=this.props,m=u.instance,h=u.buildingName,d=u.device,p=u.equipment;return a.createElement(a.Fragment,null,a.createElement("div",{className:"row col-md-12 device-graphs",id:"divGraphs"},a.createElement("br",null),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard"},a.createElement("a",{className:"col-md-5 sentence-break",onClick:function(){window.location.hash=m+"/"+h+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(c.g)(d.moncondevice)}},r&&r.length&&r.find(function(e){return"ATS graph"==e.graph})&&r.find(function(e){return"ATS graph"==e.graph}).pointEquip.length?r.find(function(e){return"ATS graph"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"Space: ",Object(c.g)(d.spaceRdfsLabel)),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",r&&r.length&&r.find(function(e){return"ATS graph"==e.graph})&&r.find(function(e){return"ATS graph"==e.graph}).pointEquip.length?r.find(function(e){return"ATS graph"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",r&&r.length&&r.find(function(e){return"ATS graph"==e.graph})&&r.find(function(e){return"ATS graph"==e.graph}).pointEquip.length?r.find(function(e){return"ATS graph"==e.graph}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(c.g)(d.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(c.g)(d.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===p||void 0===p?void 0:p.map(function(e,t){return e.rdfsLabel+(t<p.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(c.g)(d.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(c.g)(d.spaceRdfsLabel)," ")),a.createElement("span",{className:"lastUpdated"},"Last: ",s)),t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:n,size:{height:300},axis:l,grid:o,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})))},t}(a.Component);t.a=p},2971:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(715),s=n(802),r=n(11),u=n(875),c=n(803),m=n(122),h=n(736),d=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},graphData5:{x:"x",columns:[]},graphData6:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis5:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis6:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,indicateAlarm5:!1,indicateAlarm6:!1,alarmSensedPoints:[],graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},graphDataAlarmPoint5:{},graphDataAlarmPoint6:{},selectedAlarmPoint1:u.a,selectedAlarmPoint2:u.a,selectedAlarmPoint3:u.a,selectedAlarmPoint4:u.a,selectedAlarmPoint5:u.a,selectedAlarmPoint6:u.a,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(r.g)(e)&&Object(d.g)(Object(r.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,o,s,u,d,p,g,f,x,w,E,b,V=this;return v(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,o=t.selectedAlarmPoint4,s=t.selectedAlarmPoint5,u=t.selectedAlarmPoint6,d=this.props,p=d.buildingName,g=d.devicePoints,f=d.showAlarmPoints,x=d.device,Object(m.a)(!0),f&&!e?[3,2]:(w=[],g&&g.length&&g.forEach(function(e){w.push({sensedValue:Object(r.g)(e.sensedValue),maximumExtremeValue:Object(r.g)(e.maximumExtremeValue),maximumNormalValue:Object(r.g)(e.maximumNormalValue),minimumExtremeValue:Object(r.g)(e.minimumExtremeValue),minimumNormalValue:Object(r.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(r.g)(e.ifMaximumExtremeValue)||"true"!=Object(r.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(r.g)(e.ifMaximumNormalValue)||"true"!=Object(r.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(r.g)(e.ifMinimumExtremeValue)||"true"!=Object(r.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(r.g)(e.ifMinimumNormalValue)||"true"!=Object(r.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(h.a.OperationalAlarm,p,!1,0,50,null,null,[Object(r.g)(x.moncondevice)],null)]);case 1:return E=v.sent(),b=new Date(n.columns[0][1]),E=E.filter(function(e){return new Date(e.timeofalarm)>b}),this.setState({alarmSensedPoints:w,deviceAlarms:E},function(){if((null===w||void 0===w?void 0:w.length)>0&&n.columns.length>1){var e=w.filter(function(e){return"GenVAB_Volts"==e.sensedValue||"GenVBC_Volts"==e.sensedValue||"GenVCA_Volts"==e.sensedValue||"GenVAN_Volts"==e.sensedValue||"GenVBN_Volts"==e.sensedValue||"GenVCN_Volts"==e.sensedValue||" BusVoltage_Volts"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";V.selectAlarmPoint1(t);var r=w.filter(function(e){return"GenIA_Amps"==e.sensedValue||"GenIB_Amps"==e.sensedValue||"GenIC_Amps"==e.sensedValue}),c=l.sensedValue.length>1?l.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";V.selectAlarmPoint2(c);var m=w.filter(function(e){return"GenKVA_A_KiloVA"==e.sensedValue||"GenKVA__B_KiloVA"==e.sensedValue||"GenKVA_C_KiloVA"==e.sensedValue||"GenKVA_Total_KiloVA"==e.sensedValue||"Gen_A_kW"==e.sensedValue||"Gen_B_kW"==e.sensedValue||"Gen_C_kW"==e.sensedValue||"Gen_Total_kW"==e.sensedValue}),h=i.sensedValue.length>1?i.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";V.selectAlarmPoint3(h);var d=w.filter(function(e){return"GenPFLagging"==e.sensedValue}),p=o.sensedValue.length>1?o.sensedValue:(null===d||void 0===d?void 0:d.length)>0?d[d.length-1].sensedValue:"";V.selectAlarmPoint4(p);var g=w.filter(function(e){return"ActiveSpeedSource"==e.sensedValue||"EngineSpeed_rpm"==e.sensedValue||"EngineLoad_pct"==e.sensedValue||"CoolantTemp_F"==e.sensedValue||"OilPressure_psi"==e.sensedValue||"BatteryVoltage_DeciVolt"==e.sensedValue||"FuelLevel"==e.sensedValue||"ECUCoolantLevel"==e.sensedValue||"CoolDownTimeRemaining_mins"==e.sensedValue}),f=s.sensedValue.length>1?s.sensedValue:(null===g||void 0===g?void 0:g.length)>0?g[g.length-1].sensedValue:"";V.selectAlarmPoint5(f);var v=w.filter(function(e){return"UnexpectedShutdown"==e.sensedValue||"GlobalAlarm"==e.sensedValue||"AutoRestartFailure"==e.sensedValue||"FuelLeakDetect"==e.sensedValue||"BatteryChargerFailure"==e.sensedValue||"TransferFail"==e.sensedValue||"LowCoolantLevel"==e.sensedValue||"ECUShutdown"==e.sensedValue||"EmergencyShutdown"==e.sensedValue||"Overcrank"==e.sensedValue||"LossofECUComms"==e.sensedValue||"GlobalSenderFail"==e.sensedValue||"LowFuelLevel"==e.sensedValue||"LowOilPressure"==e.sensedValue||"HighCoolantTemp"==e.sensedValue}),x=u.sensedValue.length>1?u.sensedValue:(null===v||void 0===v?void 0:v.length)>0?v[v.length-1].sensedValue:"";V.selectAlarmPoint6(x)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),this.selectAlarmPoint5(""),this.selectAlarmPoint6(""),v.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenVAB_Volts"==e.sensedValueKey||"GenVBC_Volts"==e.sensedValueKey||"GenVCA_Volts"==e.sensedValueKey||"GenVAN_Volts"==e.sensedValueKey||"GenVBN_Volts"==e.sensedValueKey||"GenVCN_Volts"==e.sensedValueKey||" BusVoltage_Volts"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("GenVAB_Volts"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VAB:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVBC_Volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VBC:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVCA_Volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VCA:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVAN_Volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VA:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVBN_Volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VB:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVCN_Volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VC:"#e3e3e3",High:"grey","High-High":"red"}}}else if("BusVoltage_Volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Bus Voltage":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint1:o,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:u.a,indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenIA_Amps"==e.sensedValueKey||"GenIB_Amps"==e.sensedValueKey||"GenIC_Amps"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("GenIA_Amps"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen IA":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenIB_Amps"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen IB":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenIC_Amps"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen IC":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint2:o,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:u.a,indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenKVA_A_KiloVA"==e.sensedValueKey||"GenKVA__B_KiloVA"==e.sensedValueKey||"GenKVA_C_KiloVA"==e.sensedValueKey||"GenKVA_Total_KiloVA"==e.sensedValueKey||"Gen_A_kW"==e.sensedValueKey||"Gen_B_kW"==e.sensedValueKey||"Gen_C_kW"==e.sensedValueKey||"Gen_Total_kW"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("GenKVA_A_KiloVA"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenKVA__B_KiloVA"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenKVA_C_KiloVA"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenKVA_Total_KiloVA"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA Tota":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_A_kW"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_B_kW"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_C_kW"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_Total_kW"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltC"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[8].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW Total":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint3:o,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:u.a,indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenPFLagging"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("GenPFLagging"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen Power Factor":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint4:o,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:u.a,indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.selectAlarmPoint5=function(e){var t=this,n=this.state,a=n.graphData5,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"ActiveSpeedSource"==e.sensedValueKey||"EngineSpeed_rpm"==e.sensedValueKey||"EngineLoad_pct"==e.sensedValueKey||"CoolantTemp_F"==e.sensedValueKey||"OilPressure_psi"==e.sensedValueKey||"BatteryVoltage_DeciVolt"==e.sensedValueKey||"FuelLevel"==e.sensedValueKey||"ECUCoolantLevel"==e.sensedValueKey||"CoolDownTimeRemaining_mins"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("ActiveSpeedSource"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Act speed":"#e3e3e3",High:"grey","High-High":"red"}}}else if("EngineSpeed_rpm"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Engine Speed":"#e3e3e3",High:"grey","High-High":"red"}}}else if("EngineLoad_pct"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Engine Load":"#e3e3e3",High:"grey","High-High":"red"}}}else if("CoolantTemp_F"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Coolant Temp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("OilPressure_psi"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Oil Press":"#e3e3e3",High:"grey","High-High":"red"}}}else if("BatteryVoltage_DeciVolt"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Battery Volt":"#e3e3e3",High:"grey","High-High":"red"}}}else if("FuelLevel"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Fuel Level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("ECUCoolantLevel"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[8].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","ECU Coolant level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("CoolDownTimeRemaining_mins"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[9].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[9],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Cool Down Time Rem.":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint5:o,graphDataAlarmPoint5:e,indicateAlarm5:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint5:u.a,indicateAlarm5:s,graphDataAlarmPoint5:e,loading:!1})})},t.prototype.selectAlarmPoint6=function(e){var t=this,n=this.state,a=n.graphData6,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"UnexpectedShutdown"==e.sensedValueKey||"GlobalAlarm"==e.sensedValueKey||"AutoRestartFailure"==e.sensedValueKey||"FuelLeakDetect"==e.sensedValueKey||"BatteryChargerFailure"==e.sensedValueKey||"TransferFail"==e.sensedValueKey||"LowCoolantLevel"==e.sensedValueKey||"ECUShutdown"==e.sensedValueKey||"EmergencyShutdown"==e.sensedValueKey||"Overcrank"==e.sensedValueKey||"LossofECUComms"==e.sensedValueKey||"GlobalSenderFail"==e.sensedValueKey||"LowFuelLevel"==e.sensedValueKey||"LowOilPressure"==e.sensedValueKey||"HighCoolantTemp"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("UnexpectedShutdown"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Unexp. Shutdown":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GlobalAlarm"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Global Alarm":"#e3e3e3",High:"grey","High-High":"red"}}}else if("AutoRestartFailure"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Auto Restart Fail":"#e3e3e3",High:"grey","High-High":"red"}}}else if("FuelLeakDetect"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Fuel Leak Det.":"#e3e3e3",High:"grey","High-High":"red"}}}else if("BatteryChargerFailure"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Battery Chg. Fail":"#e3e3e3",High:"grey","High-High":"red"}}}else if("TransferFail"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Transfer Fai":"#e3e3e3",High:"grey","High-High":"red"}}}else if("LowCoolantLevel"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Low Coolant level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("ECUShutdown"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[8].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","ECU Shutdown":"#e3e3e3",High:"grey","High-High":"red"}}}else if("EmergencyShutdown"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[9].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[9],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Emerg. Shut":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Overcrank"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[10].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[10],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Overcrank:"#e3e3e3",High:"grey","High-High":"red"}}}else if("LossofECUComms"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[11].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[11],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Loss of ECU Comms":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GlobalSenderFail"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[12].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[12],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Global Sender Fail":"#e3e3e3",High:"grey","High-High":"red"}}}else if("LowFuelLevel"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[13].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[13],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Low Fuel Level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("LowOilPressure"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[14].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[14],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Low Oil Press":"#e3e3e3",High:"grey","High-High":"red"}}}else if("HighCoolantTemp"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[15].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[15],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","High Coolant":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint6:o,graphDataAlarmPoint6:e,indicateAlarm6:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint6:u.a,indicateAlarm6:s,graphDataAlarmPoint6:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,o=a.graphData3,s=a.graphData4,r=a.graphData5,u=a.graphData6,c=a.axis1,m=a.grid,h=a.alarmSensedPoints,d=a.selectedAlarmPoint1,p=a.selectedAlarmPoint2,g=a.selectedAlarmPoint3,f=a.selectedAlarmPoint4,v=a.selectedAlarmPoint5,x=a.selectedAlarmPoint6,w=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var E=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.GenVAB_Volts),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.GenVBC_Volts),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.GenVCA_Volts),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.GenVAN_Volts),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.GenVBN_Volts),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.GenVCN_Volts),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.BusVoltage_Volts),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.GenIA_Amps),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.GenIB_Amps),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.GenIC_Amps),o.columns[1].splice(1,1),o.columns[1].push(null===e||void 0===e?void 0:e.GenKVA_A_KiloVA),o.columns[2].splice(1,1),o.columns[2].push(null===e||void 0===e?void 0:e.GenKVA__B_KiloVA),o.columns[3].splice(1,1),o.columns[3].push(null===e||void 0===e?void 0:e.GenKVA_C_KiloVA),o.columns[4].splice(1,1),o.columns[4].push(null===e||void 0===e?void 0:e.GenKVA_Total_KiloVA),o.columns[5].splice(1,1),o.columns[5].push(null===e||void 0===e?void 0:e.Gen_A_kW),o.columns[6].splice(1,1),o.columns[6].push(null===e||void 0===e?void 0:e.Gen_B_kW),o.columns[7].splice(1,1),o.columns[7].push(null===e||void 0===e?void 0:e.Gen_C_kW),o.columns[8].splice(1,1),o.columns[8].push(null===e||void 0===e?void 0:e.Gen_Total_kW),s.columns[1].splice(1,1),s.columns[1].push(null===e||void 0===e?void 0:e.GenPFLagging),r.columns[1].splice(1,1),r.columns[1].push(null===e||void 0===e?void 0:e.ActiveSpeedSource),r.columns[2].splice(1,1),r.columns[2].push(null===e||void 0===e?void 0:e.EngineSpeed_rpm),r.columns[3].splice(1,1),r.columns[3].push(null===e||void 0===e?void 0:e.EngineLoad_pct),r.columns[4].splice(1,1),r.columns[4].push(null===e||void 0===e?void 0:e.CoolantTemp_F),r.columns[5].splice(1,1),r.columns[5].push(null===e||void 0===e?void 0:e.OilPressure_psi),r.columns[6].splice(1,1),r.columns[6].push(null===e||void 0===e?void 0:e.BatteryVoltage_DeciVolt),r.columns[7].splice(1,1),r.columns[7].push(null===e||void 0===e?void 0:e.FuelLevel),r.columns[8].splice(1,1),r.columns[8].push(null===e||void 0===e?void 0:e.ECUCoolantLevel),r.columns[9].splice(1,1),r.columns[9].push(null===e||void 0===e?void 0:e.CoolDownTimeRemaining_mins),u.columns[1].splice(1,1),u.columns[1].push(null===e||void 0===e?void 0:e.UnexpectedShutdown),u.columns[2].splice(1,1),u.columns[2].push(null===e||void 0===e?void 0:e.GlobalAlarm),u.columns[3].splice(1,1),u.columns[3].push(null===e||void 0===e?void 0:e.AutoRestartFailure),u.columns[4].splice(1,1),u.columns[4].push(null===e||void 0===e?void 0:e.FuelLeakDetect),u.columns[5].splice(1,1),u.columns[5].push(null===e||void 0===e?void 0:e.BatteryChargerFailure),u.columns[6].splice(1,1),u.columns[6].push(null===e||void 0===e?void 0:e.TransferFail),u.columns[7].splice(1,1),u.columns[7].push(null===e||void 0===e?void 0:e.LowCoolantLevel),u.columns[8].splice(1,1),u.columns[8].push(null===e||void 0===e?void 0:e.ECUShutdown),u.columns[9].splice(1,1),u.columns[9].push(null===e||void 0===e?void 0:e.EmergencyShutdown),u.columns[10].splice(1,1),u.columns[10].push(null===e||void 0===e?void 0:e.Overcrank),u.columns[11].splice(1,1),u.columns[11].push(null===e||void 0===e?void 0:e.LossofECUComms),u.columns[12].splice(1,1),u.columns[12].push(null===e||void 0===e?void 0:e.GlobalSenderFail),u.columns[13].splice(1,1),u.columns[13].push(null===e||void 0===e?void 0:e.LowFuelLevel),u.columns[14].splice(1,1),u.columns[14].push(null===e||void 0===e?void 0:e.LowOilPressure),u.columns[15].splice(1,1),u.columns[15].push(null===e||void 0===e?void 0:e.HighCoolantTemp),(t.getTime()-l.columns[0][2].getTime())/6e4>E&&l.columns[0].splice(1,1),c.x.tick.values[2]&&c.x.tick.values[1].getTime()&&c.x.tick.values[2].getTime()-c.x.tick.values[1].getTime()<t.getTime()-c.x.tick.values[c.x.tick.values.length-1]&&(c.x.tick.values.splice(0,1),m.x.lines.splice(0,1),t.setSeconds(0),E>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),c.x.tick.values.push(t),m.x.lines.push({value:t,class:"grid4"}));var b=null===t||void 0===t?void 0:t.toLocaleString();w?this.setState({grid:m,axis1:c,graphData:l,graphData2:i,graphData3:o,graphData4:s,graphData5:r,graphData6:u,lastUpdatedAt:b},function(){var e=h.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=d.sensedValue.length>1?d.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=h.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=p.sensedValue.length>1?p.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=h.filter(function(e){return"illuminance_lux"==e.sensedValue}),o=g.sensedValue.length>1?g.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(o);var s=h.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}),r=f.sensedValue.length>1?f.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(r);var u=h.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}),c=v.sensedValue.length>1?v.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";n.selectAlarmPoint5(c);var m=h.filter(function(e){return"motion_sensed"==e.sensedValue||"num_BTdev"==e.sensedValue}),w=x.sensedValue.length>1?x.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";n.selectAlarmPoint6(w)}):this.setState({grid:m,axis1:c,graphData:l,graphData2:i,graphData3:o,graphData4:s,graphData5:r,graphData6:u,lastUpdatedAt:b})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(r.g)(e.sensedValue)==a});!i||!Object(r.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(r.g)(i.relatedEquipment)})||l.push({value:Object(r.g)(i.relatedEquipment),label:Object(r.g)(i.relatedEquipmentLabel),space:Object(r.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,u,c,m,h,p,g,f,x,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R,M,C,G,T,I,U,B,K,W,z,Z,Y,$,J,Q,X,ee,te,ne,ae,le,ie,oe,se,re,ue,ce,me,he,de,pe,ge,fe,ve,xe,we,Ee,be,Ve,ye=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,c=this.state,m=c.grid,h=c.axis1,p=c.axis2,g=c.axis3,f=c.axis4,x=c.axis5,w=c.axis6,E=c.graphData,b=c.graphData2,V=c.graphData3,y=c.graphData4,L=c.graphData5,H=c.graphData6,A=c.lastUpdatedAt,n&&n.moncondevice?(N=Object(r.g)(n.topic),[4,Object(o.m)(N,a,l,E.columns.length>1)]):[3,2];case 1:D=v.sent(),_=["VBC"],O=["VCA"],S=["VA"],j=["VB"],k=["VC"],q=["Bus Voltage"],F=["Gen IA"],R=["Gen IB"],M=["Gen IC"],C=["Gen kVA A"],G=["Gen kVA B"],T=["Gen kVA C"],I=["Gen kVA Total"],U=["Gen kW A"],B=["Gen kW B"],K=["Gen kW C"],W=["Gen kW Total"],z=["Gen Power Factor"],Z=["Act speed"],Y=["Engine Speed"],$=["Engine Load"],J=["Coolant Temp"],Q=["Oil Press"],X=["Battery Volt"],ee=["Fuel Level"],te=["ECU Coolant level"],ne=["Cool Down Time Rem."],ae=["Unexp. Shutdown"],le=["Global Alarm"],ie=["Auto Restart Fail"],oe=["Fuel Leak Det."],se=["Battery Chg. Fail"],re=["Transfer Fail"],ue=["Low Coolant level"],ce=["ECU Shutdown"],me=["Emerg. Shut"],he=["Overcrank"],de=["Loss of ECU Comms"],pe=["Global Sender Fail"],ge=["Low Fuel Level"],fe=["Low Oil Press"],ve=["High Coolant"],xe=["x"],(P=["VAB"]).push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(null),G.push(null),T.push(null),I.push(null),U.push(null),B.push(null),K.push(null),W.push(null),z.push(null),Z.push(null),Y.push(null),$.push(null),J.push(null),Q.push(null),X.push(null),ee.push(null),te.push(null),ne.push(null),ae.push(null),le.push(null),ie.push(null),oe.push(null),se.push(null),re.push(null),ue.push(null),ce.push(null),me.push(null),he.push(null),de.push(null),pe.push(null),ge.push(null),fe.push(null),ve.push(null),xe.push(new Date(a)),D.length>0&&D.forEach(function(e){e&&(P.push(e.GenVAB_Volts),_.push(e.GenVBC_Volts),O.push(e.GenVCA_Volts),S.push(e.GenVAN_Volts),j.push(e.GenVBN_Volts),k.push(e.GenVCN_Volts),q.push(e.BusVoltage_Volts),F.push(e.GenIA_Amps),R.push(e.GenIB_Amps),M.push(e.GenIC_Amps),C.push(e.GenKVA_A_KiloVA),G.push(e.GenKVA__B_KiloVA),T.push(e.GenKVA_C_KiloVA),I.push(e.GenKVA_Total_KiloVA),U.push(e.Gen_A_kW),B.push(e.Gen_B_kW),K.push(e.Gen_C_kW),W.push(e.Gen_Total_kW),z.push(e.GenPFLagging),Z.push(e.ActiveSpeedSource),Y.push(e.EngineSpeed_rpm),$.push(e.EngineLoad_pct),J.push(e.CoolantTemp_F),Q.push(e.OilPressure_psi),X.push(e.BatteryVoltage_DeciVolt),ee.push(e.FuelLevel),te.push(e.ECUCoolantLevel),ne.push(e.CoolDownTimeRemaining_mins),ae.push(e.UnexpectedShutdown),le.push(e.GlobalAlarm),ie.push(e.AutoRestartFailure),oe.push(e.FuelLeakDetect),se.push(e.BatteryChargerFailure),re.push(e.TransferFail),ue.push(e.LowCoolantLevel),ce.push(e.ECUShutdown),me.push(e.EmergencyShutdown),he.push(e.Overcrank),de.push(e.LossofECUComms),pe.push(e.GlobalSenderFail),ge.push(e.LowFuelLevel),fe.push(e.LowOilPressure),ve.push(e.HighCoolantTemp),xe.push(new Date(e.timestamp)))}),A=D.length>0?null===(e=xe[xe.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(null),G.push(null),T.push(null),I.push(null),U.push(null),B.push(null),K.push(null),W.push(null),z.push(null),Z.push(null),Y.push(null),$.push(null),J.push(null),Q.push(null),X.push(null),ee.push(null),te.push(null),ne.push(null),ae.push(null),le.push(null),ie.push(null),oe.push(null),se.push(null),re.push(null),ue.push(null),ce.push(null),me.push(null),he.push(null),de.push(null),pe.push(null),ge.push(null),fe.push(null),ve.push(null),xe.push(new Date(l)),we=[],u&&u.length&&(we.push(this.fetchEquipmentFromPoints(u[0]||"Voltages",["GenVAB_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts"])),we.push(this.fetchEquipmentFromPoints(u[1]||"Currents",["GenIA_Amps","GenIB_Amps","GenIC_Amps"])),we.push(this.fetchEquipmentFromPoints(u[2]||"Powers",["GenKVA_A_KiloVA","GenKVA__B_KiloVA","GenKVA_C_KiloVA","GenKVA_Total_KiloVA","Gen_A_kW","Gen_B_kW","Gen_C_kW"])),we.push(this.fetchEquipmentFromPoints(u[3]||"Power Factor",["GenPFLagging"])),we.push(this.fetchEquipmentFromPoints(u[4]||"Other Parameters",["ActiveSpeedSource","EngineSpeed_rpm","EngineLoad_pct","CoolantTemp_F","OilPressure_psi","BatteryVoltage_DeciVolt","FuelLevel","ECUCoolantLevel","CoolDownTimeRemaining_mins"])),we.push(this.fetchEquipmentFromPoints(u[5]||"Binary Parameters",["UnexpectedShutdown","GlobalAlarm","AutoRestartFailure","FuelLeakDetect","BatteryChargerFailure","TransferFail","LowCoolantLevel","ECUShutdown","EmergencyShutdown","Overcrank","LossofECUComms","GlobalSenderFail","LowFuelLevel","LowOilPressure","HighCoolantTemp"]))),E={x:"x",columns:[xe,P,_,O,S,j,k,q]},b={x:"x",columns:[xe,F,R,M]},V={x:"x",columns:[xe,C,G,T,I,U,B,K,W]},y={x:"x",columns:[xe,z]},L={x:"x",columns:[xe,Z,Y,$,J,Q,X,ee,te,ne]},H={x:"x",columns:[xe,ae,le,ie,oe,se,re,ue,ce,me,he,de,pe,ge,fe,ve]},h.y.label="Volts",p.y.label="Amps",g.y.label="Watts",f.y.label="",x.y.label="",w.y.label="",xe.length>1&&(Ee=Object(s.a)(5,a,l),be="",Ee.length>1?(Ve=((new Date).getTime()-Ee[0].getTime())/1e3,be=(Ve/=3600)>24?"%m-%d %H:%M":Ve<.3?"%H:%M:%S":"%H:%M"):be="%H:%M:%S",m.x.lines=[],Ee.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(0)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(1)},f.y.tick.format=function(e){return parseFloat(e).toFixed(0)},x.y.tick.format=function(e){return parseFloat(e).toFixed(0)},w.y.tick.format=function(e){return parseFloat(e).toFixed(0)},h.y.tick.values=[0,50,100,150,200,250],p.y.tick.values=[0,10,20,30,40,50],g.y.tick.values=[0,20,40,60,80,100],f.y.tick.values=[-1,0,1],x.y.tick.values=[0,40,80,120,160,160],w.y.tick.values=[-1,0,1],h.y.max=250,h.y.min=0,p.y.max=50,p.y.min=0,g.y.max=100,g.y.min=0,f.y.max=1,f.y.min=-1,x.y.max=160,x.y.min=0,w.y.max=1,w.y.min=-1,h.x.tick.format=be,p.x.tick.format=be,g.x.tick.format=be,f.x.tick.format=be,x.x.tick.format=be,w.x.tick.format=be,h.x.tick.values=Ee,p.x.tick.values=Ee,g.x.tick.values=Ee,f.x.tick.values=Ee,x.x.tick.values=Ee,w.x.tick.values=Ee,this.props.loadNextInsight(),Object(d.h)(N,this.callLiveUpdate),this.setState({grid:m,axis1:h,axis2:p,axis3:g,axis4:f,axis5:x,axis6:w,graphData:E,graphData2:b,graphData3:V,graphData4:y,graphData5:L,graphData6:H,lastUpdatedAt:A,loading:!1,graphEquipment:we},function(){i&&ye.changeAlarmStatus(!0)})),v.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.loading,l=t.graphData,o=t.graphData2,s=t.graphData3,u=t.graphData4,c=t.graphData5,m=t.graphData6,h=t.axis1,d=t.axis2,p=t.axis3,g=t.axis4,f=t.axis5,v=t.axis6,x=t.grid,w=t.lastUpdatedAt,E=t.indicateAlarm1,b=t.indicateAlarm2,V=t.indicateAlarm3,y=t.indicateAlarm4,L=t.indicateAlarm5,H=t.indicateAlarm6,A=t.alarmSensedPoints,N=t.selectedAlarmPoint1,D=t.selectedAlarmPoint2,P=t.selectedAlarmPoint3,_=t.selectedAlarmPoint4,O=t.selectedAlarmPoint5,S=t.selectedAlarmPoint6,j=t.graphEquipment,k=this.props,q=k.graphsList,F=k.instance,R=k.buildingName,M=k.device,C=k.showAlarmPoints,G=k.equipment,T=q&&q.length&&q[0]?q[0]:"Voltages",I=q&&q.length&&q[1]?q[1]:"Currents",U=q&&q.length&&q[2]?q[1]:"Powers",B=q&&q.length&&q[3]?q[1]:"Power Factor",K=q&&q.length&&q[4]?q[1]:"Other Parameters",W=q&&q.length&&q[5]?q[1]:"Binary Parameters";return a.createElement(a.Fragment,null,q.indexOf("Voltages")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(E&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:N.sensedValue,onChange:function(t){e.selectAlarmPoint1(t.target.value)}},A.filter(function(e){return"GenVAB_Volts"==e.sensedValue||"GenVBC_Volts"==e.sensedValue||"GenVCA_Volts"==e.sensedValue||"GenVAN_Volts"==e.sensedValue||"GenVBN_Volts"==e.sensedValue||"GenVCN_Volts"==e.sensedValue||"BusVoltage_Volts"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),E&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==T})&&j.find(function(e){return e.graph==T}).pointEquip.length?j.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Voltages"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==T})&&j.find(function(e){return e.graph==T}).pointEquip.length?j.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==T})&&j.find(function(e){return e.graph==T}).pointEquip.length?j.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:l,size:{height:300},axis:h,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),q.indexOf("Currents")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(b&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:D.sensedValue,onChange:function(t){e.selectAlarmPoint2(t.target.value)}},A.filter(function(e){return"GenIA_Amps"==e.sensedValue||"GenIB_Amps"==e.sensedValue||"GenIC_Amps"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),b&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==I})&&j.find(function(e){return e.graph==I}).pointEquip.length?j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Currents"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==I})&&j.find(function(e){return e.graph==I}).pointEquip.length?j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==I})&&j.find(function(e){return e.graph==I}).pointEquip.length?j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:o,size:{height:300},axis:d,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Powers")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(V&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:P.sensedValue,onChange:function(t){e.selectAlarmPoint3(t.target.value)}},A.filter(function(e){return"GenKVA_A_KiloVA"==e.sensedValue||"GenKVA__B_KiloVA"==e.sensedValue||"GenKVA_C_KiloVA"==e.sensedValue||"GenKVA_Total_KiloVA"==e.sensedValue||"Gen_A_kW"==e.sensedValue||"Gen_B_kW"==e.sensedValue||"Gen_C_kW"==e.sensedValue||"Gen_Total_kW"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),V&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==U})&&j.find(function(e){return e.graph==U}).pointEquip.length?j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Powers"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==U})&&j.find(function(e){return e.graph==U}).pointEquip.length?j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==U})&&j.find(function(e){return e.graph==U}).pointEquip.length?j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:s,size:{height:300},axis:p,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Power Factor")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(y&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:_.sensedValue,onChange:function(t){e.selectAlarmPoint4(t.target.value)}},A.filter(function(e){return"GenPFLagging"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),y&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==B})&&j.find(function(e){return e.graph==B}).pointEquip.length?j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Power Factor"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==B})&&j.find(function(e){return e.graph==B}).pointEquip.length?j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==B})&&j.find(function(e){return e.graph==B}).pointEquip.length?j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:u,size:{height:300},axis:g,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Other Parameters")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(L&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:O.sensedValue,onChange:function(t){e.selectAlarmPoint5(t.target.value)}},A.filter(function(e){return"ActiveSpeedSource"==e.sensedValue||"EngineSpeed_rpm"==e.sensedValue||"EngineLoad_pct"==e.sensedValue||"CoolantTemp_F"==e.sensedValue||"OilPressure_psi"==e.sensedValue||"BatteryVoltage_DeciVolt"==e.sensedValue||"FuelLevel"==e.sensedValue||"ECUCoolantLevel"==e.sensedValue||"CoolDownTimeRemaining_mins"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),L&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==K})&&j.find(function(e){return e.graph==K}).pointEquip.length?j.find(function(e){return e.graph==K}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Other Parameters"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==K})&&j.find(function(e){return e.graph==K}).pointEquip.length?j.find(function(e){return e.graph==K}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==K})&&j.find(function(e){return e.graph==K}).pointEquip.length?j.find(function(e){return e.graph==K}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:c,size:{height:300},axis:f,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Binary Parameters")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(H&&C?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),C&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:S.sensedValue,onChange:function(t){e.selectAlarmPoint6(t.target.value)}},A.filter(function(e){return"UnexpectedShutdown"==e.sensedValue||"GlobalAlarm"==e.sensedValue||"AutoRestartFailure"==e.sensedValue||"FuelLeakDetect"==e.sensedValue||"BatteryChargerFailure"==e.sensedValue||"TransferFail"==e.sensedValue||"LowCoolantLevel"==e.sensedValue||"ECUShutdown"==e.sensedValue||"EmergencyShutdown"==e.sensedValue||"Overcrank"==e.sensedValue||"LossofECUComms"==e.sensedValue||"GlobalSenderFail"==e.sensedValue||"LowFuelLevel"==e.sensedValue||"LowOilPressure"==e.sensedValue||"HighCoolantTemp"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),H&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(r.g)(M.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==W})&&j.find(function(e){return e.graph==W}).pointEquip.length?j.find(function(e){return e.graph==W}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Binary Parameters"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==W})&&j.find(function(e){return e.graph==W}).pointEquip.length?j.find(function(e){return e.graph==W}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==W})&&j.find(function(e){return e.graph==W}).pointEquip.length?j.find(function(e){return e.graph==W}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(M.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(M.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===G||void 0===G?void 0:G.map(function(e,t){return e.rdfsLabel+(t<G.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(M.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(M.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:m,size:{height:300},axis:v,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=x},2972:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(715),s=n(802),r=n(11),u=n(875),c=n(803),m=n(122),h=n(736),d=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],indicateAlarm1:!1,indicateAlarm2:!1,graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},selectedAlarmPoint1:u.a,selectedAlarmPoint2:u.a,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(r.g)(e)&&Object(d.g)(Object(r.g)(e)),[2]})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(r.g)(e.sensedValue)==a});!i||!Object(r.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(r.g)(i.relatedEquipment)})||l.push({value:Object(r.g)(i.relatedEquipment),label:Object(r.g)(i.relatedEquipmentLabel),space:Object(r.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype.changeAlarmStatus=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,o,s,u,d,p,g,f,x=this;return v(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=this.props,o=i.buildingName,s=i.devicePoints,u=i.showAlarmPoints,d=i.device,Object(m.a)(!0),u&&!e?[3,2]:(p=[],s&&s.length&&s.forEach(function(e){p.push({sensedValue:Object(r.g)(e.sensedValue),maximumExtremeValue:Object(r.g)(e.maximumExtremeValue),maximumNormalValue:Object(r.g)(e.maximumNormalValue),minimumExtremeValue:Object(r.g)(e.minimumExtremeValue),minimumNormalValue:Object(r.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(r.g)(e.ifMaximumExtremeValue)||"true"!=Object(r.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(r.g)(e.ifMaximumNormalValue)||"true"!=Object(r.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(r.g)(e.ifMinimumExtremeValue)||"true"!=Object(r.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(r.g)(e.ifMinimumNormalValue)||"true"!=Object(r.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(h.a.OperationalAlarm,o,!1,0,50,null,null,[Object(r.g)(d.moncondevice)],null)]);case 1:return g=v.sent(),f=new Date(n.columns[0][1]),g=g.filter(function(e){return new Date(e.timeofalarm)>f}),this.setState({alarmSensedPoints:p,deviceAlarms:g},function(){if((null===p||void 0===p?void 0:p.length)>0&&n.columns.length>1){var e=p.filter(function(e){return"register1"==e.sensedValue||"t3frontRefrigerator1"==e.sensedValue||"t4backRefrigerator1"==e.sensedValue||"t5evapfanRefrigerator1"==e.sensedValue||"t6comprinRefrigerator1"==e.sensedValue||"t7comproutRefrigerator1"==e.sensedValue||"t8probeRefrigerator1"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";x.selectAlarmPoint1(t);var i=p.filter(function(e){return"register1"==e.sensedValue||"t3frontRefrigerator2"==e.sensedValue||"t4backRefrigerator2"==e.sensedValue||"t5evapfanRefrigerator2"==e.sensedValue||"t6comprinRefrigerator2"==e.sensedValue||"t7comproutRefrigerator2"==e.sensedValue||"t8probeRefrigerator2"==e.sensedValue}),o=l.sensedValue.length>1?l.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";x.selectAlarmPoint2(o)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),v.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"register1"==e.sensedValueKey||"t3frontRefrigerator1"==e.sensedValueKey||"t4backRefrigerator1"==e.sensedValueKey||"t5evapfanRefrigerator1"==e.sensedValueKey||"t6comprinRefrigerator1"==e.sensedValueKey||"t7comproutRefrigerator1"==e.sensedValueKey||"t8probeRefrigerator1"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("register1"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Register:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t3frontRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Front:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t4backRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Back:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t5evapfanRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Evaporator Fan":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t6comprinRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Compressor In":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t7comproutRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Compressor Out":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t8probeRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Solid:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low),t.setState({selectedAlarmPoint1:o,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:u.a,indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"register1"==e.sensedValueKey||"t3frontRefrigerator2"==e.sensedValueKey||"t4backRefrigerator2"==e.sensedValueKey||"t5evapfanRefrigerator2"==e.sensedValueKey||"t6comprinRefrigerator2"==e.sensedValueKey||"t7comproutRefrigerator2"==e.sensedValueKey||"t8probeRefrigerator2"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("register1"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Register:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t3frontRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Front:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t4backRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Back:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t5evapfanRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Evaporator Fan":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t6comprinRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Compressor In":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Compressor Out"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Analog Input 8":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t8probeRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Solid:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low),t.setState({selectedAlarmPoint2:o,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:u.a,indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,o=a.axis1,s=a.grid,r=a.alarmSensedPoints,u=a.selectedAlarmPoint1,c=a.selectedAlarmPoint2,m=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var h=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.register1),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.t3frontRefrigerator1),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.t4backRefrigerator1),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.t5evapfanRefrigerator1),l.columns[5].splice(1,1),l.columns[5].push(null===e||void 0===e?void 0:e.t6comprinRefrigerator1),l.columns[6].splice(1,1),l.columns[6].push(null===e||void 0===e?void 0:e.t7comproutRefrigerator1),l.columns[7].splice(1,1),l.columns[7].push(null===e||void 0===e?void 0:e.t8probeRefrigerator1),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.register1),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.t3frontRefrigerator2),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.t4backRefrigerator2),i.columns[4].splice(1,1),i.columns[4].push(null===e||void 0===e?void 0:e.t5evapfanRefrigerator2),i.columns[5].splice(1,1),i.columns[5].push(null===e||void 0===e?void 0:e.t6comprinRefrigerator2),i.columns[6].splice(1,1),i.columns[6].push(null===e||void 0===e?void 0:e.t7comproutRefrigerator2),i.columns[7].splice(1,1),i.columns[7].push(null===e||void 0===e?void 0:e.t8probeRefrigerator2),(t.getTime()-l.columns[0][2].getTime())/6e4>h&&l.columns[0].splice(1,1),o.x.tick.values[2]&&o.x.tick.values[1].getTime()&&o.x.tick.values[2].getTime()-o.x.tick.values[1].getTime()<t.getTime()-o.x.tick.values[o.x.tick.values.length-1]&&(o.x.tick.values.splice(0,1),s.x.lines.splice(0,1),t.setSeconds(0),h>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),o.x.tick.values.push(t),s.x.lines.push({value:t,class:"grid4"}));var d=null===t||void 0===t?void 0:t.toLocaleString();m?this.setState({grid:s,axis1:o,graphData:l,graphData2:i,lastUpdatedAt:d},function(){var e=r.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=u.sensedValue.length>1?u.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=r.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=c.sensedValue.length>1?c.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l)}):this.setState({grid:s,axis1:o,graphData:l,graphData2:i,lastUpdatedAt:d})}},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,u,c,m,h,p,g,f,x,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R,M,C=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,c=this.state,m=c.grid,h=c.axis1,p=c.axis2,g=c.graphData,f=c.graphData2,x=c.lastUpdatedAt,n&&n.moncondevice?(w=Object(r.g)(n.topic),[4,Object(o.k)(w,a,l,g.columns.length>1)]):[3,2];case 1:E=v.sent(),V=["Front"],y=["Back"],L=["Evaporator Fan"],H=["Compressor In"],A=["Compressor Out"],N=["Solid"],D=["Front"],P=["Back"],_=["Evaporator Fan"],O=["Compressor In"],S=["Compressor Out"],j=["Solid"],k=["x"],(b=["Register"]).push(null),V.push(null),y.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(new Date(a)),E.length>0&&E.forEach(function(e){e&&(b.push(""+e.register1),V.push(""+e.t3frontRefrigerator1),y.push(""+e.t4backRefrigerator1),L.push(""+e.t5evapfanRefrigerator1),H.push(""+e.t6comprinRefrigerator1),A.push(""+e.t7comproutRefrigerator1),N.push(""+e.t8probeRefrigerator1),D.push(""+e.t3frontRefrigerator2),P.push(""+e.t4backRefrigerator2),_.push(""+e.t5evapfanRefrigerator2),O.push(""+e.t6comprinRefrigerator2),S.push(""+e.t7comproutRefrigerator2),j.push(""+e.t8probeRefrigerator2),k.push(new Date(e.timestamp)))}),x=E.length>0?null===(e=k[k.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",b.push(null),V.push(null),y.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(new Date(l)),q=[],u&&u.length&&(q.push(this.fetchEquipmentFromPoints(u[0]||"Refrigerator 1",["t3frontRefrigerator1","t4backRefrigerator1","t5evapfanRefrigerator1","t6comprinRefrigerator1","t7comproutRefrigerator1","t8probeRefrigerator1"])),q.push(this.fetchEquipmentFromPoints(u[1]||"Refrigerator 2",["t3frontRefrigerator2","t4backRefrigerator2","t5evapfanRefrigerator2","t6comprinRefrigerator2","t7comproutRefrigerator2","t8probeRefrigerator2"]))),g={x:"x",columns:[k,b,V,y,L,H,A,N]},f={x:"x",columns:[k,b,D,P,_,O,S,j]},h.y.label="\xb0F",p.y.label="\xb0F",k.length>1&&(F=Object(s.a)(5,a,l),R="",F.length>1?(M=((new Date).getTime()-F[0].getTime())/1e3,R=(M/=3600)>24?"%m-%d %H:%M":M<.3?"%H:%M:%S":"%H:%M"):R="%H:%M:%S",m.x.lines=[],F.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(1)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},h.y.tick.values=[0,20,40,60,80,100],p.y.tick.values=[0,20,40,60,80,100],h.y.max=100,h.y.min=0,p.y.max=100,p.y.min=0,h.x.tick.format=R,p.x.tick.format=R,h.x.tick.values=F,p.x.tick.values=F,this.props.loadNextInsight(),Object(d.h)(w,this.callLiveUpdate),this.setState({grid:m,axis1:h,axis2:p,graphData:g,graphData2:f,lastUpdatedAt:x,loading:!1,graphEquipment:q},function(){i&&C.changeAlarmStatus(!0)})),v.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n=this,l=this.state,o=l.loading,s=l.graphData,u=l.graphData2,c=l.axis1,m=l.axis2,h=l.grid,d=l.lastUpdatedAt,p=l.graphDataAlarmPoint1,g=l.graphDataAlarmPoint2,f=l.indicateAlarm1,v=l.indicateAlarm2,x=l.alarmSensedPoints,w=l.selectedAlarmPoint1,E=l.selectedAlarmPoint2,b=l.graphEquipment,V=this.props,y=V.graphsList,L=V.instance,H=V.buildingName,A=V.device,N=V.showAlarmPoints,D=V.equipment,P=y&&y.length&&y[0]?y[0]:"Refrigerator 1",_=y&&y.length&&y[1]?y[1]:"Refrigerator 2";return a.createElement(a.Fragment,null,y.indexOf("Refrigerator 1")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(f&&N?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),N&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",x&&x.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:w.sensedValue,onChange:function(e){n.selectAlarmPoint1(e.target.value)}},x.filter(function(e){return"t3frontRefrigerator1"==e.sensedValue||"t4backRefrigerator1"==e.sensedValue||"t5evapfanRefrigerator1"==e.sensedValue||"t6comprinRefrigerator1"==e.sensedValue||"t7comproutRefrigerator1"==e.sensedValue||"t8probeRefrigerator1"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),f&&a.createElement("a",{href:"#"+L+"/"+H+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+L+"/"+H+"/Insights/Equipment/Graphs/CBW406/"+Object(r.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},b&&b.length&&b.find(function(e){return e.graph==P})&&b.find(function(e){return e.graph==P}).pointEquip.length?b.find(function(e){return e.graph==P}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"Temperatures"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",b&&b.length&&b.find(function(e){return e.graph==P})&&b.find(function(e){return e.graph==P}).pointEquip.length?b.find(function(e){return e.graph==P}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",b&&b.length&&b.find(function(e){return e.graph==P})&&b.find(function(e){return e.graph==P}).pointEquip.length?b.find(function(e){return e.graph==P}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(A.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(A.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===D||void 0===D?void 0:D.map(function(e,t){return e.rdfsLabel+(t<D.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(A.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(A.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",d)),o?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:N&&(null===(e=p.columns)||void 0===e?void 0:e.length)>1?p:s,size:{height:300},axis:c,grid:h,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),y.indexOf("Refrigerator 2")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(v&&N?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),N&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",x&&x.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:E.sensedValue,onChange:function(e){n.selectAlarmPoint2(e.target.value)}},x.filter(function(e){return"register1"==e.sensedValue||"t3frontRefrigerator2"==e.sensedValue||"t4backRefrigerator2"==e.sensedValue||"t5evapfanRefrigerator2"==e.sensedValue||"t6comprinRefrigerator2"==e.sensedValue||"t7comproutRefrigerator2"==e.sensedValue||"t8probeRefrigerator2"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),v&&a.createElement("a",{href:"#"+L+"/"+H+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+L+"/"+H+"/Insights/Equipment/Graphs/CBW406/"+Object(r.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},b&&b.length&&b.find(function(e){return e.graph==_})&&b.find(function(e){return e.graph==_}).pointEquip.length?b.find(function(e){return e.graph==_}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"Temperatures"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",b&&b.length&&b.find(function(e){return e.graph==_})&&b.find(function(e){return e.graph==_}).pointEquip.length?b.find(function(e){return e.graph==_}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",b&&b.length&&b.find(function(e){return e.graph==_})&&b.find(function(e){return e.graph==_}).pointEquip.length?b.find(function(e){return e.graph==_}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(A.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(A.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",D.map(function(e,t){return e.rdfsLabel+(t<D.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(A.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(A.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",d)),o?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:N&&(null===(t=g.columns)||void 0===t?void 0:t.length)>1?g:u,size:{height:300},axis:m,grid:h,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=x},2973:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(715),s=n(802),r=n(11),u=n(875),c=n(803),m=n(122),h=n(736),d=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},selectedAlarmPoint1:u.a,selectedAlarmPoint2:u.a,selectedAlarmPoint3:u.a,graphEquipment:Object()},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(r.g)(e)&&Object(d.g)(Object(r.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){var t;return f(this,void 0,void 0,function(){var n,a,l,i,o,s,u,d,p,g,f,x,w,E=this;return v(this,function(v){switch(v.label){case 0:return n=this.state,a=n.graphData,l=n.selectedAlarmPoint1,i=n.selectedAlarmPoint2,o=n.selectedAlarmPoint3,s=this.props,u=s.buildingName,d=s.devicePoints,p=s.showAlarmPoints,g=s.device,Object(m.a)(!0),p&&!e?[3,2]:(f=[],d&&d.length&&d.forEach(function(e){f.push({sensedValue:Object(r.g)(e.sensedValue),maximumExtremeValue:Object(r.g)(e.maximumExtremeValue),maximumNormalValue:Object(r.g)(e.maximumNormalValue),minimumExtremeValue:Object(r.g)(e.minimumExtremeValue),minimumNormalValue:Object(r.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(r.g)(e.ifMaximumExtremeValue)||"true"!=Object(r.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(r.g)(e.ifMaximumNormalValue)||"true"!=Object(r.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(r.g)(e.ifMinimumExtremeValue)||"true"!=Object(r.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(r.g)(e.ifMinimumNormalValue)||"true"!=Object(r.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(h.a.OperationalAlarm,u,!1,0,50,null,null,[Object(r.g)(g.moncondevice)],null)]);case 1:return x=v.sent(),w=(null===(t=a.columns[0])||void 0===t?void 0:t.length)>1?new Date(a.columns[0][1]):null,x=x.filter(function(e){return new Date(e.timeofalarm)>w}),this.setState({alarmSensedPoints:f,deviceAlarms:x},function(){if((null===f||void 0===f?void 0:f.length)>0&&a.columns.length>1){var e=f.filter(function(e){return"a13comprcurrRefrigerator1"==e.sensedValue||"a14efmcurrRefrigerator1"==e.sensedValue||"a15prRefrigerator1"==e.sensedValue||"a16doorRefrigerator1"==e.sensedValue}),t=l.sensedValue.length>1?l.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";E.selectAlarmPoint1(t);var n=f.filter(function(e){return"a13comprcurrRefrigerator2"==e.sensedValue||"a14efmcurrRefrigerator2"==e.sensedValue||"a15prRefrigerator2"==e.sensedValue||"a16doorRefrigerator2"==e.sensedValue}),s=i.sensedValue.length>1?i.sensedValue:(null===n||void 0===n?void 0:n.length)>0?n[n.length-1].sensedValue:"";E.selectAlarmPoint2(s);var r=f.filter(function(e){return"poweranalogInput5"==e.sensedValue||"poweranalogInput6"==e.sensedValue||"poweranalogInput7"==e.sensedValue||"poweranalogInput8"==e.sensedValue}),u=o.sensedValue.length>1?o.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";E.selectAlarmPoint3(u)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),v.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"a13comprcurrRefrigerator1"==e.sensedValueKey||"a14efmcurrRefrigerator1"==e.sensedValueKey||"a15prRefrigerator1"==e.sensedValueKey||"a16doorRefrigerator1"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("a13comprcurrRefrigerator1"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Compressor:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a14efmcurrRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EFM:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a15prRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Pressure Sensor":"#e3e3e3",High:"grey","High-High":"red"}}}else if("a16doorRefrigerator1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Door Contact":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint1:o,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:u.a,indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"a13comprcurrRefrigerator2"==e.sensedValueKey||"a14efmcurrRefrigerator2"==e.sensedValueKey||"a15prRefrigerator2"==e.sensedValueKey||"a16doorRefrigerator2"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("a13comprcurrRefrigerator2"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Compressor:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a14efmcurrRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EFM:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a15prRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Pressure Sensor":"#e3e3e3",High:"grey","High-High":"red"}}}else if("a16doorRefrigerator2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Door Contact":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint2:o,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:u.a,indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"poweranalogInput5"==e.sensedValueKey||"poweranalogInput6"==e.sensedValueKey||"poweranalogInput7"==e.sensedValueKey||"poweranalogInput8"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("poweranalogInput5"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 5":"#e3e3e3",High:"grey","High-High":"red"}}}else if("poweranalogInput6"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 6":"#e3e3e3",High:"grey","High-High":"red"}}}else if("poweranalogInput7"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 7":"#e3e3e3",High:"grey","High-High":"red"}}}else if("poweranalogInput8"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 8":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint3:o,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:u.a,indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,o=a.axis1,s=a.grid,r=a.alarmSensedPoints,u=a.selectedAlarmPoint1,c=a.selectedAlarmPoint2,m=a.selectedAlarmPoint3,h=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var d=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.a13comprcurrRefrigerator1),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.a14efmcurrRefrigerator1),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.a15prRefrigerator1),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.a16doorRefrigerator1),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.a13comprcurrRefrigerator2),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.a14efmcurrRefrigerator2),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.a15prRefrigerator2),i.columns[4].splice(1,1),i.columns[4].push(null===e||void 0===e?void 0:e.a16doorRefrigerator2),(t.getTime()-l.columns[0][2].getTime())/6e4>d&&l.columns[0].splice(1,1),o.x.tick.values[2]&&o.x.tick.values[1].getTime()&&o.x.tick.values[2].getTime()-o.x.tick.values[1].getTime()<t.getTime()-o.x.tick.values[o.x.tick.values.length-1]&&(o.x.tick.values.splice(0,1),s.x.lines.splice(0,1),t.setSeconds(0),d>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),o.x.tick.values.push(t),s.x.lines.push({value:t,class:"grid4"}));var p=null===t||void 0===t?void 0:t.toLocaleString();h?this.setState({grid:s,axis1:o,graphData:l,graphData2:i,lastUpdatedAt:p},function(){var e=r.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=u.sensedValue.length>1?u.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=r.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=c.sensedValue.length>1?c.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=r.filter(function(e){return"illuminance_lux"==e.sensedValue}),o=m.sensedValue.length>1?m.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(o)}):this.setState({grid:s,axis1:o,graphData:l,graphData2:i,lastUpdatedAt:p})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(r.g)(e.sensedValue)==a});!i||!Object(r.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(r.g)(i.relatedEquipment)})||l.push({value:Object(r.g)(i.relatedEquipment),label:Object(r.g)(i.relatedEquipmentLabel),space:Object(r.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,u,c,m,h,p,g,f,x,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R,M,C,G,T,I,U,B,K=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,c=this.state,m=c.grid,h=c.axis1,p=c.axis2,g=c.axis3,f=c.graphData,x=c.graphData2,w=c.graphData3,E=c.lastUpdatedAt,n&&n.moncondevice?(b=Object(r.g)(n.topic),[4,Object(o.l)(b,a,l,f.columns.length>1)]):[3,2];case 1:V=v.sent(),L=["EFM"],H=["Pressure Sensor"],A=["Door Contact"],N=["Compressor"],D=["EFM"],P=["Pressure Sensor"],_=["Door Contact"],O=["Register"],S=["Serial Number"],j=["Refresh"],k=["Power Analog Input 5"],q=["Power Analog Input 6"],F=["Power Analog Input 7"],R=["Power Analog Input 8"],M=["Amalgamated Watts"],C=["x"],(y=["Compressor"]).push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(new Date(a)),G=!1,V.length>0&&V.forEach(function(e){e&&(e.a13comprcurrRefrigerator1&&y.push(""+e.a13comprcurrRefrigerator1),e.a14efmcurrRefrigerator1&&(G=e.a14efmcurrRefrigerator1<-5,L.push(""+e.a14efmcurrRefrigerator1)),e.a15prRefrigerator1&&H.push(""+e.a15prRefrigerator1),e.a16doorRefrigerator1&&A.push(""+e.a16doorRefrigerator1),e.a13comprcurrRefrigerator2&&N.push(""+e.a13comprcurrRefrigerator2),e.a14efmcurrRefrigerator2&&D.push(""+e.a14efmcurrRefrigerator2),e.a15prRefrigerator2&&P.push(""+e.a15prRefrigerator2),e.a16doorRefrigerator2&&_.push(""+e.a16doorRefrigerator2),e.register1&&O.push(""+e.register1),e.serialNumber&&S.push(""+e.serialNumber),e.minRecRefresh&&j.push(""+e.minRecRefresh),e.poweranalogInput5&&k.push(""+e.poweranalogInput5),e.poweranalogInput6&&q.push(""+e.poweranalogInput6),e.poweranalogInput7&&F.push(""+e.poweranalogInput7),e.poweranalogInput8&&R.push(""+e.poweranalogInput8),M.push(""+360*e.a13comprcurrRefrigerator1),C.push(new Date(e.timestamp)))}),E=V.length>0?null===(e=C[C.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",y.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(new Date(l)),T=[],u&&u.length&&(T.push(this.fetchEquipmentFromPoints(u[0]||"Refrigerator 1",["a13comprcurrRefrigerator1","a14efmcurrRefrigerator1","a15prRefrigerator1","a16doorRefrigerator1"])),T.push(this.fetchEquipmentFromPoints(u[1]||"Refrigerator 2",["a13comprcurrRefrigerator2","a14efmcurrRefrigerator2","a15prRefrigerator2","a16doorRefrigerator2"])),T.push(this.fetchEquipmentFromPoints(u[2]||"Refrigerator 1 and 2",["poweranalogInput5","poweranalogInput6","poweranalogInput7","poweranalogInput8"]))),(y.length>3||L.length>3||H.length>3||A.length>3)&&(f={x:"x",columns:[C,y,L,H,A]}),(N.length>3||D.length>3||P.length>3||_.length>3)&&(x={x:"x",columns:[C,N,D,P,_]}),(k.length>3||q.length>3||F.length>3||R.length>3)&&(w={x:"x",columns:[C,k,q,F,R]},g.y.label="kw"),h.y.label="Amps",p.y.label="Amps",C.length>1&&(I=Object(s.a)(5,a,l),U="",I.length>1?(B=((new Date).getTime()-I[0].getTime())/1e3,U=(B/=3600)>24?"%m-%d %H:%M":B<.3?"%H:%M:%S":"%H:%M"):U="%H:%M:%S",m.x.lines=[],I.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(1)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(1)},h.y.tick.values=G?[-20,-10,0,10,20]:[0,5,10,15,20],p.y.tick.values=[0,5,10,15,20],g.y.tick.values=[0,20,40,60,80,100],h.y.max=20,h.y.min=G?-20:0,p.y.max=20,p.y.min=0,g.y.max=100,g.y.min=0,h.x.tick.format=U,p.x.tick.format=U,g.x.tick.format=U,h.x.tick.values=I,p.x.tick.values=I,g.x.tick.values=I,this.props.loadNextInsight(),Object(d.h)(b,this.callLiveUpdate),this.setState({grid:m,axis1:h,axis2:p,axis3:g,graphData:f,graphData2:x,graphData3:w,lastUpdatedAt:E,loading:!1,graphEquipment:T},function(){i&&K.changeAlarmStatus(!0)})),v.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n,l,o,s,u=this,c=this.state,m=c.loading,h=c.graphData,d=c.graphData2,p=c.graphData3,g=c.axis1,f=c.axis2,v=c.axis3,x=c.grid,w=c.lastUpdatedAt,E=c.graphDataAlarmPoint1,b=c.graphDataAlarmPoint2,V=c.graphDataAlarmPoint3,y=c.indicateAlarm1,L=c.indicateAlarm2,H=c.indicateAlarm3,A=c.alarmSensedPoints,N=c.selectedAlarmPoint1,D=c.selectedAlarmPoint2,P=c.selectedAlarmPoint3,_=c.graphEquipment,O=this.props,S=O.graphsList,j=O.instance,k=O.buildingName,q=O.showAlarmPoints,F=O.device,R=O.equipment,M=S&&S.length&&S[0]?S[0]:"Refrigerator 1",C=S&&S.length&&S[1]?S[1]:"Refrigerator 2",G=S&&S.length&&S[1]?S[1]:"Refrigerator 1 and 2";return a.createElement(a.Fragment,null,S.indexOf("Refrigerator 1")>-1&&(null===(e=h.columns[1])||void 0===e?void 0:e.length)>2&&a.createElement("div",{className:"row col-md-12 device-graphs "+(y&&q?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),q&&A.length>0&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:N.sensedValue,onChange:function(e){u.selectAlarmPoint1(e.target.value)}},A.filter(function(e){return"a13comprcurrRefrigerator1"==e.sensedValue||"a14efmcurrRefrigerator1"==e.sensedValue||"a15prRefrigerator1"==e.sensedValue||"a16doorRefrigerator1"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),y&&a.createElement("a",{href:"#"+j+"/"+k+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+j+"/"+k+"/Insights/Equipment/Graphs/CompressorControl/"+Object(r.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},_&&_.length&&_.find(function(e){return e.graph==M})&&_.find(function(e){return e.graph==M}).pointEquip.length?_.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"CT, Pres. and Door"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",_&&_.length&&_.find(function(e){return e.graph==M})&&_.find(function(e){return e.graph==M}).pointEquip.length?_.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",_&&_.length&&_.find(function(e){return e.graph==M})&&_.find(function(e){return e.graph==M}).pointEquip.length?_.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(F.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(F.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===R||void 0===R?void 0:R.map(function(e,t){return e.rdfsLabel+(t<R.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(F.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(F.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:q&&(null===(t=E.columns)||void 0===t?void 0:t.length)>1?E:h,size:{height:300},axis:g,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),S.indexOf("Refrigerator 2")>-1&&(null===(n=d.columns[1])||void 0===n?void 0:n.length)>2&&a.createElement("div",{className:"row col-md-12 device-graphs "+(L&&q?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),q&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:D.sensedValue,onChange:function(e){u.selectAlarmPoint2(e.target.value)}},A.filter(function(e){return"a13comprcurrRefrigerator2"==e.sensedValue||"a14efmcurrRefrigerator2"==e.sensedValue||"a15prRefrigerator2"==e.sensedValue||"a16doorRefrigerator2"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),L&&a.createElement("a",{href:"#"+j+"/"+k+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+j+"/"+k+"/Insights/Equipment/Graphs/CompressorControl/"+Object(r.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},_&&_.length&&_.find(function(e){return e.graph==C})&&_.find(function(e){return e.graph==C}).pointEquip.length?_.find(function(e){return e.graph==C}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"CT, Pres. and Door"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",_&&_.length&&_.find(function(e){return e.graph==C})&&_.find(function(e){return e.graph==C}).pointEquip.length?_.find(function(e){return e.graph==C}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",_&&_.length&&_.find(function(e){return e.graph==C})&&_.find(function(e){return e.graph==C}).pointEquip.length?_.find(function(e){return e.graph==C}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(F.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(F.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===R||void 0===R?void 0:R.map(function(e,t){return e.rdfsLabel+(t<R.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(F.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(F.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:q&&(null===(l=b.columns)||void 0===l?void 0:l.length)>1?b:d,size:{height:300},axis:f,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),S.indexOf("Refrigerator 1")>-1&&S.indexOf("Power Analog Inputs")>-1&&(null===(o=p.columns[1])||void 0===o?void 0:o.length)>2&&a.createElement("div",{className:"row col-md-12 device-graphs "+(H&&q?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),q&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:P.sensedValue,onChange:function(e){u.selectAlarmPoint3(e.target.value)}},A.filter(function(e){return"poweranalogInput5"==e.sensedValue||"poweranalogInput6"==e.sensedValue||"poweranalogInput7"==e.sensedValue||"poweranalogInput8"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),H&&a.createElement("a",{href:"#"+j+"/"+k+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+j+"/"+k+"/Insights/Equipment/Graphs/CompressorControl/"+Object(r.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},_&&_.length&&_.find(function(e){return e.graph==G})&&_.find(function(e){return e.graph==G}).pointEquip.length?_.find(function(e){return e.graph==G}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"CT, Pres. and Door"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",_&&_.length&&_.find(function(e){return e.graph==G})&&_.find(function(e){return e.graph==G}).pointEquip.length?_.find(function(e){return e.graph==G}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",_&&_.length&&_.find(function(e){return e.graph==G})&&_.find(function(e){return e.graph==G}).pointEquip.length?_.find(function(e){return e.graph==G}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(F.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(F.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===R||void 0===R?void 0:R.map(function(e,t){return e.rdfsLabel+(t<R.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(F.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(F.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",w)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:q&&(null===(s=V.columns)||void 0===s?void 0:s.length)>1?V:p,size:{height:300},axis:v,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=x},2974:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(707),s=n(11),r=n(802),u=n(875),c=n(803),m=n(122),h=n(736),d=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],graphDataAlarmPoint:{},selectedAlarmPoint:u.a,indicateAlarm:!1,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(s.g)(e)&&Object(d.g)(Object(s.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){var t;return f(this,void 0,void 0,function(){var n,a,l,i,o,r,u,d,p,g,f,x=this;return v(this,function(v){switch(v.label){case 0:return n=this.state,a=n.graphData,l=n.selectedAlarmPoint,i=this.props,o=i.buildingName,r=i.devicePoints,u=i.showAlarmPoints,d=i.device,Object(m.a)(!0),u&&!e?[3,2]:(p=[],r&&r.length&&r.forEach(function(e){p.push({sensedValue:Object(s.g)(e.sensedValue),maximumExtremeValue:Object(s.g)(e.maximumExtremeValue),maximumNormalValue:Object(s.g)(e.maximumNormalValue),minimumExtremeValue:Object(s.g)(e.minimumExtremeValue),minimumNormalValue:Object(s.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(s.g)(e.ifMaximumExtremeValue)||"true"!=Object(s.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(s.g)(e.ifMaximumNormalValue)||"true"!=Object(s.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(s.g)(e.ifMinimumExtremeValue)||"true"!=Object(s.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(s.g)(e.ifMinimumNormalValue)||"true"!=Object(s.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(h.a.OperationalAlarm,o,!1,0,50,null,null,[Object(s.g)(d.moncondevice)],null)]);case 1:return g=v.sent(),f=(null===(t=a.columns[0])||void 0===t?void 0:t.length)>1?new Date(a.columns[0][1]):null,g=g.filter(function(e){return new Date(e.timeofalarm)>f}),this.setState({alarmSensedPoints:p,deviceAlarms:g},function(){if((null===p||void 0===p?void 0:p.length)>0&&a.columns.length>1){var e=l.sensedValue.length>1?l.sensedValue:p[p.length-1].sensedValue;x.selectAlarmPoint(e)}}),[3,3];case 2:this.selectAlarmPoint(""),v.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("mAmps_relay1"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"grey",Low:"grey","Relay 1 Amp":"red",High:"grey","High-High":"grey"}}}else if("mAmps_relay2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 2 Amp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("mAmps_relay3"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 3 Amp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("mAmps_relay4"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 4 Amp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_Wt_relay1"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[5].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 1 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_Wt_relay2"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[6].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 2 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_Wt_relay3"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[7].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 3 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else if("nominal_src_volts"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[12].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[12],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 3 Watts":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint:o,graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint:u.a,graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.grid,s=a.alarmSensedPoints,r=a.axis1,u=a.selectedAlarmPoint,c=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var m=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.mAmps_relay1),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.mAmps_relay2),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.mAmps_relay3),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.mAmps_relay4),l.columns[5].splice(1,1),l.columns[5].push(null===e||void 0===e?void 0:e.power_Wt_relay1),l.columns[6].splice(1,1),l.columns[6].push(null===e||void 0===e?void 0:e.power_Wt_relay2),l.columns[7].splice(1,1),l.columns[7].push(null===e||void 0===e?void 0:e.power_Wt_relay3);var h=Object(o.a)(parseInt(null===e||void 0===e?void 0:e.v4relay_state));3==h.length?h="0"+h:2==h.length?h="00"+h:1==h.length&&(h="000"+h);var d=h[3],p=h[2],g=h[1],f=h[0];l.columns[8].splice(1,1),l.columns[8].push(d||"0"),l.columns[9].splice(1,1),l.columns[9].push(p||"0"),l.columns[10].splice(1,1),l.columns[10].push(g||"0"),l.columns[11].splice(1,1),l.columns[11].push(f||"0"),l.columns[12].splice(1,1),l.columns[12].push(null===e||void 0===e?void 0:e.nominal_src_volts),(t.getTime()-l.columns[0][2].getTime())/6e4>m&&l.columns[0].splice(1,1),r.x.tick.values[2]&&r.x.tick.values[1].getTime()&&r.x.tick.values[2].getTime()-r.x.tick.values[1].getTime()<t.getTime()-r.x.tick.values[r.x.tick.values.length-1]&&(r.x.tick.values.splice(0,1),i.x.lines.splice(0,1),t.setSeconds(0),m>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),r.x.tick.values.push(t),i.x.lines.push({value:t,class:"grid4"}));var v=null===t||void 0===t?void 0:t.toLocaleString();c?this.setState({grid:i,axis1:r,graphData:l,lastUpdatedAt:v},function(){var e=s.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=u.sensedValue.length>1?u.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint(t)}):this.setState({grid:i,axis1:r,graphData:l,lastUpdatedAt:v})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(s.g)(e.sensedValue)==a});!i||!Object(s.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(s.g)(i.relatedEquipment)})||l.push({value:Object(s.g)(i.relatedEquipment),label:Object(s.g)(i.relatedEquipmentLabel),space:Object(s.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,u,c,m,h,p,g,f,x,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R,M,C,G,T,I,U,B,K,W,z=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=this.state,c=u.grid,m=u.axis1,h=u.graphData,p=u.lastUpdatedAt,n&&n.moncondevice?(g=Object(s.g)(n.topic),f=Object(s.g)(n.moncondevice),[4,Object(o.h)(g,a,l,h.columns.length>1)]):[3,3];case 1:return x=v.sent(),[4,Object(o.z)(f)];case 2:if(w=v.sent(),E=[],w[0]?(b=w[0],V=Object(s.g)(b.relayNames),E=V.split(",")):(E.push("Relay 1"),E.push("Relay 2"),E.push("Relay 3"),E.push("Relay 4")),y=[E[0]+" Amp"],L=[E[1]+" Amp"],H=[E[2]+" Amp"],A=[E[3]+" Amp"],N=["Nom. Source Volts"],D=[E[0]+" Watts"],P=[E[1]+" Watts"],_=[E[2]+" Watts"],O=[E[0]+" State"],S=[E[1]+" State"],j=[E[2]+" State"],k=[E[3]+" State"],q=["x"],y.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(new Date(a)),x.length>0)for(F=0;F<x.length;F++)(null===(R=x[F])||void 0===R?void 0:R.mAmps_relay1)&&(y.push(R.mAmps_relay1),L.push(R.mAmps_relay2),H.push(R.mAmps_relay3),A.push(R.mAmps_relay4),N.push(R.nominal_src_volts),D.push(R.power_Wt_relay1),P.push(R.power_Wt_relay2),_.push(R.power_Wt_relay3),M=Object(o.a)(parseInt(R.v4relay_state)),q.push(new Date(R.timestamp)),3==M.length?M="0"+M:2==M.length?M="00"+M:1==M.length&&(M="000"+M),C=M[3],G=M[2],T=M[1],I=M[0],O.push(C||"0"),S.push(G||"0"),j.push(T||"0"),k.push(I||"0"));p=x.length>0?null===(e=q[q.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",y.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(new Date(l)),(U=[]).push(this.fetchEquipmentFromPoints("RelayV4",["mAmps_relay1","mAmps_relay2","mAmps_relay3","mAmps_relay4","power_Wt_relay1","power_Wt_relay2","power_Wt_relay3","Relay1_State","Relay2_State","Relay3_State","Relay4_State","nominal_src_volts"])),h={x:"x",columns:[q,y,L,H,A,D,P,_,O,S,j,k,N]},m.y.label="Amp, W, On/Off, Volts",B=Object(r.a)(5,a,l),K="",B.length>1?(W=((new Date).getTime()-B[0].getTime())/1e3,K=(W/=3600)>24?"%m-%d %H:%M":W<.3?"%H:%M:%S":"%H:%M"):K="%H:%M:%S",c.x.lines=[],B.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),m.y.tick.format=function(e){return parseFloat(e).toFixed(0)},m.y.tick.values=[0,50,100,150,200,250,300],m.y.max=300,m.y.min=0,m.x.tick.format=K,m.x.tick.values=B,this.props.loadNextInsight(),Object(d.h)(g,this.callLiveUpdate),this.setState({grid:c,axis1:m,graphData:h,loading:!1,lastUpdatedAt:p,graphEquipment:U},function(){i&&z.changeAlarmStatus(!0)}),v.label=3;case 3:return[2]}})})},t.prototype.render=function(){var e,t=this,n=this.state,l=n.loading,o=n.graphData,r=n.axis1,u=n.grid,c=n.lastUpdatedAt,m=n.alarmSensedPoints,h=n.selectedAlarmPoint,d=n.graphDataAlarmPoint,p=n.indicateAlarm,g=n.graphEquipment,f=this.props,v=f.instance,x=f.buildingName,w=f.device,E=f.showAlarmPoints,b=f.equipment;return a.createElement("div",{className:"row col-md-12 device-graphs "+(p&&E?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),E&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",m&&m.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:h.sensedValue,onChange:function(e){t.selectAlarmPoint(e.target.value)}},m.map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),p&&a.createElement("a",{href:"#"+v+"/"+x+"/Alarms/OperationalAlarms/Device/"+Object(s.g)(w.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+v+"/"+x+"/Insights/Equipment/Graphs/RelayControl/"+Object(s.g)(w.moncondevice),target:"_blank",rel:"noreferrer noopener"},g&&g.length&&g.find(function(e){return"RelayV4"==e.graph})&&g.find(function(e){return"RelayV4"==e.graph}).pointEquip.length?g.find(function(e){return"RelayV4"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",g&&g.length&&g.find(function(e){return"RelayV4"==e.graph})&&g.find(function(e){return"RelayV4"==e.graph}).pointEquip.length?g.find(function(e){return"RelayV4"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",g&&g.length&&g.find(function(e){return"RelayV4"==e.graph})&&g.find(function(e){return"RelayV4"==e.graph}).pointEquip.length?g.find(function(e){return"RelayV4"==e.graph}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(s.g)(w.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(s.g)(w.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===b||void 0===b?void 0:b.map(function(e,t){return e.rdfsLabel+(t<b.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(s.g)(w.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(s.g)(w.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",c)),l?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:E&&(null===(e=d.columns)||void 0===e?void 0:e.length)>1?d:o,size:{height:300},axis:r,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}}))},t}(a.Component);t.a=x},2975:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),o=n(715),s=n(802),r=n(11),u=n(875),c=n(803),m=n(122),h=n(736),d=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},graphData5:{x:"x",columns:[]},graphData6:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis5:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis6:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,indicateAlarm5:!1,indicateAlarm6:!1,alarmSensedPoints:[],graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},graphDataAlarmPoint5:{},graphDataAlarmPoint6:{},selectedAlarmPoint1:u.a,selectedAlarmPoint2:u.a,selectedAlarmPoint3:u.a,selectedAlarmPoint4:u.a,selectedAlarmPoint5:u.a,selectedAlarmPoint6:u.a,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(r.g)(e)&&Object(d.g)(Object(r.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,o,s,u,d,p,g,f,x,w,E,b,V=this;return v(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,o=t.selectedAlarmPoint4,s=t.selectedAlarmPoint5,u=t.selectedAlarmPoint6,d=this.props,p=d.buildingName,g=d.devicePoints,f=d.showAlarmPoints,x=d.device,Object(m.a)(!0),f&&!e?[3,2]:(w=[],g&&g.length&&g.forEach(function(e){w.push({sensedValue:Object(r.g)(e.sensedValue),maximumExtremeValue:Object(r.g)(e.maximumExtremeValue),maximumNormalValue:Object(r.g)(e.maximumNormalValue),minimumExtremeValue:Object(r.g)(e.minimumExtremeValue),minimumNormalValue:Object(r.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(r.g)(e.ifMaximumExtremeValue)||"true"!=Object(r.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(r.g)(e.ifMaximumNormalValue)||"true"!=Object(r.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(r.g)(e.ifMinimumExtremeValue)||"true"!=Object(r.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(r.g)(e.ifMinimumNormalValue)||"true"!=Object(r.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(h.a.OperationalAlarm,p,!1,0,50,null,null,[Object(r.g)(x.moncondevice)],null)]);case 1:return E=v.sent(),b=new Date(n.columns[0][1]),E=E.filter(function(e){return new Date(e.timeofalarm)>b}),this.setState({alarmSensedPoints:w,deviceAlarms:E},function(){if((null===w||void 0===w?void 0:w.length)>0&&n.columns.length>1){var e=w.filter(function(e){return"PowerA"==e.sensedValue||"PowerB"==e.sensedValue||"PowerB"==e.sensedValue||"PowerC"==e.sensedValue||"PowerSum"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";V.selectAlarmPoint1(t);var r=w.filter(function(e){return"VoltAB"==e.sensedValue||"VoltAC"==e.sensedValue||"VoltAB"==e.sensedValue}),c=l.sensedValue.length>1?l.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";V.selectAlarmPoint2(c);var m=w.filter(function(e){return"VoltA"==e.sensedValue||"VoltB"==e.sensedValue||"VoltC"==e.sensedValue}),h=i.sensedValue.length>1?i.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";V.selectAlarmPoint3(h);var d=w.filter(function(e){return"Freq"==e.sensedValue}),p=o.sensedValue.length>1?o.sensedValue:(null===d||void 0===d?void 0:d.length)>0?d[d.length-1].sensedValue:"";V.selectAlarmPoint4(p);var g=w.filter(function(e){return"EnergySumNR"==e.sensedValue}),f=s.sensedValue.length>1?s.sensedValue:(null===g||void 0===g?void 0:g.length)>0?g[g.length-1].sensedValue:"";V.selectAlarmPoint5(f);var v=w.filter(function(e){return"EnergyPosSumNR"==e.sensedValue}),x=u.sensedValue.length>1?u.sensedValue:(null===v||void 0===v?void 0:v.length)>0?v[v.length-1].sensedValue:"";V.selectAlarmPoint6(x)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),this.selectAlarmPoint5(""),this.selectAlarmPoint6(""),v.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"PowerA"==e.sensedValueKey||"PowerB"==e.sensedValueKey||"PowerB"==e.sensedValueKey||"PowerC"==e.sensedValueKey||"PowerSum"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("PowerA"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("PowerB"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("PowerC"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("PowerSum"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[4].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",PowerSum:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint1:o,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:u.a,indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"VoltAB"==e.sensedValueKey||"VoltAC"==e.sensedValueKey||"VoltAB"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("VoltAB"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts AB":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltBC"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts BC":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltAC"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts AC":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint2:o,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:u.a,indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"VoltA"==e.sensedValueKey||"VoltB"==e.sensedValueKey||"VoltC"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("VoltA"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltB"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[2].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltC"==o.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[3].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts C":"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint3:o,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:u.a,indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"Freq"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("Freq"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Freq:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint4:o,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:u.a,indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.selectAlarmPoint5=function(e){var t=this,n=this.state,a=n.graphData5,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"EnergySumNR"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("EnergySumNR"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EnergySumNR:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint5:o,graphDataAlarmPoint5:e,indicateAlarm5:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint5:u.a,indicateAlarm5:s,graphDataAlarmPoint5:e,loading:!1})})},t.prototype.selectAlarmPoint6=function(e){var t=this,n=this.state,a=n.graphData6,l=n.alarmSensedPoints,i=n.deviceAlarms,o=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"EnergyPosSumNR"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(o){if("EnergyPosSumNR"==o.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],r=["High-High"],c=0;c<a.columns[1].length-1;c++)n.push(o.minimumExtremeValue),l.push(o.minimumNormalValue),i.push(o.maximumNormalValue),r.push(o.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,r],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EnergyPosSumNR:"#e3e3e3",High:"grey","High-High":"red"}},!o.generateMaximumExtremeValue&&e.columns&&e.columns.length&&e.columns[5]&&(e.columns.splice(5,1),delete e.regions["High-High"],delete e.colors["High-High"]),!o.generateMaximumNormalValue&&e.columns&&e.columns.length&&e.columns[4]&&(e.columns.splice(4,1),delete e.regions.High,delete e.colors.High),!o.generateMinimumExtremeValue&&e.columns&&e.columns.length&&e.columns[1]&&(e.columns.splice(1,1),delete e.regions["Low-Low"],delete e.colors["Low-Low"]),!o.generateMinimumNormalValue&&e.columns&&e.columns.length&&e.columns[2]&&(e.columns.splice(2,1),delete e.regions.Low,delete e.colors.Low)}else e=a;t.setState({selectedAlarmPoint6:o,graphDataAlarmPoint6:e,indicateAlarm6:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint6:u.a,indicateAlarm6:s,graphDataAlarmPoint6:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,o=a.graphData3,s=a.graphData4,r=a.graphData5,u=a.graphData6,c=a.axis1,m=a.grid,h=a.alarmSensedPoints,d=a.selectedAlarmPoint1,p=a.selectedAlarmPoint2,g=a.selectedAlarmPoint3,f=a.selectedAlarmPoint4,v=a.selectedAlarmPoint5,x=a.selectedAlarmPoint6,w=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var E=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.PowerA),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.PowerB),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.PowerC),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.PowerSum),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.VoltAB),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.VoltAC),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.VoltBC),o.columns[1].splice(1,1),o.columns[1].push(null===e||void 0===e?void 0:e.VoltA),o.columns[2].splice(1,1),o.columns[2].push(null===e||void 0===e?void 0:e.VoltB),o.columns[3].splice(1,1),o.columns[3].push(null===e||void 0===e?void 0:e.VoltC),s.columns[1].splice(1,1),s.columns[1].push(null===e||void 0===e?void 0:e.Freq),r.columns[1].splice(1,1),r.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.EnergySumNR)/1e3),u.columns[1].splice(1,1),u.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.EnergyPosSumNR)/1e3),(t.getTime()-l.columns[0][2].getTime())/6e4>E&&l.columns[0].splice(1,1),c.x.tick.values[2]&&c.x.tick.values[1].getTime()&&c.x.tick.values[2].getTime()-c.x.tick.values[1].getTime()<t.getTime()-c.x.tick.values[c.x.tick.values.length-1]&&(c.x.tick.values.splice(0,1),m.x.lines.splice(0,1),t.setSeconds(0),E>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),c.x.tick.values.push(t),m.x.lines.push({value:t,class:"grid4"}));var b=null===t||void 0===t?void 0:t.toLocaleString();w?this.setState({grid:m,axis1:c,graphData:l,graphData2:i,graphData3:o,graphData4:s,graphData5:r,graphData6:u,lastUpdatedAt:b},function(){var e=h.filter(function(e){return"PowerA"==e.sensedValue||"PowerB"==e.sensedValue||"PowerB"==e.sensedValue||"PowerC"==e.sensedValue||"PowerSum"==e.sensedValue}),t=d.sensedValue.length>1?d.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=h.filter(function(e){return"VoltAB"==e.sensedValue||"VoltAC"==e.sensedValue||"VoltAB"==e.sensedValue}),l=p.sensedValue.length>1?p.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=h.filter(function(e){return"VoltA"==e.sensedValue||"VoltB"==e.sensedValue||"VoltC"==e.sensedValue}),o=g.sensedValue.length>1?g.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(o);var s=h.filter(function(e){return"Freq"==e.sensedValue}),r=f.sensedValue.length>1?f.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(r);var u=h.filter(function(e){return"EnergySumNR"==e.sensedValue}),c=v.sensedValue.length>1?v.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";n.selectAlarmPoint5(c);var m=h.filter(function(e){return"EnergyPosSumNR"==e.sensedValue}),w=x.sensedValue.length>1?x.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";n.selectAlarmPoint6(w)}):this.setState({grid:m,axis1:c,graphData:l,graphData2:i,graphData3:o,graphData4:s,graphData5:r,graphData6:u,lastUpdatedAt:b})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(r.g)(e.sensedValue)==a});!i||!Object(r.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(r.g)(i.relatedEquipment)})||l.push({value:Object(r.g)(i.relatedEquipment),label:Object(r.g)(i.relatedEquipmentLabel),space:Object(r.g)(i.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)i(o);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,u,c,m,h,p,g,f,x,w,E,b,V,y,L,H,A,N,D,P,_,O,S,j,k,q,F,R,M,C,G,T,I,U,B,K,W,z,Z,Y,$,J=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,c=this.state,m=c.grid,h=c.axis1,p=c.axis2,g=c.axis3,f=c.axis4,x=c.axis5,w=c.axis6,E=c.graphData,b=c.graphData2,V=c.graphData3,y=c.graphData4,L=c.graphData5,H=c.graphData6,A=c.lastUpdatedAt,n&&n.moncondevice?(N=Object(r.g)(n.topic),(D=N?N.split(","):[]).length&&D[0]?[4,Object(o.n)(D[0],a,l,E.columns.length>1)]:[3,2]):[3,2];case 1:P=v.sent(),O=["EnergyPOSSUM"],S=["EnergySumNR"],j=["EnergyPosSumNR"],k=["PowerSum"],q=["Power A"],F=["Power B"],R=["Power C"],M=["Volts A"],C=["Volts B"],G=["Volts C"],T=["VoltsAvgLL"],I=["Volts AB"],U=["Volts AC"],B=["Volts BC"],K=["Freq"],W=["x"],(_=["EnerygySum"]).push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(null),G.push(null),T.push(null),I.push(null),U.push(null),B.push(null),K.push(null),W.push(new Date(a)),P.length>0&&P.forEach(function(e){e&&(_.push(e.EnergySum),O.push(e.EnergyPosSum),S.push(+e.EnergySumNR/1e3),j.push(+e.EnergyPosSumNR/1e3),k.push(e.PowerSum),q.push(e.PowerA),F.push(e.PowerB),R.push(e.PowerC),M.push(e.VoltA),C.push(e.VoltB),G.push(e.VoltC),T.push(e.VoltAvgLL),I.push(e.VoltAB),U.push(e.VoltAC),B.push(e.VoltBC),K.push(e.Freq),W.push(new Date(e.timestamp)))}),A=P.length>0?null===(e=W[W.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",_.push(null),O.push(null),S.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),M.push(null),C.push(null),G.push(null),T.push(null),I.push(null),U.push(null),B.push(null),K.push(null),W.push(new Date(l)),z=[],u&&u.length&&(z.push(this.fetchEquipmentFromPoints(u[0]||"Power",["powerA","powerB","powerC","powerSum"])),z.push(this.fetchEquipmentFromPoints(u[1]||"Phase Voltage",["voltAB","voltBC","voltAC"])),z.push(this.fetchEquipmentFromPoints(u[2]||"Voltage",["voltA","voltB","voltC"])),z.push(this.fetchEquipmentFromPoints(u[3]||"Frequency",["freq"])),z.push(this.fetchEquipmentFromPoints(u[4]||"Energy Sum Resettable",["energySumNR"])),z.push(this.fetchEquipmentFromPoints(u[5]||"Positive Energy Sum Non-resettable",["energyPosSumNR"]))),E={x:"x",columns:[W,q,F,R,k]},b={x:"x",columns:[W,I,B,U]},V={x:"x",columns:[W,M,C,G]},y={x:"x",columns:[W,K]},L={x:"x",columns:[W,S]},H={x:"x",columns:[W,j]},h.y.label="Watts",p.y.label="Volts",g.y.label="Volts",f.y.label="Hz",x.y.label="MWh",w.y.label="MWh",Z=Object(s.a)(5,a,l),Y="",Z.length>1?($=((new Date).getTime()-Z[0].getTime())/1e3,Y=($/=3600)>24?"%m-%d %H:%M":$<.3?"%H:%M:%S":"%H:%M"):Y="%H:%M:%S",m.x.lines=[],Z.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(1)},p.y.tick.format=function(e){return parseFloat(e).toFixed(0)},g.y.tick.format=function(e){return parseFloat(e).toFixed(0)},f.y.tick.format=function(e){return parseFloat(e).toFixed(1)},x.y.tick.format=function(e){return parseFloat(e).toFixed(1)},w.y.tick.format=function(e){return parseFloat(e).toFixed(1)},h.y.tick.values=[0,1e4,2e4,3e4,4e4],p.y.tick.values=[0,50,100,150,200,250],g.y.tick.values=[0,50,100,150],f.y.tick.values=[0,20,40,60,80],x.y.tick.values=[0,40,80,120,160],w.y.tick.values=[0,40,80,120,160],h.y.max=4e4,h.y.min=0,p.y.max=250,p.y.min=0,g.y.max=150,g.y.min=0,f.y.max=80,f.y.min=0,x.y.max=160,x.y.min=0,w.y.max=160,w.y.min=0,h.x.tick.format=Y,p.x.tick.format=Y,g.x.tick.format=Y,f.x.tick.format=Y,x.x.tick.format=Y,w.x.tick.format=Y,h.x.tick.values=Z,p.x.tick.values=Z,g.x.tick.values=Z,f.x.tick.values=Z,x.x.tick.values=Z,w.x.tick.vawlues=Z,this.props.loadNextInsight(),Object(d.h)(D,this.callLiveUpdate),this.setState({grid:m,axis1:h,axis2:p,axis3:g,axis4:f,axis5:x,axis6:w,graphData:E,graphData2:b,graphData3:V,graphData4:y,graphData5:L,graphData6:H,lastUpdatedAt:A,loading:!1,graphEquipment:z},function(){i&&J.changeAlarmStatus(!0)}),v.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n,l,o,s,u=this,c=this.state,m=c.loading,h=c.graphData,d=c.graphData2,p=c.graphData3,g=c.graphData4,f=c.graphData5,v=c.graphData6,x=c.axis1,w=c.axis2,E=c.axis3,b=c.axis4,V=c.axis5,y=c.axis6,L=c.grid,H=c.lastUpdatedAt,A=c.graphDataAlarmPoint1,N=c.graphDataAlarmPoint2,D=c.graphDataAlarmPoint3,P=c.graphDataAlarmPoint4,_=c.graphDataAlarmPoint5,O=c.graphDataAlarmPoint6,S=c.indicateAlarm1,j=c.indicateAlarm2,k=c.indicateAlarm3,q=c.indicateAlarm4,F=c.indicateAlarm5,R=c.indicateAlarm6,M=c.alarmSensedPoints,C=c.selectedAlarmPoint1,G=c.selectedAlarmPoint2,T=c.selectedAlarmPoint3,I=c.selectedAlarmPoint4,U=c.selectedAlarmPoint5,B=c.selectedAlarmPoint6,K=c.graphEquipment,W=this.props,z=W.graphsList,Z=W.instance,Y=W.buildingName,$=W.device,J=W.showAlarmPoints,Q=W.equipment,X=z&&z.length&&z[0]?z[0]:"Power",ee=z&&z.length&&z[1]?z[1]:"Phase Voltage",te=z&&z.length&&z[2]?z[1]:"Voltage",ne=z&&z.length&&z[3]?z[1]:"Frequency",ae=z&&z.length&&z[4]?z[1]:"Energy Sum Resettable",le=z&&z.length&&z[5]?z[1]:"Positive Energy Sum Non-resettable";return a.createElement(a.Fragment,null,z.indexOf("Power")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(S&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:C.sensedValue,onChange:function(e){u.selectAlarmPoint1(e.target.value)}},M.filter(function(e){return"PowerA"==e.sensedValue||"PowerB"==e.sensedValue||"PowerB"==e.sensedValue||"PowerC"==e.sensedValue||"PowerSum"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),S&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==X})&&K.find(function(e){return e.graph==X}).pointEquip.length?K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Power"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==X})&&K.find(function(e){return e.graph==X}).pointEquip.length?K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==X})&&K.find(function(e){return e.graph==X}).pointEquip.length?K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(e=A.columns)||void 0===e?void 0:e.length)>1?A:h,size:{height:300},axis:x,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),z.indexOf("Phase Voltage")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(j&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:G.sensedValue,onChange:function(e){u.selectAlarmPoint2(e.target.value)}},M.filter(function(e){return"VoltAB"==e.sensedValue||"VoltAC"==e.sensedValue||"VoltAB"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),j&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ee})&&K.find(function(e){return e.graph==ee}).pointEquip.length?K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Phase Voltage"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ee})&&K.find(function(e){return e.graph==ee}).pointEquip.length?K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ee})&&K.find(function(e){return e.graph==ee}).pointEquip.length?K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(t=N.columns)||void 0===t?void 0:t.length)>1?N:d,size:{height:300},axis:w,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Voltage")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(k&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:T.sensedValue,onChange:function(e){u.selectAlarmPoint3(e.target.value)}},M.filter(function(e){return"VoltA"==e.sensedValue||"VoltB"==e.sensedValue||"VoltC"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),k&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==te})&&K.find(function(e){return e.graph==te}).pointEquip.length?K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Voltage"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==te})&&K.find(function(e){return e.graph==te}).pointEquip.length?K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==te})&&K.find(function(e){return e.graph==te}).pointEquip.length?K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(n=D.columns)||void 0===n?void 0:n.length)>1?D:p,size:{height:300},axis:E,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Frequency")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(q&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:I.sensedValue,onChange:function(e){u.selectAlarmPoint4(e.target.value)}},M.filter(function(e){return"Freq"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),q&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ne})&&K.find(function(e){return e.graph==ne}).pointEquip.length?K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Frequency"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ne})&&K.find(function(e){return e.graph==ne}).pointEquip.length?K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ne})&&K.find(function(e){return e.graph==ne}).pointEquip.length?K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(l=P.columns)||void 0===l?void 0:l.length)>1?P:g,size:{height:300},axis:b,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Energy Sum Resettable")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(F&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:U.sensedValue,onChange:function(e){u.selectAlarmPoint5(e.target.value)}},M.filter(function(e){return"EnergySumNR"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),F&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ae})&&K.find(function(e){return e.graph==ae}).pointEquip.length?K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-4 sentence-break"}," ","Energy Sum Resettable"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ae})&&K.find(function(e){return e.graph==ae}).pointEquip.length?K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ae})&&K.find(function(e){return e.graph==ae}).pointEquip.length?K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(o=_.columns)||void 0===o?void 0:o.length)>1?_:f,size:{height:300},axis:V,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Positive Energy Sum Non-resettable")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(R&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",M&&M.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:B.sensedValue,onChange:function(e){u.selectAlarmPoint6(e.target.value)}},M.filter(function(e){return"EnergyPosSumNR"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),R&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(r.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==le})&&K.find(function(e){return e.graph==le}).pointEquip.length?K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-4 sentence-break"}," ","Pos. Energy Sum Non-resettable"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==le})&&K.find(function(e){return e.graph==le}).pointEquip.length?K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==le})&&K.find(function(e){return e.graph==le}).pointEquip.length?K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),m?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(s=O.columns)||void 0===s?void 0:s.length)>1?O:v,size:{height:300},axis:y,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=x},2976:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(744)),i=n(1013),o=n(772),s=n.n(o),r=n(760),u=(n.n(r),n(715)),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),m=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function s(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}r((a=a.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var n,a,l,i,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){o.label=i[1];break}if(6===i[0]&&o.label<l[1]){o.label=l[1],l=i;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(i);break}l[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={asisData:[],seasonList:[],graphData1:{x:"Date",columns:[],type:"bar"},grid1:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{count:30,format:"%m-%d"}},y:{label:"kWh",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},graphData2:{x:"Date",columns:[],type:"bar"},grid2:{x:{lines:[{}]},y:{show:!0}},axis2:{x:{type:"timeseries",tick:{count:30,format:"%m-%d"}},y:{label:"kWh",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}},y2:{show:!0,label:"$",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,selectedSeason:""},n._fetchData=n._fetchData.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return m(this,void 0,void 0,function(){return h(this,function(e){return this._fetchData(),[2]})})},t.prototype.fetchVeifyDetail=function(e){return m(this,void 0,void 0,function(){return h(this,function(e){return[2]})})},t.prototype._fetchData=function(){return m(this,void 0,void 0,function(){var e,t,n=this;return h(this,function(a){switch(a.label){case 0:return e=this.props.buildingName,t=this.props.projectName,[4,Object(l.o)(e,"",t).then(function(e){return m(n,void 0,void 0,function(){var t,n,a,o,s,r,u,c,m,d,p,g,f,v,x=this;return h(this,function(h){switch(h.label){case 0:return e&&e[0]&&e[0].ontology?(t=[],0,0,0,0,n=[],a=e[0],[4,Object(l.l)(a.ontology)]):[3,7];case 1:if(!((o=h.sent())&&o.length>0))return[3,7];for((t=o.sort(function(e,t){return e.seasonSequence>t.seasonSequence?1:t.seasonSequence>e.seasonSequence?-1:0})).map(function(e){var t=e.analysisName+": "+(e.seasonType&&"both"==e.seasonType.toLocaleLowerCase().trim()?e.seasonType+": "+("cooling"==e.selectedAnalysis?"Cooling":"Heating"):e.seasonType);n.push({label:t,value:e.ontology})}),s=0;s<t.length;s++)r=t[s],r.totalConsumedEnergyASIS,r.totalConsumedEnergyECM,r.totalConsumedEnergyCostASIS,r.totalConsumedEnergyCostECM;return 0==a.measureAnalysis.length?a.measureAnalysis=[{staticSeasonName:"Summer",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value},{staticSeasonName:"Fall",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value},{staticSeasonName:"Winter",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value},{staticSeasonName:"Spring",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value}]:a.measureAnalysis.length,u=[],c=[],t&&t.length>0?(m=[],d=[],(p=t.sort(function(e,t){return new Date(e.asisStartDate)>new Date(t.asisStartDate)?1:new Date(t.asisStartDate)>new Date(e.asisStartDate)?-1:0}))&&p.length>0?(g=p[0],[4,Object(l.k)(g.importDataASISOntology).then(function(e){u=e?e[0].fileData:[]})]):[3,6]):[3,7];case 2:return h.sent(),[4,Object(l.k)(g.importDataECMOntology).then(function(e){c=e?e[0].fileData:[]})];case 3:return h.sent(),[4,Object(i.c)(u,new Date(g.asisStartDate),new Date(g.asisEndDate),g.noaaStation.value,parseFloat(g.basepointCD),parseFloat(g.basepointHD),g.isMeasureFile)];case 4:return f=h.sent(),[4,Object(i.c)(c,new Date(g.ecmStartDate),new Date(g.ecmEndDate),g.noaaStation.value,parseFloat(g.basepointCD),parseFloat(g.basepointHD),g.isMeasureFile)];case 5:v=h.sent(),m.push.apply(m,f),d.push.apply(d,v),h.label=6;case 6:this.setState({seasonList:t,asisData:u},function(){x.energyConsumptionGraph()}),h.label=7;case 7:return[2]}})})}).catch(function(e){console.log(e)})];case 1:return a.sent(),[2]}})})},t.prototype.energyConsumptionGraph=function(){return m(this,void 0,void 0,function(){var e,t,n,a,l,i,o,s,r,c,m,d,p,g,f,v,x,w,E,b,V,y,L,H;return h(this,function(h){switch(h.label){case 0:e=this.state.asisData,t=this.state,n=t.graphData1,a=t.axis1,l=t.grid1,i=t.graphData2,o=t.axis2,s=t.grid2,r=new Date,c=new Date,r.setMonth(r.getMonth()-1),r.setHours(0,0,0,0),m=["ECM Energy Consumption (Metered)"],d=["Date"],p=["Asis Consumption (Projected)"],g=["Energy Saving"],f=["Energy Savings $ at 10.42 cents per unit"],v=["Tons CO2 emission reduction at 0.000709 tons per unit"],x=new Date(r),h.label=1;case 1:return x<=c?((w=new Date(x)).setHours(23,59,59,0),[4,Object(u.n)("michaels/5_125/wn_basicreg1",x,w,!1)]):[3,4];case 2:E=h.sent(),b=E[0],V=E[E.length-1],b&&V?m.push(""+(V.EnergyPosSum-b.EnergyPosSum)):m.push("0"),d.push(new Date(x)),h.label=3;case 3:return x.setDate(x.getDate()+1),[3,1];case 4:for(y=function(t){var n=new Date(d[t]),a=0;e.filter(function(e){if(+e.Date.split("/")[1]==n.getDate())return e}).forEach(function(e){a+=+e.ValueSum}),p.push(a),l.x.lines.push({value:n,class:"grid4"}),s.x.lines.push({value:n,class:"grid4"})},L=1;L<d.length-1;L++)y(L);for(L=1;L<p.length-1;L++)+p[L]&&+m[L]?(H=+p[L]-+m[L],g.push(H),f.push(.01042*H),v.push(709e-6*H)):(g.push(0),f.push(0));return n={x:"Date",columns:[d,m,p],type:"bar"},i={x:"Date",columns:[d,g,f],groups:[["Energy Saving"]],axes:{"Energy Savings $ at 10.42 cents per unit":"y"},type:"bar",types:{"Energy Savings $ at 10.42 cents per unit":"line"}},a.y.label="KwH",o.y.tick.values=[-2e3,-1e3,0,1e3,2e3],o.y.tick.max=2e3,o.y.tick.min=-2e3,o.y2.tick.values=[-40,-20,0,20,40],o.y2.tick.max=40,o.y2.tick.min=-40,this.setState({loading:!1,graphData1:n,axis1:a,grid1:l,graphData2:i,grid2:s}),[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,n=e.graphData1,l=e.grid1,i=e.axis1,o=e.graphData2,r=e.axis2,u=e.grid2;return a.createElement(a.Fragment,null,a.createElement("div",{className:"row col-md-12 device-graphs mt-22 ",id:"divGraphs"},t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(s.a,{data:n,size:{height:500},axis:i,grid:l,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),a.createElement("div",{className:"row col-md-12 device-graphs mt-22 ",id:"divGraphs"},t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(s.a,{data:o,size:{height:500},axis:r,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=d},875:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:"",generateMaximumExtremeValue:!0,generateMaximumNormalValue:!0,generateMinimumExtremeValue:!0,generateMinimumNormalValue:!0}}});