webpackJsonp([22,59],{1019:function(e,t,n){"use strict";t.g=function(e,t,n,l){return o(this,void 0,void 0,function(){return c(this,function(o){switch(o.label){case 0:return[4,Object(i.f)({model:e,buildingData:t,equipment:n,lightingEquipment:l},i.a.LIFE.SaveProject,a.b.LIFE).then(function(){Object(r.b)("Project saved Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Project.")})];case 1:return[2,o.sent()]}})})},t.r=function(e,t){return o(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,Object(i.e)({buildingName:e,instance:t},i.a.LIFE.GetProjectList,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.m=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({_id:e},i.a.LIFE.DeleteProject,a.b.LIFE).then(function(){Object(r.b)(" Deleted Successfully.")}).catch(function(e){Object(r.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.h=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({model:e},i.a.LIFE.SaveProjectSolution,a.b.LIFE).then(function(){Object(r.b)("Solution saved Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Solution.")})];case 1:return[2,t.sent()]}})})},t.o=function(e,t){return o(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,Object(i.e)({spreadSheetId:e,fileType:t},i.a.LIFE.ExportSheet,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.t=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({projectId:e},i.a.LIFE.GetSolutionList,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.u=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({inspectionOntology:e},i.a.LIFE.GetSolutionListForInspection,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.s=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({solutionId:e},i.a.LIFE.GetSolution,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.n=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({_id:e},i.a.LIFE.DeleteSolution,a.b.LIFE).then(function(){Object(r.b)(" Deleted Successfully.")}).catch(function(e){Object(r.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.v=function(e,t){return o(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,Object(i.f)({manageFile:e,fileData:t},i.a.LIFE.ManageFile,a.b.LIFE).then(function(){Object(r.b)("Upload Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Upload.")})];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return o(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,Object(i.f)({communityFile:e,fileData:t},i.a.LIFE.SaveCommunityFile,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.p=function(e,t){return o(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,Object(i.e)({buildingName:e,instance:t},i.a.LIFE.GetManageFile,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.b=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({instance:e},i.a.LIFE.GetCommunityFile,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.l=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({ManageFile:e},i.a.LIFE.DeleteManageFile,a.b.LIFE).then(function(){Object(r.b)(" Deleted Successfully.")}).catch(function(e){Object(r.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.a=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({communityFile:e},i.a.LIFE.DeleteCommunityFile,a.b.LIFE).then(function(){Object(r.b)(" Deleted Successfully.")}).catch(function(e){Object(r.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.q=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({projectId:e},i.a.LIFE.GetProject,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.f=function(e,t,n){return o(this,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:return[4,Object(i.f)({email:e,buildingName:t,instance:n},i.a.LIFE.SaveEmailAndDrive,a.b.LIFE)];case 1:return[2,r.sent()]}})})},t.j=function(e,t){return o(this,void 0,void 0,function(){return c(this,function(n){switch(n.label){case 0:return[4,Object(i.f)({email:e,instance:t},i.a.LIFE.ShareCommunityFolder,a.b.LIFE).then(function(e){e.result?Object(r.b)("Successfully Share."):Object(r.a)("The user Email is not valid.")}).catch(function(e){Object(r.a)("Something Went Wrong!")})];case 1:return[2,n.sent()]}})})},t.k=function(e,t,n){return o(this,void 0,void 0,function(){return c(this,function(o){switch(o.label){case 0:return[4,Object(i.f)({email:e,buildingName:t,instance:n},i.a.LIFE.ShareMMTemplateFolder,a.b.LIFE).then(function(e){e.result?Object(r.b)("Successfully Share."):Object(r.a)("The user Email is not valid.")}).catch(function(e){Object(r.a)("Something Went Wrong!")})];case 1:return[2,o.sent()]}})})},t.i=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({templatePurpose:e},i.a.LIFE.SaveTemplatePurpose,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.c=function(e){return o(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({instance:e},i.a.LIFE.GetTemplatePurpose,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.d=function(e){var t=e.getFullYear().toString().slice(2,4),n=(e.getMonth()+1).toString().padStart(2,0),i=e.getDate().toString().padStart(2,0),r=e.getHours().toString().padStart(2,0),a=e.getMinutes().toString().padStart(2,0),o=e.getSeconds().toString().padStart(2,0);return t+n+i+r+a+o};var i=n(9),r=n(8),a=n(10),o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,c)}l((i=i.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}},1042:function(e,t,n){"use strict";t.b=function(e,t,n,o){return r(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,Object(i.f)({modelId:e,newModel:t,oldModel:n,user:o},i.a.HistorianArchive.SaveHistorianArchive,"")];case 1:return[2,r.sent()]}})})},t.a=function(e){return r(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,Object(i.d)(i.a.HistorianArchive.GetHistorianArchive,"modelID="+e)];case 1:return[2,t.sent()]}})})};var i=n(9),r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,c)}l((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}},871:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=(n.n(i),n(16)),a=n(21),o=n(13),c=n(1042),l=n(181),s=n(7),u=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),d=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,c)}l((i=i.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={archive:[],versionToRestore:Object(),historianArchiveDifferences:[],sourceTimestamp:Object(),targetTimestamp:Object(),user:"",peopleList:Object()},n.getHistorianArchive=n.getHistorianArchive.bind(n),n.restoreHistorian=n.restoreHistorian.bind(n),n.getPeopleList=n.getPeopleList.bind(n),n}return u(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){return m(this,function(e){switch(e.label){case 0:return this.props.buildingName&&this.props.instance&&this.props.ObjectId?(Object(r.a)(!0),[4,this.getHistorianArchive()]):[3,3];case 1:return e.sent(),[4,this.getPeopleList()];case 2:e.sent(),Object(r.a)(!1),e.label=3;case 3:return[2]}})})},t.prototype.getPeopleList=function(){return d(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,Object(l.m)(this.props.buildingName)];case 1:return e=t.sent(),this.setState({peopleList:e}),[2]}})})},t.prototype.getHistorianArchive=function(){return d(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,Object(c.a)(this.props.ObjectId)];case 1:return e=t.sent(),this.setState({archive:e}),[2]}})})},t.prototype.difference=function(e,t){return d(this,void 0,void 0,function(){var n,i,r,a,o,c;return m(this,function(l){switch(l.label){case 0:return n=this.state.peopleList,e&&e.model&&t&&t.model?(i=JSON.parse(e.model),r=JSON.parse(t.model),[4,this.getDifference(i,r)]):[3,2];case 1:a=l.sent(),o=n.find(function(t){return Object(s.g)(t.contact)==e.createdBy}),c=o&&o.name?Object(s.g)(o.name):"",this.setState({historianArchiveDifferences:a,sourceTimestamp:e.timestamp,targetTimestamp:t.timestamp,user:c},function(){document.getElementById("btnShowDifference").click()}),l.label=2;case 2:return[2]}})})},t.prototype.getDifference=function(e,t,n){return d(this,void 0,Promise,function(){var i,r=this;return m(this,function(a){return i=[],Object.keys(e).forEach(function(a){return d(r,void 0,void 0,function(){var r,o,c,l;return m(this,function(s){switch(s.label){case 0:return r=e&&e[a]?e[a]:"",o=t&&t[a]?t[a]:"","object"!=typeof r?[3,3]:JSON.stringify(r)==JSON.stringify(o)?[3,2]:(c=isNaN(a)?a:n||"",[4,this.getDifference(r,o,c)]);case 1:l=s.sent(),i.push.apply(i,l),s.label=2;case 2:return[3,4];case 3:r!=o&&"value"!=a&&i.push({key:n?n+("label"!=a?" - "+a:""):a,source:r||"",target:o||""}),s.label=4;case 4:return[2]}})})}),[2,i]})})},t.prototype.restoreHistorian=function(){return d(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return(e=this.state.versionToRestore)&&e.model&&this.props.restoreSelectedVersion(e),[4,this.getHistorianArchive()];case 1:return t.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props.instance,n=this.state,r=n.archive,c=n.versionToRestore,l=n.historianArchiveDifferences,s=n.sourceTimestamp,u=n.targetTimestamp,d=n.user;return i.createElement("div",{className:"card",id:"HistorianArchiveList"},i.createElement("div",{className:"container-fluid"},i.createElement("div",{className:"content"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement("h3",null,"Historian Archive"))),i.createElement("br",null),i.createElement("div",{className:"row no-margin"},i.createElement("div",{className:"hidden-xs col-md-10 col-md-offset-1 col-md-offset-right-1 no-padding cell_border",style:{marginBottom:"0px"}},i.createElement("div",{className:"col-md-12 bgcol trim-data headingText",style:{padding:"10px"}},"Timestamp"))),i.createElement("div",{className:"dataCard"},i.createElement("div",{className:"hidden"}),r&&r.length>0&&r.map(function(t,n){return i.createElement("div",{className:"col-md-10 cell_border no-padding col-md-offset-1 col-md-offset-right-1 clickable"},i.createElement("div",{className:"row no-margin hover"},i.createElement("div",{className:"col-md-4 padding-10"},i.createElement("span",{className:"hidden visible-xs-inline headingText"},"Timestamp"),"  ",t.timestamp.ToEasternDateTime()),i.createElement("div",{className:"col-md-8"},0!=n&&i.createElement("button",{className:"btn btn-sm btn-success btn-fill pull-right margin-5 mr-0",title:"Restore this version",onClick:function(n){e.setState({versionToRestore:t},function(){document.getElementById("btnConfirmRestore").click()})}},"Restore this version  "),n!=r.length-1&&i.createElement("button",{className:"btn btn-sm btn-primary btn-fill pull-right margin-5 mr-0",title:"Difference with previous version",onClick:function(i){n!=r.length-1&&e.difference(t,r[n+1])}},"Difference with previous version   "),0!=n&&i.createElement("button",{className:" btn btn-sm btn-primary btn-fill pull-right margin-5 mr-0",title:"Difference with latest version",onClick:function(i){0!=n&&e.difference(t,r[0])}},"Difference with latest version   "))))})),i.createElement("button",{id:"btnConfirmRestore",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmRestoreDialog"},"."),i.createElement(a.a,{instance:t,id:"ConfirmRestoreDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:'Are you sure to Restore "'+(c&&c.timestamp?c.timestamp.ToEasternDateTime():"")+'" Version?',heading:"Confirm...",onConfirmButtonClick:function(){e.restoreHistorian()}}),i.createElement("button",{type:"button",id:"btnShowDifference",className:"hidden","data-toggle":"modal","data-target":"#ShowDifference"}," "),i.createElement(o.a,{id:"ShowDifference",heading:"Difference",saveButtonText:"Done",onSaveButtonClick:function(){},isEditForm:!0},i.createElement("div",{className:"scroll-y",style:{maxHeight:500}},i.createElement("div",{className:"container-fluid",style:{paddingLeft:"0px"}},i.createElement("div",{className:"content",style:{paddingTop:"0px"}},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12",style:{margin:"0px 10px"}},i.createElement("p",{className:"padding-5 small pull-left cell_border hover",style:{borderRadius:"5px",background:"rgb(220 220 220 / 21%)",color:"black"}},i.createElement("b",{style:{color:"gray"}},"Updated By: \xa0")," ",d,", (",new Date(s&&s).ToEasternDateTime(),")")),l&&l.length>0&&s&&u&&i.createElement("div",{className:"col-md-12",style:{margin:"10px"}},i.createElement("div",{className:"col-md-6 cell_border no-padding center",style:{background:"#dcdcdc94",borderRadius:"50px"}},i.createElement("h4",{className:"margin-10"},s&&s.ToEasternDateTime())),i.createElement("div",{className:"col-md-6 cell_border no-padding center",style:{background:"gainsboro",borderRadius:"50px"}},i.createElement("h4",{className:"margin-10"},u&&u.ToEasternDateTime()))),l&&l.length>0&&l.map(function(e){return i.createElement("div",{className:"col-md-12",style:{margin:"10px"}},i.createElement("div",{className:"col-md-12 no-padding cell_border border-radius"},i.createElement("div",{className:"col-md-12 padding-10 center cell_border",style:{background:"ghostwhite"}},i.createElement("h5",{className:"no-margin",style:{textTransform:"uppercase",padding:"2px"}},i.createElement("b",null,"Attribute:")," ",i.createElement("span",{className:"text-primary"},e.key))),i.createElement("div",{className:"col-md-6 padding-10 center cell_border",style:{background:"#dcdcdc94"}},e.source?e.source:"-"),i.createElement("div",{className:"col-md-6 padding-10 center cell_border",style:{background:"gainsboro"}},e.target?e.target:"-")))})))))))),i.createElement("br",null),i.createElement("br",null),i.createElement("br",null),i.createElement("br",null),i.createElement("br",null),i.createElement("br",null))))},t}(i.Component);t.default=f},954:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=(n.n(i),n(13)),a=n(1019),o=n(16),c=n(14),l=n(42),s=n(7),u=n(871),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),m=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function c(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,c)}l((i=i.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={SolutionList:[],SolutionObj:Object(),solutionSelected:[],projectData:Object(),workflowList:[],isHistorian:!1},n.onChangeHandler=n.onChangeHandler.bind(n),n.updateSolutionlist=n.updateSolutionlist.bind(n),n.addSolutionObj=n.addSolutionObj.bind(n),n._deleteSolution=n._deleteSolution.bind(n),n._getSolutionList=n._getSolutionList.bind(n),n.onChangeSelection=n.onChangeSelection.bind(n),n._exportSheet=n._exportSheet.bind(n),n._getProject=n._getProject.bind(n),n.fetchWorkflow=n.fetchWorkflow.bind(n),n.onInspectionSelection=n.onInspectionSelection.bind(n),n.restoreSelectedVersion=n.restoreSelectedVersion.bind(n),n}return d(t,e),t.prototype.componentDidMount=function(){return m(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return this.props.projectId?(this._getProject(this.props.projectId),[4,this._getSolutionList()]):[3,2];case 1:e.sent(),e.label=2;case 2:return this.props.buildingName&&this.fetchWorkflow(this.props.buildingName),[2]}})})},t.prototype._getProject=function(e){return m(this,void 0,void 0,function(){var t=this;return f(this,function(n){switch(n.label){case 0:return Object(o.a)(!0),e.length>0?[4,Object(a.q)(e).then(function(e){t.setState({projectData:e},function(){return m(t,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this._getSolutionList()];case 1:return e.sent(),[2]}})})})})]:[3,2];case 1:n.sent(),n.label=2;case 2:return Object(o.a)(!1),[2]}})})},t.prototype._exportSheet=function(e){return m(this,void 0,void 0,function(){var t,n,i,r,c,l,s,u,d,m,h;return f(this,function(f){switch(f.label){case 0:return t=this.state.SolutionList,n=t[0].spreadSheetId,i=t[0].solutionTitle,n?(Object(o.a)(!0),r=void 0,[4,Object(a.o)(n,e)]):[3,2];case 1:for((c=f.sent())&&(r=window.atob(c)),l=r.length,s=new Uint8Array(l),u=0;u<l;u++)d=r.charCodeAt(u),s[u]=d;Object(o.a)(!1),e?(m=new Blob([s],{type:"application/pdf"}),(h=document.createElement("a")).href=window.URL.createObjectURL(m),h.download=i+".pdf",h.click()):(m=new Blob([s],{type:"application/xlsx"}),(h=document.createElement("a")).href=window.URL.createObjectURL(m),h.download=i+".xlsx",h.click()),f.label=2;case 2:return[2]}})})},t.prototype.onChangeSelection=function(e,t){for(var n=this.state.SolutionList,i=[],r=0;r<n.length;r++){var a=n[r];r==t&&(a.active=e.target.checked,i.push(a))}this.setState({solutionSelected:i})},t.prototype.onInspectionSelection=function(e){var t=this.state.SolutionObj;t.inspection=e.target.value,this.setState({SolutionObj:t})},t.prototype._getSolutionList=function(){return m(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){switch(n.label){case 0:return(e=this.props.projectId)?[4,Object(a.t)(e).then(function(e){e.forEach(function(e){Object(c.r)(e._id,e.solutionTitle)}),t.setState({SolutionList:e})})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.updateSolutionlist=function(){return m(this,void 0,void 0,function(){var e,t,n,i,r,c,l=this;return f(this,function(s){switch(s.label){case 0:return e=this.props.projectId,t=this.state,n=t.SolutionObj,i=t.SolutionList,r=t.projectData,c=i&&i.find(function(e){return e._id==n._id}),Object(o.a)(!0),c&&c._id.length>0?[4,Object(a.h)(n).then(function(e){}).catch(function(e){console.log("error: ",e)})]:[3,2];case 1:return s.sent(),this.setState({SolutionObj:Object()},function(){return m(l,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this._getSolutionList()];case 1:return e.sent(),[2]}})})}),[3,4];case 2:return n.spreadSheetId=r.templateId,e?(n.projectId=e,n.projectId.length>0?[4,Object(a.h)(n).then(function(e){}).catch(function(e){console.log("error: ",e)})]:[3,4]):[3,4];case 3:s.sent(),this.setState({SolutionObj:Object()},function(){return m(l,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this._getSolutionList()];case 1:return e.sent(),[2]}})})}),s.label=4;case 4:return Object(o.a)(!1),[2]}})})},t.prototype.onChangeHandler=function(e,t){var n=this.state.SolutionObj;n[e]=t,this.setState({SolutionObj:n})},t.prototype.addSolutionObj=function(){var e={financialAssumptionsID:"",assigned:"",serviceBidders:"",solutionDescription:"",status:"",projectTitle:this.state.projectData.projectTitle,solutionTitle:"",inspection:""};this.setState({SolutionObj:e}),document.getElementById("editSolutionbtn").click()},t.prototype._deleteSolution=function(e){return m(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return e.length>0?[4,Object(a.n)(e)]:[3,3];case 1:return t.sent(),[4,this._getSolutionList()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.fetchWorkflow=function(e){return m(this,void 0,void 0,function(){var t=this;return f(this,function(n){switch(n.label){case 0:return e?[4,Object(l.k)(e).then(function(e){var n=[];if(e&&e.length&&Object(s.g)(e[0].ontology))for(var i=0;i<e.length;i++){var r=Object(),a=e[i];r.ca="true"==Object(s.g)(a.ca),r.ecm="true"==Object(s.g)(a.ecm),r.rcx="true"==Object(s.g)(a.rcx),r.other="true"==Object(s.g)(a.other),r.isTemplate="true"==Object(s.g)(a.isTemplate),r.dateOfStart=Object(s.g)(a.dateOfStart),r.description=Object(s.g)(a.description),r.finishDate=Object(s.g)(a.finishDate),r.lead=Object(s.g)(a.lead),r.ontology=Object(s.g)(a.ontology),n.push.apply(n,[r])}t.setState({workflowList:n})}).catch(function(e){})]:[3,2];case 1:n.sent(),Object(o.a)(!1),n.label=2;case 2:return[2]}})})},t.prototype.restoreSelectedVersion=function(e){return m(this,void 0,void 0,function(){var t;return f(this,function(n){switch(n.label){case 0:return e&&e.model?((t=JSON.parse(e.model)).lastUpdated=(new Date).toString(),[4,Object(a.g)(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,a=t.instance,o=t.projectId,c=this.state,l=c.SolutionList,s=c.SolutionObj,d=c.projectData,m=c.workflowList,f=c.isHistorian;return i.createElement(i.Fragment,null,f&&i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement("button",{className:"btn btn-success pull-right active custom-outline-btn",style:{marginLeft:3,marginTop:5},onClick:function(){e.setState({isHistorian:!1})}}," Go Back To ",d.projectTitle))),f&&i.createElement(u.default,{buildingName:n,instance:a,ObjectId:o,restoreSelectedVersion:this.restoreSelectedVersion}),!f&&i.createElement("div",{className:"content"},i.createElement("div",{className:"container-fluid"},i.createElement("div",{className:""},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement("div",{className:"col-md-3 col-sm-12",style:{display:"inline-flex"}},i.createElement("h4",{className:"margin-5"},"Project Title: ",d.projectTitle)),i.createElement("button",{style:{marginLeft:3,marginTop:5},className:"btn btn-dark btn-fill dropdown-toggle pull-right",type:"button","data-toggle":"dropdown"},i.createElement("span",null," Export"),i.createElement("b",{className:"caret"})),i.createElement("ul",{className:"dropdown-menu pull-right"},i.createElement("li",{onClick:function(){e._exportSheet()}},i.createElement("a",{href:"javascript:void(0)"},i.createElement("i",{className:"fa fa-file"})," Excel")),i.createElement("li",{onClick:function(){e._exportSheet(!0)}},i.createElement("a",{href:"javascript:void(0)"},i.createElement("i",{className:"fa fa-file"})," PDF"))),i.createElement("button",{type:"button",className:"btn btn-success pull-right active custom-outline-btn",onClick:function(){e.addSolutionObj()}},i.createElement("span",null,"Add"),i.createElement("i",{className:"fa fa-plus"}))," \xa0",i.createElement("button",{type:"button",className:"btn btn-danger pull-right active custom-outline-btn",onClick:function(){window.location.hash=a+"/"+n+"/Risk"}}," Risk "),i.createElement("button",{className:"btn btn-success pull-right active custom-outline-btn",onClick:function(){e.setState({isHistorian:!0})}}," ",i.createElement("i",{className:"fa fa-history","aria-hidden":"true"})," Historian Archive"))),i.createElement("br",null),i.createElement("div",{className:"card padding-10"},i.createElement("div",{className:"container-fluid"},i.createElement("div",{className:"dataCard"},i.createElement("div",{className:"row no-padding  hidden-xs hidden-sm"},i.createElement("div",{className:"col-md-2 small trim-data grid-header"},"Solution Title"),i.createElement("div",{className:"col-md-2 small trim-data grid-header"},"Solution Description"),i.createElement("div",{className:"col-md-1 small trim-data grid-header"},"Status"),i.createElement("div",{className:"col-md-2 small trim-data grid-header"},"Service Bidders"),i.createElement("div",{className:"col-md-1 small trim-data grid-header"},"Assigned"),i.createElement("div",{className:"col-md-4 small trim-data grid-header"},"\xa0")),l&&l.length>0&&l.map(function(t,r){return i.createElement("div",{className:"row no-padding",key:r},i.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12 small trim-data padding-10"},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Solution Title"),i.createElement("a",{href:"#"+a+"/"+n+"/Solution/"+t._id,title:t.solutionTitle},t.solutionTitle)),i.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12 small trim-data padding-10"},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Solution Description"),t.solutionDescription),i.createElement("div",{className:"col-md-1 col-sm-12 col-xs-12 small trim-data padding-10"},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Status"),t.status),i.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12 small trim-data padding-10"},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Service Bidders"),t.serviceBidders),i.createElement("div",{className:"col-md-1 col-sm-12 col-xs-12 small trim-data padding-10"},i.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Assigned"),t.assigned),i.createElement("div",{className:"col-md-3 col-sm-12 col-xs-12 center padding-5",style:{display:"inline-block",paddingTop:"7px"}},i.createElement("a",{className:"btn-sm btn-danger active custom-outline-btn trim-data",onClick:function(){window.location.hash=a+"/"+n+"/Risk"}}," Risk "),i.createElement("a",{className:"btn-sm btn-success active custom-outline-btn trim-data"}," LCA "),i.createElement("a",{className:"btn-sm btn-primary active custom-outline-btn trim-data",onClick:function(){e.setState({SolutionObj:t}),document.getElementById("editSolutionbtn").click()}},"  Edit "),i.createElement("a",{className:"btn-sm btn-danger active custom-outline-btn trim-data",onClick:function(){e._deleteSolution(t._id)}}," Delete ")),i.createElement("div",{className:"col-md-1 col-sm-12 col-xs-12 padding-5",style:{display:"inline-block",paddingTop:"7px"}},i.createElement("input",{className:"trim-data active",type:"checkbox",checked:t.active,onClick:function(t){e.onChangeSelection(t,r)}})))})))))),i.createElement("button",{id:"editSolutionbtn",className:"hidden","data-toggle":"modal","data-target":"#editSolution",title:"Add"}," ",i.createElement("i",{className:"fa fa-plus"})," "),i.createElement(r.a,{id:"editSolution",heading:s&&""==s.solutionTitle?"Add Solution":s.solutionTitle,saveButtonText:l&&l.length>0&&l.indexOf(s)>-1?"Update":"Add",isEditForm:!0,onSaveButtonClick:function(){e.updateSolutionlist()},disableSaveButton:!s.solutionTitle},i.createElement("div",{className:"content dataCard"},i.createElement("div",{className:""},i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4 headingText padding-10"},"Project Title:"),i.createElement("div",{className:"col-md-8"},i.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},disabled:!0,type:"text",name:"projectTitle",value:s.projectTitle,className:"form-control cell_border"}))),i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4 headingText padding-10"},"Solution Title:"),i.createElement("div",{className:"col-md-8"},i.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"solutionTitle",value:s.solutionTitle,className:"form-control cell_border"})))),i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4 headingText padding-10 trim-data"},"Solution Description:"),i.createElement("div",{className:"col-md-8"},i.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"solutionDescription",value:s.solutionDescription,className:"form-control cell_border"}))),i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4 headingText padding-10"},"Status:"),i.createElement("div",{className:"col-md-8"},i.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"status",value:s.status,className:"form-control cell_border"})))),i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4 headingText padding-10"},"Service Bidders:"),i.createElement("div",{className:"col-md-8"},i.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"serviceBidders",value:s.serviceBidders,className:"form-control cell_border"}))),i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4 headingText padding-10"},"Assigned:"),i.createElement("div",{className:"col-md-8",style:{paddingTop:"10px"}},i.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"assigned",value:s.assigned,className:"form-control cell_border"})))),i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"col-md-4"},i.createElement("label",{htmlFor:"coiltype"},"Select Inspection:")),i.createElement("div",{className:"col-md-8"},i.createElement("select",{id:"inspection",className:"form-control",value:s.inspection,onChange:function(t){e.onInspectionSelection(t)}},i.createElement("option",{value:"",key:-2},"Select Inspection"),m&&m.filter(function(e){return 1!=e.isTemplate}).map(function(e,t){return i.createElement("option",{key:t,className:"trim-data",value:e.ontology},e.description," ")}))))))))))},t}(i.Component);t.default=h}});