webpackJsonp([57,91],{3265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"ZonesForm",function(){return C});var r,a=n(2),i=(n.n(a),n(1102)),o=n(119),l=n(116),s=n(657),c=n(667),d=n(10),u=n(763),m=n(669),p=n(23),h=n(661),v=n(658),f=n(11),b=n(666),g=n(776),y=n(773),E=n(1403),N=n(651),S=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=this&&this.__assign||function(){return(w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},O=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,l)}s((r=r.apply(e,t||[])).next())})},j=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={Zone:Object(),oldModel:Object(),_spaceList:[],_zoneTypes:[],spaceDropDownList:[],deviceList:[],_serviceProvidersList:[],isEdit:!1,isView:!0,devicesOriginalList:[],relayDevices:[],isHistorian:!1,newFloor:Object()},r=n,n.handleZoneTypeChange=n.handleZoneTypeChange.bind(n),n.handleServiceProviderChange=n.handleServiceProviderChange.bind(n),n.handleServiceTypeChange=n.handleServiceTypeChange.bind(n),n.handleSubServiceProviderChange=n.handleSubServiceProviderChange.bind(n),n.handleMonconChange=n.handleMonconChange.bind(n),n.handleMonConDeviceTypeChange=n.handleMonConDeviceTypeChange.bind(n),n.handleDeviceList=n.handleDeviceList.bind(n),n.handleRelayDevices=n.handleRelayDevices.bind(n),n.onZoneChange=n.onZoneChange.bind(n),n.handleMultiSubServiceProviderChange=n.handleMultiSubServiceProviderChange.bind(n),n._fetchZone=n._fetchZone.bind(n),n.getMultiSelectDropDownLabel=n.getMultiSelectDropDownLabel.bind(n),n._fetchServiceProvidersList=n._fetchServiceProvidersList.bind(n),n.handleControllerEndPointChange=n.handleControllerEndPointChange.bind(n),n.fetchDevicesList=n.fetchDevicesList.bind(n),n._getSpacesList=n._getSpacesList.bind(n),n.restoreSelectedVersion=n.restoreSelectedVersion.bind(n),n.oldModel=n.oldModel.bind(n),n.createFloor=n.createFloor.bind(n),n.handleFloorChange=n.handleFloorChange.bind(n),n}return S(t,e),t.prototype.componentWillMount=function(){return O(this,void 0,void 0,function(){return j(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._getSpacesList()]:[3,4];case 1:return e.sent(),[4,this._getZoneTypesList()];case 2:return e.sent(),[4,this.fetchDevicesList()];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.oldModel=function(){},t.prototype.componentDidMount=function(){return O(this,void 0,void 0,function(){var e,t,n,r=this;return j(this,function(a){switch(a.label){case 0:return this.props.buildingName&&((e=this.props.zoneName)&&e.length>0?setTimeout(function(){return O(r,void 0,void 0,function(){return j(this,function(e){switch(e.label){case 0:return[4,this._fetchZone()];case 1:return e.sent(),[2]}})})},1e3):this.setState({Zone:Object(),isEdit:!1}),t=this.state._spaceList.map(function(e){return{value:Object(d.g)(e.ontology),label:Object(d.g)(e.rdfsLabel)}}),this.setState({spaceDropDownList:t})),this.props.zoneName?(n=this.state.newFloor,[4,Object(c.a)(this.props.buildingName,this.props.zoneName).then(function(e){return O(r,void 0,void 0,function(){var t;return j(this,function(r){return e&&e[0]&&e[0].zone&&(t=e[0],n.floor=Object(d.g)(t.zone),n.rdfsLabel=Object(d.g)(t.rdfsLabel),n.linkBimism=Object(d.g)(t.linkBimism),n.bimSid=Object(d.g)(t.bimSid),n.bimFloor=Object(d.g)(t.type),this.setState({newFloor:n},function(){})),[2]})})})]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.fetchDevicesList=function(){return O(this,void 0,void 0,function(){var e,t;return j(this,function(n){switch(n.label){case 0:return[4,Object(v.w)(this.props.buildingName,!0)];case 1:return e=n.sent(),t=e&&e.length>0&&e.map(function(e){return{value:Object(d.g)(e.moncondevice),label:Object(d.g)(e.rdfsLabel)}}),this.setState({deviceList:t,devicesOriginalList:e}),[2]}})})},t.prototype._fetchZone=function(){return O(this,void 0,void 0,function(){var e=this;return j(this,function(t){switch(t.label){case 0:return[4,Object(c.a)(this.props.buildingName,this.props.zoneName).then(function(t){return O(e,void 0,void 0,function(){var e,n,a,i,o=this;return j(this,function(l){switch(l.label){case 0:return e=t[0],n=Object(),t.length>0?(a=[],e.controllerendpoint&&Object(d.g)(e.controllerendpoint)&&(a=Object(d.g)(e.controllerendpoint).indexOf(",")>0?Object(d.g)(e.controllerendpoint).split(","):[Object(d.g)(e.controllerendpoint)],n.controllerEndPoint=a.map(function(e,t){return{label:o.getMultiSelectDropDownLabel(e,o.state.deviceList),value:e}})),n.name=Object(d.g)(e.zone),n.rdfsLabel=Object(d.g)(e.rdfsLabel),n.type=Object(d.g)(e.type),n.zoneNo=Object(d.g)(e.zoneNo),[4,r._fetchServiceProvidersList(n.type)]):[3,4];case 1:return l.sent(),n.serviceType=Object(d.g)(e.servicetype),i=[],e.serviceprovider&&Object(d.g)(e.serviceprovider)&&(i=Object(d.g)(e.serviceprovider).indexOf(",")>0?Object(d.g)(e.serviceprovider).split(","):[Object(d.g)(e.serviceprovider)],n.serviceProvider=i.map(function(e,t){return{label:o.getMultiSelectDropDownLabel(e,o.state._serviceProvidersList),value:e}})),n.subServiceProvider=Object(d.g)(e.subserviceprovider),n.serviceType=Object(d.g)(e.servicetype),n.notes=Object(d.g)(e.notes),console.log(n),e.relayDevice&&Object(d.g)(e.relayDevice)?[4,this.fetchRelayControlSettings(n.controllerEndPoint[0].value).then(function(){var t=o.state.relayDevices;if(t){var r=Object(d.g)(e.relayDevice).indexOf(",")>0?Object(d.g)(e.relayDevice).split(","):[Object(d.g)(e.relayDevice)];n.relayDevice=[];for(var a=function(e){var a=r[e],i=t.find(function(e){return e.value==a});i&&n.relayDevice.push(i)},i=0;i<r.length;i++)a(i)}})]:[3,3];case 2:l.sent(),l.label=3;case 3:return e.selectedSpaces&&(n.selectedSpaces=e.selectedSpaces?Object(d.g)(e.selectedSpaces).split(",").map(function(e){return{label:o.getMultiSelectDropDownLabel(e,o.state.spaceDropDownList),value:e}}):[]),this.setState({Zone:n,oldModel:w({},n),isEdit:!this.props.isView&&!0}),[3,5];case 4:this.setState({Zone:Object(),isEdit:!1}),l.label=5;case 5:return[2]}})})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype.getMultiSelectDropDownLabel=function(e,t){var n=t,r=Object();return(r=n&&n.find(function(t){return t.value==e}))&&r.label},t.prototype._fetchServiceProvidersList=function(e){return O(this,void 0,void 0,function(){var t;return j(this,function(n){switch(n.label){case 0:return t=[],Object(l.a)(!0),"zoneHeat"==e&&(e="both"),[4,Object(c.g)(this.props.buildingName,e).then(function(e){for(var n=0;n<e.length;n++){var a={value:Object(d.g)(e[n].ontology),label:Object(d.g)(e[n].rdfsLabel)};t&&t.push(a)}r.setState({_serviceProvidersList:t})}).catch(function(e){return e})];case 1:return n.sent(),Object(l.a)(!1),[2]}})})},t.prototype.fetchRelayControlSettings=function(e){return O(this,void 0,void 0,function(){var t,n,r,a,i,o,l,s;return j(this,function(c){switch(c.label){case 0:return t=this.state.Zone,n=this.state.relayDevices,n=[],t.controllerEndPoint||t.controllerEndPoint[0]?(e||(e=t.controllerEndPoint[0].value),[4,Object(b.x)(e)]):[2];case 1:return(r=c.sent())[0]?(a=r[0],i=Object(d.g)(a.relayNames),o=i.split(","),n=o.map(function(e){return{value:e,label:e}}),[3,4]):[3,2];case 2:return l=this.props.buildingName,[4,Object(v.t)(e,l)];case 3:(s=c.sent())&&s.monitoringControlDeviceType&&-1==s.monitoringControlDeviceType.indexOf("OneRelay")?(n.push({label:"Relay 1",value:"Relay 1"}),n.push({label:"Relay 2",value:"Relay 2"}),n.push({label:"Relay 3",value:"Relay 3"}),n.push({label:"Relay 4",value:"Relay 4"})):n.push({label:"Relay",value:"Relay"}),c.label=4;case 4:return this.setState({relayDevices:n}),[2]}})})},t.prototype._getSpacesList=function(){return O(this,void 0,void 0,function(){var e,t=this;return j(this,function(n){switch(n.label){case 0:return e=this.props.buildingName,[4,Object(s.b)(e).then(function(e){var n=e.map(function(e){return{value:Object(d.g)(e.ontology),label:Object(d.g)(e.rdfsLabel)}});t.setState({_spaceList:e,spaceDropDownList:n})})];case 1:return n.sent(),[2]}})})},t.prototype._getZoneTypesList=function(){return O(this,void 0,void 0,function(){var e,t=this;return j(this,function(n){switch(n.label){case 0:return e=this.props.buildingName,[4,Object(c.h)(e).then(function(e){t.setState({_zoneTypes:e})})];case 1:return n.sent(),[2]}})})},t.prototype.handleDeviceList=function(){var e,t=this.state,n=t.Zone,r=t.devicesOriginalList;e=-1!=n.type.toLowerCase().indexOf("light")?r&&r.length>0&&r.filter(function(e){return-1!=Object(d.g)(e.moncontype).toLowerCase().indexOf("relay")}).map(function(e){return{value:Object(d.g)(e.moncondevice),label:Object(d.g)(e.rdfsLabel)}}):r&&r.length>0&&r.map(function(e){return{value:Object(d.g)(e.moncondevice),label:Object(d.g)(e.rdfsLabel)}}),n.controllerEndPoint=[],this.setState({deviceList:e})},t.prototype.handleRelayDevices=function(e){if(!this.props.isView){var t=this.state.Zone;t.relayDevice=e,this.setState({Zone:t})}},t.prototype.handleNameChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.rdfsLabel=e,this.setState({Zone:t})}},t.prototype.handleZoneNoChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.zoneNo=e,this.setState({Zone:t})}},t.prototype.handleZoneTypeChange=function(e){var t=this;if(!this.props.isView){var n=this.state.Zone,r=this.state.newFloor;n.type=e,"Floor"==e&&(r.rdfsLabel=n.rdfsLabel),this.setState({Zone:n,newFloor:r},function(){t._fetchServiceProvidersList(e)}),this.handleDeviceList()}},t.prototype.handleMonConDeviceTypeChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.monitoringControlDeviceType=e,this.setState({Zone:t})}},t.prototype.handleServiceProviderChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.serviceProvider=e,this.setState({Zone:t})}},t.prototype.handleControllerEndPointChange=function(e){var t=this;if(!this.props.isView){var n=this.state.Zone;n.controllerEndPoint=[],n.controllerEndPoint.push(e),this.setState({Zone:n},function(){t.fetchRelayControlSettings()})}},t.prototype.handleServiceTypeChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.serviceType=e,this.setState({Zone:t})}},t.prototype.handleSubServiceProviderChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.subServiceProvider=e,this.setState({Zone:t})}},t.prototype.handleMultiSubServiceProviderChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.selectedSpaces=e,this.setState({Zone:t})}},t.prototype.handleMonconChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.moncon=e,this.setState({Zone:t})}},t.prototype.onZoneChange=function(e){this.props.isView||this.setState({Zone:e})},t.prototype.handleNotesChange=function(e){if(!this.props.isView){var t=this.state.Zone;t.notes=e,this.setState({Zone:t})}},t.prototype.saveZone=function(e){return O(this,void 0,void 0,function(){var t,n,r,a,i,o,s,d,u,m;return j(this,function(h){switch(h.label){case 0:return t=this.props,n=t.instance,r=t.buildingName,a=this.state,i=a.Zone,o=a.oldModel,(s=this.state.isEdit)?(Object(l.a)(!0),[4,Object(c.d)(r,i.name)]):[3,2];case 1:h.sent(),Object(l.a)(!1),h.label=2;case 2:return i.name=i.name?i.name:Object(p.t)(7),e?(d=e||i,u=i):(d=i,u=s?o:null),[4,Object(c.c)(d,r)];case 3:return h.sent(),m=JSON.parse(f.a.getItem("user")),Object(y.b)(i.name,d,u,m.contact),window.location.hash=n+"/"+r+"/Zones",[2]}})})},t.prototype.restoreSelectedVersion=function(e){return O(this,void 0,void 0,function(){var t;return j(this,function(n){switch(n.label){case 0:return e&&e.model?(t=JSON.parse(e.model),[4,this.saveZone(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.createFloor=function(){return O(this,void 0,void 0,function(){var e;return j(this,function(t){switch(t.label){case 0:return(e=this.state.newFloor)&&e.rdfsLabel?(e.floor=e.floor?e.floor:Object(p.t)(7),[4,Object(c.b)(this.props.buildingName,e)]):[3,2];case 1:t.sent(),this.setState({newFloor:{floor:"",rdfsLabel:"",linkBimism:"",bimFloor:"",bimSid:"",xScaleMap:"",xOffsetMap:"",yScaleMap:"",yOffsetMap:""}}),t.label=2;case 2:return[2]}})})},t.prototype.handleFloorChange=function(e){return O(this,void 0,void 0,function(){return j(this,function(e){return console.log("clicked"),[2]})})},t.prototype.render=function(){var e=this,t=this.props,n=t.isView,r=void 0!==n&&n,l=t.instance,s=t.buildingName,c=t.zoneName,d=this.state,v=d.Zone,b=d._zoneTypes,y=d._serviceProvidersList,S=d.deviceList,w=void 0===S?[]:S,O=d.spaceDropDownList,j=d.relayDevices,C=d.isHistorian,D=d.newFloor;w||(w=[]);var L=JSON.parse(f.a.getItem("user")),T=Object(m.b)(L,"info-zone","write"),_=v&&v.rdfsLabel&&v.type&&!0,Z=v.type&&"Floor"==v.type;return a.createElement("div",{className:"content",style:{marginTop:"-15px"}},a.createElement("div",{className:"container-fluid"},a.createElement(o.a.Consumer,null,function(t){return a.createElement(a.Fragment,null,C&&a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("button",{className:"btn btn-success pull-right active",style:{marginLeft:3,marginTop:5},onClick:function(){e.setState({isHistorian:!1})}}," Go Back To ")),a.createElement("div",{className:"col-md-12"},a.createElement("br",null))),C&&a.createElement(g.default,{buildingName:s,instance:l,ObjectId:v.name,restoreSelectedVersion:e.restoreSelectedVersion}),!C&&a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid"},r&&a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-6"},a.createElement(u.a,{instance:l,buildingName:s,tabName:"Zone",itemName:c})),a.createElement("div",{className:"col-md-6"},T&&a.createElement("button",{className:"btn btn-success pull-right active custom-outline-btn",onClick:function(e){D.bimSid?document.getElementById("btnShowFloorForm").click():setTimeout(function(){c&&v.rdfsLabel&&Object(p.E)(c,v.rdfsLabel),window.location.hash=l+"/"+s+"/EditZone/"+c},200)}},a.createElement("i",{className:"fa fa-edit"})," Edit "),a.createElement("button",{type:"button",id:"btnShowFloorForm",className:"btn btn-primary btn-fill","data-toggle":"modal","data-target":"#floorFormDialog",style:{display:"none"}},"."),a.createElement(N.a,{id:"floorFormDialog",onSaveButtonClick:function(){e.createFloor()},saveButtonText:"Save",disableSaveButton:!(D.rdfsLabel&&D.bimFloor&&D.bimSid&&D.linkBimism)},a.createElement(E.a,{instance:l,buildingName:s,isView:!1,handleFloorChange:e.handleFloorChange,newFloor:D,floorData:e.state.Zone})),a.createElement("button",{className:"btn btn-success pull-right active custom-outline-btn",onClick:function(){e.setState({isHistorian:!0})}}," ",a.createElement("i",{className:"fa fa-history","aria-hidden":"true"})," Historian Archive")))),a.createElement("br",null)),"Floor"==v.type&&D&&c&&r&&a.createElement(E.a,{buildingName:s,instance:l,ontology:c,isView:!0}),a.createElement("div",{className:Z?"":"card",style:{marginLeft:"-23px",marginRight:"-23px"}},a.createElement("div",{className:"container-fluid padding-10"},a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},Z?"":a.createElement("div",null,a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"zonename"},Z?"Floor":"Zone"," Name"))),a.createElement("div",{className:"col-md-4"},a.createElement("input",{type:"text",disabled:r,id:"zonename",className:(v.rdfsLabel?"":"addFieldValidate")+" col-md-4 form-control",value:v.rdfsLabel,onChange:function(t){return e.handleNameChange(t.target.value)}}))),Z&&!r&&a.createElement(E.a,{buildingName:s,instance:l,ontology:"",newFloor:D}),!Z&&!D.bimSid&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"zonetype"},"Zone Type"))),a.createElement("div",{className:"col-md-4"},a.createElement("div",{className:(v.type?"":"addFieldValidate")+" dropdown"},a.createElement("button",{disabled:r,style:r?{cursor:"default"}:{},className:"btn btn-default btn-block dropdown-toggle",type:"button","data-toggle":"dropdown"},v.type&&b&&b.find(function(e){return-1!==e.z.value.indexOf(v.type.substring(3))})?b.find(function(e){return-1!==e.z.value.indexOf(v.type.substring(3))}).zone.value:"Select Zone Type",a.createElement("span",{className:"caret"})),a.createElement("ul",{className:"dropdown-menu"},a.createElement("li",{className:"dropdown-header"},a.createElement("h5",null,a.createElement("b",null,"Space Group"))),b.filter(function(e){return"Space Group"==e.yname.value}).map(function(t,n){return a.createElement("li",{key:n},a.createElement("a",{href:"javascript:void(0);",onClick:function(){return e.handleZoneTypeChange(t.z.value)}},t.zone.value))}),a.createElement("li",{className:"dropdown-header"},a.createElement("h5",null,a.createElement("b",null,"Service Zone"))),b.filter(function(e){return"Service Zone"==e.yname.value}).map(function(t,n){return a.createElement("li",{key:n},a.createElement("a",{href:"javascript:void(0);",onClick:function(){return e.handleZoneTypeChange(t.z.value)}},t.zone.value))}))))))),!Z&&!D.bimSid&&a.createElement(a.Fragment,null,a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"serviceprovider"},"Service Provider"))),a.createElement("div",{className:"col-md-4"},a.createElement("div",null,a.createElement(h.a,{isDisabled:r,closeMenuOnSelect:!1,isMulti:!0,value:v.serviceProvider,onChange:e.handleServiceProviderChange,placeholder:"Service Provider",options:y}))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"servicetype"},"Service Type"))),a.createElement("div",{className:"col-md-4"},a.createElement("select",{className:"form-control",id:"servicetype",disabled:r,onChange:function(t){return e.handleServiceTypeChange(t.target.value)}},a.createElement("option",{value:""},"Select Service Type"),i.b.map(function(e,t){return e.predicate===v.serviceType?a.createElement("option",{key:t,selected:!0,value:e.predicate},e.name):a.createElement("option",{key:t,value:e.predicate},e.name)}))))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"controllerendname"},"Controller EndName"))),a.createElement("div",{className:"col-md-4"},a.createElement("div",null,a.createElement(h.a,{isDisabled:r,closeMenuOnSelect:!0,isMulti:!1,value:v.controllerEndPoint,onChange:e.handleControllerEndPointChange,placeholder:"Select Devices",options:w}))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"zoneNo"},Z?"Floor":"Zone"," No."))),a.createElement("div",{className:"col-md-4"},a.createElement("input",{type:"number",disabled:r,id:"zoneNo",className:"form-control",value:v.zoneNo,onChange:function(t){return e.handleZoneNoChange(t.target.value)}})))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},v.type&&-1!=v.type.toLowerCase().indexOf("light")&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"controllerendname"},"Relay"))),a.createElement("div",{className:"col-md-4"},a.createElement("div",null,a.createElement(h.a,{isDisabled:r,closeMenuOnSelect:!1,isMulti:!0,value:v.relayDevice,onChange:e.handleRelayDevices,placeholder:"Select Relay",options:j})))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"controllerendname"},"Spaces"))),a.createElement("div",{className:"col-md-10"},a.createElement("div",null,a.createElement(h.a,{isDisabled:r,closeMenuOnSelect:!1,isMulti:!0,value:v.selectedSpaces,onChange:e.handleMultiSubServiceProviderChange,placeholder:"Select Spaces",options:O}))))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"notes"},"Notes"))),a.createElement("div",{className:"col-md-10"},a.createElement("input",{type:"text",id:"notes",className:"form-control",disabled:r,value:v.notes,onChange:function(t){return e.handleNotesChange(t.target.value)}}))))),!r&&a.createElement("div",{className:"row"},a.createElement("br",null),a.createElement("br",null),a.createElement("div",{className:"col-md-12 inline-block"},a.createElement("button",{className:"btn btn-primary btn-fill",disabled:!_,onClick:function(){t.onChangeZone(Object()),e.saveZone()}},a.createElement("i",{className:"fa fa-save"})," Save"),a.createElement("button",{className:"btn btn-secondary btn-fill",onClick:function(){window.location.hash=l+"/"+s+"/Zones"}},a.createElement("i",{className:"fa fa-window-close"})," Cancel"))))))))})))},t}(a.Component);t.default=C},776:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=(n.n(r),n(116)),i=n(654),o=n(651),l=n(773),s=n(659),c=n(10),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,l)}s((r=r.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={archive:[],versionToRestore:Object(),historianArchiveDifferences:[],sourceTimestamp:Object(),targetTimestamp:Object(),user:"",peopleList:Object()},n.getHistorianArchive=n.getHistorianArchive.bind(n),n.restoreHistorian=n.restoreHistorian.bind(n),n.getPeopleList=n.getPeopleList.bind(n),n}return d(t,e),t.prototype.componentDidMount=function(){return u(this,void 0,void 0,function(){return m(this,function(e){switch(e.label){case 0:return this.props.buildingName&&this.props.instance&&this.props.ObjectId?(Object(a.a)(!0),[4,this.getHistorianArchive()]):[3,3];case 1:return e.sent(),[4,this.getPeopleList()];case 2:e.sent(),Object(a.a)(!1),e.label=3;case 3:return[2]}})})},t.prototype.getPeopleList=function(){return u(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,Object(s.s)(this.props.buildingName)];case 1:return e=t.sent(),this.setState({peopleList:e}),[2]}})})},t.prototype.getHistorianArchive=function(){return u(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,Object(l.a)(this.props.ObjectId)];case 1:return e=t.sent(),this.setState({archive:e}),[2]}})})},t.prototype.difference=function(e,t){return u(this,void 0,void 0,function(){var n,r,a,i,o,l;return m(this,function(s){switch(s.label){case 0:return n=this.state.peopleList,e&&e.model&&t&&t.model?(r=JSON.parse(e.model),a=JSON.parse(t.model),[4,this.getDifference(r,a)]):[3,2];case 1:i=s.sent(),o=n.find(function(t){return Object(c.g)(t.contact)==e.createdBy}),l=o&&o.name?Object(c.g)(o.name):"",console.log("historianArchiveDifferences",i),this.setState({historianArchiveDifferences:i,sourceTimestamp:e.timestamp,targetTimestamp:t.timestamp,user:l},function(){document.getElementById("btnShowDifference").click()}),s.label=2;case 2:return[2]}})})},t.prototype.getDifference=function(e,t,n){return u(this,void 0,Promise,function(){var r,a=this;return m(this,function(i){return r=[],Object.keys(e).forEach(function(i){return u(a,void 0,void 0,function(){var a,o,l,s;return m(this,function(c){switch(c.label){case 0:return a=e&&e[i]?e[i]:"",o=t&&t[i]?t[i]:"","object"!=typeof a?[3,3]:JSON.stringify(a)==JSON.stringify(o)?[3,2]:(l=isNaN(i)?i:n||"",[4,this.getDifference(a,o,l)]);case 1:s=c.sent(),r.push.apply(r,s),c.label=2;case 2:return[3,4];case 3:a!=o&&"value"!=i&&r.push({key:n?n+("label"!=i?" - "+i:""):i,source:a||"",target:o||""}),c.label=4;case 4:return[2]}})})}),[2,r]})})},t.prototype.restoreHistorian=function(){return u(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return(e=this.state.versionToRestore)&&e.model&&this.props.restoreSelectedVersion(e),[4,this.getHistorianArchive()];case 1:return t.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props.instance,n=this.state,a=n.archive,l=n.versionToRestore,s=n.historianArchiveDifferences,c=n.sourceTimestamp,d=n.targetTimestamp,p=n.user;return r.createElement("div",{className:"card",id:"HistorianArchiveList"},r.createElement("div",{className:"container-fluid"},r.createElement("div",{className:"content"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12"},r.createElement("h3",null,"Historian Archive"))),r.createElement("br",null),r.createElement("div",{className:"row no-margin"},r.createElement("div",{className:"hidden-xs col-md-10 col-md-offset-1 col-md-offset-right-1 no-padding cell_border",style:{marginBottom:"0px"}},r.createElement("div",{className:"col-md-12 bgcol trim-data headingText",style:{padding:"10px"}},"Timestamp"))),r.createElement("div",{className:"dataCard"},r.createElement("div",{className:"hidden"}),a&&a.length>0&&a.map(function(t,n){return r.createElement("div",{className:"col-md-10 cell_border no-padding col-md-offset-1 col-md-offset-right-1 clickable"},r.createElement("div",{className:"row no-margin hover"},r.createElement("div",{className:"col-md-4 padding-10"},r.createElement("span",{className:"hidden visible-xs-inline headingText"},"Timestamp"),"  ",t.timestamp.ToEasternDateTime()),r.createElement("div",{className:"col-md-8"},0!=n&&r.createElement("button",{className:"btn btn-sm btn-success btn-fill pull-right margin-5 mr-0",title:"Restore this version",onClick:function(n){e.setState({versionToRestore:t},function(){document.getElementById("btnConfirmRestore").click()})}},"Restore this version  "),n!=a.length-1&&r.createElement("button",{className:"btn btn-sm btn-primary btn-fill pull-right margin-5 mr-0",title:"Difference with previous version",onClick:function(r){return u(e,void 0,void 0,function(){return m(this,function(e){switch(e.label){case 0:return n==a.length-1?[3,2]:[4,this.difference(t,a[n+1])];case 1:e.sent(),e.label=2;case 2:return[2]}})})}},"Difference with previous version   "),0!=n&&r.createElement("button",{className:" btn btn-sm btn-primary btn-fill pull-right margin-5 mr-0",title:"Difference with latest version",onClick:function(r){return u(e,void 0,void 0,function(){return m(this,function(e){switch(e.label){case 0:return 0==n?[3,2]:[4,this.difference(t,a[0])];case 1:e.sent(),e.label=2;case 2:return[2]}})})}},"Difference with latest version   "))))})),r.createElement("button",{id:"btnConfirmRestore",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmRestoreDialog"},"."),r.createElement(i.a,{instance:t,id:"ConfirmRestoreDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:'Are you sure to Restore "'+(l&&l.timestamp?l.timestamp.ToEasternDateTime():"")+'" Version?',heading:"Confirm...",onConfirmButtonClick:function(){e.restoreHistorian()},onCancelButton:function(){e.setState({versionToRestore:Object()})}}),r.createElement("button",{type:"button",id:"btnShowDifference",className:"hidden","data-toggle":"modal","data-target":"#ShowDifference"}," "),r.createElement(o.a,{id:"ShowDifference",heading:"Difference",saveButtonText:"Done",onSaveButtonClick:function(){e.setState({historianArchiveDifferences:[],sourceTimestamp:Object(),targetTimestamp:Object(),user:""})},isEditForm:!0},r.createElement("div",{className:"scroll-y",style:{maxHeight:500}},r.createElement("div",{className:"container-fluid",style:{paddingLeft:"0px"}},r.createElement("div",{className:"content",style:{paddingTop:"0px"}},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12",style:{margin:"0px 10px"}},r.createElement("p",{className:"padding-5 small pull-left cell_border hover",style:{borderRadius:"5px",background:"rgb(220 220 220 / 21%)",color:"black"}},r.createElement("b",{style:{color:"gray"}},"Updated By: \xa0")," ",p,", (",new Date(c&&c).ToEasternDateTime(),")")),s&&s.length>0&&c&&d&&r.createElement("div",{className:"col-md-12",style:{margin:"10px"}},r.createElement("div",{className:"col-md-6 cell_border no-padding center",style:{background:"#dcdcdc94",borderRadius:"50px"}},r.createElement("h4",{className:"margin-10"}," After "),r.createElement("h4",{className:"margin-10"},c&&c.ToEasternDateTime())),r.createElement("div",{className:"col-md-6 cell_border no-padding center",style:{background:"gainsboro",borderRadius:"50px"}},r.createElement("h4",{className:"margin-10"}," Before "),r.createElement("h4",{className:"margin-10"},d&&d.ToEasternDateTime()))),s&&s.length>0&&s.map(function(e){return console.log(e),r.createElement("div",{className:"col-md-12",style:{margin:"10px"}},r.createElement("div",{className:"col-md-12 no-padding cell_border border-radius"},r.createElement("div",{className:"col-md-12 padding-10 center cell_border",style:{background:"ghostwhite"}},r.createElement("h5",{className:"no-margin",style:{textTransform:"uppercase",padding:"2px"}},r.createElement("b",null,"Attribute:")," ",r.createElement("span",{className:"text-primary"},e.key))),r.createElement("div",{className:"col-md-6 padding-10 center cell_border",style:{background:"#dcdcdc94"}},e.source?e.source:"-"),r.createElement("div",{className:"col-md-6 padding-10 center cell_border",style:{background:"gainsboro"}},e.target?e.target:"-")))})))))))),r.createElement("br",null),r.createElement("br",null),r.createElement("br",null),r.createElement("br",null),r.createElement("br",null),r.createElement("br",null))))},t}(r.Component);t.default=p}});