webpackJsonp([62],{924:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,s=a(3),i=(a.n(s),a(656)),l=a(925),c=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),o=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function l(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(i,l)}c((n=n.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var a,n,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{a=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},m=this&&this.__spreadArrays||function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<a;t++)for(var s=arguments[t],i=0,l=s.length;i<l;i++,r++)n[r]=s[i];return n},d=function(e){function t(t){var a=e.call(this,t)||this;return a.pageLength=15,a.state={AcknowledgedItems:[],sortOrder:1,AlarmList:[],showArchivedOnly:!1,alarmType:i.a.OperationalAlarm},n=a,a.handleAcknowledgeCheck=a.handleAcknowledgeCheck.bind(a),a.handleAcknowledgeButton=a.handleAcknowledgeButton.bind(a),a.handleStatusChange=a.handleStatusChange.bind(a),a._FetchAlarmList=a._FetchAlarmList.bind(a),a.sortAlarmList=a.sortAlarmList.bind(a),a.handleAcknowledgeChange=a.handleAcknowledgeChange.bind(a),a.handleClear=a.handleClear.bind(a),a.handleAcknowledge=a.handleAcknowledge.bind(a),a}return c(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,function(){var e,t,a,r=this;return u(this,function(s){return e=this.props,t=e.alarmType,a=e.buildingName,this.setState({alarmType:t},function(){return o(r,void 0,void 0,function(){var e=this;return u(this,function(t){return a&&setTimeout(function(){return o(e,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,n._FetchAlarmList(!1)];case 1:return e.sent(),[2]}})})},1e3),[2]})})}),[2]})})},t.prototype.componentWillUnmount=function(){return o(this,void 0,void 0,function(){return u(this,function(e){return clearInterval(r),[2]})})},t.prototype._FetchAlarmList=function(e){return o(this,void 0,void 0,function(){var t,a,n,s,i,c,o,d,h,p,f,b,v=this;return u(this,function(u){switch(u.label){case 0:return t=this.props,a=t.buildingName,n=t.equipmentName,s=t.spaceName,i=t.deviceId,c=this.state,o=c.alarmType,d=c.showArchivedOnly,(h=c.AlarmList)||(h=[]),p=this.pageLength,f=e?0:h.length,[4,Object(l.d)(o,a,d,f,p,n,s,i)];case 1:return b=u.sent(),e?h=m(b):h.push.apply(h,b),this.setState({AlarmList:h}),clearInterval(r),r=setTimeout(function(){v._FetchAlarmList(e)},3e4),[2]}})})},t.prototype.handleAcknowledgeCheck=function(e){if(e.target.checked){var t=this.state.AlarmList.find(function(t){return t.id==e.target.value});(a=this.state.AcknowledgedItems).push(t),this.setState({AcknowledgedItems:a})}else{var a,n=(a=this.state.AcknowledgedItems).findIndex(function(t){return t.id==e.target.value});a.splice(n,1),this.setState({AcknowledgedItems:a})}},t.prototype.sortAlarmList=function(e,t){var a=this.state.AlarmList,n=this.state.sortOrder,r=a.sort(function(t,a){if(t&&a){var r="",s="";switch(e){case"Floor":t.floorRdfsLabel&&a.floorRdfsLabel&&(r=t.floorRdfsLabel,s=a.floorRdfsLabel);break;case"Description":t.description&&a.description&&(r=t.description,s=a.description);break;case"Space":t.spaceRdfsLabel&&a.spaceRdfsLabel&&(r=t.spaceRdfsLabel,s=a.spaceRdfsLabel);break;case"Zone":t.zoneRdfsLabel&&a.zoneRdfsLabel&&(r=t.zoneRdfsLabel,s=a.zoneRdfsLabel);break;case"EquipmentSensor":t.equipmentsensor&&a.equipmentsensor&&(r=t.equipmentsensor,s=a.equipmentsensor);break;case"Status":t.status&&a.status&&(r=t.status,s=a.status);break;case"TimeofAlarm":t.timeofalarm&&a.timeofalarm&&(r=t.timeofalarm,s=a.timeofalarm)}var i=0;return r.toLocaleLowerCase()<s.toLocaleLowerCase()?i=-1:r.toLocaleLowerCase()>s.toLocaleLowerCase()&&(i=1),i*n}});this.setState({AlarmList:r,sortOrder:-1*n})},t.prototype.handleStatusChange=function(e,t){var a=this.state.AlarmList;a[t].status=e,this.setState({AlarmList:a})},t.prototype.handleAcknowledgeChange=function(e,t){var a=this.state.AlarmList;a[t].isSelected=e,this.setState({AlarmList:a})},t.prototype.handleClear=function(){return o(this,void 0,void 0,function(){var e,t,a;return u(this,function(n){switch(n.label){case 0:for(e=this.state.alarmType,t=this.state.AlarmList,a=0;a<t.length;a++)t[a].status=t[a].isSelected?"clear":t[a].status,t[a].isSelected=!1;return this.setState({AlarmList:t}),e!=i.a.CustomerAlarm?[3,2]:[4,Object(l.a)(t)];case 1:return n.sent(),[3,6];case 2:return e!=i.a.OperationalAlarm?[3,4]:[4,Object(l.b)(t)];case 3:return n.sent(),[3,6];case 4:return e!=i.a.SupervisoryAlarm?[3,6]:[4,Object(l.c)(t)];case 5:n.sent(),n.label=6;case 6:return[4,this._FetchAlarmList(!0)];case 7:return n.sent(),[2]}})})},t.prototype.handleAcknowledge=function(){return o(this,void 0,void 0,function(){var e,t,a;return u(this,function(n){switch(n.label){case 0:for(e=this.state.alarmType,t=this.state.AlarmList,!1,t.map(function(e){e.acknowledge}),a=0;a<t.length;a++)!!t[a].isSelected&&(t[a].acknowledge=!!t[a].isSelected),t[a].isSelected=!1;return this.setState({AlarmList:t}),e!=i.a.CustomerAlarm?[3,2]:[4,Object(l.a)(t)];case 1:return n.sent(),[3,6];case 2:return e!=i.a.OperationalAlarm?[3,4]:[4,Object(l.b)(t)];case 3:return n.sent(),[3,6];case 4:return e!=i.a.SupervisoryAlarm?[3,6]:[4,Object(l.c)(t)];case 5:n.sent(),n.label=6;case 6:return[4,this._FetchAlarmList(!0)];case 7:return n.sent(),[2]}})})},t.prototype.handleArchive=function(){return o(this,void 0,void 0,function(){var e,t,a;return u(this,function(n){switch(n.label){case 0:for(e=this.state.alarmType,t=this.state.AlarmList,!1,t.map(function(e){e.archived}),a=0;a<t.length;a++)!!t[a].isSelected&&(t[a].archived=!!t[a].isSelected),t[a].isSelected=!1;return this.setState({AlarmList:t}),e!=i.a.CustomerAlarm?[3,2]:[4,Object(l.a)(t)];case 1:return n.sent(),[3,6];case 2:return e!=i.a.OperationalAlarm?[3,4]:[4,Object(l.b)(t)];case 3:return n.sent(),[3,6];case 4:return e!=i.a.SupervisoryAlarm?[3,6]:[4,Object(l.c)(t)];case 5:n.sent(),n.label=6;case 6:return[4,this._FetchAlarmList(!0)];case 7:return n.sent(),[2]}})})},t.prototype.handleAcknowledgeButton=function(){this.setState({AcknowledgedItems:[]})},t.prototype.render=function(){var e=this,t=this.state.alarmType,a=this.props,n=a.buildingName,r=a.instance,l=a.equipmentName,c=a.spaceName,m=a.isInTab,d=this.state,h=d.AlarmList,p=d.showArchivedOnly,f=!!(h&&h.length>0);if(h)for(var b=0;b<h.length;b++){h[b].isSelected||(f=!1)}return s.createElement("div",{className:"content"},s.createElement("div",{className:"container-fluid"},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12 "},s.createElement("div",{className:"btn-group margin-5",style:{marginLeft:"0px"}},s.createElement("button",{type:"button",className:"btn btn-dark "+(t==i.a.OperationalAlarm?"btn-fill":"")+" ",onClick:function(){m?e.setState({alarmType:i.a.OperationalAlarm,showArchivedOnly:!1,AlarmList:[]},function(){return o(e,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this._FetchAlarmList(!0)];case 1:return e.sent(),[2]}})})}):window.location.hash="/"+r+"/"+n+"/"+(l?"Alarms/OperationalAlarms/Equip/"+l:c?"Alarms/OperationalAlarms/Space/"+c:"Health/Alarms/OperationalAlarms")}},s.createElement("span",null,"Operational Alarms")),s.createElement("button",{type:"button",className:"btn btn-dark "+(t==i.a.CustomerAlarm?"btn-fill":"")+" ",onClick:function(){m?e.setState({alarmType:i.a.CustomerAlarm,showArchivedOnly:!1,AlarmList:[]},function(){return o(e,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this._FetchAlarmList(!0)];case 1:return e.sent(),[2]}})})}):window.location.hash="/"+r+"/"+n+"/"+(l?"Alarms/CustomerAlarms/Equip/"+l:c?"Alarms/CustomerAlarms/Space/"+c:"Health/Alarms/CustomerAlarms")}},s.createElement("span",null,"Customer Alarms")),s.createElement("button",{type:"button",className:"btn btn-dark "+(t==i.a.SupervisoryAlarm?"btn-fill":"")+" ",onClick:function(){m?e.setState({alarmType:i.a.SupervisoryAlarm,showArchivedOnly:!1,AlarmList:[]},function(){return o(e,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this._FetchAlarmList(!0)];case 1:return e.sent(),[2]}})})}):window.location.hash="/"+r+"/"+n+"/"+(l?"Alarms/SupervisoryAlarms/Equip/"+l:c?"Alarms/SupervisoryAlarms/Space/"+c:"Health/Alarms/SupervisoryAlarms")}},s.createElement("span",{className:""},"Supervisor Alarms"))),!p&&s.createElement(s.Fragment,null," ",s.createElement("button",{type:"button",className:"margin-5 btn btn-dark pull-right active",onClick:function(){e.handleArchive()}}," ",s.createElement("span",null,"ARCHIVE")),s.createElement("button",{type:"button",className:"margin-5 btn btn-default btn-fill pull-right",onClick:function(){e.handleClear()}}," ",s.createElement("span",null,"CLEAR")),s.createElement("button",{type:"button",className:"margin-5 btn btn-default btn-fill pull-right",onClick:function(){e.handleAcknowledge()}}," ",s.createElement("span",null,"ACKNOWLEDGE")),s.createElement("button",{type:"button",className:"margin-5 btn btn-success active pull-right"}," ",s.createElement("span",null,"GRAPH"))))),s.createElement("br",null),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12"},s.createElement("a",{className:"btn-sm btn-success pull-left custom-icon-btn",title:"Archived "+(t==i.a.CustomerAlarm?"Customer":t==i.a.SupervisoryAlarm?"Supervisory":t==i.a.OperationalAlarm?"Operational":"")+" Alarms",style:{marginTop:"0px"},onClick:function(t){e.setState({showArchivedOnly:!p,AlarmList:[]},function(){return e._FetchAlarmList(!0)})}},p?s.createElement("img",{className:"icon-img",style:{backgroundColor:"#B3A2C7"},src:"assets/img/alarm.png"}):s.createElement("img",{className:"icon-img",style:{backgroundColor:"#B3A2C7"},src:"assets/img/archive.png"})))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12"},s.createElement("br",null),s.createElement("div",{className:"card padding-10",style:{paddingTop:"0px"}},s.createElement("div",{className:"content",style:{paddingTop:"10px"}},s.createElement("div",{className:"dataCard"},s.createElement("div",{className:"row hidden-sm hidden-xs no-padding"},s.createElement("div",{className:"col-md-12 no-padding dataCard"},s.createElement("div",{className:"col-md-1 col-sm-12 small grid-header-left",onClick:function(){return e.sortAlarmList("Floor")}},s.createElement("i",{className:"fa fas fa-sort"}),"Floor"),s.createElement("div",{className:(p?"col-md-4":"col-md-3")+" col-sm-12 small  grid-header",onClick:function(){return e.sortAlarmList("Description")}},s.createElement("i",{className:"fa fas fa-sort"}),"Description"),s.createElement("div",{className:"col-md-1 col-sm-12 small grid-header",onClick:function(){return e.sortAlarmList("Space")}},s.createElement("i",{className:"fa fas fa-sort"}),"Space"),s.createElement("div",{className:"col-md-3 col-sm-12 small  grid-header",onClick:function(){return e.sortAlarmList("EquipmentSensor")}},s.createElement("i",{className:"fa fas fa-sort"}),"Equipment/Sensor"),s.createElement("div",{className:"col-md-1 col-sm-12 small grid-header",onClick:function(){return e.sortAlarmList("Status")}},s.createElement("i",{className:"fa fas fa-sort"}),"Status"),s.createElement("div",{className:"col-md-2 col-sm-12 small  grid-header",onClick:function(){return e.sortAlarmList("TimeofAlarm")}},s.createElement("i",{className:"fa fas fa-sort"}),"Time of Alarm"),!p&&s.createElement("div",{className:"col-md-1 col-sm-12 small  grid-header"},s.createElement("input",{style:{marginTop:"0px",marginLeft:"50px",height:"17px"},onChange:function(t){if(h){for(var a=0;a<h.length;a++){h[a].isSelected=t.target.checked}e.setState({AlarmList:h})}},type:"checkbox",checked:f,className:"form-control"})))),h&&h.length>0&&h.map(function(t,a){return s.createElement("div",{key:a,className:" row clickable"},s.createElement("div",{className:t.acknowledge?"col-md-12 no-padding":"text-danger col-md-12 no-padding blink-text"},s.createElement("div",{className:"col-md-1 small headingText trim-data",title:t.floorRdfsLabel},s.createElement("span",{className:"visible-sm-inline visible-xs-inline headingText"},"Floor"),t.floorRdfsLabel),s.createElement("div",{className:(p?"col-md-4":"col-md-3")+" small headingText trim-data",title:t.description},s.createElement("span",{className:"visible-sm-inline visible-xs-inline headingText"},"Description"),t.description),s.createElement("div",{className:"col-md-1 small headingText trim-data",title:t.spaceRdfsLabel},s.createElement("span",{className:"visible-sm-inline visible-xs-inline headingText"},"Space"),t.spaceRdfsLabel),s.createElement("div",{className:"col-md-3 small headingText trim-data",title:t.equipmentsensor?t.equipmentsensor:t.device?t.device:""},s.createElement("span",{className:"visible-sm-inline visible-xs-inline headingText"},"Equipment/Sensor"),"\xa0\xa0",t.equipmentsensor?t.equipmentsensor:t.device?t.device:""),s.createElement("div",{className:"col-md-1 small headingText trim-data",title:t.status},s.createElement("span",{className:"visible-sm-inline visible-xs-inline headingText"},"Status"),t.status),s.createElement("div",{className:"col-md-2 small headingText trim-data",title:t.timeofalarm.ToEasternDateTime()},s.createElement("span",{className:"visible-sm-inline visible-xs-inline headingText"},"Time of Alarm"),t.timeofalarm.ToEasternDateTime()),!p&&s.createElement("div",{className:"col-md-1 headingText"},s.createElement("span",{className:"visible-sm-inline visible-xs-inline  headingText"},"Select"),s.createElement("input",{style:{marginTop:"0px",marginLeft:"36px",height:"22px"},onChange:function(t){e.handleAcknowledgeChange(t.target.checked,a)},type:"checkbox",checked:t.isSelected,className:"form-control"}))))}),h&&h.length>=this.pageLength&&h.length%this.pageLength==0&&s.createElement("div",{className:"row center"},s.createElement("button",{type:"button",className:"margin-5 btn btn-secondary",onClick:function(){e._FetchAlarmList(!1)}}," ",s.createElement("span",null,"Load More..."))))))))))},t}(s.Component);t.default=d},925:function(e,t,a){"use strict";t.d=function(e,t,a,s,c,o,u,m){return i(this,void 0,void 0,function(){var i,d,h,p;return l(this,function(l){switch(l.label){case 0:return d="",h=window.location.hash,d=-1!=h.indexOf("/")?h.substring(1,h.indexOf("/")):h.substring(1),p=e==r.a.CustomerAlarm?n.a.ALARMS.GetCutomerAlarm:e==r.a.SupervisoryAlarm?n.a.ALARMS.GetSupervisorAlarm:(r.a.OperationalAlarm,n.a.ALARMS.GetOperationalAlarm),t?[4,Object(n.d)(p,"instance="+d+"&buildingName="+t+"&isArchivedOnly="+a+"&skip="+s+"&limit="+c+(o?"&equipmentName="+o:"")+(u?"&spaceName="+u:"")+(m?"&deviceId="+m:""))]:[3,2];case 1:return i=l.sent(),[3,4];case 2:return[4,Object(n.d)(p,"instance="+d)];case 3:i=l.sent(),l.label=4;case 4:return[2,i.result]}})})},t.c=function(e){return i(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(n.f)({model:e},n.a.ALARMS.UpdateSuperviorAlarm,"").then(function(e){if(e&&e.result)return e.result;Object(s.b)("Supervisory Alarm updated Successfully.")}).catch(function(e){Object(s.a)("Error occured while updating Supervisory Alarm.")})];case 1:return[2,t.sent()]}})})},t.a=function(e){return i(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(n.f)({model:e},n.a.ALARMS.UpdateCustomerAlarm,"").then(function(e){if(e&&e.result)return e.result;Object(s.b)("Customer Alarm updated Successfully.")}).catch(function(e){Object(s.a)("Error occured while updating Customer Alarm.")})];case 1:return[2,t.sent()]}})})},t.b=function(e){return i(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(n.f)({model:e},n.a.ALARMS.UpdateOperationalAlarm,"").then(function(e){if(e&&e.result)return e.result;Object(s.b)("Operational Alarm updated Successfully.")}).catch(function(e){Object(s.a)("Error occured while updating Operational Alarm.")})];case 1:return[2,t.sent()]}})})};var n=a(19),r=a(656),s=a(44),i=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function l(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(i,l)}c((n=n.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var a,n,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(s){return function(l){return function(s){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{a=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}}});