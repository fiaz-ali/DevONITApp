webpackJsonp([80],{1244:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l});var a=[{roleID:"1",value:"1-Super User"},{roleID:"2",value:"2-Operating Officer / Manager"},{roleID:"3",value:"3-Staff / Contractors"},{roleID:"4",value:"4-Customer"},{roleID:"5",value:"5-Service Manager"},{roleID:"6",value:"6-Service Worker"}],l=[{roleID:"3",value:"3-Staff / Contractors"},{roleID:"4",value:"4-Customer"},{roleID:"5",value:"5-Service Manager"},{roleID:"6",value:"6-Service Worker"}]},610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),l=(n.n(a),n(16)),o=n(38),r=n(59),c=n(109),i=n(8),s=n(1244),m=n(119),u=n(60),d=n(9),f=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function r(e){try{i(a.next(e))}catch(e){o(e)}}function c(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?l(e.value):new n(function(t){t(e.value)}).then(r,c)}i((a=a.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var n,a,l,o,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){r.label=o[1];break}if(6===o[0]&&r.label<l[1]){r.label=l[1],l=o;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(o);break}l[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_people:[],columns:[{name:"Name",selected:!0},{name:"Role",selected:!0},{name:"Phone",selected:!0},{name:"Email",selected:!0},{name:"Status",selected:!0},{name:"Chat",selected:!0}],sortOrder:1,ContactToDelete:Object(),contactNameForReset:""},n.handleColumnFilters=n.handleColumnFilters.bind(n),n.sortPeople=n.sortPeople.bind(n),n.onDeleteContact=n.onDeleteContact.bind(n),n._fetchPeople=n._fetchPeople.bind(n),n}return f(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchPeople()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype._fetchPeople=function(){return p(this,void 0,void 0,function(){var e,t,n,a=this;return h(this,function(l){switch(l.label){case 0:return e=JSON.parse(d.a.getItem("user")),[4,Object(c.m)(this.props.buildingName)];case 1:return t=l.sent(),"1"==e.role?this.setState({_people:t}):(n=t.filter(function(e){return Object(i.g)(e.assignedTo).includes(a.props.buildingName)}),this.setState({_people:n})),[2]}})})},t.prototype.handleColumnFilters=function(e){var t=e.target.checked,n=this.state.columns;n[n.findIndex(function(t){return t.name===e.target.value})].selected=t,this.setState({columns:n})},t.prototype.sortPeople=function(e,t){var n=this.state._people,a=this.state.sortOrder,l=n.sort(function(n,l){if(n&&l){var o="",r="";switch(e){case"Name":n.name&&l.name&&(o=n.name.value,r=l.name.value,a=t||1);break;case"Role":n.role&&l.role&&(o=n.role.value,r=l.role.value);break;case"Phone":n.phone&&l.phone&&(o=n.phone.value,r=l.phone.value);break;case"Email":n.email&&l.email&&(o=n.email.value,r=l.email.value);break;case"Status":n.status&&l.status&&(o=n.status.value,r=l.status.value);break;case"Chat":n.chatlink&&l.chatlink&&(o=n.chatlink.value,r=l.chatlink.value)}var c=0;return o.toLocaleLowerCase()<r.toLocaleLowerCase()?c=-1:o.toLocaleLowerCase()>r.toLocaleLowerCase()&&(c=1),c*a}});this.setState({_people:l,sortOrder:-1*a})},t.prototype.onDeleteContact=function(e){return p(this,void 0,void 0,function(){return h(this,function(t){return this.setState({ContactToDelete:e}),document.getElementById("btnConfirm").click(),[2]})})},t.prototype.deleteContact=function(){return p(this,void 0,void 0,function(){var e;return h(this,function(t){switch(t.label){case 0:return e=this.state.ContactToDelete,[4,Object(c.c)(this.props.buildingName,e.contact.value)];case 1:return t.sent(),[4,this._fetchPeople()];case 2:return t.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,c=t.buildingName,f=this.state,p=f.columns,h=f._people,v=JSON.parse(d.a.getItem("user")),b=Object(u.b)(v,"people","write");return a.createElement(l.AppContext.Consumer,null,function(t){return a.createElement("div",{className:"content",style:{paddingTop:"0px"}},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row no-padding"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 "},a.createElement("button",{type:"button",className:"btn btn-primary btn-fill","data-toggle":"modal","data-target":"#filtercolumnsModal"},a.createElement("i",{className:"fa fa-bookmark-o"}),a.createElement("span",{className:"hidden-xs"},"Quick Filters")),a.createElement(o.a,{id:"filtercolumnsModal",heading:"Table Column Preferences",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},p.map(function(t,n){return!0===t.selected?a.createElement("div",{key:n},a.createElement("input",{checked:!0,type:"checkbox",value:t.name,onChange:e.handleColumnFilters})," ",a.createElement("label",null,t.name)):a.createElement("div",{key:n},a.createElement("input",{type:"checkbox",value:t.name,onChange:e.handleColumnFilters})," ",a.createElement("label",null,t.name))})),b&&a.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){window.location.hash=n+"/"+c+"/People/NewContact"}},a.createElement("i",{className:"fa fa-plus"}),a.createElement("span",null,"Create New Contact")))),a.createElement("br",null),a.createElement("div",{className:"card padding-10",id:"PeopleList",style:{paddingTop:"0px"}},a.createElement("div",{className:"content",style:{paddingTop:"10px"}},a.createElement("div",{className:"dataCard"},a.createElement("div",{className:"row hidden-xs no-padding"},a.createElement("div",{className:"col-md-10 dataCard no-padding"},p.find(function(e){return"Name"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left",onClick:function(){return e.sortPeople("Name")}},a.createElement("i",{className:"fa fas fa-sort"}),"Name"),p.find(function(e){return"Role"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Role")}},a.createElement("i",{className:"fa fas fa-sort",style:{paddingLeft:"8px"}}),"Role"),p.find(function(e){return"Phone"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Phone")}},a.createElement("i",{className:"fa fas fa-sort"}),"Phone"),p.find(function(e){return"Email"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Email")}},a.createElement("i",{className:"fa fas fa-sort"}),"Email"),p.find(function(e){return"Status"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Status")}},a.createElement("i",{className:"fa fas fa-sort"}),"Status"),p.find(function(e){return"Chat"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header"}," \xa0 \xa0 \xa0Chat")),a.createElement("div",{className:"col-md-2"})),a.createElement(m.a,{userName:e.state.contactNameForReset,dialogButtonName:"btnChangePassword"}),h&&h.length>0&&h.map(function(l,o){return a.createElement("div",{key:o,className:"row clickable no-padding"},a.createElement("div",{className:"col-md-10 no-padding"},p.find(function(e){return"Name"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(i.g)(l.name)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Name"),a.createElement("a",{href:"#"+n+"/"+c+"/People/EditContact/"+Object(i.g)(l.contact)}," ",Object(i.g)(l.name))),p.find(function(e){return"Role"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:s.a.find(function(e){return e.roleID==Object(i.g)(l.role)})?s.a.find(function(e){return e.roleID==Object(i.g)(l.role)}).value:""},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"role"),s.a.find(function(e){return e.roleID==Object(i.g)(l.role)})?s.a.find(function(e){return e.roleID==Object(i.g)(l.role)}).value:""),p.find(function(e){return"Phone"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(i.g)(l.phone)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Phone"),Object(i.g)(l.phone)),p.find(function(e){return"Email"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(i.g)(l.email)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Email"),Object(i.g)(l.email)),p.find(function(e){return"Status"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 trim-data",title:"Not Working"==Object(i.g)(l.workingStatus)?"OFF":Object(i.g)(l.workingStatus)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Status"),"Not Working"==Object(i.g)(l.workingStatus)?"OFF":Object(i.g)(l.workingStatus)),p.find(function(e){return"Chat"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small center trim-data padding-5",title:Object(i.g)(l.chatlink)},a.createElement("button",{className:"btn btn-xs btn-primary active padding-5",onClick:function(e){window.location.hash=n+"/"+c+"/PersonChatWindow/Contact/"+Object(i.g)(l.contact)}},a.createElement("i",{className:"fa fa-comments"}),"Go To/ Start New"))),b&&a.createElement("div",{className:"col-md-2 col-xs-12 padding-10 center"},"1"==t.authenticatedUser.role&&a.createElement("a",{className:"btn-sm btn-primary active custom-outline-btn",title:"Change Password",onClick:function(t){e.setState({contactNameForReset:l.contact.value},function(){document.getElementById("btnChangePassword").click()})}},a.createElement("i",{className:"fa fa-key"})),a.createElement("a",{className:"btn-sm btn-danger active custom-outline-btn",title:"Delete",onClick:function(t){e.onDeleteContact(l)}},a.createElement("i",{className:"fa fa-trash"})),a.createElement("a",{className:"btn-sm btn-success active custom-outline-btn",title:"Edit",onClick:function(e){window.location.hash=n+"/"+c+"/People/EditContact/"+l.contact.value}},a.createElement("i",{className:"fa fa-edit"}))))}),a.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),a.createElement(r.a,{instance:n,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Contact?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteContact()}}))))))))})},t}(a.Component);t.default=v}});