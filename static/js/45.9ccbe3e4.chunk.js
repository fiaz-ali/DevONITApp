webpackJsonp([45],{1779:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),o=(n.n(a),n(659)),i=n(1055),c=n.n(i),r=n(1054),l=n(713),s=n(568),u=n(93),d=n(601),m=n(17),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function c(e){try{l(a.next(e))}catch(e){i(e)}}function r(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,r)}l((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(o=2&i[0]?a.return:i[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,a=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],a=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},b=n(877),v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={actions:[],previousActions:[],testtext:"",qrcodeActionIndex:null,qrcodeShow:!1,toEmail:[],points:[],selectedPoints:[]},n.getObjectFormActions=n.getObjectFormActions.bind(n),n.onChangeNumericHandler=n.onChangeNumericHandler.bind(n),n.onBlur=n.onBlur.bind(n),n.afterPaste=n.afterPaste.bind(n),n.onChangeHandler=n.onChangeHandler.bind(n),n.handleScan=n.handleScan.bind(n),n.saveActions=n.saveActions.bind(n),n.onToEmail=n.onToEmail.bind(n),n.handleSaveMultiPointsActions=n.handleSaveMultiPointsActions.bind(n),n}return h(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return[4,Object(d.h)(this.props.buildingName,"","")];case 1:return e=t.sent(),this.setState({points:e}),this.getObjectFormActions(),[2]}})})},t.prototype.getObjectFormActions=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o;return f(this,function(i){switch(i.label){case 0:return e=this.state,t=e.points,n=e.selectedPoints,a=[],[4,Object(l.b)(this.props.buildingName,[this.props.taskID])];case 1:return(o=i.sent())&&o.length>0&&o[0].visibleObjectFormActions&&o[0].visibleObjectFormActions.length>0?[4,Object(l.b)(this.props.buildingName,[],o[0].visibleObjectFormActions)]:[3,3];case 2:a=i.sent(),i.label=3;case 3:return o.map(function(e,a){for(var o=[],i=e.pointOntology.split(","),c=0;c<i.length;c++){var r=t.find(function(e){return Object(m.g)(e.point)===i[c]});r&&void 0!=r&&o.push({label:Object(m.g)(r.pointLabel),value:Object(m.g)(r.point)})}n.push(o)}),this.setState({actions:o,previousActions:a,selectedPoints:n}),[2]}})})},t.prototype.onChangeHandler=function(e,t,n){var a=this.state.actions;a[n].dataEntered=e.editor.getData(),this.setState({actions:a})},t.prototype.onChangeNumericHandler=function(e,t){var n=this.state.actions;n[t].dataEntered=e.target.value,this.setState({actions:n})},t.prototype.onToEmail=function(e,t){var n=this.state.toEmail;n[t]=e.target.value,this.setState({toEmail:n})},t.prototype.onEmailData=function(e,t){var n=this.state.actions;n[t].dataEntered=e.target.value,this.setState({actions:n})},t.prototype.onBlur=function(e){},t.prototype.afterPaste=function(e){},t.prototype.handleScan=function(e){var t=this.state,n=t.qrcodeActionIndex,a=t.actions,o=a[n];e&&e.toString()==o.qrCode&&(a[n].isQrCodeVerified=!0,this.setState({actions:a,qrcodeShow:!1,qrcodeActionIndex:null}))},t.prototype.saveActions=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o=this;return f(this,function(i){switch(i.label){case 0:return e=this.state,t=e.actions,n=e.toEmail,a=!1,t.map(function(e,t){return p(o,void 0,void 0,function(){var o;return f(this,function(i){switch(i.label){case 0:return"email"!=e.directiveType?[3,2]:((o=Object()).to=n[t],o.subject="Update Email",o.text=e.dataEntered,[4,Object(u.a)(o)]);case 1:i.sent(),i.label=2;case 2:return"done"==e.directiveType&&(a=!0),[2]}})})}),a?(document.getElementById("multiPointsbtn").click(),[2]):[4,Object(l.c)(this.props.buildingName,t).then(function(){window.location.hash=o.props.instance+"/"+o.props.buildingName+"/Tasks"})];case 1:return i.sent(),[2]}})})},t.prototype.handleSaveMultiPointsActions=function(){return p(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){switch(n.label){case 0:return e=this.state.actions,[4,Object(l.c)(this.props.buildingName,e).then(function(){window.location.hash=t.props.instance+"/"+t.props.buildingName+"/Tasks"})];case 1:return n.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props.buildingName,n=this.state,i=n.actions,l=n.qrcodeShow,u=n.previousActions;return a.createElement(a.Fragment,null,a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid"},u&&u.length>0&&a.createElement("div",{className:"card padding-10"},a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12"},u.map(function(e,n){return a.createElement(a.Fragment,null,a.createElement("div",{key:n,className:"row hidden-xs no-padding"},a.createElement("div",{className:"col-md-12 "},a.createElement("div",{className:"col-md-3 col-sm-12 small grid-header-left"},a.createElement("label",null,"Task"),a.createElement("div",{className:"padding-5"},e.taskDescription)),a.createElement("div",{className:"col-md-3 col-sm-12 small grid-header-left"},a.createElement("label",null,"Do What? "),a.createElement("div",{className:"padding-5"},e.directive)),a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left"},a.createElement("label",null,"Floor"),a.createElement("div",{className:"padding-5"},e.floorOntology)),a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left"},a.createElement("label",null,"Space "),a.createElement("div",{className:"padding-5"},e.spaceOntology," ")),a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left"},a.createElement("label",null,"Asset "),a.createElement("div",{className:"padding-5"},e.assetOntology)))),a.createElement("div",{key:n+"a",className:"row hidden-xs no-padding"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-3"}," ",a.createElement("p",{className:"headingText"},e.directive,":")),a.createElement("div",{className:"col-md-9"},"enter"==e.directiveType&&a.createElement("div",{dangerouslySetInnerHTML:{__html:e.dataEntered}}),"numeric"==e.directiveType&&a.createElement("p",null,e.dataEntered," ",e.unit),"email"==e.directiveType&&a.createElement("p",null,e.dataEntered),"done"==e.directiveType&&a.createElement("p",null,e.isDone?"Completed":"Not Done"),"scan"==e.directiveType&&a.createElement(a.Fragment,null,e.isQrCodeVerified?a.createElement("h4",{style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Verified"):a.createElement("h4",{style:{color:"red"}},a.createElement("i",{className:"fa fa-cross",style:{margin:8}}),"Not Verified")),"upload"==e.directiveType&&a.createElement(o.a,{showUploader:!1,showGrid:!0,buildingName:t,assetOntology:e.ontology,entityType:"ObjectAttachment"})))))})))),a.createElement("div",{className:"card"},a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12"},i.map(function(n,i){return a.createElement(a.Fragment,null,a.createElement("div",{key:i,className:"row m-0 body-bg-p"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-3"}," ",a.createElement("p",{className:"headingText"},n.directive,":")),a.createElement("div",{className:"col-md-9"},"enter"==n.directiveType&&a.createElement(c.a,{activeClass:"p10",config:r.a,content:n.dataEntered,events:{blur:e.onBlur,afterPaste:e.afterPaste,change:function(t){e.onChangeHandler(t,n,i)}}}),"numeric"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("input",{type:"number",className:"form-control",value:n.dataEntered,onChange:function(t){e.onChangeNumericHandler(t,i)}})," ",a.createElement("span",null)),"done"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("ul",null,e.state.selectedPoints[i].map(function(e,t){return a.createElement(a.Fragment,null,a.createElement("li",null,e.label))})),n.isDone?a.createElement("h4",{style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"):a.createElement("button",{className:"m-2 btn btn-primary btn-fill",onClick:function(){var t=e.state.actions;t[i].isDone=!0,e.setState({actions:t})}},"Done")),"email"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("p",{className:"headingText"},"To:")),a.createElement("div",{className:"col-md-10"},a.createElement("input",{type:"text",className:"form-control",value:e.state.toEmail,onChange:function(t){e.onToEmail(t,i)}})," ",a.createElement("span",null)),a.createElement("div",{className:"col-md-2 mt-2"},a.createElement("p",{className:"headingText"},"Body:")),a.createElement("div",{className:"col-md-10 mt-2"},a.createElement("textarea",{rows:5,className:"form-control",value:n.dataEntered,onChange:function(t){e.onEmailData(t,i)}})," ",a.createElement("span",null)))),"scan"==n.directiveType&&!n.isQrCodeVerified&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:function(){e.setState({qrcodeShow:!0,qrcodeActionIndex:i},function(){document.getElementById("qrDailogebtn").click()})},className:"ml-1 btn btn-secondary btn-fill pull-right pull-right"},a.createElement("i",{className:"fa fa-qrcode"}),"\xa0","Show Scanner"),a.createElement("button",{id:"qrDailogebtn",type:"button","data-toggle":"modal","data-target":"#qrDailoge",className:"hidden"},"."),a.createElement(s.a,{id:"qrDailoge",closeButtonId:"qrDailogeClose",heading:"Scan QR",showSaveButton:!1,showCancelButton:!0,onCancelButtonClick:function(){e.setState({qrcodeShow:!1,qrcodeActionIndex:null})}},l&&a.createElement("div",null,a.createElement(b,{delay:500,onError:function(e){console.log(e)},onScan:e.handleScan,style:{width:"100%"}})))),"scan"==n.directiveType&&n.isQrCodeVerified&&a.createElement(a.Fragment,null,a.createElement("h4",{style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"QR Verified")),"upload"==n.directiveType&&a.createElement(o.a,{showUploader:!0,showGrid:!0,buildingName:t,assetOntology:n.ontology,entityType:"ObjectAttachment"})))))}),a.createElement("hr",null),a.createElement("div",{className:"row m-0 body-bg-p pb-0 "},a.createElement("div",{className:"col-md-12 force-center"},a.createElement("button",{className:"m-2 btn btn-primary btn-fill",onClick:function(){e.saveActions()}},"Save"),a.createElement("button",{className:"m-2 btn btn-secondary btn-fill",onClick:function(){window.location.hash=e.props.instance+"/"+t+"/Tasks"}},"Back")))))),a.createElement("button",{id:"multiPointsbtn",type:"button","data-toggle":"modal","data-target":"#multiPoints",className:"hidden"},"."),a.createElement(s.a,{id:"multiPoints",closeButtonId:"multiPointsClose",heading:"Action",saveButtonText:"Done",onSaveButtonClick:function(){return e.handleSaveMultiPointsActions()},showSaveButton:!0},a.createElement("div",null,a.createElement("p",null,"Are you sure that you have done your task?"))))))},t}(a.Component);t.default=v},713:function(e,t,n){"use strict";t.b=function(e,t,n){return c(this,void 0,void 0,function(){return r(this,function(a){switch(a.label){case 0:return[4,Object(i.e)({buildingName:e,tasks:t,ontologies:n},i.a.OBJECTFORM.GetObjectFormActions,o.b.TASK,!0)];case 1:return[2,a.sent()]}})})},t.c=function(e,t){return c(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(i.f)({buildingName:e,ObjectActionTemplates:t},i.a.OBJECTFORM.SaveObjectFormActions,o.b.TASK).then(function(){Object(a.b)(" Assigned Successfully.")}).catch(function(e){Object(a.a)("Error occured while saving.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return c(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(i.f)({buildingName:e,ontology:t},i.a.OBJECTFORM.DeleteObjectFormActions,o.b.TASK).then(function(){Object(a.b)("All Actions Deleted Successfully.")}).catch(function(e){Object(a.a)("Error occured while saving.")})];case 1:return[2,n.sent()]}})})};var a=n(44),o=n(26),i=n(19),c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function c(e){try{l(a.next(e))}catch(e){i(e)}}function r(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,r)}l((a=a.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,a,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(o=2&i[0]?a.return:i[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,a=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],a=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}}}});