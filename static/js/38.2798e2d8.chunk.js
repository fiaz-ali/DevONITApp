webpackJsonp([38],{1038:function(e,t,a){"use strict";t.b=function(e,t,a,r){return l(this,void 0,void 0,function(){return c(this,function(l){switch(l.label){case 0:return[4,Object(o.e)({buildingName:e,getArchivedOnly:t,includeArchived:a,workOrderID:r},o.a.WORKORDER.FetchWorkOrders,n.b.WORKORDER)];case 1:return[2,l.sent()]}})})},t.d=function(e,t){return l(this,void 0,void 0,function(){return c(this,function(a){switch(a.label){case 0:return[4,Object(o.f)({workOrderID:e,newStatus:t},o.a.WORKORDER.SetNewStatus,n.b.WORKORDER).then(function(){Object(r.b)("Work Order Updated Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Work Order.")})];case 1:return[2,a.sent()]}})})},t.a=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({workOrderID:e},o.a.WORKORDER.ArchiveWorkOrder,n.b.WORKORDER).then(function(){Object(r.b)("Work Order Updated Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Work Order.")})];case 1:return[2,t.sent()]}})})},t.c=function(e,t,a){return l(this,void 0,void 0,function(){return c(this,function(l){switch(l.label){case 0:return[4,Object(o.f)({buildingName:e,workOrderModel:t,isEdit:a},o.a.WORKORDER.SaveWorkOrder,n.b.WORKORDER).then(function(){Object(r.b)("Work Order "+(a?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Work Order.")})];case 1:return[2,l.sent()]}})})};var n=a(29),r=a(48),o=a(22),l=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,o){function l(e){try{s(n.next(e))}catch(e){o(e)}}function c(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(l,c)}s((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var a,n,r,o,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,n=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(r=(r=l.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){l.label=o[1];break}if(6===o[0]&&l.label<r[1]){l.label=r[1],r=o;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(o);break}r[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],n=0}finally{a=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}},1500:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=(a.n(n),a(624)),o=a.n(r),l=a(1038),c=a(610),s=a(606),i=a(99),u=a(614),m=a(650),d=a(29),h=a(17),f=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),p=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,o){function l(e){try{s(n.next(e))}catch(e){o(e)}}function c(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(l,c)}s((n=n.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var a,n,r,o,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,n=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(r=(r=l.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){l.label=o[1];break}if(6===o[0]&&l.label<r[1]){l.label=r[1],r=o;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(o);break}r[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],n=0}finally{a=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},E=new Date,b=function(e){function t(t){var a=e.call(this,t)||this;return a.state={workOrder:Object(),locationList:[],assets:[],people:[],isEdit:!1},a._fetchWorkOrder=a._fetchWorkOrder.bind(a),a._getLocationsList=a._getLocationsList.bind(a),a._fetchPeople=a._fetchPeople.bind(a),a.handleFormChange=a.handleFormChange.bind(a),a.handleDueDateChange=a.handleDueDateChange.bind(a),a._getAssets=a._getAssets.bind(a),a}return f(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchWorkOrder()]:[3,5];case 1:return e.sent(),[4,this._getLocationsList()];case 2:return e.sent(),[4,this._fetchPeople()];case 3:return e.sent(),[4,this._getAssets()];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.prototype._saveWorkOrder=function(){return p(this,void 0,void 0,function(){var e,t,a,n,r,o;return v(this,function(c){switch(c.label){case 0:return e=this.state,t=e.workOrder,a=e.isEdit,n=this.props,r=n.instance,o=n.buildingName,t&&t.workOrder?(Object(i.a)(!0),[4,Object(l.c)(o,t,a)]):[3,2];case 1:c.sent(),Object(i.a)(!1),window.location.hash=r+"/"+o+"/WorkOrders",c.label=2;case 2:return[2]}})})},t.prototype._getAssets=function(){return p(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Object(m.e)(this.props.buildingName,d.b.WORKORDER)];case 1:return e=t.sent(),this.setState({assets:e}),[2]}})})},t.prototype._fetchPeople=function(){return p(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Object(s.n)(this.props.buildingName)];case 1:return e=t.sent(),this.setState({people:e}),[2]}})})},t.prototype._getLocationsList=function(){return p(this,void 0,void 0,function(){var e,t=this;return v(this,function(a){switch(a.label){case 0:return e=this.props.buildingName,[4,Object(c.b)(e).then(function(e){t.setState({locationList:e})})];case 1:return a.sent(),[2]}})})},t.prototype.handleFormChange=function(e){if(!this.props.isView){var t=this.state.workOrder;t[""+e.target.name]=e.target.value,this.setState({workOrder:t})}},t.prototype._fetchWorkOrder=function(){return p(this,void 0,void 0,function(){var e,t;return v(this,function(a){return e=Object(),t=!(!this.props.workOrderNo||this.props.isView),e.workOrder=(new Date).WO_Number(),e.dueDate=(new Date).toString(),this.props.workOrderNo&&Object(l.b)(this.props.buildingName,!1,!0,this.props.workOrderNo).then(function(t){if(t&&t.length>0){var a=t[0];e.assignee=a.assignee?a.assignee.value:"",e.assigneeName=a.assigneeName?a.assigneeName.value:"",e.category=a.category?a.category.value:"",e.createdDate=a.createdDate?a.createdDate.value:"",e.description=a.description?a.description.value:"",e.dueDate=a.dueDate?a.dueDate.value:"",e.duration=a.duration?a.duration.value:"",e.lastEdit=a.lastEdit?a.lastEdit.value:"",e.location=a.location?a.location.value:"",e.priority=a.priority?a.priority.value:"",e.status=a.status?a.status.value:"",e.title=a.title?a.title.value:"",e.workOrder=a.workOrder?a.workOrder.value:"",e.isArchived=!(!a.workOrder||"true"!=a.workOrder.value),e.asset=a.asset?a.asset.value:"",e.additionalWorkers=a.additionalWorkers?a.additionalWorkers.value:""}}),this.setState({workOrder:e,isEdit:t}),[2]})})},t.prototype.handleDueDateChange=function(e){var t=this.state.workOrder;E=e,t.dueDate=e.toString(),this.setState({workOrder:t})},t.prototype.render=function(){var e=this,t=this.props,a=t.isView,r=t.instance,l=t.buildingName,c=t.workOrderNo,s=this.state,i=s.workOrder,m=s.locationList,d=s.people,f=s.assets,p=JSON.parse(h.a.getItem("user")),v=Object(u.b)(p,"work-wo","write"),b=i&&i.title&&i.status&&i.dueDate&&i.priority&&i.assignee&&i.location&&i.asset&&!0;return n.createElement("div",{className:"content "+(v&&a?"overlay":"")},n.createElement("div",{className:"card"},n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"header"},n.createElement("h4",{className:"title"},a?i.workOrder+" details":"Create Work Order")),n.createElement("br",null),n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"workOrder"},"Work Order #")),n.createElement("div",{className:"col-md-4 col-xs-12"},n.createElement("input",{disabled:!0,type:"text",className:"form-control",name:"title",value:i.workOrder}))),n.createElement("div",{className:"row form-group"},a&&n.createElement("div",{className:"col-md-6 col-xs-12 pull-right"},n.createElement("div",{className:"col-md-6 col-xs-12"},n.createElement("img",{src:"https://via.placeholder.com/200"})),n.createElement("div",{className:"col-md-3 col-xs-6"},v&&n.createElement("button",{className:"btn btn-primary",onClick:function(){return window.location.hash=r+"/"+l+"/WorkOrder/"+c+"/Edit"}},n.createElement("i",{className:"fa fa-edit"})," Edit")),n.createElement("div",{className:"col-md-3 col-xs-6"},n.createElement("button",{className:"btn btn-secondary",onClick:function(){return window.location.hash=r+"/"+l+"/PurchaseOrders/"+c}},"Related PO's"))),n.createElement("div",{className:a?"col-md-6 col-xs-12 ":"col-md-6 col-md-offset-right-5 col-xs-12 "},n.createElement("div",{className:"col-md-12 col-xs-12 no-padding"},n.createElement("div",{className:"col-md-12 col-xs-12 no-padding"},n.createElement("label",{htmlFor:"title"},"Title:")),n.createElement("div",{className:"col-md-11 col-xs-11 no-padding"},n.createElement("input",{type:"text",className:"form-control",name:"title",value:i.title,onChange:function(t){return e.handleFormChange(t)}})),n.createElement("div",{className:"col-md-1 col-xs-1"},n.createElement("label",null,n.createElement("i",{className:"fa fas fa-asterisk"}))))),n.createElement("div",{className:"col-md-6 col-xs-12 "},n.createElement("div",{className:"col-md-12 col-xs-12 no-padding"},n.createElement("label",{htmlFor:"description"},"Description")),n.createElement("div",{className:"col-md-11 col-xs-11 no-padding"},n.createElement("textarea",{className:"form-control",name:"description",value:i.description,onChange:function(t){return e.handleFormChange(t)}})))),!a&&n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-6 col-xs-12",id:"divAddImage"},n.createElement("label",{htmlFor:""},"Add image"),n.createElement("br",null),n.createElement("button",{className:"btn btn-primary btn-fill"},n.createElement("i",{className:"fa fa-camera"})," Take Photo or Video"),n.createElement("button",{className:"btn btn-primary btn-fill"},n.createElement("i",{className:"fa fa-image"})," Choose From"))),n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"status"},"Status")),n.createElement("div",{className:"col-md-3 col-xs-11"},n.createElement("select",{className:"form-control",value:i.status,id:"status",name:"status",onChange:function(t){return e.handleFormChange(t)}},n.createElement("option",{value:""},"Select Status"),n.createElement("option",{value:"open"},"Open"),n.createElement("option",{value:"inprogress"},"In Progress"),n.createElement("option",{value:"onhold"},"On Hold"),n.createElement("option",{value:"pending"},"Pending"),n.createElement("option",{value:"completed"},"Completed"),n.createElement("option",{value:"canceled"},"Canceled"))),n.createElement("div",{className:"col-md-1 col-xs-1"},n.createElement("label",null,n.createElement("i",{className:"fa fas fa-asterisk"}))),n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"dueDate"},"Due Date")),n.createElement("div",{className:"col-md-4 col-xs-12"},n.createElement(o.a,{disabled:a,id:"dueDate",className:"form-control",selected:E,onChange:function(t){return e.handleDueDateChange(t)},showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",timeCaption:"time",customInput:n.createElement("input",{type:"text",className:"form-control",placeholder:"Due Date","aria-label":"","aria-describedby":"button-addon4",value:i.dueDate})}))),n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"duration"},"Estimated Duration (hours)")),n.createElement("div",{className:"col-md-4 col-xs-12"},n.createElement("input",{type:"number",className:"form-control",min:0,name:"duration",value:i.duration,onChange:function(t){return e.handleFormChange(t)}})),n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"priority"},"Priority")),n.createElement("div",{className:"col-md-3 col-xs-11"},n.createElement("select",{className:"form-control",name:"priority",value:i.priority,onChange:function(t){return e.handleFormChange(t)}},n.createElement("option",{value:""},"None"),n.createElement("option",{value:"Low"},"Low"),n.createElement("option",{value:"Medium"},"Medium"),n.createElement("option",{value:"High"},"High"),n.createElement("option",{value:"Critical Path"},"Critical Path"))),n.createElement("div",{className:"col-md-1 col-xs-1"},n.createElement("label",null,n.createElement("i",{className:"fa fas fa-asterisk"})))),n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"category"},"Category")),n.createElement("div",{className:"col-md-4 col-xs-12"},n.createElement("input",{type:"text",className:"form-control",name:"category",value:i.category,onChange:function(t){return e.handleFormChange(t)}})),n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"assignee"},"Assigned To")),n.createElement("div",{className:"col-md-3 col-xs-11"},n.createElement("select",{className:"form-control",name:"assignee",value:i.assignee,onChange:function(t){return e.handleFormChange(t)}},n.createElement("option",{value:""},"Select Person"),d.map(function(e,t){return n.createElement("option",{key:t,value:e.contact.value},e.name.value," ",e.group&&"- ("+e.group.value+")"," ")}))),n.createElement("div",{className:"col-md-1 col-xs-1"},n.createElement("label",null,n.createElement("i",{className:"fa fas fa-asterisk"})))),n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"additionalWorkers"},"Additional Workers")),n.createElement("div",{className:"col-md-4 col-xs-12"},n.createElement("input",{type:"text",className:"form-control",name:"additionalWorkers",value:i.additionalWorkers,onChange:function(t){return e.handleFormChange(t)}}))),n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"location"},"Location")),n.createElement("div",{className:"col-md-3 col-xs-11"},n.createElement("select",{className:"form-control",name:"location",value:i.location,onChange:function(t){return e.handleFormChange(t)}},n.createElement("option",{value:""},"Select Location"),m.map(function(e,t){return n.createElement("option",{value:e.ontology.value,key:t},e.rdfsLabel.value," ")}))),n.createElement("div",{className:"col-md-1 col-xs-1"},n.createElement("label",null,n.createElement("i",{className:"fa fas fa-asterisk"}))),n.createElement("div",{className:"col-md-2 col-xs-12"},n.createElement("label",{htmlFor:"asset"},"Asset")),n.createElement("div",{className:"col-md-3 col-xs-11"},n.createElement("select",{className:"form-control",name:"asset",value:i.asset,onChange:function(t){return e.handleFormChange(t)}},n.createElement("option",{value:""},"Select Asset"),f.map(function(e,t){return n.createElement("option",{value:e.ontology.value,key:t},e.rdfsLabel.value," ")}))),n.createElement("div",{className:"col-md-1 col-xs-1"},n.createElement("label",null,n.createElement("i",{className:"fa fas fa-asterisk"})))),!a&&n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-12 inline-flex"},n.createElement("button",{className:"btn btn-primary btn-fill",disabled:!b,onClick:function(){e._saveWorkOrder()}},n.createElement("i",{className:"fa fa-save"})," Save"),n.createElement("button",{className:"btn btn-secondary btn-fill",onClick:function(){window.location.hash=r+"/"+l+"/WorkOrders"}},n.createElement("i",{className:"fa fa-window-close"})," Cancel"))))))},t}(n.Component);t.default=b}});