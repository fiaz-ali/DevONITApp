webpackJsonp([9],{1016:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={task:{Action:"Detail about work that is needed to be done",AssignedTo:"In Simple or Detail Task mode, It is the person(s) who is responsible to perform this task, In Sequence task, this person is the facilitator who is looking after the tasks/subtasks. Facilitator is authorised to modify the task. He is also responsible for resolving issues occuring to workers in this task. ",Criticality:"Criticality of the task to define its priority.",Building:"Defines in which building this task is needed to be performed , On Selection, It Filters out all the related Floors and and people of selected building.",Floor:"Defines in which Floor this task is needed to be performed, On selection, associated locations(spaces) are filtered out",Location:"Defines in which Space this task is needed to be performed, On selection, associated Assets are filtered out",Asset:"Defines on which Asset this task is needed to be performed, Assets includes related devices, points and equipments residing in selected space. "}}},1017:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),n(995)),o=n(568),s=n(656),r=n(17),c=n(592),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),u=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,selectedSteps:n.props.sweeps,modelDetails:Object(),mapModelDetails:Object(),spaceDetails:[],currentSweep:Object(),matterTags:[],floorDetails:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:n.props.isViewForm,prevSweepIndex:0,prevSweepModel:Object(),onPropsReceivedStateChanged:!1,linkBimism:n.props.bimURL,routes:n.props.routes,locationDropdownList:[],destinationSpace:n.props.selectedSpace,destinationSweeps:n.props.sweeps,isTaskView:n.props.isTaskView,currentView:"TaskRoute",floor:Object(),hideMap:!0,hideInBuildingRoutes:!0,allSweeps:[],inBuildingRoutes:[],space:n.props.space,currentFloor:"",floorsBimList:[]},n.loadSDK=n.loadSDK.bind(n),n.loadFrame=n.loadFrame.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.removeSweep=n.removeSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.onSaveHandle=n.onSaveHandle.bind(n),n.handleRouteChange=n.handleRouteChange.bind(n),n.getRoutes=n.getRoutes.bind(n),n.checkPreviousRoutesWithCurrentRoutes=n.checkPreviousRoutesWithCurrentRoutes.bind(n),n.fetchFloorListImages=n.fetchFloorListImages.bind(n),n.getFloorsList=n.getFloorsList.bind(n),n}return l(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this;if((0==this.state.selectedSteps.length&&e.sweeps.length>0||e.isSweepChangeable)&&(this.setState({selectedSteps:JSON.parse(JSON.stringify(e.sweeps)),hasStartSweep:!0,startSweep:e.sweeps.find(function(e){return 0==e.stepNo}),onPropsReceivedStateChanged:!0},function(){t.state.sdk&&t.loadFrame(t.state.sdk,t.setDialogState,t.state)}),e.isSweepChangeable&&this.props.onSweepChangeable(e.isSweepChangeable)),e.bimURL&&this.state.linkBimism!=e.bimURL&&this.setState({linkBimism:e.bimURL}),e.locationDropdownList&&this.setState({locationDropdownList:e.locationDropdownList}),e.sweeps&&e.sweeps.length>0&&this.state.destinationSweeps!=e.sweeps){var n=e.sweeps.sort(function(e){return e.stepNo});this.setState({destinationSweeps:e.sweeps,hasStartSweep:!0,startSweep:n[0]})}if(e.selectedSpace&&this.state.destinationSpace.value!=e.selectedSpace.value&&this.setState({destinationSpace:e.selectedSpace}),e.routes&&e.routes.length>0){var a=this.state.selectedSteps;e.routes.forEach(function(e){e.sweeps.forEach(function(e){null==e&&""+e=="undefined"||a.push(e)})}),this.setState({routes:e.routes,onPropsReceivedStateChanged:!0,selectedSteps:a}),this.state.sdk&&this.loadFrame(this.state.sdk,this.setDialogState,this.state)}e.floor&&e.floor.bimSid&&this.setState({floor:e.floor,floorsBimList:[]},function(){t.getFloorsList(e.floor)}),e.space&&e.space!=this.state.space&&(this.setState({space:e.space}),this.state.sdk&&this.loadFrame(this.state.sdk,this.setDialogState,this.state))},t.prototype.componentDidUpdate=function(){this.state.onPropsReceivedStateChanged&&this.setState({onPropsReceivedStateChanged:!1})},t.prototype.getRoutes=function(e){return u(this,void 0,void 0,function(){var t,n,a,i,o,c,l,p=this;return d(this,function(h){switch(h.label){case 0:return t=this.props.buildingName,n=this.state,a=n.space,i=n.selectedSteps,o=[],c=[],l=[],a?[4,Object(s.a)(t,a).then(function(t){return u(p,void 0,void 0,function(){var n,s,u,p,h,m,f,b;return d(this,function(d){for(n=0;n<t.length;n++){for(s=t[n],(u=Object()).description=Object(r.g)(s.description),u.ontology=Object(r.g)(s.ontology),u.space=Object(r.g)(s.space),u.routeName=Object(r.g)(s.routeName),c=Object(r.g)(s.sweeps).split(","),l=Object(r.g)(s.stepNo).split(","),p=Object(),h=[],m=function(t){var n=c[t],o=Object();(p=e.find(function(e){return e.uuid==n}))&&(o.uuid=p.uuid,o.assignedSpace=a,o.stepNo=l[t],h.push(o),i.push(o))},f=0;f<c.length;f++)m(f);u.sweeps=h,o.push(u)}return b=this.state.inBuildingRoutes,this.setState({inBuildingRoutes:o,selectedSteps:i}),o.length>0&&(this.checkPreviousRoutesWithCurrentRoutes(o,b)||this.loadFrame(this.state.sdk,this.setDialogState,this.state)),[2]})})}).catch(function(e){return e})]:[2];case 1:return h.sent(),[2]}})})},t.prototype.checkPreviousRoutesWithCurrentRoutes=function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++){if(e[n].description!=t[n].description||e[n].floorBimUrl!=t[n].floorBimUrl||e[n].hideRoutesView!=t[n].hideRoutesView||e[n].ontology!=t[n].ontology||e[n].routeName!=t[n].routeName||e[n].space!=t[n].space)return!1;if(e[n].sweeps.length!=t[n].sweeps.length)return!1;for(var a=0;a<e[n].sweeps.length;a++)if(e[n].sweeps[a].assignedSpace!=t[n].sweeps[a].assignedSpace||e[n].sweeps[a].buildingName!=t[n].sweeps[a].buildingName||e[n].sweeps[a].ontology!=t[n].sweeps[a].ontology||e[n].sweeps[a].stepNo!=t[n].sweeps[a].stepNo||e[n].sweeps[a].uuid!=t[n].sweeps[a].uuid||e[n].sweeps[a].uuidIndex!=t[n].sweeps[a].uuidIndex)return!1}},t.prototype.getFloorsList=function(e){return u(this,void 0,void 0,function(){var t,n,a=this;return d(this,function(i){switch(i.label){case 0:return t=this.props.buildingName,n=this.state.floorsBimList,(n=[]).push({floor:e.floor,linkBimism:e.linkBimism,rdfsLabel:e.rdfsLabel+" (Default)",bimFloor:e.bimFloor,bimSid:e.bimSid,xScaleMap:e.xScaleMap,yOffsetMap:e.yOffsetMap,xOffsetMap:e.xOffsetMap,yScaleMap:e.yScaleMap}),this.setState({floorsBimList:n},function(){return u(a,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this.fetchFloorListImages()];case 1:return e.sent(),[2]}})})}),e.bimSid?[4,Object(c.a)(t,"",e.bimSid).then(function(t){return u(a,void 0,void 0,function(){var n,a,i,o=this;return d(this,function(s){for(n=this.state.floorsBimList,a=function(a){var i=t[a];if(Object(r.g)(i.bimFloor)==e.bimFloor)return"continue";if(n.find(function(e){return e.bimFloor==Object(r.g)(i.bimFloor)}))return"continue";var o=Object();o.floor=Object(r.g)(i.zone),o.linkBimism=Object(r.g)(i.linkBimism),o.rdfsLabel=Object(r.g)(i.rdfsLabel),o.bimFloor=Object(r.g)(i.bimFloor),o.bimSid=Object(r.g)(i.bimSid),o.xScaleMap=Object(r.g)(i.xScaleMap),o.yOffsetMap=Object(r.g)(i.yOffsetMap),o.xOffsetMap=Object(r.g)(i.xOffsetMap),o.yScaleMap=Object(r.g)(i.yScaleMap),o.imgFloorMap="",n.push(o)},i=0;i<t.length;i++)a(i);return this.setState({floorsBimList:n},function(){return u(o,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this.fetchFloorListImages()];case 1:return e.sent(),[2]}})})}),[2]})})})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.fetchFloorListImages=function(){return u(this,void 0,void 0,function(){var e,t,a,i,o,r;return d(this,function(c){switch(c.label){case 0:e=this.state.floorsBimList,t=this.props.buildingName,a=0,c.label=1;case 1:return a<e.length?(i=e[a],[4,Object(s.b)(t,i.floor)]):[3,4];case 2:o=c.sent(),r=o&&o[0]?""+o[0].bimImageBase:n(661),i.imgFloorMap=r,e[a]=i,c.label=3;case 3:return a++,[3,1];case 4:return this.setState({floorsBimList:e},function(){console.log("floor bim list with images loaded")}),[2]}})})},t.prototype.onFloorChange=function(e){return u(this,void 0,void 0,function(){var t,n,a,i,o,s,r;return d(this,function(c){return t=this.state,n=t.currentFloor,a=t.floor,i=t.floorsBimList,o=t.currentSweep,s=i.find(function(t){return t.bimFloor==e}),a=s,r=parseInt(e.split(" ")[1]),r-=1,window.moveToFloor(r),n="Floor "+(r+1),this.setState({currentFloor:n,floor:a},function(){window.sweepsMappingFloor(a,o.uuid)}),[2]})})},t.prototype.onSaveHandle=function(){if(this.props.isTaskForm){var e=this.state.routes;this.props.onSaveRouteClickButton(e)}else{var t=this.state.selectedSteps;this.props.onSaveClickButton(t)}},t.prototype.toggleAddingSweep=function(){window.toggleStartStopAddingSweep()},t.prototype.toggleTourStartStop=function(){window.toggleTourSelectedSweep()},t.prototype.toggleTourSweepsStartStop=function(e,t){window.toggleTourSweepsSelectedSweepNew(e,t)},t.prototype.addCurrentSweep=function(){window.addCurrentSweep()},t.prototype.removeSweep=function(e){window.removeSweep(e)},t.prototype.setDialogState=function(e,t,n,a,i,o,s,r,c,l,p,h){var m=this;null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&this.setState({selectedSteps:n}),null!=a&&(this.setState({modelDetails:a}),this.getRoutes(a.sweeps)),null!=p&&this.setState({mapModelDetails:p}),null!=i&&this.setState({currentSweep:i}),null!=o&&this.setState({logMessage:o}),null!=r&&this.setState({prevSweepIndex:r}),null!=c&&this.setState({prevSweepModel:c}),null!=h&&this.state.currentFloor!=h&&this.setState({currentFloor:h},function(){return u(m,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this.onFloorChange(h)];case 1:return e.sent(),[2]}})})}),null!=s&&this.setState({sdkReady:s}),null!=l&&(this.setState({sdk:l}),this.loadFrame(this.state.sdk,this.setDialogState,this.state))},t.prototype.loadSDK=function(e){var t=n(706),a=t.APIKey,i=t.Version,o=document.getElementById("showcase");window.MP_SDK.connect(o,a,i).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.loadFrame=function(e,t,n){var a,i,o,s=document.getElementById("map"),r=0,c={sweep:"",mode:"INSIDE",transition:"FLY"},l=this.state,p=l.modelDetails,h=l.currentSweep,m=l.isStarted,f=l.isTourSelected,b=l.selectedSteps,g=l.sdkReady,v=l.startSweep,S=l.hasStartSweep,w=l.prevSweepIndex,k=l.prevSweepModel,y=l.isTaskView,T=l.mapModelDetails,E=l.currentFloor;function O(){return u(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,e.Model.getData().then(function(n){e.Camera.getPose().then(function(a){e.Renderer.getWorldPositionData(a.position).then(function(e){console.log("Model data loaded for sid:",n.sid),console.log("Current floor:",e.floor),E="Floor "+(parseInt(e.floor)+1),p=n,T.sweeps=n.sweeps.filter(function(t){return t.floor==parseInt(e.floor)}),h.uuid=a.sweep,t(null,null,null,p,h,null,null,null,null,null,null,E)})})})];case 1:return n.sent(),[2]}})})}function N(n,a){m?console.log("Tour Stopped"):(a.length>0&&a.length>n?(f=!0,e.Sweep.moveTo(a[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+a[n].uuidIndex;console.log(t),N(n+=1,a)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(f=!1,console.log("Tour Ended")),t(null,f))}function j(e,t){var n=document.getElementById("p"+t),a=document.getElementById("p"+e)||n;c.sweep=n&&n.value||"",function(e,t){t&&t.classList.remove("active");e&&(e.classList+=" active")}(n,a)}function C(e,t,n,a,i){return(e-t)/(n-t)*a+i}g||e.App.state.subscribe(function(n){return u(this,void 0,void 0,function(){return d(this,function(a){switch(a.label){case 0:return n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase!==e.App.Phase.PLAYING?[3,2]:(console.log("The app is ready to take user input now!"),g=!0,t(null,null,null,null,null,null,!0),[4,function e(t){return u(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return n.sent(),p.sweeps&&p.sweeps.length>0&&E?[2]:[3,2];case 2:return[4,e(O)];case 3:n.sent(),n.label=4;case 4:return[2]}})})}(O)]);case 1:a.sent(),S&&window.goToSweep(v.uuid),a.label=2;case 2:return[2]}})})}),window.sweepsMappingFloor=function(e,t){if(T.sweeps&&T.sweeps.length>0){a=0,o=0,i=0,r=0;var n=T.sweeps.map(function(e){if(e.position){var t={pid:e.uuid,x:e.position.x||0,y:e.position.z||0};return function(e,t){a=Math.min(a,e),o=Math.max(o,e),i=Math.min(i,t),r=Math.max(o,t)}(t.x,t.y),0==t.x&&0==t.y&&(c.sweep=e.uuid),t}});s.innerHTML="",n.map(function(t){return function(e,t){if(e){var n=document.createElement("BUTTON"),c=0,l=0,u=0,d=0,p=0,h=0;if(!t)return;u=t.xScaleMap&&parseInt(t.xScaleMap)?parseInt(t.xScaleMap):70,d=t.xOffsetMap&&parseInt(t.xOffsetMap)?parseInt(t.xOffsetMap):13,p=t.yScaleMap&&parseInt(t.yScaleMap)?parseInt(t.yScaleMap):70,h=t.yOffsetMap&&parseInt(t.yOffsetMap)?parseInt(t.yOffsetMap):45,c=C(e.x,a,o,u,d),l=C(e.y,i,r,p,h),n.setAttribute("id","p"+e.pid),n.setAttribute("value",e.pid),n.style.left=c+"%",n.style.top=l+"%",n.setAttribute("class","sweep z-depth-3"),n.addEventListener("click",function(e){window.goToSweep(e.target.value),e.stopPropagation()}),s.appendChild(n)}}(t,e)})}},window.toggleStartStopAddingSweep=function(){t(m=!m),m&&window.addCurrentSweep()},window.toggleTourSelectedSweep=function(){(t(null,f=!0),f)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),N(0,b.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,f))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,f=!0),f)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),N(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,f))},window.toggleTourSweepsSelectedSweepNew=function(n,a){for(var i=1;i<=n.length;i++){var o=document.getElementById(a+"_chkstep_"+i);o&&(o.checked=!1)}(0==a&&++a,t(null,f=!0),f)?(t(null,null,null,null,null,"Tour Started"),function n(a,i,o){m?console.log("Tour Stopped"):(i.length>0&&i.length>a?(f=!0,e.Sweep.moveTo(i[a].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+i[a].uuidIndex;console.log(t),a+=1;var s=document.getElementById(o+"_chkstep_"+a);s&&(s.checked=!0),n(a,i,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(f=!1,console.log("Tour Ended")),t(null,f))}(0,n.sort(function(e,t){return e.stepNo-t.stepNo}),a)):t(null,f)},window.addCurrentSweep=function(){e.Camera.getPose().then(function(e){var n=p.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,h=n);var a=p.sweeps.indexOf(n);if(!function(e){if(b.length>0){var t=b.find(function(t){return t.uuid==e});if(null!=t||""+t!="undefined"){var n="Sweep "+t.uuid+" of index "+t.uuidIndex+" is already added in the current list";return console.log(n),!0}}return!1}(h.uuid)){b.push({uuid:h.uuid,uuidIndex:a,stepNo:b.length}),t(null,null,b);var i="Sweep "+h.uuid+" of index "+a+" is added in the current list";console.log(i)}})},window.removeSweep=function(e){var n=b.find(function(t){return t.uuid==e}),a=b.indexOf(n);if(a>-1){b.splice(a,1),t(null,null,b);var i="Sweep "+n.uuid+" of index "+n.uuidIndex+" is removed from the current list";console.log(i)}},window.goToSweep=function(t){e.Sweep.moveTo(t,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+t;console.log(n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},window.moveToFloor=function(t){e.Floor.moveTo(t).then(function(e){console.log("Current floor: "+e),E="Floor "+(-1==e?1:e+1)}).catch(function(e){})},e.on(e.Sweep.Event.ENTER,function(){if(f)return!1;e.Camera.getPose().then(function(n){if("mode.inside"==n.mode||"mode.outside"==n.mode){if(b.length>0){var a=b.find(function(e){return e.uuid==n.sweep});if(null!=a&&""+a!="undefined"){var i="Moved to sweep "+a.uuid;console.log(i),y?(j(k.uuid,n.sweep),k=a):(j(b[w].uuid,n.sweep),w=b.indexOf(a)),t(null,null,null,null,null,null,null,w)}else{i="Not allowed in the current step ";console.log(i),y&&k.uuid?window.goToSweep(k.uuid):window.goToSweep(b[w].uuid)}}e.Renderer.getWorldPositionData(n.position).then(function(e){return u(this,void 0,void 0,function(){var a;return d(this,function(i){return a="Floor "+(parseInt(e.floor)+1),E&&E!=a&&(E=a,h.uuid=n.sweep,p.sweeps&&(T.sweeps=p.sweeps.filter(function(t){return t.floor==parseInt(e.floor)}),t(null,null,null,null,h,null,null,null,null,null,T,E))),[2]})})})}})})},t.prototype.handleRouteChange=function(e){for(var t=[],n=0;n<e.length;n++)for(var a=e[n].sweeps,i=0;i<a.length;i++){var o=a[i];t.push(o)}this.setState({routes:e,selectedSteps:t});var s=this.state,r=s.floor,c=s.currentSweep;window.sweepsMappingFloor(r,c.uuid)},t.prototype.render=function(){var e=this;this.props.isRefreshDialog&&(this.setState({isStarted:!1,isTourSelected:!1,selectedSteps:[],modelDetails:Object(),spaceDetails:[],currentSweep:Object(),matterTags:[],floorDetails:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:this.props.isViewForm,prevSweepIndex:0,onPropsReceivedStateChanged:!1,linkBimism:this.props.bimURL,destinationSpace:{label:"",value:""},destinationSweeps:[],routes:[],locationDropdownList:[],hideInBuildingRoutes:!0,hideMap:!0}),this.props.onRefreshMatterport(!1),document.getElementById("map").innerHTML="");var t=this.props,s=t.id,r=t.heading,c=t.isViewForm,l=t.isTaskForm,u=t.isTaskView,d=t.sweeps,p=t.selectedSpace,h=t.showSaveButton,m=this.state,f=m.isStarted,b=m.selectedSteps,g=m.isTourSelected,v=m.logMessage,S=m.sdkReady,w=m.linkBimism,k=m.routes,y=m.locationDropdownList,T=m.currentView,E=m.floor,O=m.hideMap,N=m.inBuildingRoutes,j=m.hideInBuildingRoutes,C=0,D=0,R=!1,_=!1;S?(R=g,_=f):(R=!0,_=!0);var A=E&&E.imgFloorMap?E.imgFloorMap:n(661);return a.createElement(o.a,{id:s,saveButtonText:"Save",heading:r,showSaveButton:h,showCancelButton:c,onSaveButtonClick:function(){e.onSaveHandle()},isFullWidth:!0},"TaskRoute"==T&&a.createElement("div",{className:"card dataCard no-margin"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:""},l&&a.createElement("div",{className:"col-md-7 col-xs-12 matterport-dialog-task-margin-bottom"},!l&&!u&&a.createElement(a.Fragment,null,!c&&a.createElement("button",{type:"button",id:"btnStartStop",disabled:R,title:1==f?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:this.toggleAddingSweep},a.createElement("i",{className:1==f?"fa fa-stop":"fa fa-plus"})),!c&&a.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:R&&_,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:this.addCurrentSweep},a.createElement("i",{className:"fa fa-thumb-tack"})),a.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:_,title:1==f?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:this.toggleTourStartStop},a.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})),a.createElement("br",null),a.createElement("br",null)),!l&&!u&&a.createElement("span",{className:"small-font-list"},v),l&&a.createElement(i.a,{building:this.props.buildingName,items:k,onItemChange:this.handleRouteChange,isView:!1,spaces:y,destinationSpace:p,destinationSweeps:d})),!u&&a.createElement("div",{className:"col-md-5 col-xs-12"},a.createElement("table",null,a.createElement("tr",null,a.createElement("th",null,"Steps"),a.createElement("th",null)),b&&b.map(function(t){return C+=1,a.createElement("tr",null,a.createElement("td",{className:"link",onClick:function(){S&&window.goToSweep(t.uuid)}},"Step ",C,": ",t.uuid),a.createElement("td",null,!c&&S&&a.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(t.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},a.createElement("i",{className:"fa fa-times"}))))}))),u&&a.createElement("div",{className:"col-md-5 col-xs-12"},k&&k.map(function(t,n){return C=0,D+=1,a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6"},a.createElement("b",null,"Route ",D)),a.createElement("div",{className:"col-md-6"},a.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:_,title:1==f?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill btn-sm float-right matterport-dialog-btn-play-sm",onClick:function(){e.toggleTourSweepsStartStop(t.sweeps,n+1)}},a.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})))),a.createElement("span",{className:"small-font-list"},t.description),l&&a.createElement("table",null,a.createElement("tr",null,a.createElement("th",null,"Steps")),t.sweeps.map(function(e){return C+=1,a.createElement("tr",null,a.createElement("td",{className:"link",onClick:function(){S&&window.goToSweep(e.uuid)}}," Step ",C,": ",a.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:D+"_chkstep_"+C.toString()})))})),a.createElement("br",null),a.createElement("br",null))}))),a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("button",{type:"button",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:function(){e.setState({hideMap:!O})}},O?"Show Map":"Hide Map")),N&&N.length>0&&a.createElement("div",{className:"col-md-3"},a.createElement("button",{type:"button",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin pull-left",onClick:function(){e.setState({hideInBuildingRoutes:!j})}},j?"Show In Building Routes":"Hide In Building Routes"))),a.createElement("br",null),!j&&N.map(function(t,n){return a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-3"},a.createElement("b",null,t.routeName)),a.createElement("div",{className:"col-md-1"},a.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:_,title:1==f?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill btn-sm float-right matterport-dialog-btn-play-sm",onClick:function(){e.toggleTourSweepsStartStop(t.sweeps,n)}},a.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})))),a.createElement("br",null))})),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("iframe",{id:"showcase",src:w,onLoad:function(){e.loadSDK(e.setDialogState)},width:"100%",height:"500",frameBorder:"0",allowFullScreen:!0})),a.createElement("div",{className:O?"col-md-12 display-none":"col-md-12"},a.createElement("div",{className:"map-container"},a.createElement("img",{className:"responsive-img",src:A,alt:""}),a.createElement("div",{id:"map",className:"map"})))))))},t}(a.Component);t.a=p},1509:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(3),o=(n.n(i),n(1510)),s=n(1511),r=n(1512),c=n(18),l=n(568),u=n(600),d=n.n(u),p=n(629),h=n(17),m=n(699),f=n(578),b=n(87),g=n(93),v=n(581),S=n(14),w=n(656),k=n(579),y=n(1016),T=n(595),E=n(92),O=n(627),N=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),j=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},C=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},D=new m.a,R=new Date,_=new Date,A=function(e){function t(t){var n=e.call(this,t)||this;return n.state={task:Object(),showDetailForm:!1,showSequenceForm:!1,isEdit:!1,people:[],isDateOnly:!1,startedTasks:[],tasksDropdownList:[],isNotifyDate:!0,taskType:"",routeSpaces:[],allSpaces:[],allSweeps:[],showQRTaskToggle:!1,_buildings:[],filteredPeople:[],actions:[]},n.updateView=n.updateView.bind(n),n.handleTaskChange=n.handleTaskChange.bind(n),n.handleDoAtChange=n.handleDoAtChange.bind(n),n.handleDoIfStartRadio=n.handleDoIfStartRadio.bind(n),n._saveTask=n._saveTask.bind(n),n._saveRoutes=n._saveRoutes.bind(n),n.sendSms=n.sendSms.bind(n),n.sendMail=n.sendMail.bind(n),n._fetchPeople=n._fetchPeople.bind(n),n.fetchTask=n.fetchTask.bind(n),n._fetchTasks=n._fetchTasks.bind(n),n.getTaskRoutes=n.getTaskRoutes.bind(n),n.getAllSpaces=n.getAllSpaces.bind(n),n.getAllSweeps=n.getAllSweeps.bind(n),n.interruptTasks=n.interruptTasks.bind(n),n.handleNotifyDateChange=n.handleNotifyDateChange.bind(n),n.handleNotifyRadio=n.handleNotifyRadio.bind(n),n.handleManagerReviewCheck=n.handleManagerReviewCheck.bind(n),n.handleRecurringCheck=n.handleRecurringCheck.bind(n),n.handleRecurringScheduleRadio=n.handleRecurringScheduleRadio.bind(n),n.handleRecurringEndDays=n.handleRecurringEndDays.bind(n),n.handleRecurringDays=n.handleRecurringDays.bind(n),n.handleMultiTaskChange=n.handleMultiTaskChange.bind(n),n.handleRoutesMatterport=n.handleRoutesMatterport.bind(n),n.handleShowQrToggle=n.handleShowQrToggle.bind(n),n.handleBuildingChange=n.handleBuildingChange.bind(n),n.onDoneClicked=n.onDoneClicked.bind(n),n._saveObjectFormAction=n._saveObjectFormAction.bind(n),n.addNewDoWhatTask=n.addNewDoWhatTask.bind(n),a=n,n}return N(t,e),t.prototype.componentWillMount=function(){return j(this,void 0,void 0,function(){return C(this,function(e){return[2]})})},t.prototype.componentDidMount=function(){return j(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return(e=this.state.actions)[0]=[],this.setState({actions:e}),this.props.buildingName?(this._fetchBuildings(),this._fetchTasks(),[4,this.fetchTask()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.addNewDoWhatTask=function(e){return j(this,void 0,void 0,function(){var t;return C(this,function(n){return(t=this.state.actions)[e]=[],this.setState({actions:t}),[2]})})},t.prototype._fetchBuildings=function(){return j(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,Object(T.d)().then(function(e){a.setState({_buildings:e})}).catch(function(e){return e})];case 1:return e.sent(),[2]}})})},t.prototype._fetchTasks=function(){return j(this,void 0,void 0,function(){var e,t,n;return C(this,function(i){switch(i.label){case 0:return e=this.state,t=e.startedTasks,n=e.tasksDropdownList,t.length<1||n.length<1?[4,Object(p.i)("","",!1).then(function(e){var t=(e&&e.filter(function(e){return!e.hasOwnProperty("parentTask")&&"Completed"!=Object(h.g)(e.status)})).map(function(e){return{value:Object(h.g)(e.task),label:Object(h.g)(e.taskNumber)+"- "+Object(h.g)(e.description)}});a.setState({startedTasks:e&&e.filter(function(e){return e.hasOwnProperty("startTime")&&"Started"==Object(h.g)(e.status)}),tasksDropdownList:t})}).catch(function(e){return e})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.interruptTasks=function(){return j(this,void 0,void 0,function(){var e,t,n=this;return C(this,function(a){return e=this.state.startedTasks,t=this.state.task,e.length>0&&e.map(function(e){t.assignedTo.map(function(t){Object(h.g)(e.assignedTo)==t.value&&(Object(p.c)(Object(h.g)(e.task),"Interrupted"),n.updateTaskStatus(Object(h.g)(e.task),"Paused"))})}),[2]})})},t.prototype.updateTaskStatus=function(e,t){return j(this,void 0,void 0,function(){return C(this,function(n){switch(n.label){case 0:return[4,Object(p.t)(e,t,!0)];case 1:return n.sent(),[2]}})})},t.prototype.getTaskRoutes=function(e,t){return j(this,void 0,void 0,function(){var n,a,i,o,s=this;return C(this,function(r){switch(r.label){case 0:return n=[],a=[],i=[],o=[],[4,Object(w.d)(e,t).then(function(e){return j(s,void 0,void 0,function(){var t,s,r,c=this;return C(this,function(l){return t=this.state,s=t.allSpaces,r=t.allSweeps,e.forEach(function(e){return j(c,void 0,void 0,function(){var t,c,l,u,d,p,m,f,b;return C(this,function(g){for((t=Object()).description=Object(h.g)(e.description),t.ontology=Object(h.g)(e.ontology),t.task=Object(h.g)(e.task),a=e.space.value.split(","),i=e.sweeps.value.split(","),o=e.stepNo.value.split(","),c=Object(),l=[],d=function(e){var t=a[e];null==(u=s.find(function(e){return e.space.value==t}))&&""+u=="undefined"||(c={label:u.rdfsLabel.value,value:t},l.push(c))},b=0;b<a.length;b++)d(b);for(p=Object(),m=[],f=function(e){var t=i[e];null==(p=r.find(function(e){return e.uuid==t}))&&""+p=="undefined"||(p.stepNo=o[e],m.push(p))},b=0;b<i.length;b++)f(b);return t.space=l,t.sweeps=m,n.push(t),[2]})})}),this.setState({routeSpaces:n}),[2]})})}).catch(function(e){return e})];case 1:return r.sent(),[2]}})})},t.prototype.getAllSpaces=function(e){return j(this,void 0,void 0,function(){var t=this;return C(this,function(n){switch(n.label){case 0:return[4,Object(k.g)(e).then(function(n){return j(t,void 0,void 0,function(){return C(this,function(t){return this.setState({allSpaces:n}),""+this.state.task.task!="undefined"&&this.getTaskRoutes(e,this.state.task.task),[2]})})}).catch(function(e){return e})];case 1:return n.sent(),[2]}})})},t.prototype.getAllSweeps=function(e){return j(this,void 0,void 0,function(){var t,n=this;return C(this,function(a){switch(a.label){case 0:return t=[],[4,Object(w.c)(e).then(function(a){return j(n,void 0,void 0,function(){return C(this,function(n){return a.forEach(function(e){var n=Object();n.assignedSpace=Object(h.g)(e.assignedSpace),n.buildingName=Object(h.g)(e.buildingName),n.ontology=Object(h.g)(e.ontology),n.uuid=Object(h.g)(e.uuid),n.uuidIndex=parseInt(Object(h.g)(e.uuidIndex)),n.stepNo=parseInt(Object(h.g)(e.stepNo)),t.push(n)}),this.setState({allSweeps:t}),""+this.state.task.task!="undefined"&&this.getTaskRoutes(e,this.state.task.task),[2]})})}).catch(function(e){return e})];case 1:return a.sent(),[2]}})})},t.prototype.fetchTask=function(){return j(this,void 0,void 0,function(){var e,t,n,a,i,o,s,r,l,u,d,m,f,b=this;return C(this,function(g){switch(g.label){case 0:return e=this.props.taskID,t=this.state,n=t.task,a=t.showDetailForm,i=t.showSequenceForm,o=t.taskType,s=t.actions,a=!1,i=!1,r="",e?[4,Object(p.i)("",e).then(function(e){return j(b,void 0,void 0,function(){var t,o,s,c,l,u;return C(this,function(d){return t=e[0],o=t.assignedTo.value.indexOf(",")>0?t.assignedTo.value.split(", "):[t.assignedTo.value],s=t.assignedToName.value.indexOf(",")>0?t.assignedToName.value.split(", "):[t.assignedToName.value],n.task=Object(h.g)(t.task),n.taskNumber=Object(h.g)(t.taskNumber),n.description=Object(h.g)(t.description),n.action=Object(h.g)(t.action),n.enteredBy=Object(h.g)(t.enteredBy),n.enteredByName=Object(h.g)(t.enteredByName),n.assignedTo=t.assignedTo&&o.map(function(e,t){return{label:s[t],value:e}}),n.hasChat=Object(h.g)(t.chatName).trim().length>2,n.entryTimeStamp=Object(h.g)(t.entryTimeStamp),n.criticality=Object(h.g)(t.criticality),c=""!=Object(h.g)(t.equipSubject)?t.equipSubject.value.indexOf(",")>0?t.equipSubject.value.split(","):[t.equipSubject.value]:[],l=t.equipRdfsLabel&&t.equipRdfsLabel.value.indexOf(",")>0?t.equipRdfsLabel.value.split(","):[t.equipRdfsLabel.value],n.equipSubject=t.equipSubject&&c.map(function(e,t){return{label:l[t].trim(),value:e.trim()}}),n.equipRdfsLabel=Object(h.g)(t.equipRdfsLabel),n.spaceSubject=Object(h.g)(t.spaceSubject),n.spaceRdfsLabel=Object(h.g)(t.spaceRdfsLabel),n.floor=Object(h.g)(t.floor),n.building=Object(h.g)(t.building),a=Object(h.g)(t.floor).length>0||""!=Object(h.g)(t.floor)||"true"==Object(h.g)(t.isSequence),n.floorRdfsLabel=Object(h.g)(t.floorRdfsLabel),n.status=Object(h.g)(t.status),n.subTasks=[],r=Object(h.g)(t.subTasks),n.acknowledged="true"==Object(h.g)(t.acknowledged),n.archived="true"==Object(h.g)(t.archived),n.note=Object(h.g)(t.note),n.isForcePush="true"==Object(h.g)(t.isForcePush),n.isRecurring="true"==Object(h.g)(t.isRecurring),n.recurringSchedule=Object(h.g)(t.recurringSchedule),n.startTime=Object(h.g)(t.startTime),R=new Date(Object(h.g)(t.startTime)?Object(h.g)(t.startTime):Date.now()),n.notifyAt=Object(h.g)(t.notifyAt),_=new Date(Object(h.g)(t.notifyAt)?Object(h.g)(t.notifyAt):Date.now()),n.isQRTask="true"==Object(h.g)(t.isQRTask),n.QRTag=Object(h.g)(t.QRTag),n.isSequence="true"==Object(h.g)(t.isSequence),i="true"==Object(h.g)(t.isSequence),n.startTaskCondition=Object(h.g)(t.startTaskCondition),n.endingDaysCount=""==Object(h.g)(t.endingDaysCount)?null:parseInt(Object(h.g)(t.endingDaysCount)),n.recurDays=""==Object(h.g)(t.recurDays)?null:parseInt(Object(h.g)(t.recurDays)),u=""!=Object(h.g)(t.conditionalTasks)?t.conditionalTasks.value.indexOf(",")>0?t.conditionalTasks.value.split(", "):[t.conditionalTasks.value]:[],n.conditionalTasks=t.conditionalTasks&&u.map(function(e,t){return{label:e,value:e}}),n.workflowType=Object(h.g)(t.workflowType),n.redirectionLink=Object(h.g)(t.redirectionLink),n.isStage="true"==Object(h.g)(t.isStage),n.isActivated="true"==Object(h.g)(t.isActivated),n.estimatedStartTime=""!=Object(h.g)(n.estimatedStartTime)?new Date(Object(h.g)(n.estimatedStartTime)):void 0,n.estimatedEndTime=""!=Object(h.g)(n.estimatedEndTime)?new Date(Object(h.g)(n.estimatedEndTime)):void 0,[2]})})})]:[3,9];case 1:return g.sent(),[4,Object(p.j)("",e,r)];case 2:(l=g.sent())[0].subTask||(l=[]),u=function(e){var t,a,i,o,r;return C(this,function(c){switch(c.label){case 0:return t=l[e],(a=Object()).subTask=Object(h.g)(t.subTask),a.taskNumber=Object(h.g)(a.taskNumber),a.description=Object(h.g)(t.description),a.action=Object(h.g)(t.action),a.assignedTo=Object(h.g)(t.assignedTo),a.assignedDepartment=Object(h.g)(t.assignedDepartment),a.index=parseInt(Object(h.g)(t.index)),a.parentTask=Object(h.g)(t.parentTask),a.entryTimeStamp=Object(h.g)(t.entryTimeStamp),a.workOrder=Object(h.g)(t.workOrder),a.note=Object(h.g)(t.note),a.relatedLink=t.relatedLink?t.relatedLink.value.indexOf(",")>0?t.relatedLink.value.split(","):[t.relatedLink.value]:[""],a.duration=t.duration&&-1!=t.duration.value.indexOf("-")?t.duration.value.split("-")[0]:"1",a.durationUnit=t.duration&&-1!=t.duration.value.indexOf("-")?t.duration.value.split("-")[1]:"Hours",a.workerDuration=t.workerDuration&&-1!=t.workerDuration.value.indexOf("-")?t.workerDuration.value.split("-")[0]:"1",a.workerDurationUnit=t.workerDurationUnit&&-1!=t.workerDurationUnit.value.indexOf("-")?t.workerDurationUnit.value.split("-")[1]:"Hours",a.fileName=Object(h.g)(t.fileName).split(","),a.oldFileName=Object(h.g)(t.fileName).split(","),a.enteredBy=Object(h.g)(t.enteredBy),a.enteredByName=Object(h.g)(t.enteredByName),a.startTime=Object(h.g)(t.startTime),a.workType=Object(h.g)(t.workType),a.status=Object(h.g)(t.status),a.checklistID=Object(h.g)(t.checklistID),a.isQRTask="true"==Object(h.g)(t.isQRTask),a.QRTag=Object(h.g)(t.QRTag),a.notifyViaEmail="true"==Object(h.g)(t.notifyViaEmail),a.notifyViaSMS="true"==Object(h.g)(t.notifyViaSMS),a.estimatedStartTime=""!=Object(h.g)(t.estimatedStartTime)?new Date(Object(h.g)(t.estimatedStartTime)):void 0,a.estimatedEndTime=""!=Object(h.g)(t.estimatedEndTime)?new Date(Object(h.g)(t.estimatedEndTime)):void 0,i=""!=Object(h.g)(t.equipSubject)?t.equipSubject.value.indexOf(",")>0?t.equipSubject.value.split(","):[t.equipSubject.value]:[],o=t.equipRdfsLabel&&t.equipRdfsLabel.value.indexOf(",")>0?t.equipRdfsLabel.value.split(","):[t.equipRdfsLabel.value],a.equipSubject=t.equipSubject&&i.map(function(e,t){return{label:o[t].trim(),value:e.trim()}}),a.equipRdfsLabel=Object(h.g)(t.equipRdfsLabel),a.spaceSubject=Object(h.g)(t.spaceSubject),a.spaceRdfsLabel=Object(h.g)(t.spaceRdfsLabel),a.building=Object(h.g)(t.building),a.workflowType=Object(h.g)(t.workflowType),a.redirectionLink=Object(h.g)(t.redirectionLink),a.isStage="true"==Object(h.g)(t.isStage),a.isActivated="true"==Object(h.g)(t.isActivated),a.acknowledged="true"==Object(h.g)(t.acknowledged),a.archived="true"==Object(h.g)(t.archived),n.subTasks.push(a),[4,Object(O.b)(d.props.buildingName,[Object(h.g)(t.subTask)])];case 1:return r=c.sent(),s[e]=[],s[e]=r,[2]}})},d=this,m=0,g.label=3;case 3:return m<l.length?[5,u(m)]:[3,6];case 4:g.sent(),g.label=5;case 5:return m++,[3,3];case 6:return""!=n.startTime&&"Pending"!=n.status&&"Completed"!=n.status&&n.acknowledged?o="Do Now":(""!=n.startTime||n.conditionalTasks.length>0)&&"Pending"==n.status?o="Do If":""==n.startTime&&n.acknowledged&&0==n.conditionalTasks.length&&(o="Do Next"),this.setState({task:n,actions:s,taskType:o,isEdit:!0,showDetailForm:a,showSequenceForm:i,showQRTaskToggle:""!=n.QRTag},function(){return j(b,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this._fetchPeople()];case 1:return e.sent(),[2]}})})}),[4,this.getAllSpaces(n.building)];case 7:return g.sent(),[4,this.getAllSweeps(n.building)];case 8:return g.sent(),[3,10];case 9:f=JSON.parse(S.a.getItem("user")),n={acknowledged:!1,archived:!1,status:"Pending",startTime:"",spaceSubject:"",hasChat:!1,criticality:"3",assignedTo:[],description:"",spaceRdfsLabel:"",floorRdfsLabel:"",enteredBy:f.contact,enteredByName:"",floor:"",equipSubject:[],equipRdfsLabel:"",entryTimeStamp:"",task:Object(c.l)(7),subTasks:[],note:"",isDeleted:!1,isForcePush:!1,recurringSchedule:"week",isSequence:!1,startTaskCondition:"daytime",taskNumber:Object(c.k)(8).toString(),workOrder:"",isQRTask:!1,building:n.building?n.building:this.props.buildingName,isActivated:!0,isStage:!1},this.setState({task:n,isEdit:!1},function(){return j(b,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this._fetchPeople()];case 1:return e.sent(),[2]}})})}),g.label=10;case 10:return[2]}})})},t.prototype._fetchPeople=function(){return j(this,void 0,void 0,function(){var e,t,n;return C(this,function(a){switch(a.label){case 0:return e=this.state.task,[4,Object(f.n)()];case 1:return t=a.sent(),n=t.filter(function(t){return Object(h.g)(t.assignedTo).includes(e.building)}),this.setState({people:t,filteredPeople:n}),[2]}})})},t.prototype.filterPeople=function(e){return this.state.people.filter(function(t){return Object(h.g)(t.assignedTo).includes(e)})},t.prototype.handleTaskChange=function(e){this.setState({task:e})},t.prototype.handleShowQrToggle=function(e){this.setState({showQRTaskToggle:e})},t.prototype.handleDoAtChange=function(e){var t=this.state.isDateOnly,n=this.state.task;R=e,n.startTime=t?e.toDateString():e.toString(),this.setState({task:n})},t.prototype.handleManagerReviewCheck=function(e){var t=this.state.task;t.isForcePush=e,t.acknowledged=e,this.setState({task:t})},t.prototype.handleRecurringCheck=function(e){var t=this.state.task;t.isRecurring=e,this.setState({task:t})},t.prototype.handleDoIfStartRadio=function(e){var t=this.state.task;t.startTaskCondition=e,this.setState({task:t})},t.prototype.handleNotifyDateChange=function(e){var t=this.state.task;_=e,t.notifyAt=e.toString(),this.setState({task:t})},t.prototype.handleNotifyRadio=function(e){var t=this.state.isNotifyDate;t=e,this.setState({isNotifyDate:t})},t.prototype.handleRecurringScheduleRadio=function(e){var t=this.state.task;t.recurringSchedule=e,this.setState({task:t})},t.prototype.handleMultiTaskChange=function(e){var t=this.state.task;t.conditionalTasks=e,this.setState({task:t})},t.prototype.handleRoutesMatterport=function(e){this.setState({routeSpaces:e})},t.prototype.updateView=function(e,t){return j(this,void 0,void 0,function(){return C(this,function(n){return this.setState({showDetailForm:e,showSequenceForm:t}),[2]})})},t.prototype._saveRoutes=function(){return j(this,void 0,void 0,function(){var e,t,n,a,i;return C(this,function(o){switch(o.label){case 0:return e=this.props.buildingName,t=this.state,n=t.task,a=t.isEdit,(i=t.routeSpaces).map(function(e){return e.task=n.task}),Object(b.a)(!0),[4,Object(w.h)(e,i,a).then(function(){Object(b.a)(!1)})];case 1:return o.sent(),[2]}})})},t.prototype._saveTask=function(){return j(this,void 0,void 0,function(){var e,t,n,a,i,o,s,r,c,l,u,d,h=this;return C(this,function(m){for(e=this.props,t=e.buildingName,n=e.instance,a=this.state,i=a.task,o=a.isEdit,s=a.actions,r=i.subTasks,c=0,l=function(e){var t=r[e],n="";s.map(function(t,a){return j(h,void 0,void 0,function(){return C(this,function(i){return e==a&&(n="",t.map(function(e,t){n=n+e.ontology+","}),n=n.substring(0,n.length-1)),[2]})})}),r[e].checklistID=n,c+=parseInt(t.duration)},u=0;u<r.length;u++)l(u);return d=i.subTasks.length>0?new Date(i.subTasks[0].estimatedStartTime):new Date,i.estimatedEndTime=new Date(d.setHours(d.getHours()+c)),Object(b.a)(!0),i.hasChat=!0,i.isActivated=!0,i.workflowType?i.isStage=!0:i.isStage=!1,Object(p.n)(i.building,i,o).then(function(){Object(E.c)(),Object(b.a)(!1),window.location.hash=n+"/"+t+"/Tasks"}),[2]})})},t.prototype.sendMail=function(e){return j(this,void 0,void 0,function(){var t,n,a,i,o;return C(this,function(s){return t=this.state.people,n=this.props.instance,a="Scheduled 'Do At' Task: "+e.description+" Criticality: "+e.criticality+", Click: "+window.location.origin+"/#"+n+"/"+e.building+"/NewTask/"+e.task,(i=t.find(function(t){return Object(h.g)(t.contact)==e.enteredBy}))&&Object(h.g)(i.email).length>0&&"Not Working"!=Object(h.g)(i.status)&&((o=Object()).subject="Do At Task Reminder",o.to=Object(h.g)(i.email),o.text=a,Object(g.a)(o)),[2]})})},t.prototype.sendSms=function(e){return j(this,void 0,void 0,function(){var t,n;return C(this,function(a){return t=this.state.people,n=this.props.instance,e.assignedTo.map(function(a){var i=t.find(function(e){return Object(h.g)(e.contact)==a.value});i&&Object(c.r)(Object(h.g)(i.smsSchedule))&&i&&Object(h.g)(i.phone).length>0&&D.SendSMS(Object(h.g)(i.phone),'You have been assigned a new "Do Now", To view the Task: '+window.location.origin+"/#"+n+"/"+e.building+"/NewTask/"+e.task+" , Are you on it?",n,function(e){})}),[2]})})},t.prototype.handleRecurringDays=function(e){var t=this.state.task;t.recurDays=e,this.setState({task:t})},t.prototype.handleRecurringEndDays=function(e){var t=this.state.task;t.endingDaysCount=e,this.setState({task:t})},t.prototype.handleBuildingChange=function(e){var t=this.state.task;t.building=e,t.floor="",t.spaceSubject="",t.equipSubject=[],t.assignedTo=[],t.isQRTask=!1;var n=this.filterPeople(e);this.setState({task:t,showQRTaskToggle:!1,filteredPeople:n})},t.prototype.onDoneClicked=function(e,t){return j(this,void 0,void 0,function(){var n;return C(this,function(a){return(n=this.state.actions)[e-1]=t,this.setState({actions:n}),[2]})})},t.prototype._saveObjectFormAction=function(){return j(this,void 0,void 0,function(){var e,t,n;return C(this,function(a){switch(a.label){case 0:Object(b.a)(!0),e=this.props.buildingName,t=this.state.actions,n=0,a.label=1;case 1:return n<t.length?[4,Object(O.c)(e,this.state.actions[n])]:[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return Object(b.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,a=t.instance,u=this.state,p=u.task,m=u.showDetailForm,f=u.showSequenceForm,g=u.isEdit,w=u.isNotifyDate,k=u.isDateOnly,T=u.tasksDropdownList,E=u.taskType,O=u.routeSpaces,N=u.people,D=u._buildings,A=u.filteredPeople,F=JSON.parse(S.a.getItem("user")),M="1"==F.role||"2"==F.role,x=!!(p.subTasks&&p.subTasks.length>0)&&!1===p.subTasks.map(function(e){return""!==e.description&&""!==e.duration}).find(function(e){return!1===e}),L=p.description&&p.building&&p.assignedTo&&p.assignedTo.length>0&&!x&&!0,P=p.description&&!0,I=p.description&&(!p.isRecurring||"days"!=p.recurringSchedule||p.recurDays&&null!=p.recurDays)&&!0;return i.createElement("div",{className:"content",id:""},i.createElement("div",{className:"card"},i.createElement("div",{className:"container-fluid padding-10"},i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-8 no-padding"},i.createElement(o.a,{instance:a,buildingName:p.building?p.building:n,task:p,onTaskChange:this.handleTaskChange,isEdit:g,isManagerorAdmin:M,people:A,isFacilitatorText:f})),i.createElement("div",{className:"col-md-4 no-padding"},i.createElement("div",{className:"col-md-3"},i.createElement("label",{htmlFor:"building",title:y.a.task.Building}," Building: ")),i.createElement("div",{className:"col-md-9"},i.createElement("select",{className:"form-control",name:"building",disabled:!M,value:p.building,id:"building",onChange:function(t){e.handleBuildingChange(t.target.value)}},D&&D.map(function(e,t){return i.createElement("option",{key:t,value:Object(h.g)(e.building)},Object(h.g)(e.rdfsLabel)," ")})))),!m&&i.createElement("div",{className:"col-md-12 padding-10"},i.createElement("button",{className:"btn btn-primary btn-fill pull-right",onClick:function(){e.updateView(!0,!1)}}," ",i.createElement("i",{className:"fa fa-plus"})," More"))),m&&i.createElement("div",{className:""},i.createElement(s.a,{instance:a,buildingName:p.building?p.building:n,task:p,onTaskChange:this.handleTaskChange,isManagerorAdmin:M,onRouteChange:this.handleRoutesMatterport,routes:O,handleShowQrToggle:this.handleShowQrToggle,isEdit:g,showQRTaskToggle:this.state.showQRTaskToggle}),!f&&i.createElement("div",{className:"row col-md-12"},i.createElement("button",{className:"btn btn-primary btn-fill pull-right",onClick:function(){e.updateView(!0,!0).then(function(){var t=e.state.task;t.isQRTask=!1,(!g||g&&t.subTasks.length<1)&&(t.subTasks=[{duration:"",description:"",workerDuration:"",workerDurationUnit:"Hours",parentTask:t.task,assignedTo:"",entryTimeStamp:"",fileName:[],hasChat:!1,index:1,note:"",startTime:(new Date).toString(),relatedLink:[],status:"Pending",subTask:Object(c.l)(7),workOrder:"",workType:"",durationUnit:"Hours",acknowledged:!1,enteredBy:F.contact,enteredByName:"",oldFileName:[],archived:!1,criticality:t.criticality,isDeleted:!1,assignedDepartment:"",QRTag:t.QRTag?t.QRTag:"",isQRTask:!1,equipRdfsLabel:"",isStage:!1,isActivated:!0,estimatedStartTime:void 0,spaceRdfsLabel:"",equipSubject:[],spaceSubject:"",taskNumber:Object(c.k)(8).toString(),building:t.building?t.building:n}],e.setState({task:t}))})}},i.createElement("i",{className:"fa fa-plus"})," More"))),f&&i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-12"},i.createElement(r.a,{addNewDoWhatTask:this.addNewDoWhatTask,onDoneClicked:this.onDoneClicked,actions:this.state.actions,instance:a,buildingName:p.building?p.building:n,task:p,onTaskChange:this.handleTaskChange,isEdit:g,isManagerorAdmin:M,showQRToggle:this.state.showQRTaskToggle,people:A}))),i.createElement("div",{className:"row form-group col-md-12"},i.createElement("div",{className:"col-md-12"},M&&i.createElement(i.Fragment,null,i.createElement("button",{disabled:!L,className:"btn "+("Do Now"==E?"btn-success":"btn-primary")+" btn-fill margin-5",onClick:function(){if(Object(b.a)(!0),p.startTime=(new Date).toString(),p.status="Assigned",p.acknowledged=!0,p.subTasks.length>0)for(var t=function(e){if(p.subTasks[e].equipSubject=p.equipSubject,p.subTasks[e].spaceSubject=p.spaceSubject,p.subTasks[e].building=p.building,p.subTasks[e].criticality=p.criticality,p.subTasks[0].startTime=(new Date).toString(),p.subTasks[0].status="Assigned",e>0&&(p.subTasks[e].acknowledged=!0),""==p.subTasks[e].assignedTo&&""!=p.subTasks[e].assignedDepartment){var t=N.find(function(t){return Object(h.g)(t.departmentsAndGroups).toLowerCase().includes(p.subTasks[e].assignedDepartment.toLocaleLowerCase())});null!=t&&(p.subTasks[e].assignedTo=Object(h.g)(t.contact))}},n=0;n<p.subTasks.length;n++)t(n);Object(b.a)(!1),e.setState({task:p},function(){return j(e,void 0,void 0,function(){var e=this;return C(this,function(t){switch(t.label){case 0:return this.interruptTasks(),this.sendSms(p),[4,this._saveRoutes()];case 1:return t.sent(),setTimeout(function(){return j(e,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this._saveTask()];case 1:return e.sent(),[4,this._saveObjectFormAction()];case 2:return e.sent(),[2]}})})},1e3),[2]}})})})}},i.createElement("i",{className:"fa fa-save"})," Do Now"),i.createElement("button",{disabled:!L,className:"btn "+("Do Next"==E?"btn-success":"btn-primary")+" btn-fill margin-5",onClick:function(){if(p.startTime="",p.acknowledged=!0,p.subTasks.length>0)for(var t=0;t<p.subTasks.length;t++)p.subTasks[t].equipSubject=p.equipSubject,p.subTasks[t].spaceSubject=p.spaceSubject,p.subTasks[t].building=p.building,p.subTasks[t].criticality=p.criticality,p.subTasks[t].startTime="",p.subTasks[t].acknowledged=!0;e.setState({task:p},function(){return j(e,void 0,void 0,function(){var e=this;return C(this,function(t){switch(t.label){case 0:return[4,this._saveRoutes()];case 1:return t.sent(),setTimeout(function(){return j(e,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this._saveTask()];case 1:return e.sent(),[4,this._saveObjectFormAction()];case 2:return e.sent(),[2]}})})},1e3),[2]}})})})}},i.createElement("i",{className:"fa fa-save"})," Do Next"),i.createElement("button",{disabled:!P,className:"btn "+("Do If"==E?"btn-success":"btn-primary")+" btn-fill margin-5","data-toggle":"modal","data-target":"#DoIfDialog"},i.createElement("i",{className:"fa fa-save"})," Do If")),M&&g&&i.createElement("button",{className:"btn btn-primary btn-fill",onClick:function(){return j(e,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this._saveTask()];case 1:return e.sent(),[4,this._saveObjectFormAction()];case 2:return e.sent(),[2]}})})}},i.createElement("i",{className:"fa fa-save"})," Save"),i.createElement("button",{className:"btn btn-secondary btn-fill margin-5",onClick:function(){window.location.hash=a+"/"+n+"/Tasks"}},i.createElement("i",{className:"fa fa-angle-double-left"})," ",i.createElement("span",{className:""}," Back to Task list"))),"Started"==p.status&&g&&i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-12"},i.createElement("label",null,"Task ID - ",p.taskNumber," ")))),i.createElement(l.a,{id:"DoIfDialog",heading:"Do If",disableSaveButton:!I,showSaveButton:!0,onSaveButtonClick:function(){if(p.subTasks.length>0)for(var t=0;t<p.subTasks.length;t++)p.subTasks[t].equipSubject=p.equipSubject,p.subTasks[t].spaceSubject=p.spaceSubject,p.subTasks[t].building=p.building,p.subTasks[t].criticality=p.criticality,p.subTasks[0].startTaskCondition=p.startTaskCondition,p.subTasks[0].startTime=p.startTime,p.subTasks[0].conditionalTasks=p.conditionalTasks,p.subTasks[0].acknowledged=!1;if(p.acknowledged=!1,""==p.startTime){var n=(new Date).toString();e.handleDoAtChange(new Date(n))}if(!w){var a=new Date(p.startTime).getTime()-3e5;p.notifyAt=new Date(a).toString()}p.isForcePush&&(p.acknowledged=!0),e.setState({task:p},function(){return j(e,void 0,void 0,function(){var e=this;return C(this,function(t){switch(t.label){case 0:return[4,this._saveRoutes()];case 1:return t.sent(),setTimeout(function(){e._saveTask()},1e3),[2]}})})})},isEditForm:!0,showCancelButton:!0,cancelButtonText:"cancel",cancelButtonId:"btnCloseDoIfDialog"},i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"daytime"},"Start time: "))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"radio",id:"daytime",checked:"daytime"==p.startTaskCondition,onChange:function(t){e.handleDoIfStartRadio("daytime")}}),i.createElement("label",{htmlFor:"daytime"},"Day Time"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"compof",checked:"completionof"==p.startTaskCondition,onChange:function(){e.handleDoIfStartRadio("completionof")}}),i.createElement("label",{htmlFor:"compof"},"Upon Completion of"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"startof",checked:"startof"==p.startTaskCondition,onChange:function(){e.handleDoIfStartRadio("startof")}}),i.createElement("label",{htmlFor:"startof"},"Upon Start of"))),i.createElement("div",{className:"col-md-6"},"daytime"==p.startTaskCondition&&i.createElement("div",{className:"form-group"},i.createElement(d.a,{id:"startTime",className:"form-control",selected:R,onChange:function(t){return e.handleDoAtChange(t)},showTimeSelect:!k,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",timeCaption:"time",customInput:i.createElement("input",{type:"text",className:"form-control",placeholder:"Start Time","aria-label":"","aria-describedby":"button-addon4",value:p.startTime})})),("completionof"==p.startTaskCondition||"startof"==p.startTaskCondition)&&i.createElement(v.a,{isDisabled:!1,closeMenuOnSelect:!1,isMulti:!0,value:p.conditionalTasks,onChange:this.handleMultiTaskChange,placeholder:"Select Task(s)",options:T}))),i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"5min"},"Notify At"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"radio",id:"5min",checked:!w,onChange:function(){e.handleNotifyRadio(!1)}}),i.createElement("label",{htmlFor:"5min"},"5 min before"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"time",checked:w,onChange:function(){e.handleNotifyRadio(!0)}}),i.createElement("label",{htmlFor:"time"},"Set Date Time"))),i.createElement("div",{className:"col-md-6"},i.createElement("div",{className:"form-group"},w&&i.createElement(d.a,{id:"notifyTime",className:"form-control",selected:_,onChange:function(t){return e.handleNotifyDateChange(t)},showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",timeCaption:"time",customInput:i.createElement("input",{type:"text",className:"form-control",placeholder:"Start Time","aria-label":"","aria-describedby":"button-addon4",value:p.notifyAt})})))),i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-12"},i.createElement("div",{className:"form-group"},i.createElement("span",{className:"headingText padding-10"},"Place without Manager Review"),i.createElement("input",{type:"checkbox",checked:p.isForcePush,onChange:function(t){e.handleManagerReviewCheck(t.target.checked)}})))),"daytime"==p.startTaskCondition&&i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("span",{className:"headingText padding-10"},"Recurring Task"),i.createElement("input",{type:"checkbox",checked:p.isRecurring,onChange:function(t){e.handleRecurringCheck(t.target.checked)}}))),p.isRecurring&&i.createElement("div",{className:"col-md-8"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"radio",id:"week",checked:"week"==p.recurringSchedule,onChange:function(){e.handleRecurringScheduleRadio("week")}}),i.createElement("label",{htmlFor:"week"},"Weekly"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"month",checked:"month"==p.recurringSchedule,onChange:function(){e.handleRecurringScheduleRadio("month")}}),i.createElement("label",{htmlFor:"month"},"Monthly"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"quarter",checked:"quarter"==p.recurringSchedule,onChange:function(){e.handleRecurringScheduleRadio("quarter")}}),i.createElement("label",{htmlFor:"quarter"},"Quarterly"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"year",checked:"year"==p.recurringSchedule,onChange:function(){e.handleRecurringScheduleRadio("year")}}),i.createElement("label",{htmlFor:"year"},"Yearly"),i.createElement("br",null),i.createElement("input",{type:"radio",id:"days",checked:"days"==p.recurringSchedule,onChange:function(){e.handleRecurringScheduleRadio("days")}}),i.createElement("label",{htmlFor:"days"},"Every",i.createElement("span",null,i.createElement("input",{type:"number",name:"recurDays",disabled:"days"!=p.recurringSchedule,value:p.recurDays,onChange:function(t){e.handleRecurringDays(t.target.value)}}))," Days"),i.createElement("br",null),i.createElement("label",{htmlFor:"endingdays"},"Ending in",i.createElement("span",null," ",i.createElement("input",{type:"number",name:"endingDaysCount",value:p.endingDaysCount,onChange:function(t){e.handleRecurringEndDays(t.target.value)}})," "),"Days"))))))))},t}(i.Component);t.default=A},1510:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),n(581)),o=n(26),s=n(1016),r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={task:n.props.task},n.handleAssignTo=n.handleAssignTo.bind(n),n.handleTaskFormChange=n.handleTaskFormChange.bind(n),n}return r(t,e),t.prototype.componentDidMount=function(){return c(this,void 0,void 0,function(){return l(this,function(e){return[2]})})},t.prototype.componentWillReceiveProps=function(e){this.setState({task:e.task})},t.prototype.handleAssignTo=function(e){var t=this.state.task;t.assignedTo=e,this.setState({task:t}),this.props.onTaskChange(t)},t.prototype.handleTaskFormChange=function(e){var t=this.state.task;t[""+e.target.name]=e.target.value,this.setState({task:t}),this.props.onTaskChange(t)},t.prototype.render=function(){var e=this,t=this.props,n=t.isEdit,r=t.instance,c=t.buildingName,l=t.isManagerorAdmin,u=t.isFacilitatorText,d=t.people,p=this.state.task,h=d&&d.length>0?d.map(function(e){return{value:e.contact.value,label:e.name?e.name.value+" ("+o.e[e.role.value]+")":e.contact.value+" ("+e.qualifications.value+")"}}).filter(function(e){return e.value!=(p.assignedTo&&p.assignedTo.find(function(t){return t.value==e.value})?p.assignedTo.find(function(t){return t.value==e.value}).value:"")}):[];return a.createElement("div",{className:""},a.createElement("div",{className:"col-md-2"},a.createElement("label",{htmlFor:"description",title:s.a.task.Action}," Action: ")),a.createElement("div",{className:"col-md-4"},a.createElement("b",null," ",a.createElement("input",{type:"text",className:"form-control",disabled:!l,id:"description",name:"description",value:p.description,onChange:function(t){e.handleTaskFormChange(t)}})," ")),a.createElement("div",{className:"col-md-2"},a.createElement("label",{htmlFor:"assignedTo",title:s.a.task.AssignedTo},u?"Facilitator":"Assigned "+(l?"To:":"By:"),"  ")),l&&a.createElement("div",{className:"col-md-4"},a.createElement("b",null," ",p.assignedTo&&p.assignedTo.length>0&&"NoOne"!=p.assignedTo[0].value?a.createElement(i.a,{id:"assignTo",isMulti:!0,closeMenuOnSelect:!1,value:p.assignedTo,onChange:this.handleAssignTo,placeholder:"Select Person(s)",options:h}):a.createElement(i.a,{id:"assignTo",isMulti:!0,closeMenuOnSelect:!1,value:[],onChange:this.handleAssignTo,placeholder:"Select Person(s)",options:h}))),!l&&a.createElement("div",{className:"col-md-4"},a.createElement("b",null," ",a.createElement("input",{type:"text",className:"form-control",disabled:!0,id:"description",name:"description",value:p.enteredBy}))),p.hasChat&&n&&a.createElement("div",{className:"col-md-12 row"},a.createElement("button",{className:"btn btn-primary btn-fill pull-right",onClick:function(){window.location.hash="/"+r+"/"+c+"/ChatWindow/"+p.task+"/Task"}},"Goto Chat")))},t}(a.Component);t.a=u},1511:function(e,t,n){"use strict";var a,i=n(3),o=(n.n(i),n(26)),s=n(592),r=n(623),c=n(579),l=n(872),u=n(17),d=n(581),p=n(850),h=n(656),m=n(1017),f=n(599),b=n(1016),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},S=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}};a=a;var w=function(e){function t(t){var n=e.call(this,t)||this;return n.state={task:n.props.task,assets:[],floors:[],locations:[],bimSweeps:[],onSweepChangeableStatus:!1,floorDetails:Object(),refreshMatterportDialog:!1,routeSpaces:[],points:[]},a=n,n.fetchFloors=n.fetchFloors.bind(n),n._getFloorDetails=n._getFloorDetails.bind(n),n._getSweeps=n._getSweeps.bind(n),n._getAssets=n._getAssets.bind(n),n._getLocations=n._getLocations.bind(n),n._fetchPoints=n._fetchPoints.bind(n),n.handleRefreshMatterport=n.handleRefreshMatterport.bind(n),n.handleFloorChange=n.handleFloorChange.bind(n),n.handleTaskFormChange=n.handleTaskFormChange.bind(n),n.handleLocationChange=n.handleLocationChange.bind(n),n.handleMultiAssetChange=n.handleMultiAssetChange.bind(n),n.handleRoutesMatterport=n.handleRoutesMatterport.bind(n),n.updateSpace=n.updateSpace.bind(n),n.onSweepChangeable=n.onSweepChangeable.bind(n),n.handleQRtoggle=n.handleQRtoggle.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){var e,t,n;return S(this,function(a){return e=this.state.task,t=this.props,n=t.buildingName,t.instance&&n&&(this.fetchFloors(n),this._fetchPoints(),e.floor&&e.floor.length>0&&(this._getFloorDetails(),this._getLocations()),""!=e.spaceSubject&&(this._getAssets(),this._getSweeps(e.buildingName,e.spaceSubject))),[2]})})},t.prototype.componentWillReceiveProps=function(e){e.buildingName&&this.props.buildingName&&e.buildingName!=this.props.buildingName&&this.fetchFloors(e.buildingName),this.setState({task:e.task}),e.routes&&e.routes.length>0&&this.setState({routeSpaces:e.routes})},t.prototype.fetchFloors=function(e){return v(this,void 0,void 0,function(){var t;return S(this,function(n){switch(n.label){case 0:return[4,Object(s.f)(e)];case 1:return t=n.sent(),this.setState({floors:t,locations:[],assets:[]}),[2]}})})},t.prototype.onSweepChangeable=function(e){this.setState({onSweepChangeableStatus:!e})},t.prototype._fetchPoints=function(){return v(this,void 0,void 0,function(){var e=this;return S(this,function(t){switch(t.label){case 0:return[4,Object(f.h)("",null,null).then(function(t){t&&t.length>0&&e.setState({points:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._getAssets=function(){return v(this,void 0,void 0,function(){var e,t,n;return S(this,function(a){switch(a.label){case 0:return e=this.state.task,[4,Object(r.f)(e.building,o.b.TASK,e.floor,[e.spaceSubject])];case 1:return t=a.sent(),n=t.map(function(e){return{value:Object(u.g)(e.ontology),label:Object(u.g)(e.rdfsLabel)}}),this.setState({assets:n}),[2]}})})},t.prototype._getLocations=function(){return v(this,void 0,void 0,function(){var e,t;return S(this,function(n){switch(n.label){case 0:return e=this.state.task,[4,Object(c.c)(e.floor,e.building,!0)];case 1:return t=n.sent(),this.setState({locations:t}),[2]}})})},t.prototype._getFloorDetails=function(){return v(this,void 0,void 0,function(){var e,t,a=this;return S(this,function(i){switch(i.label){case 0:return e=this.state.task,t=this.state.floorDetails,[4,Object(s.a)(e.building,e.floor).then(function(i){return v(a,void 0,void 0,function(){var a=this;return S(this,function(o){switch(o.label){case 0:return[4,Object(h.b)(e.building,e.floor).then(function(e){if(i&&i.length>0){var o=e&&e[0]?""+e[0].bimImageBase:n(661);t.linkBimism=Object(u.g)(i[0].linkBimism),t.xOffsetMap=Object(u.g)(i[0].xOffsetMap),t.yOffsetMap=Object(u.g)(i[0].yOffsetMap),t.xScaleMap=Object(u.g)(i[0].xScaleMap),t.yScaleMap=Object(u.g)(i[0].yScaleMap),t.bimFloor=Object(u.g)(i[0].bimFloor),t.bimSid=Object(u.g)(i[0].bimSid),t.floor=Object(u.g)(i[0].zone),t.rdfsLabel=Object(u.g)(i[0].rdfsLabel),t.imgFloorMap=o,a.setState({floorDetails:t,refreshMatterportDialog:!0})}})];case 1:return o.sent(),[2]}})})}).catch(function(e){return e})];case 1:return i.sent(),[2]}})})},t.prototype._getSweeps=function(e,t){return v(this,void 0,void 0,function(){var n,a=this;return S(this,function(i){switch(i.label){case 0:return n=[],[4,Object(h.c)(e,t).then(function(e){return v(a,void 0,void 0,function(){var t,a,i,o,s,r,c;return S(this,function(l){for(t=0;t<e.length;t++)a=e[t],(i=Object()).assignedSpace=Object(u.g)(a.assignedSpace),i.buildingName=Object(u.g)(a.buildingName),i.ontology=Object(u.g)(a.ontology),i.uuid=Object(u.g)(a.uuid),i.uuidIndex=parseInt(Object(u.g)(a.uuidIndex)),i.stepNo=parseInt(Object(u.g)(a.stepNo)),n.push(i);if((o=this.state.bimSweeps).length==n.length){for(s=0,r=0;r<o.length;r++)(c=o[r]).assignedSpace==n[r].assignedSpace&&c.buildingName==n[r].buildingName&&c.ontology==n[r].ontology&&c.stepNo==n[r].stepNo&&c.uuid==n[r].uuid&&c.uuidIndex==n[r].uuidIndex&&(s+=1);s!=o.length&&this.setState({bimSweeps:n,onSweepChangeableStatus:!0,refreshMatterportDialog:!0})}else this.setState({bimSweeps:n,onSweepChangeableStatus:!0,refreshMatterportDialog:!0});return[2]})})}).catch(function(e){return e})];case 1:return i.sent(),[2]}})})},t.prototype.handleRefreshMatterport=function(e){this.setState({refreshMatterportDialog:e})},t.prototype.handleRoutesMatterport=function(e){this.setState({routeSpaces:e}),this.props.onRouteChange(e)},t.prototype.handleFloorChange=function(e){return v(this,void 0,void 0,function(){var t,n=this;return S(this,function(a){return t=this.state.task,""!=e&&(t.floor=e,t.equipSubject=[],t.spaceSubject="",this.setState({task:t},function(){n._getFloorDetails(),n._getLocations()}),this.props.onTaskChange(t)),[2]})})},t.prototype.handleLocationChange=function(e){return v(this,void 0,void 0,function(){var t,n,a,i,o,s,r=this;return S(this,function(c){return t=this.state,n=t.task,a=t.points,i=!1,""!=e&&("newSpace"==e?document.getElementById("btnShowSpaceFormDialog").click():(n.spaceSubject=e,n.equipSubject=[],o=a.filter(function(e){return Object(u.g)(e.space)==n.spaceSubject}),s=o.map(function(e){return Object(u.g)(e.tag)}).join(","),o.length>0&&(i=!0,n.QRTag=s,n.subTasks.forEach(function(e){e.QRTag=s})),this._getSweeps(n.building,n.spaceSubject)),this.setState({refreshMatterportDialog:!0,task:n},function(){r._getAssets()}),this.props.onTaskChange(n),this.props.handleShowQrToggle(i)),[2]})})},t.prototype.handleTaskFormChange=function(e){var t=this.state.task;t[""+e.target.name]=e.target.value,this.setState({task:t}),this.props.onTaskChange(t)},t.prototype.handleMultiAssetChange=function(e){var t=this.state.task;t.equipSubject=e,this.setState({task:t}),this.props.onTaskChange(t)},t.prototype.updateSpace=function(e){return v(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return[4,this._getLocations()];case 1:return t.sent(),setTimeout(function(){var t=a.state.task;t.spaceSubject=e.name,t.floor=e.floor,t.equipSubject=[],a.setState({task:t},function(){a.handleFloorChange(e.floor)})},500),[2]}})})},t.prototype.handleQRtoggle=function(e){var t=this.state.task;t.isQRTask=e,this.setState({task:t}),this.props.onTaskChange(t)},t.prototype.render=function(){var e=this,t=this.props,n=t.isManagerorAdmin,a=t.instance,o=t.showQRTaskToggle,s=this.state,r=s.floors,c=s.assets,h=s.locations,f=s.task,g=s.bimSweeps,v=s.onSweepChangeableStatus,S=s.floorDetails,w=s.refreshMatterportDialog,k=s.routeSpaces,y=!!(g&&g.length>0),T=S.linkBimism?S.linkBimism:localStorage.getItem("BIMURL"),E={value:"",label:""},O=!0;if(f.spaceSubject){var N=f.spaceRdfsLabel?f.spaceRdfsLabel:h&&h.length>0&&h.find(function(e){return e.ontology.value==f.spaceSubject})?h.find(function(e){return e.ontology.value==f.spaceSubject}).rdfsLabel.value:"";E={value:f.spaceSubject,label:N},O=!!n}return i.createElement(i.Fragment,null,i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-2"},i.createElement("label",{htmlFor:"criticality",title:b.a.task.Criticality}," Concern: ")),i.createElement("div",{className:"col-md-5"},i.createElement("select",{className:"form-control",name:"criticality",disabled:!n,value:f.criticality,id:"criticality",onChange:function(t){e.handleTaskFormChange(t)}},l.c.map(function(e,t){return i.createElement("option",{key:t,value:e.id}," ",e.id," - ",e.name," ")})))),i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-4"},i.createElement("label",{htmlFor:"floor",title:b.a.task.Floor}," Floor "),i.createElement("select",{className:"form-control",id:"floor",name:"floor",disabled:!n,value:f.floor,onChange:function(t){e.handleFloorChange(t.target.value)}},i.createElement("option",{value:""},"Select Floor"),r.map(function(e,t){return i.createElement("option",{value:Object(u.g)(e.ontology),key:t},e.rdfsLabel.value," ")}))),i.createElement("div",{className:"col-md-4"},i.createElement("label",{htmlFor:"spaceSubject",title:b.a.task.Location}," Space "),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-10 col-sm-10"},i.createElement("select",{className:"form-control",name:"spaceSubject",value:f.spaceSubject,disabled:!n,onChange:function(t){e.handleLocationChange(t.target.value)}},i.createElement("option",{value:""},"Select Space"),i.createElement("option",{value:"newSpace",className:"headingText"},"New Space "),i.createElement("hr",null),h.map(function(e,t){return i.createElement("option",{value:Object(u.g)(e.ontology),key:t},e.rdfsLabel.value," ")}))),y&&i.createElement("div",{className:"col-md-2 col-sm-2"},i.createElement("button",{type:"button",className:"btn btn-dark btn-fill btn-sm pull-right",onClick:function(){document.getElementById("btnVirtualBIM").click()},style:{border:"1px solid transparent",backgroundColor:"#A69888"}},i.createElement("img",{className:"icon-img",src:"assets/img/virtual-bim.png"})))),i.createElement(p.a,{updateSpace:this.updateSpace,closeDailogBtnID:"btnShowSpaceFormDialog",floor:f.floor,buildingName:f.building,instance:a})),i.createElement("div",{className:"col-md-4"},i.createElement("label",{htmlFor:"equipSubject",title:b.a.task.Asset}," Asset "),i.createElement(d.a,{isDisabled:!n,closeMenuOnSelect:!1,isMulti:!0,value:f.equipSubject,onChange:this.handleMultiAssetChange,placeholder:"Select Asset(s)",options:c}))),o&&f.subTasks.length<1&&i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-3"},i.createElement("label",{htmlFor:"allowAutoSMS"},"QR Task:")),i.createElement("div",{className:"col-md-1"},i.createElement("div",{className:"switch-container"},i.createElement("label",null,i.createElement("input",{id:"qrTask",name:"qrTask",checked:f.isQRTask,onChange:function(t){e.handleQRtoggle(t.target.checked)},className:"switch",type:"checkbox"}),i.createElement("div",null,i.createElement("div",null)))))),i.createElement("button",{type:"button",id:"btnVirtualBIM",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#virtualBIMDialog"}," ."),i.createElement(m.a,{id:"virtualBIMDialog",heading:"Virtual BIM Routes",bimURL:T,isViewForm:!0,isSweepChangeable:v,sweeps:g,isTaskForm:O,isTaskView:!0,onSweepChangeable:this.onSweepChangeable,isRefreshDialog:w,buildingName:this.props.buildingName,onRefreshMatterport:this.handleRefreshMatterport,locationDropdownList:h,routes:k,showSaveButton:O,selectedSpace:E,onSaveRouteClickButton:this.handleRoutesMatterport,floor:S,space:f.spaceSubject}))},t}(i.Component);t.a=w},1512:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),n(1513)),o=n(18),s=n(87),r=n(14),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),l=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={task:n.props.task,actions:n.props.actions},n.reorderTask=n.reorderTask.bind(n),n.setCollapseIcon=n.setCollapseIcon.bind(n),n.onSubTaskChange=n.onSubTaskChange.bind(n),n.sortSubTasks=n.sortSubTasks.bind(n),n.handleChangesToActions=n.handleChangesToActions.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return l(this,void 0,void 0,function(){return u(this,function(e){return[2]})})},t.prototype.componentWillReceiveProps=function(e){this.setState({task:e.task})},t.prototype.onSubTaskChange=function(e,t){var n=this.state.task;n.subTasks[e]=t,this.setState({task:n}),this.props.onTaskChange(n)},t.prototype.setCollapseIcon=function(e){var t=e.currentTarget.children[0].className;e.currentTarget.children[0].className="fa fa-plus"==t?"fa fa-minus":"fa fa-plus"},t.prototype.reorderTask=function(e,t){return l(this,void 0,void 0,function(){var n,a;return u(this,function(i){return n=this.state.task,Object(s.a)(!0),"up"==t&&0!==e?(a=n.subTasks[e].index,n.subTasks[e].index=n.subTasks[e-1].index,n.subTasks[e-1].index=a,this.setState({task:n})):"down"==t&&e!==n.subTasks.length-1&&(a=n.subTasks[e].index,n.subTasks[e].index=n.subTasks[e+1].index,n.subTasks[e+1].index=a),Object(s.a)(!1),n.subTasks.sort(function(e,t){return e.index-t.index}),this.setState({task:n}),this.props.onTaskChange(n),[2]})})},t.prototype._createNewTask=function(e,t,n){return l(this,void 0,void 0,function(){var e,a,i,s;return u(this,function(c){return e=JSON.parse(r.a.getItem("user")),a=this.state.task,i=a.subTasks,s={assignedTo:e.contact,description:"",workerDurationUnit:"Hours",workerDuration:"",parentTask:this.props.task.task,duration:"",entryTimeStamp:"",fileName:[],hasChat:!1,index:t+1,note:"",relatedLink:[""],startTime:"",status:"Pending",subTask:Object(o.l)(7),workOrder:"",workType:"",durationUnit:"Hours",acknowledged:!1,enteredBy:e.contact,enteredByName:"",oldFileName:[],archived:!1,criticality:a.criticality,isDeleted:!1,startTaskCondition:"completionof",conditionalTasks:n?[{label:n,value:n}]:[],assignedDepartment:"",QRTag:a.QRTag?a.QRTag:"",isQRTask:!1,building:this.props.buildingName,equipRdfsLabel:"",equipSubject:[],isActivated:!0,isStage:!1,spaceSubject:"",spaceRdfsLabel:"",taskNumber:Object(o.k)(8).toString()},i.push(s),this.setState({task:a},function(){}),this.props.onTaskChange(a),[2]})})},t.prototype.sortSubTasks=function(e){e.sort(function(e,t){return e.index-t.index})},t.prototype.handleChangesToActions=function(e,t){this.props.onDoneClicked(e,t)},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,o=t.instance,s=t.isManagerorAdmin,c=t.people,l=this.state.task,u=JSON.parse(r.a.getItem("user"));return a.createElement("div",{className:"content",id:""},a.createElement("div",{className:"container-fluid"},l.subTasks&&l.subTasks.sort(function(e,t){return e.index-t.index}).map(function(t,r){var d=t&&t.assignedTo&&t.description&&t.index&&t.duration&&!0;return(!!s||u.contact==t.assignedTo)&&a.createElement("div",{key:r,className:"row padding-10"},a.createElement("div",{className:"panel panel-default"},a.createElement("div",{className:"panel-heading"},a.createElement("h4",{className:"panel-title"},a.createElement("div",null,0!=r&&a.createElement("span",{className:"circle"},a.createElement("i",{className:"fa fa-arrow-up",onClick:function(){e.reorderTask(r,"up")}})),a.createElement("span",{className:"task-number"},t.index),r!=l.subTasks.length-1&&a.createElement("span",{className:"circle"},a.createElement("i",{className:"fa fa-arrow-down",onClick:function(){e.reorderTask(r,"down")}}))," ",t.subTask&&t.action&&t.assignedTo&&t.status?t.action+" | "+t.status+" |\n                                                  "+t.assignedTo:"Task "+(r+1),a.createElement("a",{className:"icn-collapse pull-right","data-toggle":"collapse",id:"btn-collapse"+r,href:"#collapse"+r,onClick:function(t){e.setCollapseIcon(t)}},a.createElement("i",{className:r==l.subTasks.length-1?"fa fa-minus":"fa fa-plus"}))))),a.createElement("div",{id:"collapse"+r,className:"panel-collapse collapse "+(r==l.subTasks.length-1?"in":"")},a.createElement("div",{className:"panel-body"},a.createElement("div",{className:"card"},a.createElement(i.a,{actionChanges:e.handleChangesToActions,buildingName:n,instance:o,isEdit:e.props.isEdit,subTask:t,onTaskChange:function(t){e.onSubTaskChange(r,t)},actions:e.state.actions[r],isManagerorAdmin:s,showQRToggle:e.props.showQRToggle,people:c}),r==l.subTasks.length-1&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group d-flex"},s&&a.createElement("button",{className:"btn btn-primary btn-fill",disabled:!d||!s,onClick:function(){e.props.addNewDoWhatTask(t.index),e._createNewTask("btn-collapse"+r,t.index,t.subTask)}},a.createElement("i",{className:"fa fa-save"})," Create Next Task"),l.subTasks.length>1&&a.createElement("button",{className:"btn btn-danger btn-fill margin-left-right-10",onClick:function(){l.subTasks.pop(),e.setState({task:l}),e.props.onTaskChange(l)}},a.createElement("i",{className:"fa fa-remove"})," Delete Subtask")))))))))})))},t}(a.Component);t.a=d},1513:function(e,t,n){"use strict";var a,i=n(3),o=(n.n(i),n(26)),s=n(629),r=n(578),c=n(17),l=n(699),u=n(18),d=n(45),p=n(87),h=n(658),m=n(600),f=n.n(m),b=n(649),g=n(568),v=n(1514),S=n(627),w=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),k=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},T=new l.a,E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={actions:[],subTask:n.props.subTask,workTypeList:[],isEdit:!1,oldStatus:"",hasChatLink:!1,files:[],WOList:[],qualifiedPeople:n.props.people,departments:[],objectFormIsOpened:!1},a=n,n.handleTaskFormChange=n.handleTaskFormChange.bind(n),n.handleTaskChangeBoolean=n.handleTaskChangeBoolean.bind(n),n.handleRelatedLinks=n.handleRelatedLinks.bind(n),n.addRelatedLink=n.addRelatedLink.bind(n),n.handleStartTimeChange=n.handleStartTimeChange.bind(n),n._taskTypeList=n._taskTypeList.bind(n),n._workTypeList=n._workTypeList.bind(n),n.configure=n.configure.bind(n),n.sendSms=n.sendSms.bind(n),n.handleCompleteChange=n.handleCompleteChange.bind(n),n.handlefileAttached=n.handlefileAttached.bind(n),n.handleTaskStatusChange=n.handleTaskStatusChange.bind(n),n.handleRelatedWO=n.handleRelatedWO.bind(n),n.filterQualifiedPeople=n.filterQualifiedPeople.bind(n),n._fetchDepartmentOrGroup=n._fetchDepartmentOrGroup.bind(n),n.handleQRtoggle=n.handleQRtoggle.bind(n),n.handleNotificationtoggle=n.handleNotificationtoggle.bind(n),n.changeObjectFormIsOpened=n.changeObjectFormIsOpened.bind(n),n.fetchObjectFormActionTemplates=n.fetchObjectFormActionTemplates.bind(n),n}return w(t,e),t.prototype.componentWillMount=function(){return k(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this.configure()]:[3,2];case 1:e.sent(),a=a,e.label=2;case 2:return[2]}})})},t.prototype.componentDidMount=function(){return k(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._getWorkOrdersList()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.componentWillReceiveProps=function(e){return k(this,void 0,void 0,function(){return y(this,function(t){return this.setState({subTask:e.subTask,qualifiedPeople:e.people,actions:e.actions}),[2]})})},t.prototype.fetchObjectFormActionTemplates=function(e){var t=this;Object(S.b)(this.props.buildingName,[e]).then(function(e){t.setState({actions:e})})},t.prototype._getWorkOrdersList=function(){return k(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return Object(p.a)(!0),[4,Object(h.e)(this.props.buildingName).then(function(t){e.setState({WOList:t})}).catch(function(e){return e})];case 1:return t.sent(),Object(p.a)(!1),[2]}})})},t.prototype.configure=function(){return k(this,void 0,void 0,function(){var e,t,n,a=this;return y(this,function(i){switch(i.label){case 0:return e=this.state.subTask,[4,this._workTypeList()];case 1:return t=i.sent(),[4,this._fetchDepartmentOrGroup()];case 2:return n=i.sent(),this.setState({workTypeList:t,departments:n},function(){(e.workType||e.assignedDepartment)&&a.filterQualifiedPeople()}),[2]}})})},t.prototype._fetchDepartmentOrGroup=function(){return k(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Object(r.e)()];case 1:return[2,e.sent()]}})})},t.prototype.handleTaskFormChange=function(e){var t=this,n=this.state.subTask,a=e.target.name;n[""+a]=e.target.value,"assignedTo"!=a&&"workType"!=a&&"assignedDepartment"!=a||(n.notifyViaEmail=!1,n.notifyViaSMS=!1),this.setState({subTask:n},function(){"workType"!=a&&"assignedDepartment"!=a||t.filterQualifiedPeople()}),this.props.onTaskChange(n)},t.prototype.filterQualifiedPeople=function(){var e=this.props.people,t=this.state.subTask,n=t.assignedDepartment,a=t.workType,i=[];i=""!=a&&""!=n?e&&e.filter(function(e){return Object(c.g)(e.qualifications).toLowerCase().includes(a.toLocaleLowerCase())&&Object(c.g)(e.departmentsAndGroups).toLowerCase().includes(n.toLocaleLowerCase())}):a&&""!=a?e&&e.filter(function(e){return Object(c.g)(e.qualifications).toLowerCase().includes(a.toLocaleLowerCase())}):n&&""!=n?e&&e.filter(function(e){return Object(c.g)(e.departmentsAndGroups).toLowerCase().includes(n.toLocaleLowerCase())}):e,this.setState({qualifiedPeople:i})},t.prototype.handleTaskStatusChange=function(e){var t=this.state.subTask;"Working"==e&&(t.startTime=(new Date).ToEasternDateTime().toString()),t.status=e,this.setState({subTask:t}),this.props.onTaskChange(t)},t.prototype.handleCompleteChange=function(e,t){},t.prototype.sendSms=function(e){return k(this,void 0,void 0,function(){var t,n,a,i,o;return y(this,function(s){return t=this.props.people,n=this.props,a=n.instance,i=n.buildingName,(o=t.find(function(t){return Object(c.g)(t.contact)==e.assignedTo}))&&Object(u.r)(Object(c.g)(o.smsSchedule))&&o&&Object(c.g)(o.phone).length>0&&T.SendSMS(Object(c.g)(o.phone),"Task: "+e.subTask+", Description: "+e.description+" , Work Type: "+e.workType+" , Task Type: "+(e.workType?e.workType:"None")+" , Assigned On : "+(new Date).toString()+", To view the Task: "+window.location.origin+"/#"+a+"/"+i+"/Task/"+e.subTask+" , Are you on it?",a,function(e){}),[2]})})},t.prototype._taskTypeList=function(){return k(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Object(s.k)()];case 1:return[2,e.sent()]}})})},t.prototype._workTypeList=function(){return k(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Object(s.l)()];case 1:return[2,e.sent()]}})})},t.prototype.handleRelatedLinks=function(e,t){var n=this.state.subTask;n.relatedLink[t]=e,this.setState({subTask:n}),this.props.onTaskChange(n)},t.prototype.addRelatedLink=function(){var e=this.state.subTask;e.relatedLink.push(""),this.setState({subTask:e}),this.props.onTaskChange(e)},t.prototype.handleTaskChangeBoolean=function(e,t){var n=this.state.subTask;switch(e){case"hasChat":n.hasChat=t}this.setState({subTask:n})},t.prototype.handleStartTimeChange=function(e){var t=this.state.subTask;t.startTime=e.toString(),this.setState({subTask:t}),this.props.onTaskChange(t)},t.prototype.handleEstimatedStartTimeChange=function(e){var t=this.state.subTask;t.estimatedStartTime=e,this.setState({subTask:t}),this.props.onTaskChange(t)},t.prototype.handleRelatedWO=function(e){var t=this.state.subTask;t.workOrder=e,this.setState({subTask:t})},t.prototype.handlefileAttached=function(e){if(e.length>0){for(var t=this.state.subTask,n=0;n<e.length;n++){var a=e[n].name.split(".").pop(),i=this.props.buildingName+"_"+Object(u.l)(15)+"."+a.toLowerCase();t.fileName[n]=i}Object(o.g)(e),this.setState({files:e,subTask:t},function(){}),this.props.onTaskChange(t)}},t.prototype.handleQRtoggle=function(e){var t=this.state.subTask;t.isQRTask=e,this.setState({subTask:t}),this.props.onTaskChange(t)},t.prototype.handleNotificationtoggle=function(e){var t=this.state.subTask;t[""+e.target.name]=e.target.checked,this.setState({subTask:t}),this.props.onTaskChange(t)},t.prototype.changeObjectFormIsOpened=function(){var e=this.state.objectFormIsOpened;this.setState({objectFormIsOpened:!e})},t.prototype.render=function(){for(var e=this,t=this.state,n=t.subTask,a=t.qualifiedPeople,s=t.workTypeList,r=t.hasChatLink,l=t.departments,u=this.props,p=u.isManagerorAdmin,h=u.buildingName,m=new d.b,S=[],w=0;w<n.oldFileName.length;w++){var T=n.oldFileName[w];T&&T.length>0&&S.push(m.GetSignedURL(d.a.DOCUMENT(),T))}return i.createElement("div",{className:"content"},i.createElement("div",{className:"container-fluid padding-10"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"action"},"Action:*"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"text",id:"action",name:"action",className:"form-control",disabled:!p,value:n.action,onChange:function(t){e.handleTaskFormChange(t)}}))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"description"},"Description:*"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"text",id:"description",name:"description",className:"form-control",disabled:!p,value:n.description,onChange:function(t){e.handleTaskFormChange(t)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"workType"},"Work Type:"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",id:"workType",name:"workType",disabled:!p,value:n.workType,onChange:function(t){e.handleTaskFormChange(t)}},i.createElement("option",{value:""},"Select Work Type"),s.map(function(e,t){return i.createElement("option",{key:t,value:e.value},e.value," ")})))),p&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"assignedDepartment"},"Department:"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",id:"assignedDepartment",name:"assignedDepartment",value:n.assignedDepartment,onChange:function(t){e.handleTaskFormChange(t)}},i.createElement("option",{value:""},"Select Department"),l.map(function(e){return i.createElement("option",{value:e},e," ")})))))),i.createElement("div",{className:"row"},p&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"assignedTo"},"Assigned to:"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",id:"assignedTo",name:"assignedTo",value:n.assignedTo,onChange:function(t){e.handleTaskFormChange(t)}},i.createElement("option",{value:""},"Select Person"),a.map(function(e){return i.createElement("option",{value:Object(c.g)(e.contact)},Object(c.g)(e.name)," ",e.role&&"- ("+o.e[Object(c.g)(e.role)]+")"," ")}))))),!p&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"assignedTo"},"Assigned By:"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"text",id:"description",name:"description",disabled:!0,className:"form-control",value:n.enteredByName}))))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"dueDate"},"Estimated Start Time: "))),i.createElement("div",{className:"col-md-3"},i.createElement("div",{className:"form-group"},i.createElement(f.a,{id:"dueDate",className:"form-control",selected:n.estimatedStartTime?n.estimatedStartTime:void 0,onChange:function(t){return e.handleEstimatedStartTimeChange(t)},showTimeSelect:!0,timeFormat:"HH:mm",disabled:!p,timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",timeCaption:"time",customInput:i.createElement("input",{type:"text",className:"form-control",placeholder:"Estimate Start time","aria-label":"","aria-describedby":"button-addon4",value:n.estimatedStartTime&&n.estimatedStartTime.toString()})}))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"duration"},"Estimated Duration Length:"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"number",min:0,id:"duration",name:"duration",disabled:!p,value:n.duration,onChange:function(t){e.handleTaskFormChange(t)}}))),i.createElement("div",{className:"col-md-1"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"durationUnit"},"Units:"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",id:"durationUnit",name:"durationUnit",disabled:!0,value:n.durationUnit,onChange:function(t){e.handleTaskFormChange(t)}},i.createElement("option",{value:"Seconds"},"Seconds"),i.createElement("option",{value:"Minutes"},"Minutes"),i.createElement("option",{value:"Hours"},"Hours"),i.createElement("option",{value:"Days"},"Days"),i.createElement("option",{value:"Months"},"Months"),i.createElement("option",{value:"Years"},"Years"))))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"duration"},"Worker Estimation:"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"number",min:0,id:"workerDuration",name:"workerDuration",disabled:!p,value:n.workerDuration,onChange:function(t){e.handleTaskFormChange(t)}}))),i.createElement("div",{className:"col-md-1"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"durationUnit"},"Units:"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",id:"workerDurationUnit",name:"workerDurationUnit",disabled:!0,value:n.workerDurationUnit,onChange:function(t){e.handleTaskFormChange(t)}},i.createElement("option",{value:"Seconds"},"Seconds"),i.createElement("option",{value:"Minutes"},"Minutes"),i.createElement("option",{value:"Hours"},"Hours"),i.createElement("option",{value:"Days"},"Days"),i.createElement("option",{value:"Months"},"Months"),i.createElement("option",{value:"Years"},"Years"))))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"note"},"Notes:"))),i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("textarea",{className:"form-control",id:"note",name:"note",disabled:!p,value:n.note,onChange:function(t){e.handleTaskFormChange(t)}}))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"building"}))),i.createElement("div",{className:"row row col-md-4",style:{display:"inline-block"}},i.createElement("div",{className:"col-md-5 col-xs-12"},i.createElement("label",{htmlFor:"relatedWO"},"Related WO #")),i.createElement("div",{className:"col-md-7 col-xs-12"},i.createElement("select",{className:"form-control",id:"relatedWO",name:"relatedwo",value:n.workOrder,onChange:function(t){return e.handleRelatedWO(t.target.value)}},i.createElement("option",{value:""},"Select Related"),this.state.WOList&&this.state.WOList.length&&this.state.WOList.map(function(e,t){return i.createElement("option",{value:e.value,key:t},e.value," ")})))),r&&i.createElement("div",{className:"col-md-2"},i.createElement("button",{className:"btn btn-primary btn-fill pull-right",onClick:function(){}},"Goto Chat"))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"relatedLink"},"Related Links:"))),n.relatedLink&&n.relatedLink.map(function(t,a){return i.createElement(i.Fragment,null,i.createElement("div",{className:0==a&&n.relatedLink.length>1?"col-md-6 col-md-offset-right-4":a>0?"col-md-6 col-md-offset-2":"col-md-6"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"text",id:"relatedLink",className:"form-control",disabled:!p,value:t,onChange:function(t){e.handleRelatedLinks(t.target.value,a)}}))))}),i.createElement("div",{className:"col-md-4"},i.createElement("button",{className:"btn btn-dark btn-fill btn-sm",onClick:function(){e.addRelatedLink()}},i.createElement("i",{className:"fa fa-plus"})))),n.assignedTo&&a.find(function(e){return Object(c.g)(e.contact)==n.assignedTo&&(""!=Object(c.g)(e.email)||""!=Object(c.g)(e.phone))})&&i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"notifyVia"},"Notify Via:"))),n.assignedTo&&a.find(function(e){return Object(c.g)(e.contact)==n.assignedTo&&""!=Object(c.g)(e.email)})&&i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("div",{className:"switch-container",style:{top:0}},i.createElement("label",null,i.createElement("input",{id:"notifyViaEmail",disabled:!1,name:"notifyViaEmail",checked:n.notifyViaEmail,onChange:function(t){e.handleNotificationtoggle(t)},className:"switch",type:"checkbox"}),i.createElement("div",null,i.createElement("div",null)))),i.createElement("span",null,i.createElement("label",null,"Email")))),n.assignedTo&&a.find(function(e){return Object(c.g)(e.contact)==n.assignedTo&&""!=Object(c.g)(e.phone)})&&i.createElement("div",{className:"col-md-4"},i.createElement("div",{className:"form-group"},i.createElement("div",{className:"switch-container",style:{top:0}},i.createElement("label",null,i.createElement("input",{id:"notifyViaSMS",disabled:!1,name:"notifyViaSMS",checked:n.notifyViaSMS,onChange:function(t){e.handleNotificationtoggle(t)},className:"switch",type:"checkbox"}),i.createElement("div",null,i.createElement("div",null)))),i.createElement("span",null,i.createElement("label",null,"SMS"))))),i.createElement("div",{className:"row"},i.createElement(b.a,{showUploader:!0,buildingName:h,assetOntology:n.subTask,entityType:"Task",uploaderID:n.subTask})),this.props.showQRToggle&&i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-3"},i.createElement("label",{htmlFor:"allowAutoSMS"},"QR Task:")),i.createElement("div",{className:"col-md-1"},i.createElement("div",{className:"switch-container"},i.createElement("label",null,i.createElement("input",{id:"qrTask",name:"qrTask",checked:n.isQRTask,onChange:function(t){e.handleQRtoggle(t.target.checked)},className:"switch",type:"checkbox"}),i.createElement("div",null,i.createElement("div",null)))))),i.createElement("div",{className:"row form-group"}),"Completed"==n.status&&i.createElement("div",{className:"row form-group"},i.createElement("div",{className:"col-md-9 col-md-offset-2"},i.createElement("h4",{style:{color:"#33cc66"}},i.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"))),i.createElement("div",{className:"row padding-10"},i.createElement("button",{type:"button",className:"btn btn-primary btn-fill text-center checklistBtn margin-5",onClick:function(){e.setState({objectFormIsOpened:!0},function(){document.getElementById("btnObjectDialog"+n.subTask).click()})}},i.createElement("img",{className:"",src:"assets/img/Checklist1.png"}),"\xa0 \xa0 Assign Do What Tasks ")),i.createElement("button",{id:"btnObjectDialog"+n.subTask,style:{display:"none"},"data-target":"#ObjectDialog"+n.subTask,"data-toggle":"modal"},"."),i.createElement(g.a,{id:"ObjectDialog"+n.subTask,heading:"",showSaveButton:!0,saveButtonText:"Done",disableSaveButton:!1,isFullWidth:!0,onCancelButtonClickActive:!0,onCancelButtonClick:function(){e.changeObjectFormIsOpened()},onSaveButtonClick:function(){return k(e,void 0,void 0,function(){return y(this,function(e){return this.props.actionChanges(n.index,this.state.actions),[2]})})}},this.state.objectFormIsOpened&&i.createElement(v.a,{buildingName:this.props.buildingName,taskID:n.subTask,actions:this.state.actions,isTemplate:!1,_fetchActions:this.fetchObjectFormActionTemplates}))))},t}(i.Component);t.a=E},1514:function(e,t,n){"use strict";var a=n(3),i=(n.n(a),n(17)),o=n(573),s=n(18),r=n(627),c=n(599),l=n(592),u=n(581),d=n(578),p=n(579),h=n(87),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={actions:n.props.actions,_points:[],_floors:[],_assets:[],_spaces:[],showPoints:[],people:[],_components:[],showMultiSelect:[],pointsDropDown:[],selectedPoints:[],spaces:[],assets:[]},n.getUnits=n.getUnits.bind(n),n.addActionItem=n.addActionItem.bind(n),n.saveActions=n.saveActions.bind(n),n.handleActionsFormChange=n.handleActionsFormChange.bind(n),n._fetchPoints=n._fetchPoints.bind(n),n.floorChangeHandler=n.floorChangeHandler.bind(n),n.getFloorBasedOnBuildingHandler=n.getFloorBasedOnBuildingHandler.bind(n),n.getSpacesBasedOnFloorHandler=n.getSpacesBasedOnFloorHandler.bind(n),n.spacesChangeHandler=n.spacesChangeHandler.bind(n),n.getAssetsBasedOnSpaceHandler=n.getAssetsBasedOnSpaceHandler.bind(n),n.assetChangeHandler=n.assetChangeHandler.bind(n),n.componentChangeHandler=n.componentChangeHandler.bind(n),n.pointChangeHandler=n.pointChangeHandler.bind(n),n.unitChangeHandler=n.unitChangeHandler.bind(n),n.tenantChangeHandler=n.tenantChangeHandler.bind(n),n.getComponentsHandler=n.getComponentsHandler.bind(n),n.showMultiDropDown=n.showMultiDropDown.bind(n),n.addMultiplePoints=n.addMultiplePoints.bind(n),n.setPeopleTenantDropDown=n.setPeopleTenantDropDown.bind(n),n.showMultiDrop=n.showMultiDrop.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e,t,n,a,s=this;return b(this,function(r){switch(r.label){case 0:return e=this.state.actions,this.getFloorBasedOnBuildingHandler(),[4,Object(d.n)(this.props.buildingName)];case 1:return t=(t=r.sent()).filter(function(e){return"4"==Object(i.g)(e.role)}),[4,Object(p.g)(this.props.buildingName)];case 2:return n=r.sent(),[4,Object(o.f)(this.props.buildingName)];case 3:return a=r.sent(),this.setState({people:t,spaces:n,assets:a}),e&&e.map(function(e,t){return f(s,void 0,void 0,function(){return b(this,function(n){switch(n.label){case 0:return e.spaceOntology?(this.getSpacesBasedOnFloorHandler(e.floorOntology,t),this.getAssetsBasedOnSpaceHandler(e.spaceOntology,t),this.getComponentsHandler(e.assetOntology,t),[4,this._fetchPoints(e.assetOntology,t)]):[3,2];case 1:n.sent(),this.setPeopleTenantDropDown(e.directiveType,t),this.addSelectedPoints(e.pointOntology,t),n.label=2;case 2:return[2]}})})}),[2]}})})},t.prototype.addSelectedPoints=function(e,t){return f(this,void 0,void 0,function(){var n,a,o,s,r;return b(this,function(c){for(n=this.state.selectedPoints,a=[],o=e.split(","),s=0;s<o.length;s++)(r=this.state._points[t].location.find(function(e){return Object(i.g)(e.point)===o[s]}))&&void 0!=r&&a.push({label:Object(i.g)(r.pointLabel),value:Object(i.g)(r.point)}),n.push(a);return this.setState({selectedPoints:n}),[2]})})},t.prototype.setPeopleTenantDropDown=function(e,t){return f(this,void 0,void 0,function(){var n,a,i,o;return b(this,function(s){return"done"==e?[2,this.showMultiDrop(e,t)]:(n=this.state.actions,a=this.state.showPoints,i=this.state.showMultiSelect,o="directiveType",n[t][""+o]=e,a[t]="customer"!=e,i[t]="done"==e,this.setState({actions:n,showPoints:a,showMultiSelect:i}),[2])})})},t.prototype.showMultiDrop=function(e,t){return f(this,void 0,void 0,function(){var n,a,i,o;return b(this,function(s){return n=this.state.actions,a=this.state.showPoints,(i=this.state.showMultiSelect)[t]=!0,a[t]=!1,o="directiveType",n[t][""+o]=e,this.setState({showMultiSelect:i,showPoints:a,actions:n}),[2]})})},t.prototype.getUnits=function(){return f(this,void 0,void 0,function(){return b(this,function(e){return[2]})})},t.prototype.getFloorBasedOnBuildingHandler=function(){return f(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return[4,Object(l.f)(this.props.buildingName)];case 1:return e=t.sent(),this.setState({_floors:e,_spaces:[],_assets:[],_components:[],_points:[]}),[2]}})})},t.prototype.floorChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a,i,o,s,r;return b(this,function(c){return n=this.state.actions,a=this.state._components,i=this.state,o=i._spaces,s=i._assets,r=i._points,void 0==o[t]&&(o[t]=Object()),o[t].location=[],void 0==s[t]&&(s[t]=Object()),s[t].location=[],void 0==r[t]&&(r[t]=Object()),r[t].location=[],n[t].spaceOntology="",n[t].assetOntology="",n[t].pointOntology="",n[t].floorOntology="0"==e?"":e,void 0==a[t]&&(a[t]=Object()),a[t].location=[],n[t].componentOntology="",this.setState({actions:n,_components:a,_spaces:o,_assets:s,_points:r}),this.getSpacesBasedOnFloorHandler(e,t),[2]})})},t.prototype.getSpacesBasedOnFloorHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a,o,s,r;return b(this,function(c){return n=this.state,a=n._spaces,o=n.spaces,s=o&&o.filter(function(t){return Object(i.g)(t.floor)==e}),r=[],s&&s.map(function(e,t){var n=Object();n.rdfsLabel=e.rdfsLabel,n.ontology=e.space,r.push(n)}),void 0==a[t]&&(a[t]=Object()),a[t].location=r||[],this.setState({_spaces:a}),[2]})})},t.prototype.spacesChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a,i,o,s,r;return b(this,function(c){return n=this.state.actions,a=this.state._components,"0"==e&&(i=this.state,o=i._assets,s=i._points,r=i._components,o[t].location=[],s[t].location=[],this.setState({_assets:o,_points:s,_components:r}),n[t].assetOntology="",n[t].pointOntology=""),n[t].spaceOntology="0"==e?"":e,a[t].location=[],n[t].componentOntology="",this.setState({actions:n,_components:a}),this.getAssetsBasedOnSpaceHandler(e,t),[2]})})},t.prototype.getAssetsBasedOnSpaceHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a,o,s,r;return b(this,function(c){return n=this.state,a=n._assets,o=n.assets,s=o&&o.filter(function(t){return Object(i.g)(t.space)==e}),void 0==a[t]&&(a[t]=Object()),a[t].location=[],r=[],s&&s.map(function(e,t){var n=Object();n.rdfsLabel=e.equipRdfsLabel,n.ontology=e.equip,r.push(n)}),a[t].location=r||[],this.setState({_assets:a}),[2]})})},t.prototype.assetChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a,i,o,s,r;return b(this,function(c){return n=this.state.actions,"0"==e&&(a=this.state,i=a._points,o=a._components,s=a.selectedPoints,i[t].location=[],r=[],s[t]=r,this.setState({_points:i,_components:o,selectedPoints:s}),n[t].componentOntology="",n[t].pointOntology=""),n[t].assetOntology="0"==e?"":e,this.setState({actions:n}),this.getComponentsHandler(e,t),this._fetchPoints(e,t),[2]})})},t.prototype.getComponentsHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a;return b(this,function(i){switch(i.label){case 0:return n=this.state._components,[4,Object(o.m)(this.props.buildingName,e)];case 1:return a=i.sent(),void 0==n[t]&&(n[t]=Object()),n[t].location=a||[],this.setState({_components:n}),[2]}})})},t.prototype.componentChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n;return b(this,function(a){return(n=this.state.actions)[t].componentOntology="0"==e?"":e,this.setState({actions:n}),[2]})})},t.prototype.pointChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n,a,o;return b(this,function(s){return n=this.state.actions,a=this.state._points,n[t].pointOntology="0"==e?"":e,o=a[t].location.find(function(t){return Object(i.g)(t.point)==e}).tag,n[t].qrCode="0"==e?"":Object(i.g)(o),this.setState({actions:n}),[2]})})},t.prototype.tenantChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n;return b(this,function(a){return(n=this.state.actions)[t].pointOntology="0"==e?"":e,this.setState({actions:n}),[2]})})},t.prototype._fetchPoints=function(e,t){return f(this,void 0,void 0,function(){var n,a,o,s,r,l,u;return b(this,function(d){switch(d.label){case 0:return n=this.props.buildingName,a=this.state,o=a._points,s=a.pointsDropDown,[4,Object(c.h)(n,"",e)];case 1:return r=d.sent(),void 0==o[t]&&(o[t]=Object()),o[t].location=r||[],l=[],r&&r.length>0&&r.map(function(e,t){l.push({label:Object(i.g)(e.pointLabel),value:Object(i.g)(e.point)})}),u=Object(),0==l.length&&l.push({label:"No Points",value:"-1"}),u.location=l,s[t]=u,this.setState({_points:o,pointsDropDown:s}),[2]}})})},t.prototype.addActionItem=function(){var e=this.state,t=e.actions,n=e._spaces,a=e._assets,i=e._points,o=e._components;t.push({ontology:Object(s.l)(8),assetOntology:"",dataEntered:"",directive:"",directiveType:"",taskOntology:this.props.taskID,unit:"",pointOntology:"",isTemplate:!1,floorOntology:"",spaceOntology:"",componentOntology:""});var r=Object(),c=Object(),l=Object(),u=Object();r.location=[],c.location=[],l.location=[],u.location=[],n.push(r),a.push(c),o.push(l),i.push(u),this.setState({actions:t,_spaces:n,_assets:a,_points:i})},t.prototype.componentWillReceiveProps=function(e){return f(this,void 0,void 0,function(){return b(this,function(t){return this.setState({actions:e.actions}),[2]})})},t.prototype.saveActions=function(){return f(this,void 0,void 0,function(){var e,t;return b(this,function(n){switch(n.label){case 0:for(e=this.state.actions,t=0;t<e.length;t++)e[t].taskOntology=this.props.taskID,e[t].isTemplate=this.props.isTemplate;return Object(h.a)(!0),[4,Object(r.c)(this.props.buildingName,e)];case 1:return n.sent(),Object(h.a)(!1),[2]}})})},t.prototype.deleteActions=function(e){return f(this,void 0,void 0,function(){var t,n;return b(this,function(a){switch(a.label){case 0:return t=this.props.buildingName,n=this.state.actions,[4,Object(r.a)(t,e).then(function(){})];case 1:return a.sent(),n=n.filter(function(t){return t.ontology!==e}),this.setState({actions:n}),[2]}})})},t.prototype.handleActionsFormChange=function(e,t){if("done"==e.target.value)return this.showMultiDropDown(e,t);var n=this.state.actions,a=this.state.showPoints,i=this.state.showMultiSelect,o=e.target.name;n[t][""+o]=e.target.value,a[t]="customer"!=e.target.value,i[t]="done"==e.target.value,this.setState({actions:n,showPoints:a,showMultiSelect:i})},t.prototype.showMultiDropDown=function(e,t){return f(this,void 0,void 0,function(){var n,a,i,o;return b(this,function(s){return n=this.state.actions,a=this.state.showPoints,(i=this.state.showMultiSelect)[t]=!0,a[t]=!1,o=e.target.name,n[t][""+o]=e.target.value,this.setState({showMultiSelect:i,showPoints:a,actions:n}),[2]})})},t.prototype.unitChangeHandler=function(e,t){return f(this,void 0,void 0,function(){var n;return b(this,function(a){return(n=this.state.actions)[t].unit=e.target.value,this.setState({actions:n}),[2]})})},t.prototype.addMultiplePoints=function(e,t){return f(this,void 0,void 0,function(){var n,a,o,s;return b(this,function(r){return e[0]&&-1==e[0].value?[2]:(n=this.state.selectedPoints,a=this.state.actions,o="",n[t]=e,e&&e.map(function(e,t){o=o+Object(i.g)(e)+","}),s=o.substring(0,o.length-1),a[t].pointOntology=s,this.setState({actions:a,selectedPoints:n}),[2])})})},t.prototype.render=function(){var e=this,t=(this.props,this.state),n=t.actions,o=t._points,s=t._spaces,r=t._floors,c=t._components,l=t._assets,d=t.people;return a.createElement("div",{className:"row mx-1 p-2"},a.createElement("div",{className:"col-md-12 no-padding b-row-background"},a.createElement("div",{className:"col-md-2 py-3 grid-header"},"Do What "),a.createElement("div",{className:"col-md-2 py-3 grid-header"},"What Type"),a.createElement("div",{className:"col-md-1 py-3 grid-header"},"Floor"),a.createElement("div",{className:"col-md-1 py-3 grid-header"},"Space"),a.createElement("div",{className:"col-md-1 py-3 grid-header"},"Asset"),a.createElement("div",{className:"col-md-2 py-3 grid-header"},"Component"),a.createElement("div",{className:"col-md-2 py-3 grid-header"},"Point/Tenant"),a.createElement("div",{className:"col-md-1 py-3 grid-header"},"Delete")),n&&n.map(function(t,n){return a.createElement("div",{key:n,className:"col-md-12 no-padding"},a.createElement("div",{className:"col-md-2 p-1"},a.createElement("input",{type:"text",className:"form-control",value:t.directive,name:"directive",placeholder:"Action...",onChange:function(t){e.handleActionsFormChange(t,n)}})),a.createElement("div",{className:"col-md-2 p-1"},a.createElement("select",{className:"form-control",name:"directiveType",value:t.directiveType,onChange:function(t){e.handleActionsFormChange(t,n)}},a.createElement("option",{value:""},"Select Action Type"),a.createElement("option",{value:"scan"},"Scan QR"),a.createElement("option",{value:"enter"},"Enter Form Data"),a.createElement("option",{value:"numeric"},"Enter Numeric Data"),a.createElement("option",{value:"upload"},"Upload Attachment"),a.createElement("option",{value:"email"},"Send Email"),a.createElement("option",{value:"customer"},"Customer"),a.createElement("option",{value:"done"},"Check Done"))),a.createElement("div",{className:"col-md-1 p-1"},a.createElement("select",{className:"form-control",id:"floor",name:"floor",value:t.floorOntology,onChange:function(t){e.floorChangeHandler(t.target.value,n)}},a.createElement("option",{value:"0"},"Select Floor"),r&&r.map(function(e,t){return a.createElement("option",{value:Object(i.g)(e.ontology),key:t},e.rdfsLabel.value," ")}))),a.createElement("div",{className:"col-md-1 p-1"},a.createElement("select",{className:"form-control",id:"spaces",name:"spaces",value:t.spaceOntology,onChange:function(t){e.spacesChangeHandler(t.target.value,n)}},a.createElement("option",{value:"0"},"Select Spaces"),s&&void 0!=s[n]&&s[n].location!=[]&&void 0!==s[n].location&&s[n].location.length>0&&s[n].location[0]&&s[n].location.map(function(e,t){return a.createElement("option",{value:Object(i.g)(e.ontology),key:t},Object(i.g)(e.rdfsLabel)," ")}))),a.createElement("div",{className:"col-md-1 p-1"},a.createElement("select",{className:"form-control",id:"assets",name:"assets",value:t.assetOntology,onChange:function(t){e.assetChangeHandler(t.target.value,n)}},a.createElement("option",{value:"0"},"Select Assets"),l&&void 0!=l[n]&&l[n].location!=[]&&l[n].location.length>0&&l[n].location[0]&&l[n].location.map(function(e,t){return a.createElement("option",{value:Object(i.g)(e.ontology),key:t},Object(i.g)(e.rdfsLabel)," ")}))),a.createElement("div",{className:"col-md-2 p-1"},a.createElement("select",{className:"form-control",id:"components",name:"components",value:t.componentOntology,onChange:function(t){e.componentChangeHandler(t.target.value,n)}},a.createElement("option",{value:"0"},"Select Component"),c&&void 0!=c[n]&&c[n].location!=[]&&c[n].location.length>0&&c[n].location[0]&&c[n].location.map(function(e,t){return a.createElement("option",{value:Object(i.g)(e.name),key:t},Object(i.g)(e.rdfsLabel)," ")}))),a.createElement("div",{className:"col-md-2 p-1"},e.state.showPoints[n]&&a.createElement("select",{className:"form-control",id:"points",name:"points",value:t.pointOntology,onChange:function(t){e.pointChangeHandler(t.target.value,n)}},a.createElement("option",{value:"0"},"Select Points"),o&&o[n]&&void 0!=o[n].location&&o[n].location.length>0&&o[n].location[0]&&o[n].location.map(function(e,t){return a.createElement("option",{value:Object(i.g)(e.point),key:t},Object(i.g)(e.pointLabel)," ")})),!e.state.showPoints[n]&&!e.state.showMultiSelect[n]&&a.createElement("select",{className:"form-control",id:"tenants",name:"tenants",value:t.pointOntology,onChange:function(t){e.tenantChangeHandler(t.target.value,n)}},a.createElement("option",{value:"0"},"Select Tenant"),d&&void 0!=d.length&&d.length>0&&d.map(function(e,t){return a.createElement("option",{value:Object(i.g)(e.contact),key:t},Object(i.g)(e.name)," ")})),!e.state.showPoints[n]&&e.state.showMultiSelect[n]&&a.createElement(u.a,{isMulti:!0,onChange:function(t){e.addMultiplePoints(t,n)},placeholder:"Add Points",options:e.state.pointsDropDown&&e.state.pointsDropDown[n]&&e.state.pointsDropDown[n].location.length>0&&e.state.pointsDropDown[n].location[0]&&e.state.pointsDropDown[n].location!=[]&&e.state.pointsDropDown[n].location,value:e.state.selectedPoints[n]})),a.createElement("div",{className:"col-md-1 p-1"},a.createElement("button",{className:"margin-5 btn btn-danger btn-fill pull-right",onClick:function(){e.deleteActions(t.ontology)}},a.createElement("i",{className:"fa fa-close"}))))}),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("button",{className:"margin-5 btn btn-primary btn-fill",onClick:function(){e.addActionItem()}},a.createElement("i",{className:"fa fa-plus"})))))},t}(a.Component);t.a=g},627:function(e,t,n){"use strict";t.b=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(a){switch(a.label){case 0:return[4,Object(o.e)({buildingName:e,tasks:t,ontologies:n},o.a.OBJECTFORM.GetObjectFormActions,i.b.TASK,!0)];case 1:return[2,a.sent()]}})})},t.c=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,ObjectActionTemplates:t},o.a.OBJECTFORM.SaveObjectFormActions,i.b.TASK).then(function(){Object(a.b)(" Assigned Successfully.")}).catch(function(e){Object(a.a)("Error occured while saving.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,ontology:t},o.a.OBJECTFORM.DeleteObjectFormActions,i.b.TASK).then(function(){Object(a.b)("All Actions Deleted Successfully.")}).catch(function(e){Object(a.a)("Error occured while saving.")})];case 1:return[2,n.sent()]}})})};var a=n(44),i=n(26),o=n(19),s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}},629:function(e,t,n){"use strict";t.k=function(){return s(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,Object(o.e)({},o.a.TASKS.GetTaskTypeList,a.b.TASK)];case 1:return[2,e.sent()]}})})},t.l=function(){return s(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,Object(o.e)({},o.a.TASKS.GetWorkTypeList,a.b.TASK)];case 1:return[2,e.sent()]}})})},t.h=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,getArchivedOnly:t},o.a.CHATS.GetChats,a.b.TASK)];case 1:return[2,n.sent()]}})})},t.f=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,chatName:t},o.a.CHATS.DeleteChat,a.b.TASK).then(function(){Object(i.b)("Chat Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting Chat.")})];case 1:return[2,n.sent()]}})})},t.p=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,chatName:t},o.a.TASKS.UpdateLastMessageOn,a.b.CHAT)];case 1:return[2,n.sent()]}})})},t.u=function(e){return s(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({chatName:e},o.a.TASKS.UpdateUnreadCount,a.b.TASK)];case 1:return[2,t.sent()]}})})},t.n=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(s){switch(s.label){case 0:return[4,Object(o.f)({buildingName:e,model:t,isEdit:n},o.a.TASKS.UpdateRootTask,a.b.TASK).then(function(){Object(i.b)("Task "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Task.")})];case 1:return[2,s.sent()]}})})},t.i=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(i){switch(i.label){case 0:return[4,Object(o.e)({buildingName:e,taskNumber:t,isArchived:n},o.a.TASKS.GETTASKS,a.b.TASK,!0)];case 1:return[2,i.sent()]}})})},t.j=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(i){switch(i.label){case 0:return[4,Object(o.e)({buildingName:e,parentTask:t,subTaskNumber:n},o.a.TASKS.GetSubTask,a.b.TASK)];case 1:return[2,i.sent()]}})})},t.r=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,isDeleted:t},o.a.TASKS.UpdateRootTaskDeleteStatus,a.b.TASK).then(function(){Object(i.b)("Task Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting Task.")})];case 1:return[2,n.sent()]}})})},t.t=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(s){switch(s.label){case 0:return[4,Object(o.f)({taskID:e,status:t},o.a.TASKS.UpdateTaskStatus,a.b.TASK).then(function(){n||Object(i.b)("Status Updated Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Task.")})];case 1:return[2,s.sent()]}})})},t.s=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,startTime:t},o.a.TASKS.UpdateTaskStartTime,a.b.TASK).then(function(){Object(i.b)("Start Time Updated Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Task.")})];case 1:return[2,n.sent()]}})})},t.d=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,isArchived:t},o.a.TASKS.ArchiveTask,a.b.TASK).then(function(){Object(i.b)((t?"Archived":"Unarchived")+" Successfully.")}).catch(function(e){Object(i.a)("Error occured while Archiving Task.")})];case 1:return[2,n.sent()]}})})},t.c=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,note:t},o.a.TASKS.AddPauseNote,a.b.TASK).then(function(){}).catch(function(e){Object(i.a)("Error occured while saving Task.")})];case 1:return[2,n.sent()]}})})},t.g=function(e){return s(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({taskID:e},o.a.TASKS.DeletePauseNote,a.b.TASK).then(function(){}).catch(function(e){Object(i.a)("Error occured while saving Task.")})];case 1:return[2,t.sent()]}})})},t.b=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,note:t},o.a.TASKS.AddNote,a.b.TASK).then(function(){Object(i.b)("Note Added Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Task.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,isAcknowledged:t},o.a.TASKS.AcknowledgeRootTask,a.b.TASK).then(function(){Object(i.b)(t?"Acknowledged Successfully.":"Unacknowledged Successfully.")}).catch(function(e){Object(i.a)("Error occured while Acknowledging.")})];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,checklistID:t},o.a.TASKS.AssignChecklist,a.b.TASK).then(function(){Object(i.b)("Checklist Assigned Successfully.")}).catch(function(e){Object(i.a)("Error occured while Assigning Checklist.")})];case 1:return[2,n.sent()]}})})},t.q=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(s){switch(s.label){case 0:return[4,Object(o.f)({email:e,roles:t,fileName:n},o.a.ONEDRIVE.UPDATEPERMISSION,a.b.TASK,"",!0).then(function(e){return e}).catch(function(e){Object(i.a)("Error occured while update Permission.")})];case 1:return[2,s.sent()]}})})},t.m=function(e){return s(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({fileName:e},o.a.ONEDRIVE.REMOVEPERMISSION,a.b.TASK,"",!0).then(function(e){return e}).catch(function(e){Object(i.a)("Error occured while removing Permission.")})];case 1:return[2,t.sent()]}})})},t.o=function(e){return s(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({buildingName:e},o.a.TASKS.TriggerTaskManagement,a.b.TASK,"").then(function(e){return e}).catch(function(e){Object(i.a)("Error occured while triggering task automation.")})];case 1:return[2,t.sent()]}})})};var a=n(26),i=n(44),o=n(19),s=(n(14),this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})}),r=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}},658:function(e,t,n){"use strict";t.f=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(s){switch(s.label){case 0:return[4,Object(o.f)({buildingName:e,purchaseOrder:t,isEdit:n},o.a.PURCHASEORDER.SavePurchaseOrder,a.b.PURCHASEORDER).then(function(){Object(i.b)("Purchase Order "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Purchase Order.")})];case 1:return[2,s.sent()]}})})},t.a=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,poID:t},o.a.PURCHASEORDER.DeletePO_Items,a.b.PURCHASEORDER)];case 1:return[2,n.sent()]}})})},t.c=function(e,t,n){return s(this,void 0,void 0,function(){return r(this,function(i){switch(i.label){case 0:return[4,Object(o.e)({buildingName:e,purchaseOrderID:t,workOrderID:n},o.a.PURCHASEORDER.FetchPurchaseOrders,a.b.PURCHASEORDER)];case 1:return[2,i.sent()]}})})},t.b=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,purchaseOrderID:t},o.a.PURCHASEORDER.FetchPurchaseOrderItems,a.b.PURCHASEORDER)];case 1:return[2,n.sent()]}})})},t.d=function(e){return s(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(o.e)({buildingName:e},o.a.PURCHASEORDER.GetShipToItems,a.b.VENDOR)];case 1:return[2,t.sent()]}})})},t.g=function(e,t){return s(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({purchaseOrderID:e,newStatus:t},o.a.PURCHASEORDER.SetNewStatusPO,a.b.PURCHASEORDER).then(function(){Object(i.b)("Purchase Order Updated Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Purchase Order.")})];case 1:return[2,n.sent()]}})})},t.e=function(e){return s(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(o.e)({buildingName:e},o.a.PURCHASEORDER.GetWorkOrdersList,a.b.PURCHASEORDER)];case 1:return[2,t.sent()]}})})};var a=n(26),i=n(44),o=n(19),s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}},699:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(17),i=n(19),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(s,r)}c((a=a.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,a,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},r=function(){function e(){}return e.prototype.SendSMS=function(e,t,n,r){return o(this,void 0,void 0,function(){var o;return s(this,function(s){switch(s.label){case 0:return t+=", To Unsubscribe SMS Alerts: "+window.location.origin+"/#"+n+"/UnsubscribeSMSAlerts/FullScreen",o={to:e,body:t},[4,fetch(i.g+"SendSMS",{mode:"cors",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/sparql-results+json"},body:Object(a.i)(o)})];case 1:return[2,s.sent()]}})})},e.prototype.SendSMS_Multiple=function(e,t,n,r,c){return o(this,void 0,void 0,function(){var o;return s(this,function(s){switch(s.label){case 0:return r&&(t+=", To Unsubscribe SMS Alerts: "+window.location.origin+"/#"+n+"/UnsubscribeSMSAlerts/FullScreen"),o={to:e,body:t},[4,fetch(i.g+"SendMultipleSMS",{mode:"cors",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8",Accept:"application/sparql-results+json"},body:Object(a.i)(o)})];case 1:return[2,s.sent()]}})})},e}()}});