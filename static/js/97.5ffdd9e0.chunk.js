webpackJsonp([97],{2981:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(2),l=(n.n(i),n(119)),o=n(673),r=n(116),c=n(10),s=n(11),d=n(649),u=n(1754),m=n(652),g=n(874),p=n(23),h=n(726),b=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,l){function o(e){try{c(a.next(e))}catch(e){l(e)}}function r(e){try{c(a.throw(e))}catch(e){l(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,r)}c((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,i,l,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return l={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(l){return function(r){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&l[0]?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,a=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){o.label=l[1];break}if(6===l[0]&&o.label<i[1]){o.label=i[1],i=l;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(l);break}i[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],a=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,r])}}},N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={buildingObj:Object(),isEdit:!1,addBuildingFunction:!1,addBuildingName:"",regionList:[],buildingNameToDelete:Object(),isDelete:!1,DropdownModelObj:Object(),BuildingFunctionListType:[],responseCenterCountryCode:"",responseCenterAreaCode:"",responseCenterPhoneNo1:"",responseCenterPhoneNo2:""},a=n,n.setBuilding=n.setBuilding.bind(n),n.saveBuilding=n.saveBuilding.bind(n),n.handleBuildingChange=n.handleBuildingChange.bind(n),n.getRegion=n.getRegion.bind(n),n.deleteBuilding=n.deleteBuilding.bind(n),n.toDeleteBuilding=n.toDeleteBuilding.bind(n),n}return b(t,e),t.prototype.saveBuilding=function(){return f(this,void 0,void 0,function(){var e,t,n,a,i;return v(this,function(l){switch(l.label){case 0:return e=this.state,t=e.buildingObj,n=e.isEdit,a=this.props.instance,t.dashboardLink&&t.dashboardLink.indexOf("&kiosk=tv&autofitpanels"),t.dashboardLink,t.wholeBuildingMeterLink&&t.wholeBuildingMeterLink.indexOf("&kiosk=tv&autofitpanels"),t.wholeBuildingMeterLink,i=JSON.parse(s.a.getItem("user")),t&&t.rdfsLabel?(Object(r.a)(!0),[4,Object(o.f)(t,i.contact,n)]):[3,2];case 1:l.sent(),Object(r.a)(!1),l.label=2;case 2:return window.location.hash=a+"/Buildings",[2]}})})},t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.instance?[4,this.setBuilding()]:[3,3];case 1:return e.sent(),[4,this.getBuildingFunction()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.setBuilding=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return this.props.buildingName&&this.props.buildingName.length>0?Object(o.d)(this.props.buildingName).then(function(e){if(e&&e.length>0){var n=e[0],i=t.state.buildingObj;console.log(i),i.rdfsLabel=Object(c.g)(n.rdfsLabel),i.address=Object(c.g)(n.address),i.buildingCode=Object(c.g)(n.buildingCode),i.area=Object(c.g)(n.area),i.buildingFunction=Object(c.g)(n.function),i.buildingName=Object(c.g)(n.building),i.campus=Object(c.g)(n.campus),i.linkbimism=Object(c.g)(n.linkBimism),i.street=Object(c.g)(n.street),i.state=Object(c.g)(n.state),i.city=Object(c.g)(n.city),i.zipcode=Object(c.g)(n.zipcode),i.dashboardLink=Object(c.g)(n.dashboardLink),i.googleMapLink=Object(c.g)(n.googleMapLink),i.wholeBuildingMeterLink=Object(c.g)(n.wholeBuildingMeterLink),i.MVPSecurity=Object(c.g)(n.MVPSecurity),i.country=Object(c.g)(n.country),i.buildingDimensionUnit=Object(c.g)(n.buildingDimensionUnit),i.responseCenterName=Object(c.g)(n.responseCenterName),i.responseCenterEmail=Object(c.g)(n.responseCenterEmail),i.responseCenterPhoneNo=Object(c.g)(n.responseCenterPhoneNo);var l=i.responseCenterPhoneNo.split(" ");a.setState({responseCenterCountryCode:l[0]?l[0].replace("+",""):"",responseCenterAreaCode:l[1]?l[1].replace("(","").replace(")",""):"",responseCenterPhoneNo1:l[2]?l[2]:"",responseCenterPhoneNo2:l[3]?l[3]:"",buildingObj:i,isEdit:!0}),t.getRegion()}}).catch(function(e){return e}):((e=Object()).buildingName=Object(p.r)(4),a.setState({buildingObj:e})),[2]})})},t.prototype.saveBuildingFunction=function(){return f(this,void 0,void 0,function(){var e,t,n,a,i=this;return v(this,function(l){switch(l.label){case 0:return e=this.state,t=e.DropdownModelObj,n=e.isEdit,a=this.state.buildingObj.buildingFunction,t.name=a,t.type="Building Function",[4,Object(g.b)(t,n).then(function(){i.getBuildingFunction()}).catch(function(e){console.log(e)})];case 1:return l.sent(),[2]}})})},t.prototype.getBuildingFunction=function(){return f(this,void 0,void 0,function(){var e,t;return v(this,function(n){switch(n.label){case 0:return e=this.state.BuildingFunctionListType,[4,Object(g.c)()];case 1:return(t=n.sent())&&t.length>0&&(e=t.filter(function(e){return"Building Function"==Object(c.g)(e.type)}),this.setState({BuildingFunctionListType:e})),[2]}})})},t.prototype.handleBuildingChange=function(e,t){var n=this.state.buildingObj;switch(e){case"buildingName":n.rdfsLabel=t;break;case"address":n.address=t;break;case"buildingCode":n.buildingCode=t;break;case"area":n.area=t;break;case"buildingFunction":n.buildingFunction=t,"Others"==n.buildingFunction&&(n.buildingFunction="",document.getElementById("openSecondDialog").click());case"campus":n.campus=t;break;case"linkbimism":n.linkbimism=t;break;case"street":n.street=t;break;case"city":n.city=t;break;case"state":n.state=t;break;case"zipcode":n.zipcode=t;break;case"dashboardLink":n.dashboardLink=t;break;case"googleMapLink":n.googleMapLink=t;break;case"wholeBuildingMeterLink":n.wholeBuildingMeterLink=t;break;case"MVPSecurity":n.MVPSecurity=t;break;case"country":n.country=t;var a=u.a&&u.a.find(function(e){return e.countryName==t});this.setState({regionList:a.regions});break;case"buildingDimensionUnit":n.buildingDimensionUnit=t;break;case"responseCenterCountryCode":t.length<3?(this.setState({responseCenterCountryCode:t}),2==t.length&&document.getElementById("responseCenterAreaCode").focus()):document.getElementById("responseCenterAreaCode").focus();break;case"responseCenterAreaCode":t.length<4?(this.setState({responseCenterAreaCode:t}),3==t.length&&document.getElementById("responseCenterPhoneNo1").focus()):document.getElementById("responseCenterPhoneNo1").focus();break;case"responseCenterPhoneNo1":t.length<4?(this.setState({responseCenterPhoneNo1:t}),3==t.length&&document.getElementById("responseCenterPhoneNo2").focus()):document.getElementById("responseCenterPhoneNo2").focus();break;case"responseCenterPhoneNo2":t.length<5&&this.setState({responseCenterPhoneNo2:t});break;default:n[e]=t}this.setState({buildingObj:n},this.setPhoneNo)},t.prototype.setPhoneNo=function(){var e=this.state.buildingObj;e.responseCenterPhoneNo="+"+this.state.responseCenterCountryCode+" ("+this.state.responseCenterAreaCode+") "+this.state.responseCenterPhoneNo1+" "+this.state.responseCenterPhoneNo2,this.setState({buildingObj:e})},t.prototype.getRegion=function(){var e=this.state,t=e.buildingObj,n=e.regionList;if(this.props.buildingName&&this.props.buildingName.length>0){var a=u.a&&u.a.find(function(e){return e.countryName==t.country});n=a&&a.regions,this.setState({regionList:n})}},t.prototype.deleteBuilding=function(e){this.setState({buildingNameToDelete:e},function(){document.getElementById("btnConfirm").click()})},t.prototype.toDeleteBuilding=function(){return f(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=this.state.buildingNameToDelete)?[4,Object(o.a)(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return document.getElementById("cancelBuildingEdit").click(),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.buildingObj,a=t.addBuildingFunction,o=t.addBuildingName,r=t.regionList,s=t.isEdit,g=t.BuildingFunctionListType,p=this.props,b=p.instance,f=p.buildingName,v=n&&n.city&&n.state&&n.country&&n.street&&n.zipcode&&n.rdfsLabel&&n.area&&n.buildingFunction&&!0;return i.createElement(l.a.Consumer,null,function(t){return i.createElement("div",{className:"content",style:{marginTop:"-15px",marginLeft:"7px",marginRight:"7px"}},i.createElement("div",{className:"card"},i.createElement("div",{className:"container-fluid padding-10"},i.createElement("h4",{className:"title"},"Building Information"),i.createElement("hr",null),i.createElement("br",null),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"buildingname"},"Building name:"))),i.createElement("div",{className:"col-md-3"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control "+(n.rdfsLabel?"":"addFieldValidate"),type:"text",id:"buildingname",value:n.rdfsLabel,onChange:function(t){e.handleBuildingChange("buildingName",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"area"},"Area:"))),i.createElement("div",{className:"col-md-3"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control "+(n.area?"":"addFieldValidate"),type:"number",id:"area",value:n.area,onChange:function(t){e.handleBuildingChange("area",t.target.value)}}))),i.createElement("div",{className:"col-md-2"},"Square Feet")),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"buildingFunction"},"Function:"))),i.createElement("div",{className:"col-md-3"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control "+(n.buildingFunction?"":"addFieldValidate"),id:"buildingFunction",value:n.buildingFunction,onChange:function(t){e.handleBuildingChange("buildingFunction",t.target.value)}},i.createElement("option",{value:""},"Select Function"),g&&g.length>0&&g.map(function(e,t){return i.createElement("option",{key:t,value:Object(c.g)(e.ontology)},Object(c.g)(e.name))}),i.createElement("option",{value:"Others"},"Others")))),i.createElement("button",{type:"button",id:"openSecondDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#secondDialog"}," ."),i.createElement(d.a,{id:"secondDialog",heading:a?"Add Building Function ":"Add Building Function",saveButtonText:o?"Update Building":"Create Building Funcion",cancelButtonText:"Cancel",disableSaveButton:!n.buildingFunction,showCancelButton:!0,showSaveButton:!0,isEditForm:!1,onSaveButtonClick:function(){e.saveBuildingFunction()}},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement("label",{htmlFor:"point"},"Name:"),i.createElement("br",null),i.createElement("input",{className:"controls clearfix form-control",type:"text",name:"buildingfunction",placeholder:"Other Name",onChange:function(t){e.handleBuildingChange("buildingFunction",t.target.value)},value:n.buildingFunction}))))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"buildingFunction"},"Building Code"))),i.createElement("div",{className:"col-md-3"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"text",id:"buildingCode",value:n.buildingCode,onChange:function(t){e.handleBuildingChange("buildingCode",t.target.value)}}))),i.createElement("div",{className:"col-md-1"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"buildingFunction"},"Dimension Unit"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control",id:"buildingDimensionUnit",name:"buildingDimensionUnit",value:n.buildingDimensionUnit,onChange:function(t){e.handleBuildingChange("buildingDimensionUnit",t.target.value)}},i.createElement("option",{value:""},"Select Dimension Unit"),i.createElement("option",{value:"Meter"},"Meter"),i.createElement("option",{value:"Feet"},"Feet"))))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"streetAddress"},"Address"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control "+(n.country?"":"addFieldValidate"),id:"country",value:n.country,onChange:function(t){e.handleBuildingChange("country",t.target.value)}},i.createElement("option",{value:""},"Select Country"),u.a&&u.a.length>0&&u.a.map(function(e,t){return i.createElement("option",{value:e.countryName},e.countryName)})))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("select",{className:"form-control "+(n.state?"":"addFieldValidate"),id:"state",value:n.state,onChange:function(t){e.handleBuildingChange("state",t.target.value)}},i.createElement("option",{value:""},"Select State"),r&&r.length>0&&r.map(function(e){return i.createElement("option",{value:e.label},e.label)})))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control "+(n.street?"":"addFieldValidate"),type:"text",id:"streetAddress",name:"streetAddress",placeholder:"Street",value:n.street,onChange:function(t){e.handleBuildingChange("street",t.target.value)}}))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control "+(n.city?"":"addFieldValidate"),type:"text",id:"city",name:"city",placeholder:"City",value:n.city,onChange:function(t){e.handleBuildingChange("city",t.target.value)}}))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control "+(n.zipcode?"":"addFieldValidate"),type:"text",id:"zipcode",name:"zipcode",placeholder:"ZipCode",value:n.zipcode,onChange:function(t){e.handleBuildingChange("zipcode",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"linkbimism"},"Virtual BIM Link:"))),i.createElement("div",{className:"col-md-9"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"text",id:"linkbimism",value:n.linkbimism,onChange:function(t){e.handleBuildingChange("linkbimism",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"linkbimism"},"Dashboard Link:"))),i.createElement("div",{className:"col-md-9"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"text",id:"dashboardLink",value:n.dashboardLink,onChange:function(t){e.handleBuildingChange("dashboardLink",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"MVPSecurity"},"MVP Security Link:"))),i.createElement("div",{className:"col-md-9"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"text",id:"MVPSecurity",name:"MVPSecurity",value:n.MVPSecurity,onChange:function(t){e.handleBuildingChange("MVPSecurity",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"linkbimism"},"Whole Building Meter Link:"))),i.createElement("div",{className:"col-md-9"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"text",id:"wholeBuildingMeterLink",value:n.wholeBuildingMeterLink,onChange:function(t){e.handleBuildingChange("wholeBuildingMeterLink",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"googleMapLink"},"Google Map Link:"))),i.createElement("div",{className:"col-md-9"},i.createElement("div",{className:"form-group"},i.createElement("input",{className:"form-control",type:"text",id:"googleMapLink",value:n.googleMapLink,onChange:function(t){e.handleBuildingChange("googleMapLink",t.target.value)}})))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"linkbimism"},"Response Center:"))),i.createElement("div",{className:"col-md-2"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"name"},"Name:"),i.createElement("input",{className:"form-control",type:"text",id:"responseCenterName",value:n.responseCenterName,onChange:function(t){e.handleBuildingChange("responseCenterName",t.target.value)}}))),i.createElement("div",{className:"col-md-3"},i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"response_center_email"},"Email:"),i.createElement("input",{className:"form-control",type:"text",id:"responseCenterEmail",value:n.responseCenterEmail,onChange:function(t){e.handleBuildingChange("responseCenterEmail",t.target.value)}}))),i.createElement("div",{className:"col-md-5"},i.createElement("div",{className:"form-group"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-5"},i.createElement("label",{htmlFor:"response_center_phone_no"},"Phone No:"))),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-2"},i.createElement("input",{className:"form-control",placeholder:"Country Code",type:"number",id:"responseCenterCountryCode",value:e.state.responseCenterCountryCode,onChange:function(t){e.handleBuildingChange("responseCenterCountryCode",t.target.value)}})),i.createElement("div",{className:"col-md-3"},i.createElement("input",{className:"form-control",placeholder:"Area Code",type:"number",id:"responseCenterAreaCode",value:e.state.responseCenterAreaCode,onChange:function(t){e.handleBuildingChange("responseCenterAreaCode",t.target.value)}})),i.createElement("div",{className:"col-md-3"},i.createElement("input",{className:"form-control",type:"number",id:"responseCenterPhoneNo1",value:e.state.responseCenterPhoneNo1,onChange:function(t){e.handleBuildingChange("responseCenterPhoneNo1",t.target.value)}})),i.createElement("div",{className:"col-md-4"},i.createElement("input",{className:"form-control",type:"number",id:"responseCenterPhoneNo2",value:e.state.responseCenterPhoneNo2,onChange:function(t){e.handleBuildingChange("responseCenterPhoneNo2",t.target.value)}})))))),(f||n.buildingName)&&i.createElement(h.a,{buildingName:f||n.buildingName,assetOntology:f||n.buildingName,entityType:"Building",showUploader:!0}),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12 inline-block"},i.createElement("button",{disabled:!v,className:"btn btn-primary btn-fill",onClick:function(){t.onChangeBuilding(Object()),e.saveBuilding()}},i.createElement("i",{className:"fa fa-save"})," Save"),i.createElement("button",{className:"btn btn-secondary btn-fill",id:"cancelBuildingEdit",onClick:function(){return window.location.hash=b+"/Buildings"}},i.createElement("i",{className:"fa fa-window-close"})," Cancel"),s&&i.createElement("button",{className:"btn btn-danger active",onClick:function(){e.deleteBuilding(f)}},i.createElement("i",{className:"fa fa-trash"})," Delete"))))),i.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),i.createElement(m.a,{instance:b,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Building?",heading:"Confirm...",onConfirmButtonClick:function(){e.toDeleteBuilding()}}))})},t}(i.Component);t.default=N}});