webpackJsonp([11],{2962:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),l=(n.n(a),n(127)),i=n(1289),r=n(11),s=n(707),o=n(2963),u=n(20),m=n(2964),c=n(2965),d=n(2966),h=n(2967),p=n(2968),g=n(2969),f=n(2970),v=n(2971),x=n(2972),E=n(2973),V=n(1678),w=(n.n(V),n(743)),y=n(2974),b=n(725),L=n(124),H=n(8),A=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),N=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},D=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},P=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),l=0;for(t=0;t<n;t++)for(var i=arguments[t],r=0,s=i.length;r<s;r++,l++)a[l]=i[r];return a},_=function(e){function t(t){var n=e.call(this,t)||this,a=new Date(new Date(Date.now()).setMinutes(new Date(Date.now()).getMinutes()-30)),l=new Date(Date.now());return n.state={from:a,to:l,dashboardURL:"",insights:[],templatesList:[],selectedTemplate:"",loadingDevices:!0,liveGraphRange:30,filteredInsights:[],showInsights:[],selectedTemplateGraphs:{},showAlarmPoints:!1,insightsLoaded:0,verifyList:[],insightPoints:[]},n}return A(t,e),t.prototype.componentDidMount=function(){return N(this,void 0,void 0,function(){var e;return D(this,function(t){switch(t.label){case 0:return e=JSON.parse(H.a.getItem("user")),[4,Object(L.b)(e.contact)];case 1:return t.sent(),[4,this._fetchInsights()];case 2:return t.sent(),[2]}})})},t.prototype.moreInsights=function(){var e=this.state,t=e.showInsights,n=e.filteredInsights.slice(t.length-1,t.length+4),a=P(t,n);this.setState({showInsights:a},function(){window.dispatchEvent(new Event("reLoadGraph"))})},t.prototype.loadNextInsight=function(){var e=this.state,t=e.showInsights,n=e.insightsLoaded;n<t.length&&this.setState({insightsLoaded:n+1})},t.prototype._fetchInsights=function(){return N(this,void 0,void 0,function(){var e,t,n,a,l,o,u=this;return D(this,function(m){switch(m.label){case 0:return e=this.props.buildingName,t=[],n=[],[4,Object(w.o)(e)];case 1:return a=(a=m.sent()).filter(function(e){return"Measure"==e.verifyType}),e?[4,Object(s.w)(e)]:[3,6];case 2:return(l=(l=m.sent()).filter(function(e){var t,n,a,l,i,s,o;return-1!=(null===(t=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===t?void 0:t.toLowerCase().indexOf("thermostat"))||-1!=(null===(n=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===n?void 0:n.toLowerCase().indexOf("ceiling"))||-1!=(null===(a=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===a?void 0:a.toLowerCase().indexOf("intesis"))||-1!=(null===(l=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===l?void 0:l.toLowerCase().indexOf("ats"))||-1!=(null===(i=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("generator"))||"CBW406"==Object(r.g)(null===e||void 0===e?void 0:e.moncontype)||"CBW418"==Object(r.g)(null===e||void 0===e?void 0:e.moncontype)||-1!=(null===(s=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===s?void 0:s.toLowerCase().indexOf("relayv4"))||-1!=(null===(o=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===o?void 0:o.toLowerCase().indexOf("relayi1"))||"WattNode"==Object(r.g)(null===e||void 0===e?void 0:e.moncontype)}))&&l.length?(o=l.map(function(e){return Object(r.g)(e.moncondevice)}),[4,Object(b.k)(e,"Sensed",o)]):[3,4];case 3:n=m.sent(),m.label=4;case 4:return[4,Object(i.b)(e).then(function(e){if(e&&e.length>0)e.map(function(e){t.push({ontology:Object(r.g)(e.ontology),label:Object(r.g)(e.label),deviceGraphs:Object(r.g)(e.deviceGraphs)})}),u.setState({insightPoints:n,templatesList:t,insights:l,selectedTemplate:(t.length-1).toString(),filteredInsights:[],showInsights:[]},function(){var e=JSON.parse(t[t.length-1].deviceGraphs),n=Object.keys(e),i=null===l||void 0===l?void 0:l.filter(function(e){return n.indexOf(Object(r.g)(e.moncondevice))>-1}),s=i.slice(0,10);u.setState({filteredInsights:i,showInsights:s,selectedTemplateGraphs:e,verifyList:a,loadingDevices:!1})});else{var i=null===l||void 0===l?void 0:l.filter(function(e){return e.moncondevice}),s=i.slice(0,10);u.setState({insightPoints:n,insights:l,filteredInsights:i,showInsights:s,verifyList:a,loadingDevices:!1})}})];case 5:m.sent(),m.label=6;case 6:return[2]}})})},t.prototype.changeAlarmStatus=function(){this.setState({showAlarmPoints:!this.state.showAlarmPoints}),window.dispatchEvent(new Event("ShowAlarms"))},t.prototype.liveGraphRangeChange=function(e){var t=this,n=new Date,a=new Date;a.setMinutes(a.getMinutes()-+e),this.setState({from:a,to:n,liveGraphRange:+e,loadingDevices:!0,insightsLoaded:0},function(){t.setState({loadingDevices:!1})})},t.prototype.selectTemplate=function(e){var t=this,n=this.state,a=n.templatesList,l=n.insights,i=n.verifyList;if(isNaN(+e))if("default"==e){var s=l,o=s.slice(0,10);this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0},function(){t.setState({selectedTemplate:e,filteredInsights:s,showInsights:o,loadingDevices:!1})})}else{if(!i.find(function(t){return t._id==e}))return;this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0},function(){t.setState({loadingDevices:!1,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],liveGraphRange:1})})}else this.setState({loadingDevices:!0,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],insightsLoaded:0},function(){var n=JSON.parse(a[+e].deviceGraphs),i=Object.keys(n),s=l.filter(function(e){return i.indexOf(Object(r.g)(e.moncondevice))>-1}),o=s.slice(0,10);t.setState({showInsights:o,filteredInsights:s,loadingDevices:!1,selectedTemplateGraphs:n})})},t.prototype.render=function(){var e,t=this,n=this.state,i=n.verifyList,s=n.from,V=n.to,w=n.showInsights,b=n.filteredInsights,L=n.templatesList,H=n.selectedTemplate,A=n.loadingDevices,N=n.liveGraphRange,D=n.selectedTemplateGraphs,P=n.showAlarmPoints,_=n.insightsLoaded,S=n.insightPoints,O=this.props,j=O.buildingName,k=O.instance;return a.createElement("div",{className:"dashboard"},a.createElement("div",{className:"dashboard-header sticky"},!A&&a.createElement("div",{className:"col-md-4 float-left"},a.createElement("div",{className:"col-md-8 no-padding"},a.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(e){t.selectTemplate(e.target.value)},value:H,placeholder:"Select Template"},0==L.length&&a.createElement("option",{value:""},"Select Template"),a.createElement("option",{value:"default"},"All Graphs"),(null===L||void 0===L?void 0:L.length)>0&&L.map(function(e,t){return a.createElement("option",{value:t,key:t},e.label)}),(null===i||void 0===i?void 0:i.length)>0&&i.map(function(e,t){return a.createElement("option",{value:e._id,key:t},e.projectName)}))),a.createElement(l.b,{target:"_blank",to:"/"+k+"/"+j+"/Dashboard/Templates",className:"btn btn-fill btn-secondary btn-secondary-dark margin-left-20 btn-fix-height"},"Create Template")),a.createElement("h3",{className:"dashboard-title"},Object(u.z)(j)),!A&&a.createElement("div",{className:"col-md-4 float-right margin-top-10"},_===w.length&&!i.find(function(e){return e._id==H})&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-3 padding-5"},a.createElement("label",{style:{color:"#fff",cursor:"default"}},"Show Alarm: \xa0")),a.createElement("div",{className:"padding-5"},a.createElement("label",null,a.createElement("input",{name:"showError",onChange:function(e){t.changeAlarmStatus()},className:"switchDashboard",type:"checkbox",checked:P}),a.createElement("div",null,a.createElement("div",null))))),a.createElement("div",{className:"col-md-5 padding-5 margin-left-20"},a.createElement("label",{style:{color:"#fff",cursor:"default"}},"Graph Range: \xa0")),a.createElement("div",{className:"col-md-6 no-padding"},a.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(e){t.liveGraphRangeChange(e.target.value)},value:N},i.find(function(e){return e._id==H})?a.createElement(a.Fragment,null,a.createElement("option",{value:1},"1 Month"),a.createElement("option",{value:2},"2 Months"),a.createElement("option",{value:3},"3 Months"),a.createElement("option",{value:4},"4 Months"),a.createElement("option",{value:5},"5 Months"),a.createElement("option",{value:6},"6 Months")):a.createElement(a.Fragment,null,a.createElement("option",{value:5},"5 Minutes"),a.createElement("option",{value:15},"15 Minutes"),a.createElement("option",{value:30},"30 Minutes"),a.createElement("option",{value:60},"1 Hour"),a.createElement("option",{value:180},"3 Hours"),a.createElement("option",{value:360},"6 Hours"),a.createElement("option",{value:720},"12 Hours"),a.createElement("option",{value:1440},"24 Hours")))))),A||""!=H||0!=L.length?A?a.createElement("div",{className:"graph-box-loader full-screen"},a.createElement("div",{className:"center-object loader"})):i.find(function(e){return e._id==H})?a.createElement("div",{className:""},a.createElement(y.a,{instance:k,buildingName:j,from:s,to:V,projectName:H,measureAnalysis:i.find(function(e){return e._id==H}).measureAnalysis})):a.createElement(m.a,{dataLength:w.length,className:"graph-boxes",next:function(){return t.moreInsights()},hasMore:w.length<b.length,loader:a.createElement("div",{className:"graph-box-loader full-screen"},a.createElement("div",{className:"center-object loader"}))},null===(e=null===w||void 0===w?void 0:w.slice(0,_+1))||void 0===e?void 0:e.map(function(e,n){for(var l,i,u,m,w,y,b,L=-1!=(null===(l=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===l?void 0:l.toLowerCase().indexOf("thermostat")),H=-1!=(null===(i=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("ceiling")),A=-1!=(null===(u=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===u?void 0:u.toLowerCase().indexOf("intesis")),_=-1!=(null===(m=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===m?void 0:m.toLowerCase().indexOf("ats")),O=-1!=(null===(w=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===w?void 0:w.toLowerCase().indexOf("generator")),q="CBW406"==Object(r.g)(null===e||void 0===e?void 0:e.moncontype),F="CBW418"==Object(r.g)(null===e||void 0===e?void 0:e.moncontype),R=-1!=(null===(y=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===y?void 0:y.toLowerCase().indexOf("relayv4")),C=-1!=(null===(b=Object(r.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===b?void 0:b.toLowerCase().indexOf("relayi1")),G="WattNode"==Object(r.g)(null===e||void 0===e?void 0:e.moncontype),T=Object(r.g)(e.equipmentsRdfsLabel).split(","),I=Object(r.g)(e.relatedEquipmentsLabel).split(","),M=[],U=0;U<T.length;U++){var B=T[U],K=I&&I[U]?I[U]:"";M.push({ontology:B,rdfsLabel:K})}var W=null===S||void 0===S?void 0:S.filter(function(t){return Object(r.g)(t.monconDevice)==Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)});return a.createElement(a.Fragment,null,L&&a.createElement(o.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,equipment:M,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),H&&a.createElement(d.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Temp & Humidity","Pressure","Illuminance","Air Particles","Gas Resistance","Other Parameters"],equipment:M,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),A&&a.createElement(h.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,space:Object(r.g)(e.spaceRdfsLabel),zone:Object(r.g)(e.zoneRdfsLabel),floor:Object(r.g)(e.floorRdfsLabel),equipment:M,index:n,loadNextInsight:function(){return t.loadNextInsight()},device:e}),_&&a.createElement(p.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,equipment:M,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),O&&a.createElement(g.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Voltages","Currents","Powers","Power Factor","Other Parameters","Binary Parameters"],equipment:M,index:n,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),q&&a.createElement(f.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Refrigerator 1","Refrigerator 2"],equipment:M,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),F&&a.createElement(v.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Refrigerator 1","Refrigerator 2"],equipment:M,index:n,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),R&&a.createElement(x.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,equipment:M,index:n,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),C&&a.createElement(c.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Totalized Energy","Frequency and Voltage","Current and Power","State and Power Factor"],equipment:M,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}),G&&a.createElement(E.a,{buildingName:j,instance:k,from:s,to:V,liveGraphRange:N,updateAfterMilliSeconds:15e3,graphsList:D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]?D[Object(r.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Power","Phase Voltage","Voltage","Frequency","Energy Sum Resettable","Positive Energy Sum Non-resettable"],equipment:M,showAlarmPoints:P,index:n,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:W,device:e}))}),0==(null===w||void 0===w?void 0:w.length)&&a.createElement("div",{className:"full-screen"},a.createElement("h1",{className:"no-graph-heading"}," No Graphs "))):a.createElement("div",{className:"full-screen"},a.createElement("h1",{className:"no-graph-heading"}," No Template Created ")))},t}(a.Component);t.default=_},2963:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(11),s=n(707),o=n(802),u=n(20),m=n(803),c=n(122),d=n(736),h=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No data",deviceAlarms:[],alarmSensedPoints:[],graphDataAlarmPoint:{},selectedAlarmPoint:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm:!1,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(r.g)(e)&&Object(h.g)(Object(r.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,s,o,u,h,p,g,f=this;return v(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint,l=this.props,i=l.buildingName,s=l.devicePoints,o=l.showAlarmPoints,u=l.device,Object(c.a)(!0),o&&!e?[3,2]:(h=[],s&&s.length&&s.forEach(function(e){h.push({sensedValue:Object(r.g)(e.sensedValue),maximumExtremeValue:Object(r.g)(e.maximumExtremeValue),maximumNormalValue:Object(r.g)(e.maximumNormalValue),minimumExtremeValue:Object(r.g)(e.minimumExtremeValue),minimumNormalValue:Object(r.g)(e.minimumNormalValue)})}),[4,Object(m.e)(d.a.OperationalAlarm,i,!1,0,50,null,null,[Object(r.g)(u.moncondevice)],null)]);case 1:return p=v.sent(),g=new Date(n.columns[0][1]),p=p.filter(function(e){return new Date(e.timeofalarm)>g}),this.setState({alarmSensedPoints:h,deviceAlarms:p},function(){if((null===h||void 0===h?void 0:h.length)>0&&n.columns.length>1){var e=a.sensedValue.length>1?a.sensedValue:h[h.length-1].sensedValue;f.selectAlarmPoint(e)}}),[3,3];case 2:this.selectAlarmPoint(""),v.label=3;case 3:return Object(c.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{},axes:{}};if(r){if("cooltemp"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"grey",Low:"grey","Cool setpoint":"red",High:"grey","High-High":"grey"}}}else if("heattemp"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},colors:{"Low-Low":"red",Low:"grey","Heat setpoint":"#e3e3e3",High:"grey","High-High":"red"}}}else if("spacetemp"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Space Temp":"#e3e3e3",High:"grey","High-High":"red"},axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"}}}else if("fan"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Fan 0: Auto 1: On":"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","Fan 0: Auto 1: On":"#e3e3e3",High:"grey","High-High":"red"}}}else if("fanstate"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Fan State 1: On":"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","Fan State 1: On":"#e3e3e3",High:"grey","High-High":"red"}}}else if("mode"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{"Mode 0: Heat 1: Cool 2: Auto":"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","Mode 0: Heat 1: Cool 2: Auto":"#e3e3e3",High:"grey","High-High":"red"}}}else if("state"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},axes:{state:"y2","Low-Low":"y2",Low:"y2","High-High":"y2",High:"y2"},colors:{"Low-Low":"red",Low:"grey","State 1: Heat 2: Cool":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint:r,graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})})},t.prototype.callLiveUpdate=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,r,s,o,m,c,d=this;return v(this,function(h){return t=this.state,n=t.graphData,a=t.axis1,l=t.grid,i=t.alarmSensedPoints,r=t.selectedAlarmPoint,s=this.props.showAlarmPoints,e["@timestamp"]&&(o=new Date(e["@timestamp"]),o=new Date(o.setHours(o.getHours()+10))),m=this.props.liveGraphRange,n.columns.length>1&&o&&(n.columns[0].push(o),1==(null===e||void 0===e?void 0:e.tempunits)?(n.columns[1].push(Object(u.a)(null===e||void 0===e?void 0:e.cooltemp).toFixed(1)),n.columns[2].push(Object(u.a)(null===e||void 0===e?void 0:e.heattemp).toFixed(1)),n.columns[3].push(Object(u.a)(null===e||void 0===e?void 0:e.spacetemp).toFixed(1))):(n.columns[1].push(null===e||void 0===e?void 0:e.cooltemp),n.columns[2].push(null===e||void 0===e?void 0:e.heattemp),n.columns[3].push(null===e||void 0===e?void 0:e.spacetemp)),n.columns[4].push(null===e||void 0===e?void 0:e.fan),n.columns[5].push(null===e||void 0===e?void 0:e.fanstate),n.columns[6].push(null===e||void 0===e?void 0:e.mode),n.columns[7].push(null===e||void 0===e?void 0:e.state),(o.getTime()-n.columns[0][2].getTime())/6e4>m&&n.columns[0].splice(1,1),a.x.tick.values[2]&&a.x.tick.values[1].getTime()&&a.x.tick.values[2].getTime()-a.x.tick.values[1].getTime()<o.getTime()-a.x.tick.values[a.x.tick.values.length-1]&&(a.x.tick.values.splice(0,1),l.x.lines.splice(0,1),o.setSeconds(0),m>10&&o.setMinutes(o.getMinutes()-o.getMinutes()%5),a.x.tick.values.push(o),l.x.lines.push({value:o,class:"grid4"})),c=null===o||void 0===o?void 0:o.toLocaleString(),s?this.setState({grid:l,axis1:a,graphData:n,lastUpdatedAt:c},function(){var e=r.sensedValue.length>1?r.sensedValue:i[i.length-1].sensedValue;d.selectAlarmPoint(e)}):this.setState({grid:l,axis1:a,graphData:n,lastUpdatedAt:c})),[2]})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(r.g)(e.sensedValue)==a});!i||!Object(r.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(r.g)(i.relatedEquipment)})||l.push({value:Object(r.g)(i.relatedEquipment),label:Object(r.g)(i.relatedEquipmentLabel),space:Object(r.g)(i.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)i(s);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,m,c,d,p,g,f,x,E,V,w,y,b,L,H,A,N,D,P,_,S=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.from,a=t.to,l=t.device,i=t.showAlarmPoints,m=this.state,c=m.grid,d=m.axis1,p=m.graphData,g=m.lastUpdatedAt,l&&l.moncondevice?(f=Object(r.g)(l.topic),[4,Object(s.I)(f,n,a,p.columns.length>1)]):[3,2];case 1:x=v.sent(),V=["Heat setpoint"],w=["Space Temp"],y=["Fan 0: Auto 1: On"],b=["Fan State 1: On"],L=["Mode 0: Heat 1: Cool 2: Auto"],H=["State 1: Heat 2: Cool"],A=["x"],(E=["Cool setpoint"]).push(null),V.push(null),w.push(null),y.push(null),b.push(null),L.push(null),H.push(null),A.push(new Date(n)),x.length>0&&(null===x||void 0===x||x.forEach(function(e){(null===e||void 0===e?void 0:e.cooltemp)&&(1==e.tempunits?(E.push(Object(u.a)(e.cooltemp).toFixed(1)),V.push(Object(u.a)(e.heattemp).toFixed(1)),w.push(Object(u.a)(e.spacetemp).toFixed(1))):(E.push(e.cooltemp),V.push(e.heattemp),w.push(e.spacetemp)),y.push(e.fan),b.push(e.fanstate),L.push(e.mode),H.push(e.state),A.push(new Date(e.timestamp)))})),g=x.length>0?null===(e=A[A.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",(p.columns.length>1||0===x.length)&&(E.push(null),V.push(null),w.push(null),y.push(null),b.push(null),L.push(null),H.push(null),A.push(new Date(a))),d.y.label="\xb0C",N=Object(o.a)(5,n,a),D="",N.length>1?(P=((new Date).getTime()-N[0].getTime())/1e3,D=(P/=3600)>24?"%m-%d %H:%M":P<.3?"%H:%M:%S":"%H:%M"):D="%H:%M:%S",c.x.lines=[],N.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),(_=[]).push(this.fetchEquipmentFromPoints("thermostat",["cooltemp","heattemp","spacetemp","fan","fanstate","mode","state"])),p={x:"x",columns:[A,E,V,w,y,b,L,H],axes:{"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},colors:{"Cool setpoint":"yellow","Heat setpoint":"green","Space Temp":"blue","Fan 0: Auto 1: On":"pink","Fan State 1: On":"yellow","Mode 0: Heat 1: Cool 2: Auto":"magenta","State 1: Heat 2: Cool":"#06cfa4"},types:{"Cool setpoint":"line","Heat setpoint":"line","Space Temp":"line","Fan 0: Auto 1: On":"step","Fan State 1: On":"step","Mode 0: Heat 1: Cool 2: Auto":"step","State 1: Heat 2: Cool":"step"}},d={x:{type:"timeseries",tick:{fit:!1,count:5,values:N,format:D}},y:{label:{text:"Temperature \xb0F",position:"outer-middle"},tick:{fit:!0,values:[0,20,40,60,80,100],count:6,format:function(e){return parseFloat(e).toFixed(1)}},max:100,min:0},y2:{show:!0,label:{text:"State, Mode, Fan, Fan State",position:"outer-middle"},tick:{fit:!0,values:[0,1,2,3],count:6,format:function(e){return parseFloat(e).toFixed(0)}},max:3,min:0}},this.props.loadNextInsight(),Object(h.h)(f,this.callLiveUpdate),this.setState({grid:c,axis1:d,graphData:p,loading:!1,lastUpdatedAt:g,graphEquipment:_},function(){i&&S.changeAlarmStatus(!0)}),v.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t=this,n=this.state,l=n.loading,s=n.graphData,o=n.axis1,u=n.grid,m=n.lastUpdatedAt,c=n.alarmSensedPoints,d=n.selectedAlarmPoint,h=n.graphDataAlarmPoint,p=n.indicateAlarm,g=n.graphEquipment,f=this.props,v=f.instance,x=f.buildingName,E=f.device,V=f.showAlarmPoints,w=f.equipment;return a.createElement("div",{className:"row col-md-12 device-graphs "+(p&&V?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),V&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",c&&c.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:d.sensedValue,onChange:function(e){t.selectAlarmPoint(e.target.value)}},c.map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),p&&a.createElement("a",{href:"#"+v+"/"+x+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(E.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+v+"/"+x+"/Insights/Equipment/Graphs/InsightControl/"+Object(r.g)(E.moncondevice),target:"_blank",rel:"noreferrer noopener"},g&&g.length&&g.find(function(e){return"thermostat"==e.graph})?g.find(function(e){return"thermostat"==e.graph}).pointEquip.length&&g.find(function(e){return"thermostat"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Space: ",Object(r.g)(E.spaceRdfsLabel)),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",g&&g.length&&g.find(function(e){return"thermostat"==e.graph})?g.find(function(e){return"thermostat"==e.graph}).pointEquip.length&&g.find(function(e){return"thermostat"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",g&&g.length&&g.find(function(e){return"thermostat"==e.graph})?g.find(function(e){return"thermostat"==e.graph}).pointEquip.length&&g.find(function(e){return"thermostat"==e.graph}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(E.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(E.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",w.map(function(e,t){return e.rdfsLabel+(t<w.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(E.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(E.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",m)),l?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:V&&(null===(e=h.columns)||void 0===e?void 0:e.length)>1?h:s,size:{height:300},axis:o,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}}))},t}(a.Component);t.a=x},2964:function(e,t,n){"use strict";var a=n(2),l=n.n(a),i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var r=function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)};var s={Pixel:"Pixel",Percent:"Percent"},o={unit:s.Percent,value:.8};function u(e){return"number"===typeof e?{unit:s.Percent,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:s.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:s.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),o):(console.warn("scrollThreshold should be string or number"),o)}var m=function(e){function t(t){var n=e.call(this,t)||this;return n.lastScrollTop=0,n.actionTriggered=!1,n.startY=0,n.currentY=0,n.dragging=!1,n.maxPullDownDistance=0,n.getScrollableTarget=function(){return n.props.scrollableTarget instanceof HTMLElement?n.props.scrollableTarget:"string"===typeof n.props.scrollableTarget?document.getElementById(n.props.scrollableTarget):(null===n.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},n.onStart=function(e){n.lastScrollTop||(n.dragging=!0,e instanceof MouseEvent?n.startY=e.pageY:e instanceof TouchEvent&&(n.startY=e.touches[0].pageY),n.currentY=n.startY,n._infScroll&&(n._infScroll.style.willChange="transform",n._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},n.onMove=function(e){n.dragging&&(e instanceof MouseEvent?n.currentY=e.pageY:e instanceof TouchEvent&&(n.currentY=e.touches[0].pageY),n.currentY<n.startY||(n.currentY-n.startY>=Number(n.props.pullDownToRefreshThreshold)&&n.setState({pullToRefreshThresholdBreached:!0}),n.currentY-n.startY>1.5*n.maxPullDownDistance||n._infScroll&&(n._infScroll.style.overflow="visible",n._infScroll.style.transform="translate3d(0px, "+(n.currentY-n.startY)+"px, 0px)")))},n.onEnd=function(){n.startY=0,n.currentY=0,n.dragging=!1,n.state.pullToRefreshThresholdBreached&&(n.props.refreshFunction&&n.props.refreshFunction(),n.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){n._infScroll&&(n._infScroll.style.overflow="auto",n._infScroll.style.transform="none",n._infScroll.style.willChange="unset")})},n.onScrollListener=function(e){"function"===typeof n.props.onScroll&&setTimeout(function(){return n.props.onScroll&&n.props.onScroll(e)},0);var t=n.props.height||n._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;n.actionTriggered||((n.props.inverse?n.isElementAtTop(t,n.props.scrollThreshold):n.isElementAtBottom(t,n.props.scrollThreshold))&&n.props.hasMore&&(n.actionTriggered=!0,n.setState({showLoader:!0}),n.props.next&&n.props.next()),n.lastScrollTop=t.scrollTop)},n.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},n.throttledOnScrollListener=function(e,t,n,a){var l,i=!1,r=0;function s(){l&&clearTimeout(l)}function o(){var o=this,u=Date.now()-r,m=arguments;function c(){r=Date.now(),n.apply(o,m)}i||(a&&!l&&c(),s(),void 0===a&&u>e?c():!0!==t&&(l=setTimeout(a?function(){l=void 0}:c,void 0===a?e-u:e)))}return"boolean"!==typeof t&&(a=n,n=t,t=void 0),o.cancel=function(){s(),i=!0},o}(150,n.onScrollListener).bind(n),n.onStart=n.onStart.bind(n),n.onMove=n.onMove.bind(n),n.onEnd=n.onEnd.bind(n),n}return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?r(r({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,a=u(t);return a.unit===s.Pixel?e.scrollTop<=a.value+n-e.scrollHeight+1:e.scrollTop<=a.value/100+n-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,a=u(t);return a.unit===s.Pixel?e.scrollTop+n>=e.scrollHeight-a.value:e.scrollTop+n>=a.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=r({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),n=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),a=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return l.a.createElement("div",{style:a,className:"infinite-scroll-component__outerdiv"},l.a.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&l.a.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},l.a.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!n&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(a.Component);t.a=m},2965:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(11),s=n(707),o=n(802),u=n(803),m=n(122),c=n(736),d=n(124),h=n(760),p=(n.n(h),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e=this;return f(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(r.g)(e)&&Object(d.g)(Object(r.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return g(this,void 0,void 0,function(){var t,n,a,l,i,s,o,d,h,p,g,v,x,E,V=this;return f(this,function(f){switch(f.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,s=t.selectedAlarmPoint4,o=this.props,d=o.buildingName,h=o.devicePoints,p=o.showAlarmPoints,g=o.device,Object(m.a)(!0),p&&!e?[3,2]:(v=[],h&&h.length&&h.forEach(function(e){v.push({sensedValue:Object(r.g)(e.sensedValue),maximumExtremeValue:Object(r.g)(e.maximumExtremeValue),maximumNormalValue:Object(r.g)(e.maximumNormalValue),minimumExtremeValue:Object(r.g)(e.minimumExtremeValue),minimumNormalValue:Object(r.g)(e.minimumNormalValue)})}),[4,Object(u.e)(c.a.OperationalAlarm,d,!1,0,50,null,null,[Object(r.g)(g.moncondevice)],null)]);case 1:return x=f.sent(),E=new Date(n.columns[0][1]),x=x.filter(function(e){return new Date(e.timeofalarm)>E}),this.setState({alarmSensedPoints:v,deviceAlarms:x},function(){if((null===v||void 0===v?void 0:v.length)>0&&n.columns.length>1){var e=v.filter(function(e){return"import_active_energy_Wh"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";V.selectAlarmPoint1(t);var r=v.filter(function(e){return"frequency_Hz"==e.sensedValue||"voltage_volts"==e.sensedValue}),o=l.sensedValue.length>1?l.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";V.selectAlarmPoint2(o);var u=v.filter(function(e){return"active_power_Watts"==e.sensedValue||"current_Amperes"==e.sensedValue}),m=i.sensedValue.length>1?i.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";V.selectAlarmPoint3(m);var c=v.filter(function(e){return"relay_state"==e.sensedValue||"power_factor"==e.sensedValue}),d=s.sensedValue.length>1?s.sensedValue:(null===c||void 0===c?void 0:c.length)>0?c[c.length-1].sensedValue:"";V.selectAlarmPoint4(d)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),f.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){return g(this,void 0,void 0,function(){var t,n,a,l,i,r,s=this;return f(this,function(o){return t=this.state,n=t.graphData,a=t.alarmSensedPoints,l=t.deviceAlarms,i=a.find(function(t){return t.sensedValue===e}),r=l.length>0&&l.findIndex(function(e){return"import_active_energy_Wh"==e.sensedValueKey})>-1,this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(i){if("import_active_energy_Wh"==i.sensedValue){for(var t=["Low-Low"],a=["Low"],l=["High"],o=["High-High"],u=0;u<n.columns[1].length-1;u++)t.push(+i.minimumExtremeValue/1e3),a.push(+i.minimumNormalValue/1e3),l.push(+i.maximumNormalValue/1e3),o.push(+i.maximumExtremeValue/1e3);e={x:"x",columns:[n.columns[0],t,a,n.columns[1],l,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Killo Watt Hour":"#e3e3e3",High:"grey","High-High":"red"}}}else e=n;s.setState({selectedAlarmPoint1:i,graphDataAlarmPoint1:e,indicateAlarm1:r,loading:!1})}else e=n,s.setState({selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm1:r,graphDataAlarmPoint1:e,loading:!1})}),[2]})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"frequency_Hz"==e.sensedValueKey||"voltage_volts"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("frequency_Hz"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Freq:"#e3e3e3",High:"grey","High-High":"red"}}}else if("voltage_volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Volts:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint2:r,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"active_power_Watts"==e.sensedValueKey||"current_Amperes"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("active_power_Watts"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Watts:"#e3e3e3",High:"grey","High-High":"red"}}}else if("current_Amperes"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Amps:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint3:r,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"relay_state"==e.sensedValueKey||"power_factor"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("relay_state"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",State:"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_factor"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Factor":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint4:r,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,r=a.graphData3,s=a.graphData4,o=a.axis1,u=a.grid,m=a.alarmSensedPoints,c=a.selectedAlarmPoint1,d=a.selectedAlarmPoint2,h=a.selectedAlarmPoint3,p=a.selectedAlarmPoint4,g=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var f=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(+(null===e||void 0===e?void 0:e.import_active_energy_Wh)/1e3),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.frequency_Hz),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.voltage_volts),r.columns[1].splice(1,1),r.columns[1].push(null===e||void 0===e?void 0:e.active_power_Watts),r.columns[2].splice(1,1),r.columns[2].push(null===e||void 0===e?void 0:e.current_Amperes),s.columns[1].splice(1,1),s.columns[1].push(null===e||void 0===e?void 0:e.i1relay_state),s.columns[2].splice(1,1),s.columns[2].push(null===e||void 0===e?void 0:e.power_factor),o.x.tick.values[0]<l.columns[0][1]&&(o.x.tick.values.splice(0,1),u.x.lines.splice(0,1)),(t.getTime()-l.columns[0][2].getTime())/6e4>f&&l.columns[0].splice(1,1),o.x.tick.values[2]&&o.x.tick.values[1].getTime()&&o.x.tick.values[2].getTime()-o.x.tick.values[1].getTime()<t.getTime()-o.x.tick.values[o.x.tick.values.length-1]&&(o.x.tick.values.splice(0,1),u.x.lines.splice(0,1),t.setSeconds(0),f>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),o.x.tick.values.push(t),u.x.lines.push({value:t,class:"grid4"}));var v=null===t||void 0===t?void 0:t.toLocaleString();g?this.setState({grid:u,axis1:o,graphData:l,graphData2:i,graphData3:r,graphData4:s,lastUpdatedAt:v},function(){var e=m.filter(function(e){return"import_active_energy_Wh"==e.sensedValue}),t=c.sensedValue.length>1?c.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=m.filter(function(e){return"frequency_Hz"==e.sensedValue||"voltage_volts"==e.sensedValue}),l=d.sensedValue.length>1?d.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=m.filter(function(e){return"active_power_Watts"==e.sensedValue||"current_Amperes"==e.sensedValue}),r=h.sensedValue.length>1?h.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(r);var s=m.filter(function(e){return"relay_state"==e.sensedValue||"power_factor"==e.sensedValue}),o=p.sensedValue.length>1?p.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(o)}):this.setState({grid:u,axis1:o,graphData:l,graphData2:i,graphData3:r,graphData4:s,lastUpdatedAt:v})}},t.prototype.liveGraph=function(){var e,t,n,a,l,i,o,u,m;return g(this,void 0,void 0,function(){var c,d,h,p,g,v,x,E,V,w,y,b,L,H,A,N;return f(this,function(f){switch(f.label){case 0:return c=this.state,d=c.graphData,h=c.graphData2,p=c.graphData3,g=c.graphData4,v=c.axis1,x=c.grid,E=c.lastUpdatedAt,V=this.props,w=V.device,y=V.liveGraphRange,b=new Date,L=new Date,H=Object(r.g)(w.topic),L.setMinutes(L.getMinutes()-y),[4,Object(s.g)(H,L,b,!0)];case 1:return A=f.sent(),(N=new Date(null===(e=A[0])||void 0===e?void 0:e.timestamp))>d.columns[0][d.columns[0].length-1]&&(null===(t=A[0])||void 0===t?void 0:t.timestamp)&&(d.columns[0].splice(1,1),d.columns[0].push(N),d.columns[1].splice(1,1),d.columns[1].push(+(null===(n=A[0])||void 0===n?void 0:n.import_active_energy_Wh)/1e3),h.columns[1].splice(1,1),h.columns[1].push(null===(a=A[0])||void 0===a?void 0:a.frequency_Hz),h.columns[2].splice(1,1),h.columns[2].push(null===(l=A[0])||void 0===l?void 0:l.voltage_volts),p.columns[1].splice(1,1),p.columns[1].push(null===(i=A[0])||void 0===i?void 0:i.active_power_Watts),p.columns[2].splice(1,1),p.columns[2].push(null===(o=A[0])||void 0===o?void 0:o.current_Amperes),g.columns[1].splice(1,1),g.columns[1].push(null===(u=A[0])||void 0===u?void 0:u.i1relay_state),g.columns[2].splice(1,1),g.columns[2].push(null===(m=A[0])||void 0===m?void 0:m.power_factor),v.x.tick.values[0]<d.columns[0][1]&&(v.x.tick.values.splice(0,1),x.x.lines.splice(0,1)),(N.getTime()-d.columns[0][2].getTime())/6e4>y&&d.columns[0].splice(1,1),v.x.tick.values[0]<d.columns[0][1]&&(v.x.tick.values.splice(0,1),x.x.lines.splice(0,1)),v.x.tick.values[2]&&v.x.tick.values[1].getTime()&&v.x.tick.values[2].getTime()-v.x.tick.values[1].getTime()<N.getTime()-v.x.tick.values[v.x.tick.values.length-1]&&(N.setSeconds(0),y>10&&N.setMinutes(N.getMinutes()-N.getMinutes()%5),v.x.tick.values.push(N),x.x.lines.push({value:N,class:"grid4"})),E=null===N||void 0===N?void 0:N.toLocaleString(),this.setState({grid:x,axis1:v,graphData:d,graphData2:h,graphData3:p,graphData4:g,lastUpdatedAt:E})),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(r.g)(e.sensedValue)==a});!i||!Object(r.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(r.g)(i.relatedEquipment)})||l.push({value:Object(r.g)(i.relatedEquipment),label:Object(r.g)(i.relatedEquipmentLabel),space:Object(r.g)(i.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)i(s);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return g(this,void 0,void 0,function(){var t,n,a,l,i,u,m,c,h,p,g,v,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R=this;return f(this,function(f){switch(f.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,m=this.state,c=m.grid,h=m.axis1,p=m.axis2,g=m.axis3,v=m.axis4,x=m.graphData,E=m.graphData2,V=m.graphData3,w=m.graphData4,y=m.lastUpdatedAt,n&&n.moncondevice?(b=Object(r.g)(n.topic),[4,Object(s.g)(b,a,l,x.columns.length>1)]):[3,2];case 1:L=f.sent(),A=["Watts"],N=["Amps"],D=["Freq"],P=["Killo Watt Hour"],_=["Power Factor"],S=["Volts"],O=["x"],(H=["State"]).push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(new Date(a)),L.length>0&&L.forEach(function(e){(null===e||void 0===e?void 0:e.i1relay_state)&&(H.push(e.i1relay_state),A.push(e.active_power_Watts),N.push(e.current_Amperes),D.push(e.frequency_Hz),P.push(+e.import_active_energy_Wh/1e3),_.push(e.power_factor),S.push(e.voltage_volts),O.push(new Date(e.timestamp)))}),y=L.length>0?null===(e=O[O.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(new Date(l)),j=[],u&&u.length&&(j.push(this.fetchEquipmentFromPoints(u[0]||"Totalized Energy",["import_active_energy_Wh"])),j.push(this.fetchEquipmentFromPoints(u[1]||"Frequency and Voltage",["frequency_Hz","voltage_volts"])),j.push(this.fetchEquipmentFromPoints(u[2]||"Current and Power",["active_power_Watts","current_Amperes"])),j.push(this.fetchEquipmentFromPoints(u[3]||"State and Power Factor",["relay_state","power_factor"]))),x={x:"x",columns:[O,P]},E={x:"x",columns:[O,D,S]},V={x:"x",columns:[O,A,N]},w={x:"x",columns:[O,H,_]},h.y.label="kWh",p.y.label="Hz/Volts",g.y.label="Watts/Amps",v.y.label="",k=Object(o.a)(5,a,l),q="",k.length>1?(F=((new Date).getTime()-k[0].getTime())/1e3,q=(F/=3600)>24?"%m-%d %H:%M":F<.3?"%H:%M:%S":"%H:%M"):q="%H:%M:%S",c.x.lines=[],k.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(0)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(1)},v.y.tick.format=function(e){return parseFloat(e).toFixed(2)},h.y.tick.values=[0,10,20,30,40,50],p.y.tick.values=[0,50,100,150,200],g.y.tick.values=[0,20,40,60,80,100],v.y.tick.values=[-1,0,1,2],h.y.max=50,h.y.min=0,p.y.max=200,p.y.min=0,g.y.max=100,g.y.min=0,v.y.max=2,v.y.min=-1,h.x.tick.format=q,p.x.tick.format=q,g.x.tick.format=q,v.x.tick.format=q,h.x.tick.values=k,p.x.tick.values=k,g.x.tick.values=k,v.x.tick.values=k,this.props.loadNextInsight(),Object(d.h)(b,this.callLiveUpdate),this.setState({grid:c,axis1:h,axis2:p,axis3:g,axis4:v,graphData:x,graphData2:E,graphData3:V,graphData4:w,loading:!1,lastUpdatedAt:y,graphEquipment:j},function(){i&&R.changeAlarmStatus(!0)}),f.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n,l,s=this,o=this.state,u=o.loading,m=o.graphData,c=o.graphData2,d=o.graphData3,h=o.graphData4,p=o.graphDataAlarmPoint1,g=o.graphDataAlarmPoint2,f=o.graphDataAlarmPoint3,v=o.graphDataAlarmPoint4,x=o.axis1,E=o.axis2,V=o.axis3,w=o.axis4,y=o.grid,b=o.lastUpdatedAt,L=o.indicateAlarm1,H=o.indicateAlarm2,A=o.indicateAlarm3,N=o.indicateAlarm4,D=o.alarmSensedPoints,P=o.selectedAlarmPoint1,_=o.selectedAlarmPoint2,S=o.selectedAlarmPoint3,O=o.selectedAlarmPoint4,j=o.graphEquipment,k=this.props,q=k.graphsList,F=k.instance,R=k.buildingName,C=k.device,G=k.showAlarmPoints,T=k.equipment,I=q&&q.length&&q[0]?q[0]:"Totalized Energy",M=q&&q.length&&q[1]?q[1]:"Frequency and Voltage",U=q&&q.length&&q[2]?q[2]:"Current and Power",B=q&&q.length&&q[3]?q[3]:"State and Power Factor";return a.createElement(a.Fragment,null,q.indexOf("Totalized Energy")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(L&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",D&&D.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:P.sensedValue,onChange:function(e){s.selectAlarmPoint1(e.target.value)}},D.filter(function(e){return"import_active_energy_Wh"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),L&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==I})?j.find(function(e){return e.graph==I}).pointEquip.length&&j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Totalized Energy"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==I})?j.find(function(e){return e.graph==I}).pointEquip.length&&j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==I})?j.find(function(e){return e.graph==I}).pointEquip.length&&j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",b)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:G&&(null===(e=p.columns)||void 0===e?void 0:e.length)>1?p:m,size:{height:300},axis:x,grid:y,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),q.indexOf("Frequency and Voltage")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(H&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",D&&D.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:_.sensedValue,onChange:function(e){s.selectAlarmPoint2(e.target.value)}},D.filter(function(e){return"frequency_Hz"==e.sensedValue||"voltage_volts"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),H&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==M})?j.find(function(e){return e.graph==M}).pointEquip.length&&j.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Freq & Volts"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==M})?j.find(function(e){return e.graph==M}).pointEquip.length&&j.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==M})?j.find(function(e){return e.graph==M}).pointEquip.length&&j.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",b)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:G&&(null===(t=g.columns)||void 0===t?void 0:t.length)>1?g:c,size:{height:300},axis:E,grid:y,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Current and Power")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(A&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",a.createElement("select",{className:"alarm-points-list",id:"spaces",value:S.sensedValue,onChange:function(e){s.selectAlarmPoint3(e.target.value)}},D.filter(function(e){return"active_power_Watts"==e.sensedValue||"current_Amperes"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})),A&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==U})?j.find(function(e){return e.graph==U}).pointEquip.length&&j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Current and Power"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==U})?j.find(function(e){return e.graph==U}).pointEquip.length&&j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==U})?j.find(function(e){return e.graph==U}).pointEquip.length&&j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",b)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:G&&(null===(n=f.columns)||void 0===n?void 0:n.length)>1?f:d,size:{height:300},axis:V,grid:y,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("State and Power Factor")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(N&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",D&&D.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:O.sensedValue,onChange:function(e){s.selectAlarmPoint4(e.target.value)}},D.filter(function(e){return"relay_state"==e.sensedValue||"power_factor"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),N&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/RelayControl/"+Object(r.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==B})?j.find(function(e){return e.graph==B}).pointEquip.length&&j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-4 sentence-break"}," ","State and Power Factor"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==B})?j.find(function(e){return e.graph==B}).pointEquip.length&&j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==B})?j.find(function(e){return e.graph==B}).pointEquip.length&&j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(r.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(r.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(r.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(r.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",b)),u?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:G&&(null===(l=v.columns)||void 0===l?void 0:l.length)>1?v:h,size:{height:300},axis:w,grid:y,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=v},2966:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(707),s=n(1007),o=n(802),u=n(11),m=n(803),c=n(736),d=n(122),h=n(124),p=n(760),g=(n.n(p),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},x=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},graphData5:{x:"x",columns:[]},graphData6:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis5:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis6:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,indicateAlarm5:!1,indicateAlarm6:!1,alarmSensedPoints:[],graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},graphDataAlarmPoint5:{},graphDataAlarmPoint6:{},selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint5:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint6:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(u.g)(e)&&Object(h.g)(Object(u.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return f(this,void 0,void 0,function(){var t,n,a,l,i,r,s,o,h,p,g,f,x,E,V,w,y=this;return v(this,function(v){switch(v.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,r=t.selectedAlarmPoint4,s=t.selectedAlarmPoint5,o=t.selectedAlarmPoint6,h=this.props,p=h.buildingName,g=h.devicePoints,f=h.showAlarmPoints,x=h.device,Object(d.a)(!0),f&&!e?[3,2]:(E=[],g&&g.length&&g.forEach(function(e){E.push({sensedValue:Object(u.g)(e.sensedValue),maximumExtremeValue:Object(u.g)(e.maximumExtremeValue),maximumNormalValue:Object(u.g)(e.maximumNormalValue),minimumExtremeValue:Object(u.g)(e.minimumExtremeValue),minimumNormalValue:Object(u.g)(e.minimumNormalValue)})}),[4,Object(m.e)(c.a.OperationalAlarm,p,!1,0,50,null,null,[Object(u.g)(x.moncondevice)],null)]);case 1:return V=v.sent(),n.columns.length>1&&(w=new Date(n.columns[0][1]),V=V.filter(function(e){return new Date(e.timeofalarm)>w})),this.setState({alarmSensedPoints:E,deviceAlarms:V},function(){if((null===E||void 0===E?void 0:E.length)>0&&n.columns.length>1){var e=E.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";y.selectAlarmPoint1(t);var u=E.filter(function(e){return"pressure_hPa"==e.sensedValue}),m=l.sensedValue.length>1?l.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";y.selectAlarmPoint2(m);var c=E.filter(function(e){return"illuminance_lux"==e.sensedValue}),d=i.sensedValue.length>1?i.sensedValue:(null===c||void 0===c?void 0:c.length)>0?c[c.length-1].sensedValue:"";y.selectAlarmPoint3(d);var h=E.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}),p=r.sensedValue.length>1?r.sensedValue:(null===h||void 0===h?void 0:h.length)>0?h[h.length-1].sensedValue:"";y.selectAlarmPoint4(p);var g=E.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}),f=s.sensedValue.length>1?s.sensedValue:(null===g||void 0===g?void 0:g.length)>0?g[g.length-1].sensedValue:"";y.selectAlarmPoint5(f);var v=E.filter(function(e){return"motion_sensed"==e.sensedValue||"num_BTdev"==e.sensedValue}),x=o.sensedValue.length>1?o.sensedValue:(null===v||void 0===v?void 0:v.length)>0?v[v.length-1].sensedValue:"";y.selectAlarmPoint6(x)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),this.selectAlarmPoint5(""),this.selectAlarmPoint6(""),v.label=3;case 3:return Object(d.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"relhumidity_pct"==e.sensedValueKey||"temp_celsius"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("temp_celsius"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[0].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Temp:"#e3e3e3",High:"grey","High-High":"red"}}}else if("relhumidity_pct"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[0].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Humidity:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint1:r,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"pressure_hPa"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("pressure_hPa"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Pressure:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint2:r,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"illuminance_lux"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("illuminance_lux"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Illuminance:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint3:r,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"gasResistance_kOhm"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("gasResistance_kOhm"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gas Res":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint4:r,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.selectAlarmPoint5=function(e){var t=this,n=this.state,a=n.graphData5,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"equiCO2_ppm"==e.sensedValueKey||"tvoc_ppm"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("equiCO2_ppm"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",CO2:"#e3e3e3",High:"grey","High-High":"red"}}}else if("tvoc_ppm"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",TVOC:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint5:r,graphDataAlarmPoint5:e,indicateAlarm5:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint5:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm5:s,graphDataAlarmPoint5:e,loading:!1})})},t.prototype.selectAlarmPoint6=function(e){var t=this,n=this.state,a=n.graphData6,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"motion_sensed"==e.sensedValueKey||"num_BTdev"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("motion_sensed"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Motion:"#e3e3e3",High:"grey","High-High":"red"}}}else if("tvoc_ppm"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Blth Dev.":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint6:r,graphDataAlarmPoint6:e,indicateAlarm6:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint6:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm6:s,graphDataAlarmPoint6:e,loading:!1})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(u.g)(e.sensedValue)==a});!i||!Object(u.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(u.g)(i.relatedEquipment)})||l.push({value:Object(u.g)(i.relatedEquipment),label:Object(u.g)(i.relatedEquipmentLabel),space:Object(u.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return f(this,void 0,void 0,function(){var t,n,a,l,i,m,c,d,p,g,f,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R,C,G,T,I,M,U,B,K,W,z=this;return v(this,function(v){switch(v.label){case 0:return t=this.props,n=t.from,a=t.to,l=t.device,i=t.showAlarmPoints,m=t.graphsList,c=this.state,d=c.grid,p=c.axis1,g=c.axis2,f=c.axis3,x=c.axis4,E=c.axis5,V=c.axis6,w=c.graphData,y=c.graphData2,b=c.graphData3,L=c.graphData4,H=c.graphData5,A=c.graphData6,N=c.lastUpdatedAt,l&&l.moncondevice?(D=Object(u.g)(l.topic),P=Object(u.g)(l.firmwareVersion),_=Object(u.g)(l.csbCallibration)?parseInt(Object(u.g)(l.csbCallibration)):0,[4,Object(r.d)(D,n,a,w.columns.length>1)]):[3,2];case 1:S=v.sent(),j=["Humidity"],k=["Alt."],q=["CO2"],F=["TVOC"],R=["Gas Res"],C=["Illuminance"],G=["Motion"],T=["Blth Dev."],I=["Pressure"],M=["x"],(O=["Temp"]).push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(null),T.push(null),I.push(null),M.push(new Date(n)),S.length>0&&S.forEach(function(e){e&&(O.push(Object(s.a)(e.temp_celsius,P||"",_)),j.push(e.relhumidity_pct),k.push(e.altitude_m),q.push(e.equiCO2_ppm),F.push(e.tvoc_ppm),I.push(e.pressure_hPa),R.push(e.gasResistance_kOhm),C.push(e.illuminance_lux),G.push(e.motion_sensed),T.push(e.num_BTdev),M.push(new Date(e.timestamp)))}),N=S.length>0?null===(e=M[M.length-1])||void 0===e?void 0:e.toLocaleString():"No data",0===S.length&&(O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(null),T.push(null),I.push(null),M.push(new Date(a))),p.y.label="\xb0F / %",g.y.label="hPa",f.y.label="Lux",x.y.label="kOhm",E.y.label="PPM",V.y.label="",M.length>1&&(U=Object(o.a)(5,n,a),B="",U.length>1?(K=((new Date).getTime()-U[0].getTime())/1e3,B=(K/=3600)>24?"%m-%d %H:%M":K<.3?"%H:%M:%S":"%H:%M"):B="%H:%M:%S",d.x.lines=[],U.forEach(function(e){d.x.lines.push({value:e,class:"grid4"})}),p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(0)},f.y.tick.format=function(e){return parseFloat(e).toFixed(0)},x.y.tick.format=function(e){return parseFloat(e).toFixed(0)},E.y.tick.format=function(e){return parseFloat(e).toFixed(0)},V.y.tick.format=function(e){return parseFloat(e).toFixed(0)},p.y.tick.values=[0,20,40,60,80,100],g.y.tick.values=[0,400,800,1200],f.y.tick.values=[0,40,80,120,160,200,240],x.y.tick.values=[0,600,1200,1800,2400,3e3],E.y.tick.values=[0,4e3,8e3,12e3,16e3],V.y.tick.values=[0,10,20,30,40,50],p.y.max=100,p.y.min=0,g.y.max=1100,g.y.min=0,f.y.max=200,f.y.min=0,x.y.max=3e3,x.y.min=0,E.y.max=16e3,E.y.min=0,V.y.max=50,V.y.min=0,p.x.tick.format=B,g.x.tick.format=B,f.x.tick.format=B,x.x.tick.format=B,E.x.tick.format=B,V.x.tick.format=B,p.x.tick.values=U,g.x.tick.values=U,f.x.tick.values=U,x.x.tick.values=U,E.x.tick.values=U,V.x.tick.values=U,W=[],m&&m.length&&(W.push(this.fetchEquipmentFromPoints(m[0]||"Temp & Humidity",["temp_celsius","relhumidity_pct"])),W.push(this.fetchEquipmentFromPoints(m[1]||"Pressure",["pressure_hPa"])),W.push(this.fetchEquipmentFromPoints(m[2]||"Illuminance",["illuminance_lux"])),W.push(this.fetchEquipmentFromPoints(m[3]||"Gas Resistance",["gasResistance_kOhm"])),W.push(this.fetchEquipmentFromPoints(m[4]||"Air Particles",["equiCO2_ppm","tvoc_ppm"])),W.push(this.fetchEquipmentFromPoints(m[5]||"Other Parameters",["motion_sensed","num_BTdev"]))),w={x:"x",columns:[M,O,j]},y={x:"x",columns:[M,I]},b={x:"x",columns:[M,C]},L={x:"x",columns:[M,R]},H={x:"x",columns:[M,q,F]},A={x:"x",columns:[M,G,T]},this.props.loadNextInsight(),Object(h.h)(D,this.callLiveUpdate),this.setState({grid:d,axis1:p,axis2:g,axis3:f,axis4:x,axis5:E,axis6:V,graphData:w,graphData2:y,graphData3:b,graphData4:L,graphData5:H,graphData6:A,lastUpdatedAt:N,loading:!1,graphEquipment:W},function(){i&&z.changeAlarmStatus(!0)})),v.label=2;case 2:return[2]}})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,r=a.graphData3,o=a.graphData4,m=a.graphData5,c=a.graphData6,d=a.axis1,h=a.grid,p=a.alarmSensedPoints,g=a.selectedAlarmPoint1,f=a.selectedAlarmPoint2,v=a.selectedAlarmPoint3,x=a.selectedAlarmPoint4,E=a.selectedAlarmPoint5,V=a.selectedAlarmPoint6,w=this.props,y=w.device,b=w.showAlarmPoints,L=Object(u.g)(y.firmwareVersion),H=Object(u.g)(y.csbCallibration)?parseInt(Object(u.g)(y.csbCallibration)):0;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var A=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].push(t),l.columns[1].push(Object(s.a)(null===e||void 0===e?void 0:e.temp_celsius,L||"",H)),l.columns[2].push(null===e||void 0===e?void 0:e.relhumidity_pct),i.columns[1].push(null===e||void 0===e?void 0:e.pressure_hPa),r.columns[1].push(null===e||void 0===e?void 0:e.illuminance_lux),o.columns[1].push(null===e||void 0===e?void 0:e.gasResistance_kOhm),m.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.equiCO2_ppm)),m.columns[2].push(parseFloat(null===e||void 0===e?void 0:e.tvoc_ppm)),c.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.motion_sensed)),c.columns[2].push(parseFloat(null===e||void 0===e?void 0:e.num_BTdev)),(t.getTime()-l.columns[0][2].getTime())/6e4>A&&l.columns[0].splice(1,1),d.x.tick.values[2]&&d.x.tick.values[1].getTime()&&d.x.tick.values[2].getTime()-d.x.tick.values[1].getTime()<t.getTime()-d.x.tick.values[d.x.tick.values.length-1]&&(d.x.tick.values.splice(0,1),h.x.lines.splice(0,1),t.setSeconds(0),A>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),d.x.tick.values.push(t),h.x.lines.push({value:t,class:"grid4"}));var N=null===t||void 0===t?void 0:t.toLocaleString();b?this.setState({grid:h,axis1:d,graphData:l,graphData2:i,graphData3:r,graphData4:o,graphData5:m,graphData6:c,lastUpdatedAt:N},function(){var e=p.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=g.sensedValue.length>1?g.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=p.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=f.sensedValue.length>1?f.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=p.filter(function(e){return"illuminance_lux"==e.sensedValue}),r=v.sensedValue.length>1?v.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(r);var s=p.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}),o=x.sensedValue.length>1?x.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(o);var u=p.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}),m=E.sensedValue.length>1?E.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";n.selectAlarmPoint5(m);var c=p.filter(function(e){return"motion_sensed"==e.sensedValue||"num_BTdev"==e.sensedValue}),d=V.sensedValue.length>1?V.sensedValue:(null===c||void 0===c?void 0:c.length)>0?c[c.length-1].sensedValue:"";n.selectAlarmPoint6(d)}):this.setState({grid:h,axis1:d,graphData:l,graphData2:i,graphData3:r,graphData4:o,graphData5:m,graphData6:c,lastUpdatedAt:N})}},t.prototype.render=function(){var e,t,n,l,r,s,o=this,m=this.state,c=m.loading,d=m.graphData,h=m.graphData2,p=m.graphData3,g=m.graphData4,f=m.graphData5,v=m.graphData6,x=m.axis1,E=m.axis2,V=m.axis3,w=m.axis4,y=m.axis5,b=m.axis6,L=m.grid,H=m.lastUpdatedAt,A=m.graphDataAlarmPoint1,N=m.graphDataAlarmPoint2,D=m.graphDataAlarmPoint3,P=m.graphDataAlarmPoint4,_=m.graphDataAlarmPoint5,S=m.graphDataAlarmPoint6,O=m.indicateAlarm1,j=m.indicateAlarm2,k=m.indicateAlarm3,q=m.indicateAlarm4,F=m.indicateAlarm5,R=m.indicateAlarm6,C=m.alarmSensedPoints,G=m.selectedAlarmPoint1,T=m.selectedAlarmPoint2,I=m.selectedAlarmPoint3,M=m.selectedAlarmPoint4,U=m.selectedAlarmPoint5,B=m.selectedAlarmPoint6,K=m.graphEquipment,W=this.props,z=W.instance,Z=W.buildingName,Y=W.graphsList,$=W.device,J=W.showAlarmPoints,Q=W.equipment,X=Y&&Y.length&&Y[0]?Y[0]:"Temp & Humidity",ee=Y&&Y.length&&Y[1]?Y[1]:"Pressure",te=Y&&Y.length&&Y[2]?Y[1]:"Illuminance",ne=Y&&Y.length&&Y[3]?Y[1]:"Gas Resistance",ae=Y&&Y.length&&Y[4]?Y[1]:"Air Particles",le=Y&&Y.length&&Y[5]?Y[1]:"Other Parameters";return a.createElement(a.Fragment,null,Y.indexOf("Temp & Humidity")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(O&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:G.sensedValue,onChange:function(e){o.selectAlarmPoint1(e.target.value)}},C.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),O&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==X})?K.find(function(e){return e.graph==X}).pointEquip.length&&K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Temp & Humidity"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==X})?K.find(function(e){return e.graph==X}).pointEquip.length&&K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==X})?K.find(function(e){return e.graph==X}).pointEquip.length&&K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(u.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(u.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(u.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(u.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(e=A.columns)||void 0===e?void 0:e.length)>1?A:d,size:{height:300},axis:x,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),Y.indexOf("Pressure")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(j&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:T.sensedValue,onChange:function(e){o.selectAlarmPoint2(e.target.value)}},C.filter(function(e){return"pressure_hPa"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),j&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ee})?K.find(function(e){return e.graph==ee}).pointEquip.length&&K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," "," Pressure"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ee})?K.find(function(e){return e.graph==ee}).pointEquip.length&&K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ee})?K.find(function(e){return e.graph==ee}).pointEquip.length&&K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(u.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(u.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(u.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(u.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(t=N.columns)||void 0===t?void 0:t.length)>1?N:h,size:{height:300},axis:E,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Illuminance")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(k&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:I.sensedValue,onChange:function(e){o.selectAlarmPoint3(e.target.value)}},C.filter(function(e){return"illuminance_lux"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),k&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==te})?K.find(function(e){return e.graph==te}).pointEquip.length&&K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Illuminance"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==te})?K.find(function(e){return e.graph==te}).pointEquip.length&&K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==te})?K.find(function(e){return e.graph==te}).pointEquip.length&&K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(u.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(u.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(u.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(u.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(n=D.columns)||void 0===n?void 0:n.length)>1?D:p,size:{height:300},axis:V,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Gas Resistance")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(q&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:M.sensedValue,onChange:function(e){o.selectAlarmPoint4(e.target.value)}},C.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),q&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ne})?K.find(function(e){return e.graph==ne}).pointEquip.length&&K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Gas Resistance"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ne})?K.find(function(e){return e.graph==ne}).pointEquip.length&&K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ne})?K.find(function(e){return e.graph==ne}).pointEquip.length&&K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(u.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(u.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(u.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(u.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(l=P.columns)||void 0===l?void 0:l.length)>1?P:g,size:{height:300},axis:w,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Air Particles")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(F&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:U.sensedValue,onChange:function(e){o.selectAlarmPoint5(e.target.value)}},C.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),F&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ae})?K.find(function(e){return e.graph==ae}).pointEquip.length&&K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Air Particles"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ae})?K.find(function(e){return e.graph==ae}).pointEquip.length&&K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ae})?K.find(function(e){return e.graph==ae}).pointEquip.length&&K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(u.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(u.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(u.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(u.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(r=_.columns)||void 0===r?void 0:r.length)>1?_:f,size:{height:300},axis:y,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),Y.indexOf("Other Parameters")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(R&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:B.sensedValue,onChange:function(e){o.selectAlarmPoint6(e.target.value)}},C.filter(function(e){return"num_BTdev"==e.sensedValue||"motion_sensed"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),R&&a.createElement("a",{href:"#"+z+"/"+Z+"/Alarms/OperationalAlarms/Device/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+z+"/"+Z+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(u.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==le})?K.find(function(e){return e.graph==le}).pointEquip.length&&K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Other Parameters"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==le})?K.find(function(e){return e.graph==le}).pointEquip.length&&K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==le})?K.find(function(e){return e.graph==le}).pointEquip.length&&K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(u.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(u.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(u.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(u.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(s=S.columns)||void 0===s?void 0:s.length)>1?S:v,size:{height:300},axis:b,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=x},2967:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(707),s=n(802),o=n(124),u=n(760),m=(n.n(u),n(11)),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),d=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data"},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e=this;return h(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return d(this,void 0,void 0,function(){var e,t=this;return h(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(m.g)(e)&&Object(o.g)(Object(m.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(){},t.prototype.callLiveUpdate=function(e){var t,n=this.state,a=n.graphData,l=n.axis1,i=n.grid;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var r=this.props.liveGraphRange;if(a.columns.length>1&&t){a.columns[0].splice(1,1),a.columns[0].push(t),a.columns[1].splice(1,1),a.columns[1].push(null===e||void 0===e?void 0:e.setpoint),a.columns[2].splice(1,1),a.columns[2].push(null===e||void 0===e?void 0:e.roomtemp),a.columns[3].splice(1,1),a.columns[3].push(null===e||void 0===e?void 0:e.fanspeed),a.columns[4].splice(1,1),a.columns[4].push(null===e||void 0===e?void 0:e.horizontalvans),a.columns[5].splice(1,1),a.columns[5].push(null===e||void 0===e?void 0:e.usermode),a.columns[6].splice(1,1),a.columns[6].push(null===e||void 0===e?void 0:e.verticalvans),a.columns[7].splice(1,1),a.columns[7].push(null===e||void 0===e?void 0:e.wifiSignal),(t.getTime()-a.columns[0][2].getTime())/6e4>r&&a.columns[0].splice(1,1),l.x.tick.values[2]&&l.x.tick.values[1].getTime()&&l.x.tick.values[2].getTime()-l.x.tick.values[1].getTime()<t.getTime()-l.x.tick.values[l.x.tick.values.length-1]&&(l.x.tick.values.splice(0,1),i.x.lines.splice(0,1),t.setSeconds(0),r>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),l.x.tick.values.push(t),i.x.lines.push({value:t,class:"grid4"}));var s=null===t||void 0===t?void 0:t.toLocaleString();this.setState({grid:i,axis1:l,graphData:a,lastUpdatedAt:s})}},t.prototype._fetchData=function(){var e;return d(this,void 0,void 0,function(){var t,n,a,l,i,u,c,d,p,g,f,v,x,E,V,w,y,b,L,H,A,N;return h(this,function(h){switch(h.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=this.state,u=i.grid,c=i.axis1,d=i.graphData,p=i.lastUpdatedAt,n&&n.moncondevice?(g=Object(m.g)(n.topic),[4,Object(r.e)(g,a,l,d.columns.length>1)]):[3,2];case 1:f=h.sent(),v=["setpoint"],E=["mode"],V=["fanspeed"],w=["horizontalvans"],y=["verticalvans"],b=["wifiSignal"],L=["x"],(x=["roomtemp"]).push(null),v.push(null),V.push(null),w.push(null),E.push(null),y.push(null),b.push(null),L.push(new Date(a)),f.length>0&&f.forEach(function(e){e&&(1!=isNaN(e.roomtemp)&&x.push(e.roomtemp),1!=isNaN(e.setpoint)&&v.push(e.setpoint),e.fanspeed?V.push(e.fanspeed):V.push("undefined"),e.horizontalvans?w.push(e.horizontalvans):w.push("undefined"),e.usermode?E.push(e.usermode):E.push("undefined"),e.verticalvans?y.push(e.verticalvans):y.push("undefined"),e.wifiSignal?b.push(e.wifiSignal):b.push("undefined"),L.push(new Date(e.timestamp)))}),p=f.length>0?null===(e=L[L.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",x.push(null),v.push(null),V.push(null),w.push(null),E.push(null),y.push(null),b.push(null),L.push(new Date(l)),d={x:"x",columns:[L,v,x,V,w,E,y,b]},c.y.label="\xb0F",H=Object(s.a)(5,a,l),A="",H.length>1?(N=((new Date).getTime()-H[0].getTime())/1e3,A=(N/=3600)>24?"%m-%d %H:%M":N<.3?"%H:%M:%S":"%H:%M"):A="%H:%M:%S",u.x.lines=[],H.forEach(function(e){u.x.lines.push({value:e,class:"grid4"})}),c.y.tick.format=function(e){return parseFloat(e).toFixed(2)},c.y.tick.values=[0,20,40,60,80,100],c.y.max=100,c.y.min=0,c.x.tick.format=A,c.x.tick.values=H,this.props.loadNextInsight(),Object(o.h)(g,this.callLiveUpdate),this.setState({grid:u,axis1:c,graphData:d,loading:!1,lastUpdatedAt:p}),h.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,n=e.graphData,l=e.axis1,r=e.grid,s=e.lastUpdatedAt,o=this.props,u=o.instance,c=o.buildingName,d=o.device,h=o.equipment;return a.createElement("div",{className:"row col-md-12 device-graphs",id:"divGraphs"},a.createElement("br",null),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-8 sentence-break",onClick:function(){window.location.hash=u+"/"+c+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(m.g)(d.moncondevice)}},h.length>0&&h[0].rdfsLabel?h[0].rdfsLabel:"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Space: ",Object(m.g)(d.spaceRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(m.g)(d.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(m.g)(d.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Equipment: ",null===h||void 0===h?void 0:h.map(function(e,t){return e.rdfsLabel+(t<h.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(m.g)(d.rdfsLabel)||"No device assigned"," ")),a.createElement("span",{className:"lastUpdated"},"Last: ",s)),t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:n,size:{height:300},axis:l,grid:r,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}}))},t}(a.Component);t.a=p},2968:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(715),s=n(802),o=n(124),u=n(760),m=(n.n(u),n(11)),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),d=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",graphEquipment:Object()},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e=this;return h(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return d(this,void 0,void 0,function(){var e,t=this;return h(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(m.g)(e)&&Object(o.g)(Object(m.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(){},t.prototype.callLiveUpdate=function(e){var t,n=this.state,a=n.graphData,l=n.axis1,i=n.grid;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var r=this.props.liveGraphRange;if(a.columns.length>1&&t){a.columns[0].splice(1,1),a.columns[0].push(t),a.columns[1].splice(1,1),a.columns[1].push(null===e||void 0===e?void 0:e.Normal_Frequency),a.columns[2].splice(1,1),a.columns[2].push(null===e||void 0===e?void 0:e.Emergency_Frequency),(t.getTime()-a.columns[0][2].getTime())/6e4>r&&a.columns[0].splice(1,1),l.x.tick.values[2]&&l.x.tick.values[1].getTime()&&l.x.tick.values[2].getTime()-l.x.tick.values[1].getTime()<t.getTime()-l.x.tick.values[l.x.tick.values.length-1]&&(l.x.tick.values.splice(0,1),i.x.lines.splice(0,1),t.setSeconds(0),r>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),l.x.tick.values.push(t),i.x.lines.push({value:t,class:"grid4"}));var s=null===t||void 0===t?void 0:t.toLocaleString();this.setState({grid:i,axis1:l,graphData:a,lastUpdatedAt:s})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(m.g)(e.sensedValue)==a});!i||!Object(m.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(m.g)(i.relatedEquipment)})||l.push({value:Object(m.g)(i.relatedEquipment),label:Object(m.g)(i.relatedEquipmentLabel),space:Object(m.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return d(this,void 0,void 0,function(){var t,n,a,l,i,u,c,d,p,g,f,v,x,E,V,w,y,b;return h(this,function(h){switch(h.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=this.state,u=i.grid,c=i.axis1,d=i.graphData,p=i.lastUpdatedAt,n&&n.moncondevice?(g=Object(m.g)(n.topic),[4,Object(r.j)(g,a,l,d.columns.length>1)]):[3,2];case 1:f=h.sent(),x=["Emergency Freq"],E=["x"],(v=["Normal Freq"]).push(null),x.push(null),E.push(new Date(a)),f.length>0&&f.forEach(function(e){e&&(v.push(e.Normal_Frequency),x.push(e.Emergency_Frequency),E.push(new Date(e.timestamp)))}),p=f.length>0?null===(e=E[E.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",v.push(null),x.push(null),E.push(new Date(l)),d={x:"x",xFormat:"%Y-%m-%dT%H:%M:%S.%LZ",columns:[E,v,x]},c.y.label="Hz",(V=[]).push(this.fetchEquipmentFromPoints("ATS graph",["Normal_Frequency","Emergency_Frequency"])),w=Object(s.a)(5,a,l),y="",w.length>1?(b=((new Date).getTime()-w[0].getTime())/1e3,y=(b/=3600)>24?"%m-%d %H:%M":b<.3?"%H:%M:%S":"%H:%M"):y="%H:%M:%S",u.x.lines=[],w.forEach(function(e){u.x.lines.push({value:e,class:"grid4"})}),c.y.tick.format=function(e){return parseFloat(e).toFixed(2)},c.y.tick.values=[0,20,40,60,80],c.y.max=80,c.y.min=0,c.x.tick.format=y,c.x.tick.values=w,this.props.loadNextInsight(),Object(o.h)(g,this.callLiveUpdate),this.setState({grid:u,axis1:c,graphData:d,loading:!1,lastUpdatedAt:p,graphEquipment:V}),h.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,n=e.graphData,l=e.axis1,r=e.grid,s=e.lastUpdatedAt,o=e.graphEquipment,u=this.props,c=u.instance,d=u.buildingName,h=u.device,p=u.equipment;return a.createElement(a.Fragment,null,a.createElement("div",{className:"row col-md-12 device-graphs",id:"divGraphs"},a.createElement("br",null),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard"},a.createElement("a",{className:"col-md-5 sentence-break",onClick:function(){window.location.hash=c+"/"+d+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(m.g)(h.moncondevice)}},o&&o.length&&o.find(function(e){return"ATS graph"==e.graph})?o.find(function(e){return"ATS graph"==e.graph}).pointEquip.length&&o.find(function(e){return"ATS graph"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"},"Space: ",Object(m.g)(h.spaceRdfsLabel)),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",o&&o.length&&o.find(function(e){return"ATS graph"==e.graph})?o.find(function(e){return"ATS graph"==e.graph}).pointEquip.length&&o.find(function(e){return"ATS graph"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",o&&o.length&&o.find(function(e){return"ATS graph"==e.graph})?o.find(function(e){return"ATS graph"==e.graph}).pointEquip.length&&o.find(function(e){return"ATS graph"==e.graph}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(m.g)(h.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(m.g)(h.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===p||void 0===p?void 0:p.map(function(e,t){return e.rdfsLabel+(t<p.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(m.g)(h.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(m.g)(h.spaceRdfsLabel)," ")),a.createElement("span",{className:"lastUpdated"},"Last: ",s)),t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:n,size:{height:300},axis:l,grid:r,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})))},t}(a.Component);t.a=p},2969:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(715),s=n(802),o=n(11),u=n(803),m=n(122),c=n(736),d=n(124),h=n(760),p=(n.n(h),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},graphData5:{x:"x",columns:[]},graphData6:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis5:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis6:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,indicateAlarm5:!1,indicateAlarm6:!1,alarmSensedPoints:[],graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},graphDataAlarmPoint5:{},graphDataAlarmPoint6:{},selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint5:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint6:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e=this;return f(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(o.g)(e)&&Object(d.g)(Object(o.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return g(this,void 0,void 0,function(){var t,n,a,l,i,r,s,d,h,p,g,v,x,E,V,w,y=this;return f(this,function(f){switch(f.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,r=t.selectedAlarmPoint4,s=t.selectedAlarmPoint5,d=t.selectedAlarmPoint6,h=this.props,p=h.buildingName,g=h.devicePoints,v=h.showAlarmPoints,x=h.device,Object(m.a)(!0),v&&!e?[3,2]:(E=[],g&&g.length&&g.forEach(function(e){E.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue)})}),[4,Object(u.e)(c.a.OperationalAlarm,p,!1,0,50,null,null,[Object(o.g)(x.moncondevice)],null)]);case 1:return V=f.sent(),w=new Date(n.columns[0][1]),V=V.filter(function(e){return new Date(e.timeofalarm)>w}),this.setState({alarmSensedPoints:E,deviceAlarms:V},function(){if((null===E||void 0===E?void 0:E.length)>0&&n.columns.length>1){var e=E.filter(function(e){return"GenVAB_Volts"==e.sensedValue||"GenVBC_Volts"==e.sensedValue||"GenVCA_Volts"==e.sensedValue||"GenVAN_Volts"==e.sensedValue||"GenVBN_Volts"==e.sensedValue||"GenVCN_Volts"==e.sensedValue||" BusVoltage_Volts"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";y.selectAlarmPoint1(t);var o=E.filter(function(e){return"GenIA_Amps"==e.sensedValue||"GenIB_Amps"==e.sensedValue||"GenIC_Amps"==e.sensedValue}),u=l.sensedValue.length>1?l.sensedValue:(null===o||void 0===o?void 0:o.length)>0?o[o.length-1].sensedValue:"";y.selectAlarmPoint2(u);var m=E.filter(function(e){return"GenKVA_A_KiloVA"==e.sensedValue||"GenKVA__B_KiloVA"==e.sensedValue||"GenKVA_C_KiloVA"==e.sensedValue||"GenKVA_Total_KiloVA"==e.sensedValue||"Gen_A_kW"==e.sensedValue||"Gen_B_kW"==e.sensedValue||"Gen_C_kW"==e.sensedValue||"Gen_Total_kW"==e.sensedValue}),c=i.sensedValue.length>1?i.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";y.selectAlarmPoint3(c);var h=E.filter(function(e){return"GenPFLagging"==e.sensedValue}),p=r.sensedValue.length>1?r.sensedValue:(null===h||void 0===h?void 0:h.length)>0?h[h.length-1].sensedValue:"";y.selectAlarmPoint4(p);var g=E.filter(function(e){return"ActiveSpeedSource"==e.sensedValue||"EngineSpeed_rpm"==e.sensedValue||"EngineLoad_pct"==e.sensedValue||"CoolantTemp_F"==e.sensedValue||"OilPressure_psi"==e.sensedValue||"BatteryVoltage_DeciVolt"==e.sensedValue||"FuelLevel"==e.sensedValue||"ECUCoolantLevel"==e.sensedValue||"CoolDownTimeRemaining_mins"==e.sensedValue}),f=s.sensedValue.length>1?s.sensedValue:(null===g||void 0===g?void 0:g.length)>0?g[g.length-1].sensedValue:"";y.selectAlarmPoint5(f);var v=E.filter(function(e){return"UnexpectedShutdown"==e.sensedValue||"GlobalAlarm"==e.sensedValue||"AutoRestartFailure"==e.sensedValue||"FuelLeakDetect"==e.sensedValue||"BatteryChargerFailure"==e.sensedValue||"TransferFail"==e.sensedValue||"LowCoolantLevel"==e.sensedValue||"ECUShutdown"==e.sensedValue||"EmergencyShutdown"==e.sensedValue||"Overcrank"==e.sensedValue||"LossofECUComms"==e.sensedValue||"GlobalSenderFail"==e.sensedValue||"LowFuelLevel"==e.sensedValue||"LowOilPressure"==e.sensedValue||"HighCoolantTemp"==e.sensedValue}),x=d.sensedValue.length>1?d.sensedValue:(null===v||void 0===v?void 0:v.length)>0?v[v.length-1].sensedValue:"";y.selectAlarmPoint6(x)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),this.selectAlarmPoint5(""),this.selectAlarmPoint6(""),f.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenVAB_Volts"==e.sensedValueKey||"GenVBC_Volts"==e.sensedValueKey||"GenVCA_Volts"==e.sensedValueKey||"GenVAN_Volts"==e.sensedValueKey||"GenVBN_Volts"==e.sensedValueKey||"GenVCN_Volts"==e.sensedValueKey||" BusVoltage_Volts"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("GenVAB_Volts"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VAB:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVBC_Volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VBC:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVCA_Volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VCA:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVAN_Volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VA:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVBN_Volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VB:"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenVCN_Volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",VC:"#e3e3e3",High:"grey","High-High":"red"}}}else if("BusVoltage_Volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Bus Voltage":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint1:r,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenIA_Amps"==e.sensedValueKey||"GenIB_Amps"==e.sensedValueKey||"GenIC_Amps"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("GenIA_Amps"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen IA":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenIB_Amps"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen IB":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenIC_Amps"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen IC":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint2:r,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenKVA_A_KiloVA"==e.sensedValueKey||"GenKVA__B_KiloVA"==e.sensedValueKey||"GenKVA_C_KiloVA"==e.sensedValueKey||"GenKVA_Total_KiloVA"==e.sensedValueKey||"Gen_A_kW"==e.sensedValueKey||"Gen_B_kW"==e.sensedValueKey||"Gen_C_kW"==e.sensedValueKey||"Gen_Total_kW"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("GenKVA_A_KiloVA"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenKVA__B_KiloVA"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenKVA_C_KiloVA"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GenKVA_Total_KiloVA"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kVA Tota":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_A_kW"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_B_kW"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_C_kW"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Gen_Total_kW"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltC"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[8].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen kW Total":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint3:r,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"GenPFLagging"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("GenPFLagging"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Gen Power Factor":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint4:r,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.selectAlarmPoint5=function(e){var t=this,n=this.state,a=n.graphData5,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"ActiveSpeedSource"==e.sensedValueKey||"EngineSpeed_rpm"==e.sensedValueKey||"EngineLoad_pct"==e.sensedValueKey||"CoolantTemp_F"==e.sensedValueKey||"OilPressure_psi"==e.sensedValueKey||"BatteryVoltage_DeciVolt"==e.sensedValueKey||"FuelLevel"==e.sensedValueKey||"ECUCoolantLevel"==e.sensedValueKey||"CoolDownTimeRemaining_mins"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("ActiveSpeedSource"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Act speed":"#e3e3e3",High:"grey","High-High":"red"}}}else if("EngineSpeed_rpm"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Engine Speed":"#e3e3e3",High:"grey","High-High":"red"}}}else if("EngineLoad_pct"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Engine Load":"#e3e3e3",High:"grey","High-High":"red"}}}else if("CoolantTemp_F"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Coolant Temp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("OilPressure_psi"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Oil Press":"#e3e3e3",High:"grey","High-High":"red"}}}else if("BatteryVoltage_DeciVolt"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Battery Volt":"#e3e3e3",High:"grey","High-High":"red"}}}else if("FuelLevel"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Fuel Level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("ECUCoolantLevel"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[8].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","ECU Coolant level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("CoolDownTimeRemaining_mins"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[9].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[9],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Cool Down Time Rem.":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint5:r,graphDataAlarmPoint5:e,indicateAlarm5:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint5:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm5:s,graphDataAlarmPoint5:e,loading:!1})})},t.prototype.selectAlarmPoint6=function(e){var t=this,n=this.state,a=n.graphData6,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"UnexpectedShutdown"==e.sensedValueKey||"GlobalAlarm"==e.sensedValueKey||"AutoRestartFailure"==e.sensedValueKey||"FuelLeakDetect"==e.sensedValueKey||"BatteryChargerFailure"==e.sensedValueKey||"TransferFail"==e.sensedValueKey||"LowCoolantLevel"==e.sensedValueKey||"ECUShutdown"==e.sensedValueKey||"EmergencyShutdown"==e.sensedValueKey||"Overcrank"==e.sensedValueKey||"LossofECUComms"==e.sensedValueKey||"GlobalSenderFail"==e.sensedValueKey||"LowFuelLevel"==e.sensedValueKey||"LowOilPressure"==e.sensedValueKey||"HighCoolantTemp"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("UnexpectedShutdown"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Unexp. Shutdown":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GlobalAlarm"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Global Alarm":"#e3e3e3",High:"grey","High-High":"red"}}}else if("AutoRestartFailure"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Auto Restart Fail":"#e3e3e3",High:"grey","High-High":"red"}}}else if("FuelLeakDetect"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Fuel Leak Det.":"#e3e3e3",High:"grey","High-High":"red"}}}else if("BatteryChargerFailure"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Battery Chg. Fail":"#e3e3e3",High:"grey","High-High":"red"}}}else if("TransferFail"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Transfer Fai":"#e3e3e3",High:"grey","High-High":"red"}}}else if("LowCoolantLevel"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Low Coolant level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("ECUShutdown"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[8].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","ECU Shutdown":"#e3e3e3",High:"grey","High-High":"red"}}}else if("EmergencyShutdown"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[9].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[9],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Emerg. Shut":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Overcrank"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[10].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[10],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Overcrank:"#e3e3e3",High:"grey","High-High":"red"}}}else if("LossofECUComms"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[11].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[11],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Loss of ECU Comms":"#e3e3e3",High:"grey","High-High":"red"}}}else if("GlobalSenderFail"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[12].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[12],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Global Sender Fail":"#e3e3e3",High:"grey","High-High":"red"}}}else if("LowFuelLevel"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[13].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[13],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Low Fuel Level":"#e3e3e3",High:"grey","High-High":"red"}}}else if("LowOilPressure"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[14].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[14],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Low Oil Press":"#e3e3e3",High:"grey","High-High":"red"}}}else if("HighCoolantTemp"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[15].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[15],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","High Coolant":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint6:r,graphDataAlarmPoint6:e,indicateAlarm6:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint6:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm6:s,graphDataAlarmPoint6:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,r=a.graphData3,s=a.graphData4,o=a.graphData5,u=a.graphData6,m=a.axis1,c=a.grid,d=a.alarmSensedPoints,h=a.selectedAlarmPoint1,p=a.selectedAlarmPoint2,g=a.selectedAlarmPoint3,f=a.selectedAlarmPoint4,v=a.selectedAlarmPoint5,x=a.selectedAlarmPoint6,E=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var V=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.GenVAB_Volts),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.GenVBC_Volts),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.GenVCA_Volts),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.GenVAN_Volts),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.GenVBN_Volts),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.GenVCN_Volts),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.BusVoltage_Volts),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.GenIA_Amps),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.GenIB_Amps),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.GenIC_Amps),r.columns[1].splice(1,1),r.columns[1].push(null===e||void 0===e?void 0:e.GenKVA_A_KiloVA),r.columns[2].splice(1,1),r.columns[2].push(null===e||void 0===e?void 0:e.GenKVA__B_KiloVA),r.columns[3].splice(1,1),r.columns[3].push(null===e||void 0===e?void 0:e.GenKVA_C_KiloVA),r.columns[4].splice(1,1),r.columns[4].push(null===e||void 0===e?void 0:e.GenKVA_Total_KiloVA),r.columns[5].splice(1,1),r.columns[5].push(null===e||void 0===e?void 0:e.Gen_A_kW),r.columns[6].splice(1,1),r.columns[6].push(null===e||void 0===e?void 0:e.Gen_B_kW),r.columns[7].splice(1,1),r.columns[7].push(null===e||void 0===e?void 0:e.Gen_C_kW),r.columns[8].splice(1,1),r.columns[8].push(null===e||void 0===e?void 0:e.Gen_Total_kW),s.columns[1].splice(1,1),s.columns[1].push(null===e||void 0===e?void 0:e.GenPFLagging),o.columns[1].splice(1,1),o.columns[1].push(null===e||void 0===e?void 0:e.ActiveSpeedSource),o.columns[2].splice(1,1),o.columns[2].push(null===e||void 0===e?void 0:e.EngineSpeed_rpm),o.columns[3].splice(1,1),o.columns[3].push(null===e||void 0===e?void 0:e.EngineLoad_pct),o.columns[4].splice(1,1),o.columns[4].push(null===e||void 0===e?void 0:e.CoolantTemp_F),o.columns[5].splice(1,1),o.columns[5].push(null===e||void 0===e?void 0:e.OilPressure_psi),o.columns[6].splice(1,1),o.columns[6].push(null===e||void 0===e?void 0:e.BatteryVoltage_DeciVolt),o.columns[7].splice(1,1),o.columns[7].push(null===e||void 0===e?void 0:e.FuelLevel),o.columns[8].splice(1,1),o.columns[8].push(null===e||void 0===e?void 0:e.ECUCoolantLevel),o.columns[9].splice(1,1),o.columns[9].push(null===e||void 0===e?void 0:e.CoolDownTimeRemaining_mins),u.columns[1].splice(1,1),u.columns[1].push(null===e||void 0===e?void 0:e.UnexpectedShutdown),u.columns[2].splice(1,1),u.columns[2].push(null===e||void 0===e?void 0:e.GlobalAlarm),u.columns[3].splice(1,1),u.columns[3].push(null===e||void 0===e?void 0:e.AutoRestartFailure),u.columns[4].splice(1,1),u.columns[4].push(null===e||void 0===e?void 0:e.FuelLeakDetect),u.columns[5].splice(1,1),u.columns[5].push(null===e||void 0===e?void 0:e.BatteryChargerFailure),u.columns[6].splice(1,1),u.columns[6].push(null===e||void 0===e?void 0:e.TransferFail),u.columns[7].splice(1,1),u.columns[7].push(null===e||void 0===e?void 0:e.LowCoolantLevel),u.columns[8].splice(1,1),u.columns[8].push(null===e||void 0===e?void 0:e.ECUShutdown),u.columns[9].splice(1,1),u.columns[9].push(null===e||void 0===e?void 0:e.EmergencyShutdown),u.columns[10].splice(1,1),u.columns[10].push(null===e||void 0===e?void 0:e.Overcrank),u.columns[11].splice(1,1),u.columns[11].push(null===e||void 0===e?void 0:e.LossofECUComms),u.columns[12].splice(1,1),u.columns[12].push(null===e||void 0===e?void 0:e.GlobalSenderFail),u.columns[13].splice(1,1),u.columns[13].push(null===e||void 0===e?void 0:e.LowFuelLevel),u.columns[14].splice(1,1),u.columns[14].push(null===e||void 0===e?void 0:e.LowOilPressure),u.columns[15].splice(1,1),u.columns[15].push(null===e||void 0===e?void 0:e.HighCoolantTemp),(t.getTime()-l.columns[0][2].getTime())/6e4>V&&l.columns[0].splice(1,1),m.x.tick.values[2]&&m.x.tick.values[1].getTime()&&m.x.tick.values[2].getTime()-m.x.tick.values[1].getTime()<t.getTime()-m.x.tick.values[m.x.tick.values.length-1]&&(m.x.tick.values.splice(0,1),c.x.lines.splice(0,1),t.setSeconds(0),V>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),m.x.tick.values.push(t),c.x.lines.push({value:t,class:"grid4"}));var w=null===t||void 0===t?void 0:t.toLocaleString();E?this.setState({grid:c,axis1:m,graphData:l,graphData2:i,graphData3:r,graphData4:s,graphData5:o,graphData6:u,lastUpdatedAt:w},function(){var e=d.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=h.sensedValue.length>1?h.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=d.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=p.sensedValue.length>1?p.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=d.filter(function(e){return"illuminance_lux"==e.sensedValue}),r=g.sensedValue.length>1?g.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(r);var s=d.filter(function(e){return"gasResistance_kOhm"==e.sensedValue}),o=f.sensedValue.length>1?f.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(o);var u=d.filter(function(e){return"equiCO2_ppm"==e.sensedValue||"tvoc_ppm"==e.sensedValue}),m=v.sensedValue.length>1?v.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";n.selectAlarmPoint5(m);var c=d.filter(function(e){return"motion_sensed"==e.sensedValue||"num_BTdev"==e.sensedValue}),E=x.sensedValue.length>1?x.sensedValue:(null===c||void 0===c?void 0:c.length)>0?c[c.length-1].sensedValue:"";n.selectAlarmPoint6(E)}):this.setState({grid:c,axis1:m,graphData:l,graphData2:i,graphData3:r,graphData4:s,graphData5:o,graphData6:u,lastUpdatedAt:w})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(o.g)(e.sensedValue)==a});!i||!Object(o.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(o.g)(i.relatedEquipment)})||l.push({value:Object(o.g)(i.relatedEquipment),label:Object(o.g)(i.relatedEquipmentLabel),space:Object(o.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return g(this,void 0,void 0,function(){var t,n,a,l,i,u,m,c,h,p,g,v,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R,C,G,T,I,M,U,B,K,W,z,Z,Y,$,J,Q,X,ee,te,ne,ae,le,ie,re,se,oe,ue,me,ce,de,he,pe,ge,fe,ve,xe,Ee,Ve,we,ye,be=this;return f(this,function(f){switch(f.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,m=this.state,c=m.grid,h=m.axis1,p=m.axis2,g=m.axis3,v=m.axis4,x=m.axis5,E=m.axis6,V=m.graphData,w=m.graphData2,y=m.graphData3,b=m.graphData4,L=m.graphData5,H=m.graphData6,A=m.lastUpdatedAt,n&&n.moncondevice?(N=Object(o.g)(n.topic),[4,Object(r.m)(N,a,l,V.columns.length>1)]):[3,2];case 1:D=f.sent(),_=["VBC"],S=["VCA"],O=["VA"],j=["VB"],k=["VC"],q=["Bus Voltage"],F=["Gen IA"],R=["Gen IB"],C=["Gen IC"],G=["Gen kVA A"],T=["Gen kVA B"],I=["Gen kVA C"],M=["Gen kVA Total"],U=["Gen kW A"],B=["Gen kW B"],K=["Gen kW C"],W=["Gen kW Total"],z=["Gen Power Factor"],Z=["Act speed"],Y=["Engine Speed"],$=["Engine Load"],J=["Coolant Temp"],Q=["Oil Press"],X=["Battery Volt"],ee=["Fuel Level"],te=["ECU Coolant level"],ne=["Cool Down Time Rem."],ae=["Unexp. Shutdown"],le=["Global Alarm"],ie=["Auto Restart Fail"],re=["Fuel Leak Det."],se=["Battery Chg. Fail"],oe=["Transfer Fail"],ue=["Low Coolant level"],me=["ECU Shutdown"],ce=["Emerg. Shut"],de=["Overcrank"],he=["Loss of ECU Comms"],pe=["Global Sender Fail"],ge=["Low Fuel Level"],fe=["Low Oil Press"],ve=["High Coolant"],xe=["x"],(P=["VAB"]).push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(null),T.push(null),I.push(null),M.push(null),U.push(null),B.push(null),K.push(null),W.push(null),z.push(null),Z.push(null),Y.push(null),$.push(null),J.push(null),Q.push(null),X.push(null),ee.push(null),te.push(null),ne.push(null),ae.push(null),le.push(null),ie.push(null),re.push(null),se.push(null),oe.push(null),ue.push(null),me.push(null),ce.push(null),de.push(null),he.push(null),pe.push(null),ge.push(null),fe.push(null),ve.push(null),xe.push(new Date(a)),D.length>0&&D.forEach(function(e){e&&(P.push(e.GenVAB_Volts),_.push(e.GenVBC_Volts),S.push(e.GenVCA_Volts),O.push(e.GenVAN_Volts),j.push(e.GenVBN_Volts),k.push(e.GenVCN_Volts),q.push(e.BusVoltage_Volts),F.push(e.GenIA_Amps),R.push(e.GenIB_Amps),C.push(e.GenIC_Amps),G.push(e.GenKVA_A_KiloVA),T.push(e.GenKVA__B_KiloVA),I.push(e.GenKVA_C_KiloVA),M.push(e.GenKVA_Total_KiloVA),U.push(e.Gen_A_kW),B.push(e.Gen_B_kW),K.push(e.Gen_C_kW),W.push(e.Gen_Total_kW),z.push(e.GenPFLagging),Z.push(e.ActiveSpeedSource),Y.push(e.EngineSpeed_rpm),$.push(e.EngineLoad_pct),J.push(e.CoolantTemp_F),Q.push(e.OilPressure_psi),X.push(e.BatteryVoltage_DeciVolt),ee.push(e.FuelLevel),te.push(e.ECUCoolantLevel),ne.push(e.CoolDownTimeRemaining_mins),ae.push(e.UnexpectedShutdown),le.push(e.GlobalAlarm),ie.push(e.AutoRestartFailure),re.push(e.FuelLeakDetect),se.push(e.BatteryChargerFailure),oe.push(e.TransferFail),ue.push(e.LowCoolantLevel),me.push(e.ECUShutdown),ce.push(e.EmergencyShutdown),de.push(e.Overcrank),he.push(e.LossofECUComms),pe.push(e.GlobalSenderFail),ge.push(e.LowFuelLevel),fe.push(e.LowOilPressure),ve.push(e.HighCoolantTemp),xe.push(new Date(e.timestamp)))}),A=D.length>0?null===(e=xe[xe.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(null),T.push(null),I.push(null),M.push(null),U.push(null),B.push(null),K.push(null),W.push(null),z.push(null),Z.push(null),Y.push(null),$.push(null),J.push(null),Q.push(null),X.push(null),ee.push(null),te.push(null),ne.push(null),ae.push(null),le.push(null),ie.push(null),re.push(null),se.push(null),oe.push(null),ue.push(null),me.push(null),ce.push(null),de.push(null),he.push(null),pe.push(null),ge.push(null),fe.push(null),ve.push(null),xe.push(new Date(l)),Ee=[],u&&u.length&&(Ee.push(this.fetchEquipmentFromPoints(u[0]||"Voltages",["GenVAB_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts","GenVBC_Volts"])),Ee.push(this.fetchEquipmentFromPoints(u[1]||"Currents",["GenIA_Amps","GenIB_Amps","GenIC_Amps"])),Ee.push(this.fetchEquipmentFromPoints(u[2]||"Powers",["GenKVA_A_KiloVA","GenKVA__B_KiloVA","GenKVA_C_KiloVA","GenKVA_Total_KiloVA","Gen_A_kW","Gen_B_kW","Gen_C_kW"])),Ee.push(this.fetchEquipmentFromPoints(u[3]||"Power Factor",["GenPFLagging"])),Ee.push(this.fetchEquipmentFromPoints(u[4]||"Other Parameters",["ActiveSpeedSource","EngineSpeed_rpm","EngineLoad_pct","CoolantTemp_F","OilPressure_psi","BatteryVoltage_DeciVolt","FuelLevel","ECUCoolantLevel","CoolDownTimeRemaining_mins"])),Ee.push(this.fetchEquipmentFromPoints(u[5]||"Binary Parameters",["UnexpectedShutdown","GlobalAlarm","AutoRestartFailure","FuelLeakDetect","BatteryChargerFailure","TransferFail","LowCoolantLevel","ECUShutdown","EmergencyShutdown","Overcrank","LossofECUComms","GlobalSenderFail","LowFuelLevel","LowOilPressure","HighCoolantTemp"]))),V={x:"x",columns:[xe,P,_,S,O,j,k,q]},w={x:"x",columns:[xe,F,R,C]},y={x:"x",columns:[xe,G,T,I,M,U,B,K,W]},b={x:"x",columns:[xe,z]},L={x:"x",columns:[xe,Z,Y,$,J,Q,X,ee,te,ne]},H={x:"x",columns:[xe,ae,le,ie,re,se,oe,ue,me,ce,de,he,pe,ge,fe,ve]},h.y.label="Volts",p.y.label="Amps",g.y.label="Watts",v.y.label="",x.y.label="",E.y.label="",xe.length>1&&(Ve=Object(s.a)(5,a,l),we="",Ve.length>1?(ye=((new Date).getTime()-Ve[0].getTime())/1e3,we=(ye/=3600)>24?"%m-%d %H:%M":ye<.3?"%H:%M:%S":"%H:%M"):we="%H:%M:%S",c.x.lines=[],Ve.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(0)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(1)},v.y.tick.format=function(e){return parseFloat(e).toFixed(0)},x.y.tick.format=function(e){return parseFloat(e).toFixed(0)},E.y.tick.format=function(e){return parseFloat(e).toFixed(0)},h.y.tick.values=[0,50,100,150,200,250],p.y.tick.values=[0,10,20,30,40,50],g.y.tick.values=[0,20,40,60,80,100],v.y.tick.values=[-1,0,1],x.y.tick.values=[0,40,80,120,160,160],E.y.tick.values=[-1,0,1],h.y.max=250,h.y.min=0,p.y.max=50,p.y.min=0,g.y.max=100,g.y.min=0,v.y.max=1,v.y.min=-1,x.y.max=160,x.y.min=0,E.y.max=1,E.y.min=-1,h.x.tick.format=we,p.x.tick.format=we,g.x.tick.format=we,v.x.tick.format=we,x.x.tick.format=we,E.x.tick.format=we,h.x.tick.values=Ve,p.x.tick.values=Ve,g.x.tick.values=Ve,v.x.tick.values=Ve,x.x.tick.values=Ve,E.x.tick.values=Ve,this.props.loadNextInsight(),Object(d.h)(N,this.callLiveUpdate),this.setState({grid:c,axis1:h,axis2:p,axis3:g,axis4:v,axis5:x,axis6:E,graphData:V,graphData2:w,graphData3:y,graphData4:b,graphData5:L,graphData6:H,lastUpdatedAt:A,loading:!1,graphEquipment:Ee},function(){i&&be.changeAlarmStatus(!0)})),f.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.loading,l=t.graphData,r=t.graphData2,s=t.graphData3,u=t.graphData4,m=t.graphData5,c=t.graphData6,d=t.axis1,h=t.axis2,p=t.axis3,g=t.axis4,f=t.axis5,v=t.axis6,x=t.grid,E=t.lastUpdatedAt,V=t.indicateAlarm1,w=t.indicateAlarm2,y=t.indicateAlarm3,b=t.indicateAlarm4,L=t.indicateAlarm5,H=t.indicateAlarm6,A=t.alarmSensedPoints,N=t.selectedAlarmPoint1,D=t.selectedAlarmPoint2,P=t.selectedAlarmPoint3,_=t.selectedAlarmPoint4,S=t.selectedAlarmPoint5,O=t.selectedAlarmPoint6,j=t.graphEquipment,k=this.props,q=k.graphsList,F=k.instance,R=k.buildingName,C=k.device,G=k.showAlarmPoints,T=k.equipment,I=q&&q.length&&q[0]?q[0]:"Voltages",M=q&&q.length&&q[1]?q[1]:"Currents",U=q&&q.length&&q[2]?q[1]:"Powers",B=q&&q.length&&q[3]?q[1]:"Power Factor",K=q&&q.length&&q[4]?q[1]:"Other Parameters",W=q&&q.length&&q[5]?q[1]:"Binary Parameters";return a.createElement(a.Fragment,null,q.indexOf("Voltages")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(V&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:N.sensedValue,onChange:function(t){e.selectAlarmPoint1(t.target.value)}},A.filter(function(e){return"GenVAB_Volts"==e.sensedValue||"GenVBC_Volts"==e.sensedValue||"GenVCA_Volts"==e.sensedValue||"GenVAN_Volts"==e.sensedValue||"GenVBN_Volts"==e.sensedValue||"GenVCN_Volts"==e.sensedValue||"BusVoltage_Volts"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),V&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==I})?j.find(function(e){return e.graph==I}).pointEquip.length&&j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Voltages"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==I})?j.find(function(e){return e.graph==I}).pointEquip.length&&j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==I})?j.find(function(e){return e.graph==I}).pointEquip.length&&j.find(function(e){return e.graph==I}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:l,size:{height:300},axis:d,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),q.indexOf("Currents")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(w&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:D.sensedValue,onChange:function(t){e.selectAlarmPoint2(t.target.value)}},A.filter(function(e){return"GenIA_Amps"==e.sensedValue||"GenIB_Amps"==e.sensedValue||"GenIC_Amps"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),w&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==M})?j.find(function(e){return e.graph==M}).pointEquip.length&&j.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Currents"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==M})?j.find(function(e){return e.graph==M}).pointEquip.length&&j.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==M})?j.find(function(e){return e.graph==M}).pointEquip.length&&j.find(function(e){return e.graph==M}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:r,size:{height:300},axis:h,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Powers")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(y&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:P.sensedValue,onChange:function(t){e.selectAlarmPoint3(t.target.value)}},A.filter(function(e){return"GenKVA_A_KiloVA"==e.sensedValue||"GenKVA__B_KiloVA"==e.sensedValue||"GenKVA_C_KiloVA"==e.sensedValue||"GenKVA_Total_KiloVA"==e.sensedValue||"Gen_A_kW"==e.sensedValue||"Gen_B_kW"==e.sensedValue||"Gen_C_kW"==e.sensedValue||"Gen_Total_kW"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),y&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==U})?j.find(function(e){return e.graph==U}).pointEquip.length&&j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Powers"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==U})?j.find(function(e){return e.graph==U}).pointEquip.length&&j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==U})?j.find(function(e){return e.graph==U}).pointEquip.length&&j.find(function(e){return e.graph==U}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:s,size:{height:300},axis:p,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Power Factor")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(b&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:_.sensedValue,onChange:function(t){e.selectAlarmPoint4(t.target.value)}},A.filter(function(e){return"GenPFLagging"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),b&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==B})?j.find(function(e){return e.graph==B}).pointEquip.length&&j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Power Factor"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==B})?j.find(function(e){return e.graph==B}).pointEquip.length&&j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==B})?j.find(function(e){return e.graph==B}).pointEquip.length&&j.find(function(e){return e.graph==B}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:u,size:{height:300},axis:g,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Other Parameters")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(L&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:S.sensedValue,onChange:function(t){e.selectAlarmPoint5(t.target.value)}},A.filter(function(e){return"ActiveSpeedSource"==e.sensedValue||"EngineSpeed_rpm"==e.sensedValue||"EngineLoad_pct"==e.sensedValue||"CoolantTemp_F"==e.sensedValue||"OilPressure_psi"==e.sensedValue||"BatteryVoltage_DeciVolt"==e.sensedValue||"FuelLevel"==e.sensedValue||"ECUCoolantLevel"==e.sensedValue||"CoolDownTimeRemaining_mins"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),L&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==K})?j.find(function(e){return e.graph==K}).pointEquip.length&&j.find(function(e){return e.graph==K}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Other Parameters"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==K})?j.find(function(e){return e.graph==K}).pointEquip.length&&j.find(function(e){return e.graph==K}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==K})?j.find(function(e){return e.graph==K}).pointEquip.length&&j.find(function(e){return e.graph==K}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:m,size:{height:300},axis:f,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),q.indexOf("Binary Parameters")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(H&&G?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),G&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:O.sensedValue,onChange:function(t){e.selectAlarmPoint6(t.target.value)}},A.filter(function(e){return"UnexpectedShutdown"==e.sensedValue||"GlobalAlarm"==e.sensedValue||"AutoRestartFailure"==e.sensedValue||"FuelLeakDetect"==e.sensedValue||"BatteryChargerFailure"==e.sensedValue||"TransferFail"==e.sensedValue||"LowCoolantLevel"==e.sensedValue||"ECUShutdown"==e.sensedValue||"EmergencyShutdown"==e.sensedValue||"Overcrank"==e.sensedValue||"LossofECUComms"==e.sensedValue||"GlobalSenderFail"==e.sensedValue||"LowFuelLevel"==e.sensedValue||"LowOilPressure"==e.sensedValue||"HighCoolantTemp"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),H&&a.createElement("a",{href:"#"+F+"/"+R+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+F+"/"+R+"/Insights/Equipment/Graphs/Generator/"+Object(o.g)(C.moncondevice),target:"_blank",rel:"noreferrer noopener"},j&&j.length&&j.find(function(e){return e.graph==W})?j.find(function(e){return e.graph==W}).pointEquip.length&&j.find(function(e){return e.graph==W}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Binary Parameters"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",j&&j.length&&j.find(function(e){return e.graph==W})?j.find(function(e){return e.graph==W}).pointEquip.length&&j.find(function(e){return e.graph==W}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",j&&j.length&&j.find(function(e){return e.graph==W})?j.find(function(e){return e.graph==W}).pointEquip.length&&j.find(function(e){return e.graph==W}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(C.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(C.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===T||void 0===T?void 0:T.map(function(e,t){return e.rdfsLabel+(t<T.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(C.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(C.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),n?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:c,size:{height:300},axis:v,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=v},2970:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(715),s=n(802),o=n(11),u=n(803),m=n(122),c=n(736),d=n(124),h=n(760),p=(n.n(h),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],indicateAlarm1:!1,indicateAlarm2:!1,graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e=this;return f(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(o.g)(e)&&Object(d.g)(Object(o.g)(e)),[2]})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(o.g)(e.sensedValue)==a});!i||!Object(o.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(o.g)(i.relatedEquipment)})||l.push({value:Object(o.g)(i.relatedEquipment),label:Object(o.g)(i.relatedEquipmentLabel),space:Object(o.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype.changeAlarmStatus=function(e){return g(this,void 0,void 0,function(){var t,n,a,l,i,r,s,d,h,p,g,v,x=this;return f(this,function(f){switch(f.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=this.props,r=i.buildingName,s=i.devicePoints,d=i.showAlarmPoints,h=i.device,Object(m.a)(!0),d&&!e?[3,2]:(p=[],s&&s.length&&s.forEach(function(e){p.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue)})}),[4,Object(u.e)(c.a.OperationalAlarm,r,!1,0,50,null,null,[Object(o.g)(h.moncondevice)],null)]);case 1:return g=f.sent(),v=new Date(n.columns[0][1]),g=g.filter(function(e){return new Date(e.timeofalarm)>v}),this.setState({alarmSensedPoints:p,deviceAlarms:g},function(){if((null===p||void 0===p?void 0:p.length)>0&&n.columns.length>1){var e=p.filter(function(e){return"register1"==e.sensedValue||"t3frontRefrigerator1"==e.sensedValue||"t4backRefrigerator1"==e.sensedValue||"t5evapfanRefrigerator1"==e.sensedValue||"t6comprinRefrigerator1"==e.sensedValue||"t7comproutRefrigerator1"==e.sensedValue||"t8probeRefrigerator1"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";x.selectAlarmPoint1(t);var i=p.filter(function(e){return"register1"==e.sensedValue||"t3frontRefrigerator2"==e.sensedValue||"t4backRefrigerator2"==e.sensedValue||"t5evapfanRefrigerator2"==e.sensedValue||"t6comprinRefrigerator2"==e.sensedValue||"t7comproutRefrigerator2"==e.sensedValue||"t8probeRefrigerator2"==e.sensedValue}),r=l.sensedValue.length>1?l.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";x.selectAlarmPoint2(r)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),f.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"register1"==e.sensedValueKey||"t3frontRefrigerator1"==e.sensedValueKey||"t4backRefrigerator1"==e.sensedValueKey||"t5evapfanRefrigerator1"==e.sensedValueKey||"t6comprinRefrigerator1"==e.sensedValueKey||"t7comproutRefrigerator1"==e.sensedValueKey||"t8probeRefrigerator1"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("register1"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Register:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t3frontRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Front:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t4backRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Back:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t5evapfanRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Evaporator Fan":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t6comprinRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Compressor In":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t7comproutRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Compressor Out":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t8probeRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[8].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Solid:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint1:r,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"register1"==e.sensedValueKey||"t3frontRefrigerator2"==e.sensedValueKey||"t4backRefrigerator2"==e.sensedValueKey||"t5evapfanRefrigerator2"==e.sensedValueKey||"t6comprinRefrigerator2"==e.sensedValueKey||"t7comproutRefrigerator2"==e.sensedValueKey||"t8probeRefrigerator2"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("register1"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Register:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t3frontRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Front:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t4backRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Back:"#e3e3e3",High:"grey","High-High":"red"}}}else if("t5evapfanRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Evaporator Fan":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t6comprinRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Compressor In":"#e3e3e3",High:"grey","High-High":"red"}}}else if("Compressor Out"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Analog Input 8":"#e3e3e3",High:"grey","High-High":"red"}}}else if("t8probeRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[8].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[8],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Solid:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint2:r,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,r=a.axis1,s=a.grid,o=a.alarmSensedPoints,u=a.selectedAlarmPoint1,m=a.selectedAlarmPoint2,c=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var d=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.register1),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.t3frontRefrigerator1),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.t4backRefrigerator1),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.t5evapfanRefrigerator1),l.columns[5].splice(1,1),l.columns[5].push(null===e||void 0===e?void 0:e.t6comprinRefrigerator1),l.columns[6].splice(1,1),l.columns[6].push(null===e||void 0===e?void 0:e.t7comproutRefrigerator1),l.columns[7].splice(1,1),l.columns[7].push(null===e||void 0===e?void 0:e.t8probeRefrigerator1),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.register1),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.t3frontRefrigerator2),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.t4backRefrigerator2),i.columns[4].splice(1,1),i.columns[4].push(null===e||void 0===e?void 0:e.t5evapfanRefrigerator2),i.columns[5].splice(1,1),i.columns[5].push(null===e||void 0===e?void 0:e.t6comprinRefrigerator2),i.columns[6].splice(1,1),i.columns[6].push(null===e||void 0===e?void 0:e.t7comproutRefrigerator2),i.columns[7].splice(1,1),i.columns[7].push(null===e||void 0===e?void 0:e.t8probeRefrigerator2),(t.getTime()-l.columns[0][2].getTime())/6e4>d&&l.columns[0].splice(1,1),r.x.tick.values[2]&&r.x.tick.values[1].getTime()&&r.x.tick.values[2].getTime()-r.x.tick.values[1].getTime()<t.getTime()-r.x.tick.values[r.x.tick.values.length-1]&&(r.x.tick.values.splice(0,1),s.x.lines.splice(0,1),t.setSeconds(0),d>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),r.x.tick.values.push(t),s.x.lines.push({value:t,class:"grid4"}));var h=null===t||void 0===t?void 0:t.toLocaleString();c?this.setState({grid:s,axis1:r,graphData:l,graphData2:i,lastUpdatedAt:h},function(){var e=o.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=u.sensedValue.length>1?u.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=o.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=m.sensedValue.length>1?m.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l)}):this.setState({grid:s,axis1:r,graphData:l,graphData2:i,lastUpdatedAt:h})}},t.prototype._fetchData=function(){var e;return g(this,void 0,void 0,function(){var t,n,a,l,i,u,m,c,h,p,g,v,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R,C,G=this;return f(this,function(f){switch(f.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,m=this.state,c=m.grid,h=m.axis1,p=m.axis2,g=m.graphData,v=m.graphData2,x=m.lastUpdatedAt,n&&n.moncondevice?(E=Object(o.g)(n.topic),[4,Object(r.k)(E,a,l,g.columns.length>1)]):[3,2];case 1:V=f.sent(),y=["Front"],b=["Back"],L=["Evaporator Fan"],H=["Compressor In"],A=["Compressor Out"],N=["Solid"],D=["Front"],P=["Back"],_=["Evaporator Fan"],S=["Compressor In"],O=["Compressor Out"],j=["Solid"],k=["x"],(w=["Register"]).push(null),y.push(null),b.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(new Date(a)),V.length>0&&V.forEach(function(e){e&&(w.push(""+e.register1),y.push(""+e.t3frontRefrigerator1),b.push(""+e.t4backRefrigerator1),L.push(""+e.t5evapfanRefrigerator1),H.push(""+e.t6comprinRefrigerator1),A.push(""+e.t7comproutRefrigerator1),N.push(""+e.t8probeRefrigerator1),D.push(""+e.t3frontRefrigerator2),P.push(""+e.t4backRefrigerator2),_.push(""+e.t5evapfanRefrigerator2),S.push(""+e.t6comprinRefrigerator2),O.push(""+e.t7comproutRefrigerator2),j.push(""+e.t8probeRefrigerator2),k.push(new Date(e.timestamp)))}),x=V.length>0?null===(e=k[k.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",w.push(null),y.push(null),b.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(new Date(l)),q=[],u&&u.length&&(q.push(this.fetchEquipmentFromPoints(u[0]||"Refrigerator 1",["t3frontRefrigerator1","t4backRefrigerator1","t5evapfanRefrigerator1","t6comprinRefrigerator1","t7comproutRefrigerator1","t8probeRefrigerator1"])),q.push(this.fetchEquipmentFromPoints(u[1]||"Refrigerator 2",["t3frontRefrigerator2","t4backRefrigerator2","t5evapfanRefrigerator2","t6comprinRefrigerator2","t7comproutRefrigerator2","t8probeRefrigerator2"]))),g={x:"x",columns:[k,w,y,b,L,H,A,N]},v={x:"x",columns:[k,w,D,P,_,S,O,j]},h.y.label="\xb0F",p.y.label="\xb0F",k.length>1&&(F=Object(s.a)(5,a,l),R="",F.length>1?(C=((new Date).getTime()-F[0].getTime())/1e3,R=(C/=3600)>24?"%m-%d %H:%M":C<.3?"%H:%M:%S":"%H:%M"):R="%H:%M:%S",c.x.lines=[],F.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(1)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},h.y.tick.values=[0,20,40,60,80,100],p.y.tick.values=[0,20,40,60,80,100],h.y.max=100,h.y.min=0,p.y.max=100,p.y.min=0,h.x.tick.format=R,p.x.tick.format=R,h.x.tick.values=F,p.x.tick.values=F,this.props.loadNextInsight(),Object(d.h)(E,this.callLiveUpdate),this.setState({grid:c,axis1:h,axis2:p,graphData:g,graphData2:v,lastUpdatedAt:x,loading:!1,graphEquipment:q},function(){i&&G.changeAlarmStatus(!0)})),f.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n=this,l=this.state,r=l.loading,s=l.graphData,u=l.graphData2,m=l.axis1,c=l.axis2,d=l.grid,h=l.lastUpdatedAt,p=l.graphDataAlarmPoint1,g=l.graphDataAlarmPoint2,f=l.indicateAlarm1,v=l.indicateAlarm2,x=l.alarmSensedPoints,E=l.selectedAlarmPoint1,V=l.selectedAlarmPoint2,w=l.graphEquipment,y=this.props,b=y.graphsList,L=y.instance,H=y.buildingName,A=y.device,N=y.showAlarmPoints,D=y.equipment,P=b&&b.length&&b[0]?b[0]:"Refrigerator 1",_=b&&b.length&&b[1]?b[1]:"Refrigerator 2";return a.createElement(a.Fragment,null,b.indexOf("Refrigerator 1")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(f&&N?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),N&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",x&&x.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:E.sensedValue,onChange:function(e){n.selectAlarmPoint1(e.target.value)}},x.filter(function(e){return"t3frontRefrigerator1"==e.sensedValue||"t4backRefrigerator1"==e.sensedValue||"t5evapfanRefrigerator1"==e.sensedValue||"t6comprinRefrigerator1"==e.sensedValue||"t7comproutRefrigerator1"==e.sensedValue||"t8probeRefrigerator1"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),f&&a.createElement("a",{href:"#"+L+"/"+H+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+L+"/"+H+"/Insights/Equipment/Graphs/CBW406/"+Object(o.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},w&&w.length&&w.find(function(e){return e.graph==P})?w.find(function(e){return e.graph==P}).pointEquip.length&&w.find(function(e){return e.graph==P}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",w&&w.length&&w.find(function(e){return e.graph==P})?w.find(function(e){return e.graph==P}).pointEquip.length&&w.find(function(e){return e.graph==P}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",w&&w.length&&w.find(function(e){return e.graph==P})?w.find(function(e){return e.graph==P}).pointEquip.length&&w.find(function(e){return e.graph==P}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(A.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(A.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===D||void 0===D?void 0:D.map(function(e,t){return e.rdfsLabel+(t<D.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(A.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(A.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",h)),r?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:N&&(null===(e=p.columns)||void 0===e?void 0:e.length)>1?p:s,size:{height:300},axis:m,grid:d,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),b.indexOf("Refrigerator 2")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(v&&N?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),N&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",x&&x.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:V.sensedValue,onChange:function(e){n.selectAlarmPoint2(e.target.value)}},x.filter(function(e){return"register1"==e.sensedValue||"t3frontRefrigerator2"==e.sensedValue||"t4backRefrigerator2"==e.sensedValue||"t5evapfanRefrigerator2"==e.sensedValue||"t6comprinRefrigerator2"==e.sensedValue||"t7comproutRefrigerator2"==e.sensedValue||"t8probeRefrigerator2"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),v&&a.createElement("a",{href:"#"+L+"/"+H+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+L+"/"+H+"/Insights/Equipment/Graphs/CBW406/"+Object(o.g)(A.moncondevice),target:"_blank",rel:"noreferrer noopener"},w&&w.length&&w.find(function(e){return e.graph==_})?w.find(function(e){return e.graph==_}).pointEquip.length&&w.find(function(e){return e.graph==_}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",w&&w.length&&w.find(function(e){return e.graph==_})?w.find(function(e){return e.graph==_}).pointEquip.length&&w.find(function(e){return e.graph==_}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",w&&w.length&&w.find(function(e){return e.graph==_})?w.find(function(e){return e.graph==_}).pointEquip.length&&w.find(function(e){return e.graph==_}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(A.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(A.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",D.map(function(e,t){return e.rdfsLabel+(t<D.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(A.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(A.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",h)),r?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:N&&(null===(t=g.columns)||void 0===t?void 0:t.length)>1?g:u,size:{height:300},axis:c,grid:d,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=v},2971:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(715),s=n(802),o=n(11),u=n(803),m=n(122),c=n(736),d=n(124),h=n(760),p=(n.n(h),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphEquipment:Object()},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e=this;return f(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(o.g)(e)&&Object(d.g)(Object(o.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){var t;return g(this,void 0,void 0,function(){var n,a,l,i,r,s,d,h,p,g,v,x,E,V=this;return f(this,function(f){switch(f.label){case 0:return n=this.state,a=n.graphData,l=n.selectedAlarmPoint1,i=n.selectedAlarmPoint2,r=n.selectedAlarmPoint3,s=this.props,d=s.buildingName,h=s.devicePoints,p=s.showAlarmPoints,g=s.device,Object(m.a)(!0),p&&!e?[3,2]:(v=[],h&&h.length&&h.forEach(function(e){v.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue)})}),[4,Object(u.e)(c.a.OperationalAlarm,d,!1,0,50,null,null,[Object(o.g)(g.moncondevice)],null)]);case 1:return x=f.sent(),E=(null===(t=a.columns[0])||void 0===t?void 0:t.length)>1?new Date(a.columns[0][1]):null,x=x.filter(function(e){return new Date(e.timeofalarm)>E}),this.setState({alarmSensedPoints:v,deviceAlarms:x},function(){if((null===v||void 0===v?void 0:v.length)>0&&a.columns.length>1){var e=v.filter(function(e){return"a13comprcurrRefrigerator1"==e.sensedValue||"a14efmcurrRefrigerator1"==e.sensedValue||"a15prRefrigerator1"==e.sensedValue||"a16doorRefrigerator1"==e.sensedValue}),t=l.sensedValue.length>1?l.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";V.selectAlarmPoint1(t);var n=v.filter(function(e){return"a13comprcurrRefrigerator2"==e.sensedValue||"a14efmcurrRefrigerator2"==e.sensedValue||"a15prRefrigerator2"==e.sensedValue||"a16doorRefrigerator2"==e.sensedValue}),s=i.sensedValue.length>1?i.sensedValue:(null===n||void 0===n?void 0:n.length)>0?n[n.length-1].sensedValue:"";V.selectAlarmPoint2(s);var o=v.filter(function(e){return"poweranalogInput5"==e.sensedValue||"poweranalogInput6"==e.sensedValue||"poweranalogInput7"==e.sensedValue||"poweranalogInput8"==e.sensedValue}),u=r.sensedValue.length>1?r.sensedValue:(null===o||void 0===o?void 0:o.length)>0?o[o.length-1].sensedValue:"";V.selectAlarmPoint3(u)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),f.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"a13comprcurrRefrigerator1"==e.sensedValueKey||"a14efmcurrRefrigerator1"==e.sensedValueKey||"a15prRefrigerator1"==e.sensedValueKey||"a16doorRefrigerator1"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("a13comprcurrRefrigerator1"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Compressor:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a14efmcurrRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EFM:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a15prRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Pressure Sensor":"#e3e3e3",High:"grey","High-High":"red"}}}else if("a16doorRefrigerator1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(+r.minimumExtremeValue/1e3),l.push(+r.minimumNormalValue/1e3),i.push(+r.maximumNormalValue/1e3),o.push(+r.maximumExtremeValue/1e3);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Door Contact":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint1:r,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"a13comprcurrRefrigerator2"==e.sensedValueKey||"a14efmcurrRefrigerator2"==e.sensedValueKey||"a15prRefrigerator2"==e.sensedValueKey||"a16doorRefrigerator2"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("a13comprcurrRefrigerator2"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Compressor:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a14efmcurrRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EFM:"#e3e3e3",High:"grey","High-High":"red"}}}else if("a15prRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Pressure Sensor":"#e3e3e3",High:"grey","High-High":"red"}}}else if("a16doorRefrigerator2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Door Contact":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint2:r,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"poweranalogInput5"==e.sensedValueKey||"poweranalogInput6"==e.sensedValueKey||"poweranalogInput7"==e.sensedValueKey||"poweranalogInput8"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("poweranalogInput5"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 5":"#e3e3e3",High:"grey","High-High":"red"}}}else if("poweranalogInput6"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 6":"#e3e3e3",High:"grey","High-High":"red"}}}else if("poweranalogInput7"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 7":"#e3e3e3",High:"grey","High-High":"red"}}}else if("poweranalogInput8"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power Analog Input 8":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint3:r,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,r=a.axis1,s=a.grid,o=a.alarmSensedPoints,u=a.selectedAlarmPoint1,m=a.selectedAlarmPoint2,c=a.selectedAlarmPoint3,d=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var h=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.a13comprcurrRefrigerator1),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.a14efmcurrRefrigerator1),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.a15prRefrigerator1),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.a16doorRefrigerator1),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.a13comprcurrRefrigerator2),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.a14efmcurrRefrigerator2),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.a15prRefrigerator2),i.columns[4].splice(1,1),i.columns[4].push(null===e||void 0===e?void 0:e.a16doorRefrigerator2),(t.getTime()-l.columns[0][2].getTime())/6e4>h&&l.columns[0].splice(1,1),r.x.tick.values[2]&&r.x.tick.values[1].getTime()&&r.x.tick.values[2].getTime()-r.x.tick.values[1].getTime()<t.getTime()-r.x.tick.values[r.x.tick.values.length-1]&&(r.x.tick.values.splice(0,1),s.x.lines.splice(0,1),t.setSeconds(0),h>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),r.x.tick.values.push(t),s.x.lines.push({value:t,class:"grid4"}));var p=null===t||void 0===t?void 0:t.toLocaleString();d?this.setState({grid:s,axis1:r,graphData:l,graphData2:i,lastUpdatedAt:p},function(){var e=o.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=u.sensedValue.length>1?u.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=o.filter(function(e){return"pressure_hPa"==e.sensedValue}),l=m.sensedValue.length>1?m.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=o.filter(function(e){return"illuminance_lux"==e.sensedValue}),r=c.sensedValue.length>1?c.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(r)}):this.setState({grid:s,axis1:r,graphData:l,graphData2:i,lastUpdatedAt:p})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(o.g)(e.sensedValue)==a});!i||!Object(o.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(o.g)(i.relatedEquipment)})||l.push({value:Object(o.g)(i.relatedEquipment),label:Object(o.g)(i.relatedEquipmentLabel),space:Object(o.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return g(this,void 0,void 0,function(){var t,n,a,l,i,u,m,c,h,p,g,v,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R,C,G,T,I,M,U,B,K=this;return f(this,function(f){switch(f.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,m=this.state,c=m.grid,h=m.axis1,p=m.axis2,g=m.axis3,v=m.graphData,x=m.graphData2,E=m.graphData3,V=m.lastUpdatedAt,n&&n.moncondevice?(w=Object(o.g)(n.topic),[4,Object(r.l)(w,a,l,v.columns.length>1)]):[3,2];case 1:y=f.sent(),L=["EFM"],H=["Pressure Sensor"],A=["Door Contact"],N=["Compressor"],D=["EFM"],P=["Pressure Sensor"],_=["Door Contact"],S=["Register"],O=["Serial Number"],j=["Refresh"],k=["Power Analog Input 5"],q=["Power Analog Input 6"],F=["Power Analog Input 7"],R=["Power Analog Input 8"],C=["Amalgamated Watts"],G=["x"],(b=["Compressor"]).push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(new Date(a)),T=!1,y.length>0&&y.forEach(function(e){e&&(e.a13comprcurrRefrigerator1&&b.push(""+e.a13comprcurrRefrigerator1),e.a14efmcurrRefrigerator1&&(T=e.a14efmcurrRefrigerator1<-5,L.push(""+e.a14efmcurrRefrigerator1)),e.a15prRefrigerator1&&H.push(""+e.a15prRefrigerator1),e.a16doorRefrigerator1&&A.push(""+e.a16doorRefrigerator1),e.a13comprcurrRefrigerator2&&N.push(""+e.a13comprcurrRefrigerator2),e.a14efmcurrRefrigerator2&&D.push(""+e.a14efmcurrRefrigerator2),e.a15prRefrigerator2&&P.push(""+e.a15prRefrigerator2),e.a16doorRefrigerator2&&_.push(""+e.a16doorRefrigerator2),e.register1&&S.push(""+e.register1),e.serialNumber&&O.push(""+e.serialNumber),e.minRecRefresh&&j.push(""+e.minRecRefresh),e.poweranalogInput5&&k.push(""+e.poweranalogInput5),e.poweranalogInput6&&q.push(""+e.poweranalogInput6),e.poweranalogInput7&&F.push(""+e.poweranalogInput7),e.poweranalogInput8&&R.push(""+e.poweranalogInput8),C.push(""+360*e.a13comprcurrRefrigerator1),G.push(new Date(e.timestamp)))}),V=y.length>0?null===(e=G[G.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",b.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(new Date(l)),I=[],u&&u.length&&(I.push(this.fetchEquipmentFromPoints(u[0]||"Refrigerator 1",["a13comprcurrRefrigerator1","a14efmcurrRefrigerator1","a15prRefrigerator1","a16doorRefrigerator1"])),I.push(this.fetchEquipmentFromPoints(u[1]||"Refrigerator 2",["a13comprcurrRefrigerator2","a14efmcurrRefrigerator2","a15prRefrigerator2","a16doorRefrigerator2"])),I.push(this.fetchEquipmentFromPoints(u[2]||"Refrigerator 1 and 2",["poweranalogInput5","poweranalogInput6","poweranalogInput7","poweranalogInput8"]))),(b.length>3||L.length>3||H.length>3||A.length>3)&&(v={x:"x",columns:[G,b,L,H,A]}),(N.length>3||D.length>3||P.length>3||_.length>3)&&(x={x:"x",columns:[G,N,D,P,_]}),(k.length>3||q.length>3||F.length>3||R.length>3)&&(E={x:"x",columns:[G,k,q,F,R]},g.y.label="kw"),h.y.label="Amps",p.y.label="Amps",G.length>1&&(M=Object(s.a)(5,a,l),U="",M.length>1?(B=((new Date).getTime()-M[0].getTime())/1e3,U=(B/=3600)>24?"%m-%d %H:%M":B<.3?"%H:%M:%S":"%H:%M"):U="%H:%M:%S",c.x.lines=[],M.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(1)},p.y.tick.format=function(e){return parseFloat(e).toFixed(1)},g.y.tick.format=function(e){return parseFloat(e).toFixed(1)},h.y.tick.values=T?[-20,-10,0,10,20]:[0,5,10,15,20],p.y.tick.values=[0,5,10,15,20],g.y.tick.values=[0,20,40,60,80,100],h.y.max=20,h.y.min=T?-20:0,p.y.max=20,p.y.min=0,g.y.max=100,g.y.min=0,h.x.tick.format=U,p.x.tick.format=U,g.x.tick.format=U,h.x.tick.values=M,p.x.tick.values=M,g.x.tick.values=M,this.props.loadNextInsight(),Object(d.h)(w,this.callLiveUpdate),this.setState({grid:c,axis1:h,axis2:p,axis3:g,graphData:v,graphData2:x,graphData3:E,lastUpdatedAt:V,loading:!1,graphEquipment:I},function(){i&&K.changeAlarmStatus(!0)})),f.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n,l,r,s,u=this,m=this.state,c=m.loading,d=m.graphData,h=m.graphData2,p=m.graphData3,g=m.axis1,f=m.axis2,v=m.axis3,x=m.grid,E=m.lastUpdatedAt,V=m.graphDataAlarmPoint1,w=m.graphDataAlarmPoint2,y=m.graphDataAlarmPoint3,b=m.indicateAlarm1,L=m.indicateAlarm2,H=m.indicateAlarm3,A=m.alarmSensedPoints,N=m.selectedAlarmPoint1,D=m.selectedAlarmPoint2,P=m.selectedAlarmPoint3,_=m.graphEquipment,S=this.props,O=S.graphsList,j=S.instance,k=S.buildingName,q=S.showAlarmPoints,F=S.device,R=S.equipment,C=O&&O.length&&O[0]?O[0]:"Refrigerator 1",G=O&&O.length&&O[1]?O[1]:"Refrigerator 2",T=O&&O.length&&O[1]?O[1]:"Refrigerator 1 and 2";return a.createElement(a.Fragment,null,O.indexOf("Refrigerator 1")>-1&&(null===(e=d.columns[1])||void 0===e?void 0:e.length)>2&&a.createElement("div",{className:"row col-md-12 device-graphs "+(b&&q?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),q&&A.length>0&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:N.sensedValue,onChange:function(e){u.selectAlarmPoint1(e.target.value)}},A.filter(function(e){return"a13comprcurrRefrigerator1"==e.sensedValue||"a14efmcurrRefrigerator1"==e.sensedValue||"a15prRefrigerator1"==e.sensedValue||"a16doorRefrigerator1"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),b&&a.createElement("a",{href:"#"+j+"/"+k+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+j+"/"+k+"/Insights/Equipment/Graphs/CompressorControl/"+Object(o.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},_&&_.length&&_.find(function(e){return e.graph==C})?_.find(function(e){return e.graph==C}).pointEquip.length&&_.find(function(e){return e.graph==C}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",_&&_.length&&_.find(function(e){return e.graph==C})?_.find(function(e){return e.graph==C}).pointEquip.length&&_.find(function(e){return e.graph==C}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",_&&_.length&&_.find(function(e){return e.graph==C})?_.find(function(e){return e.graph==C}).pointEquip.length&&_.find(function(e){return e.graph==C}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(F.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(F.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===R||void 0===R?void 0:R.map(function(e,t){return e.rdfsLabel+(t<R.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(F.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(F.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:q&&(null===(t=V.columns)||void 0===t?void 0:t.length)>1?V:d,size:{height:300},axis:g,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),O.indexOf("Refrigerator 2")>-1&&(null===(n=h.columns[1])||void 0===n?void 0:n.length)>2&&a.createElement("div",{className:"row col-md-12 device-graphs "+(L&&q?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),q&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:D.sensedValue,onChange:function(e){u.selectAlarmPoint2(e.target.value)}},A.filter(function(e){return"a13comprcurrRefrigerator2"==e.sensedValue||"a14efmcurrRefrigerator2"==e.sensedValue||"a15prRefrigerator2"==e.sensedValue||"a16doorRefrigerator2"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),L&&a.createElement("a",{href:"#"+j+"/"+k+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+j+"/"+k+"/Insights/Equipment/Graphs/CompressorControl/"+Object(o.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},_&&_.length&&_.find(function(e){return e.graph==G})?_.find(function(e){return e.graph==G}).pointEquip.length&&_.find(function(e){return e.graph==G}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",_&&_.length&&_.find(function(e){return e.graph==G})?_.find(function(e){return e.graph==G}).pointEquip.length&&_.find(function(e){return e.graph==G}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",_&&_.length&&_.find(function(e){return e.graph==G})?_.find(function(e){return e.graph==G}).pointEquip.length&&_.find(function(e){return e.graph==G}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(F.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(F.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===R||void 0===R?void 0:R.map(function(e,t){return e.rdfsLabel+(t<R.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(F.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(F.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:q&&(null===(l=w.columns)||void 0===l?void 0:l.length)>1?w:h,size:{height:300},axis:f,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),O.indexOf("Refrigerator 1")>-1&&O.indexOf("Power Analog Inputs")>-1&&(null===(r=p.columns[1])||void 0===r?void 0:r.length)>2&&a.createElement("div",{className:"row col-md-12 device-graphs "+(H&&q?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),q&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",A&&A.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:P.sensedValue,onChange:function(e){u.selectAlarmPoint3(e.target.value)}},A.filter(function(e){return"poweranalogInput5"==e.sensedValue||"poweranalogInput6"==e.sensedValue||"poweranalogInput7"==e.sensedValue||"poweranalogInput8"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),H&&a.createElement("a",{href:"#"+j+"/"+k+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+j+"/"+k+"/Insights/Equipment/Graphs/CompressorControl/"+Object(o.g)(F.moncondevice),target:"_blank",rel:"noreferrer noopener"},_&&_.length&&_.find(function(e){return e.graph==T})?_.find(function(e){return e.graph==T}).pointEquip.length&&_.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",_&&_.length&&_.find(function(e){return e.graph==T})?_.find(function(e){return e.graph==T}).pointEquip.length&&_.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",_&&_.length&&_.find(function(e){return e.graph==T})?_.find(function(e){return e.graph==T}).pointEquip.length&&_.find(function(e){return e.graph==T}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)(F.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)(F.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===R||void 0===R?void 0:R.map(function(e,t){return e.rdfsLabel+(t<R.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)(F.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)(F.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",E)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:q&&(null===(s=y.columns)||void 0===s?void 0:s.length)>1?y:p,size:{height:300},axis:v,grid:x,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=v},2972:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(707),s=n(11),o=n(802),u=n(803),m=n(122),c=n(736),d=n(124),h=n(760),p=(n.n(h),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],graphDataAlarmPoint:{},selectedAlarmPoint:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm:!1,graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e=this;return f(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(s.g)(e)&&Object(d.g)(Object(s.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){var t;return g(this,void 0,void 0,function(){var n,a,l,i,r,o,d,h,p,g,v,x=this;return f(this,function(f){switch(f.label){case 0:return n=this.state,a=n.graphData,l=n.selectedAlarmPoint,i=this.props,r=i.buildingName,o=i.devicePoints,d=i.showAlarmPoints,h=i.device,Object(m.a)(!0),d&&!e?[3,2]:(p=[],o&&o.length&&o.forEach(function(e){p.push({sensedValue:Object(s.g)(e.sensedValue),maximumExtremeValue:Object(s.g)(e.maximumExtremeValue),maximumNormalValue:Object(s.g)(e.maximumNormalValue),minimumExtremeValue:Object(s.g)(e.minimumExtremeValue),minimumNormalValue:Object(s.g)(e.minimumNormalValue)})}),[4,Object(u.e)(c.a.OperationalAlarm,r,!1,0,50,null,null,[Object(s.g)(h.moncondevice)],null)]);case 1:return g=f.sent(),v=(null===(t=a.columns[0])||void 0===t?void 0:t.length)>1?new Date(a.columns[0][1]):null,g=g.filter(function(e){return new Date(e.timeofalarm)>v}),this.setState({alarmSensedPoints:p,deviceAlarms:g},function(){if((null===p||void 0===p?void 0:p.length)>0&&a.columns.length>1){var e=l.sensedValue.length>1?l.sensedValue:p[p.length-1].sensedValue;x.selectAlarmPoint(e)}}),[3,3];case 2:this.selectAlarmPoint(""),f.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("mAmps_relay1"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"grey",Low:"grey","Relay 1 Amp":"red",High:"grey","High-High":"grey"}}}else if("mAmps_relay2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 2 Amp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("mAmps_relay3"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 3 Amp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("mAmps_relay4"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 4 Amp":"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_Wt_relay1"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[5].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[5],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 1 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_Wt_relay2"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[6].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[6],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 2 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else if("power_Wt_relay3"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[7].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[7],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 3 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else if("nominal_src_volts"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[12].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[12],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Relay 3 Watts":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint:r,graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphDataAlarmPoint:e,indicateAlarm:s,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.grid,s=a.alarmSensedPoints,o=a.axis1,u=a.selectedAlarmPoint,m=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var c=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.mAmps_relay1),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.mAmps_relay2),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.mAmps_relay3),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.mAmps_relay4),l.columns[5].splice(1,1),l.columns[5].push(null===e||void 0===e?void 0:e.power_Wt_relay1),l.columns[6].splice(1,1),l.columns[6].push(null===e||void 0===e?void 0:e.power_Wt_relay2),l.columns[7].splice(1,1),l.columns[7].push(null===e||void 0===e?void 0:e.power_Wt_relay3);var d=Object(r.a)(parseInt(null===e||void 0===e?void 0:e.v4relay_state));3==d.length?d="0"+d:2==d.length?d="00"+d:1==d.length&&(d="000"+d);var h=d[3],p=d[2],g=d[1],f=d[0];l.columns[8].splice(1,1),l.columns[8].push(h||"0"),l.columns[9].splice(1,1),l.columns[9].push(p||"0"),l.columns[10].splice(1,1),l.columns[10].push(g||"0"),l.columns[11].splice(1,1),l.columns[11].push(f||"0"),l.columns[12].splice(1,1),l.columns[12].push(null===e||void 0===e?void 0:e.nominal_src_volts),(t.getTime()-l.columns[0][2].getTime())/6e4>c&&l.columns[0].splice(1,1),o.x.tick.values[2]&&o.x.tick.values[1].getTime()&&o.x.tick.values[2].getTime()-o.x.tick.values[1].getTime()<t.getTime()-o.x.tick.values[o.x.tick.values.length-1]&&(o.x.tick.values.splice(0,1),i.x.lines.splice(0,1),t.setSeconds(0),c>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),o.x.tick.values.push(t),i.x.lines.push({value:t,class:"grid4"}));var v=null===t||void 0===t?void 0:t.toLocaleString();m?this.setState({grid:i,axis1:o,graphData:l,lastUpdatedAt:v},function(){var e=s.filter(function(e){return"relhumidity_pct"==e.sensedValue||"temp_celsius"==e.sensedValue}),t=u.sensedValue.length>1?u.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint(t)}):this.setState({grid:i,axis1:o,graphData:l,lastUpdatedAt:v})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(s.g)(e.sensedValue)==a});!i||!Object(s.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(s.g)(i.relatedEquipment)})||l.push({value:Object(s.g)(i.relatedEquipment),label:Object(s.g)(i.relatedEquipmentLabel),space:Object(s.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return g(this,void 0,void 0,function(){var t,n,a,l,i,u,m,c,h,p,g,v,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R,C,G,T,I,M,U,B,K,W,z=this;return f(this,function(f){switch(f.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=this.state,m=u.grid,c=u.axis1,h=u.graphData,p=u.lastUpdatedAt,n&&n.moncondevice?(g=Object(s.g)(n.topic),v=Object(s.g)(n.moncondevice),[4,Object(r.h)(g,a,l,h.columns.length>1)]):[3,3];case 1:return x=f.sent(),[4,Object(r.z)(v)];case 2:if(E=f.sent(),V=[],E[0]?(w=E[0],y=Object(s.g)(w.relayNames),V=y.split(",")):(V.push("Relay 1"),V.push("Relay 2"),V.push("Relay 3"),V.push("Relay 4")),b=[V[0]+" Amp"],L=[V[1]+" Amp"],H=[V[2]+" Amp"],A=[V[3]+" Amp"],N=["Nom. Source Volts"],D=[V[0]+" Watts"],P=[V[1]+" Watts"],_=[V[2]+" Watts"],S=[V[0]+" State"],O=[V[1]+" State"],j=[V[2]+" State"],k=[V[3]+" State"],q=["x"],b.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(new Date(a)),x.length>0)for(F=0;F<x.length;F++)(null===(R=x[F])||void 0===R?void 0:R.mAmps_relay1)&&(b.push(R.mAmps_relay1),L.push(R.mAmps_relay2),H.push(R.mAmps_relay3),A.push(R.mAmps_relay4),N.push(R.nominal_src_volts),D.push(R.power_Wt_relay1),P.push(R.power_Wt_relay2),_.push(R.power_Wt_relay3),C=Object(r.a)(parseInt(R.v4relay_state)),q.push(new Date(R.timestamp)),3==C.length?C="0"+C:2==C.length?C="00"+C:1==C.length&&(C="000"+C),G=C[3],T=C[2],I=C[1],M=C[0],S.push(G||"0"),O.push(T||"0"),j.push(I||"0"),k.push(M||"0"));p=x.length>0?null===(e=q[q.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",b.push(null),L.push(null),H.push(null),A.push(null),N.push(null),D.push(null),P.push(null),_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(new Date(l)),(U=[]).push(this.fetchEquipmentFromPoints("RelayV4",["mAmps_relay1","mAmps_relay2","mAmps_relay3","mAmps_relay4","power_Wt_relay1","power_Wt_relay2","power_Wt_relay3","Relay1_State","Relay2_State","Relay3_State","Relay4_State","nominal_src_volts"])),h={x:"x",columns:[q,b,L,H,A,D,P,_,S,O,j,k,N]},c.y.label="Amp, W, On/Off, Volts",B=Object(o.a)(5,a,l),K="",B.length>1?(W=((new Date).getTime()-B[0].getTime())/1e3,K=(W/=3600)>24?"%m-%d %H:%M":W<.3?"%H:%M:%S":"%H:%M"):K="%H:%M:%S",m.x.lines=[],B.forEach(function(e){m.x.lines.push({value:e,class:"grid4"})}),c.y.tick.format=function(e){return parseFloat(e).toFixed(0)},c.y.tick.values=[0,50,100,150,200,250,300],c.y.max=300,c.y.min=0,c.x.tick.format=K,c.x.tick.values=B,this.props.loadNextInsight(),Object(d.h)(g,this.callLiveUpdate),this.setState({grid:m,axis1:c,graphData:h,loading:!1,lastUpdatedAt:p,graphEquipment:U},function(){i&&z.changeAlarmStatus(!0)}),f.label=3;case 3:return[2]}})})},t.prototype.render=function(){var e,t=this,n=this.state,l=n.loading,r=n.graphData,o=n.axis1,u=n.grid,m=n.lastUpdatedAt,c=n.alarmSensedPoints,d=n.selectedAlarmPoint,h=n.graphDataAlarmPoint,p=n.indicateAlarm,g=n.graphEquipment,f=this.props,v=f.instance,x=f.buildingName,E=f.device,V=f.showAlarmPoints,w=f.equipment;return a.createElement("div",{className:"row col-md-12 device-graphs "+(p&&V?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),V&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",c&&c.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:d.sensedValue,onChange:function(e){t.selectAlarmPoint(e.target.value)}},c.map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),p&&a.createElement("a",{href:"#"+v+"/"+x+"/Alarms/OperationalAlarms/Device/"+Object(s.g)(E.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-8 sentence-break",href:"#"+v+"/"+x+"/Insights/Equipment/Graphs/RelayControl/"+Object(s.g)(E.moncondevice),target:"_blank",rel:"noreferrer noopener"},g&&g.length&&g.find(function(e){return"RelayV4"==e.graph})?g.find(function(e){return"RelayV4"==e.graph}).pointEquip.length&&g.find(function(e){return"RelayV4"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",g&&g.length&&g.find(function(e){return"RelayV4"==e.graph})?g.find(function(e){return"RelayV4"==e.graph}).pointEquip.length&&g.find(function(e){return"RelayV4"==e.graph}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",g&&g.length&&g.find(function(e){return"RelayV4"==e.graph})?g.find(function(e){return"RelayV4"==e.graph}).pointEquip.length&&g.find(function(e){return"RelayV4"==e.graph}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(s.g)(E.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(s.g)(E.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===w||void 0===w?void 0:w.map(function(e,t){return e.rdfsLabel+(t<w.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(s.g)(E.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(s.g)(E.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",m)),l?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:V&&(null===(e=h.columns)||void 0===e?void 0:e.length)>1?h:r,size:{height:300},axis:o,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}}))},t}(a.Component);t.a=v},2973:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(772)),i=n.n(l),r=n(715),s=n(802),o=n(11),u=n(803),m=n(122),c=n(736),d=n(124),h=n(760),p=(n.n(h),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}()),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphData:{x:"x",columns:[]},graphData2:{x:"x",columns:[]},graphData3:{x:"x",columns:[]},graphData4:{x:"x",columns:[]},graphData5:{x:"x",columns:[]},graphData6:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis2:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis3:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis4:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis5:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},axis6:{x:{type:"timeseries",tick:{fit:!1,multiline:!0,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],indicateAlarm1:!1,indicateAlarm2:!1,indicateAlarm3:!1,indicateAlarm4:!1,indicateAlarm5:!1,indicateAlarm6:!1,alarmSensedPoints:[],graphDataAlarmPoint1:{},graphDataAlarmPoint2:{},graphDataAlarmPoint3:{},graphDataAlarmPoint4:{},graphDataAlarmPoint5:{},graphDataAlarmPoint6:{},selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint5:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},selectedAlarmPoint6:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},graphEquipment:[]},n._fetchData=n._fetchData.bind(n),n.callLiveUpdate=n.callLiveUpdate.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e=this;return f(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(o.g)(e)&&Object(d.g)(Object(o.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(e){return g(this,void 0,void 0,function(){var t,n,a,l,i,r,s,d,h,p,g,v,x,E,V,w,y=this;return f(this,function(f){switch(f.label){case 0:return t=this.state,n=t.graphData,a=t.selectedAlarmPoint1,l=t.selectedAlarmPoint2,i=t.selectedAlarmPoint3,r=t.selectedAlarmPoint4,s=t.selectedAlarmPoint5,d=t.selectedAlarmPoint6,h=this.props,p=h.buildingName,g=h.devicePoints,v=h.showAlarmPoints,x=h.device,Object(m.a)(!0),v&&!e?[3,2]:(E=[],g&&g.length&&g.forEach(function(e){E.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue)})}),[4,Object(u.e)(c.a.OperationalAlarm,p,!1,0,50,null,null,[Object(o.g)(x.moncondevice)],null)]);case 1:return V=f.sent(),w=new Date(n.columns[0][1]),V=V.filter(function(e){return new Date(e.timeofalarm)>w}),this.setState({alarmSensedPoints:E,deviceAlarms:V},function(){if((null===E||void 0===E?void 0:E.length)>0&&n.columns.length>1){var e=E.filter(function(e){return"PowerA"==e.sensedValue||"PowerB"==e.sensedValue||"PowerB"==e.sensedValue||"PowerC"==e.sensedValue||"PowerSum"==e.sensedValue}),t=a.sensedValue.length>1?a.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";y.selectAlarmPoint1(t);var o=E.filter(function(e){return"VoltAB"==e.sensedValue||"VoltAC"==e.sensedValue||"VoltAB"==e.sensedValue}),u=l.sensedValue.length>1?l.sensedValue:(null===o||void 0===o?void 0:o.length)>0?o[o.length-1].sensedValue:"";y.selectAlarmPoint2(u);var m=E.filter(function(e){return"VoltA"==e.sensedValue||"VoltB"==e.sensedValue||"VoltC"==e.sensedValue}),c=i.sensedValue.length>1?i.sensedValue:(null===m||void 0===m?void 0:m.length)>0?m[m.length-1].sensedValue:"";y.selectAlarmPoint3(c);var h=E.filter(function(e){return"Freq"==e.sensedValue}),p=r.sensedValue.length>1?r.sensedValue:(null===h||void 0===h?void 0:h.length)>0?h[h.length-1].sensedValue:"";y.selectAlarmPoint4(p);var g=E.filter(function(e){return"EnergySumNR"==e.sensedValue}),f=s.sensedValue.length>1?s.sensedValue:(null===g||void 0===g?void 0:g.length)>0?g[g.length-1].sensedValue:"";y.selectAlarmPoint5(f);var v=E.filter(function(e){return"EnergyPosSumNR"==e.sensedValue}),x=d.sensedValue.length>1?d.sensedValue:(null===v||void 0===v?void 0:v.length)>0?v[v.length-1].sensedValue:"";y.selectAlarmPoint6(x)}}),[3,3];case 2:this.selectAlarmPoint1(""),this.selectAlarmPoint2(""),this.selectAlarmPoint3(""),this.selectAlarmPoint4(""),this.selectAlarmPoint5(""),this.selectAlarmPoint6(""),f.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint1=function(e){var t=this,n=this.state,a=n.graphData,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"PowerA"==e.sensedValueKey||"PowerB"==e.sensedValueKey||"PowerB"==e.sensedValueKey||"PowerC"==e.sensedValueKey||"PowerSum"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("PowerA"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("PowerB"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("PowerC"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Power C":"#e3e3e3",High:"grey","High-High":"red"}}}else if("PowerSum"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[4].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[4],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",PowerSum:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint1:r,graphDataAlarmPoint1:e,indicateAlarm1:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint1:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm1:s,graphDataAlarmPoint1:e,loading:!1})})},t.prototype.selectAlarmPoint2=function(e){var t=this,n=this.state,a=n.graphData2,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"VoltAB"==e.sensedValueKey||"VoltAC"==e.sensedValueKey||"VoltAB"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("VoltAB"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts AB":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltBC"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts BC":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltAC"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts AC":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint2:r,graphDataAlarmPoint2:e,indicateAlarm2:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint2:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm2:s,graphDataAlarmPoint2:e,loading:!1})})},t.prototype.selectAlarmPoint3=function(e){var t=this,n=this.state,a=n.graphData3,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"VoltA"==e.sensedValueKey||"VoltB"==e.sensedValueKey||"VoltC"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("VoltA"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts A":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltB"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[2].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[2],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts B":"#e3e3e3",High:"grey","High-High":"red"}}}else if("VoltC"==r.sensedValue){for(n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[3].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[3],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey","Volts C":"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint3:r,graphDataAlarmPoint3:e,indicateAlarm3:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint3:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm3:s,graphDataAlarmPoint3:e,loading:!1})})},t.prototype.selectAlarmPoint4=function(e){var t=this,n=this.state,a=n.graphData4,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"Freq"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("Freq"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",Freq:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint4:r,graphDataAlarmPoint4:e,indicateAlarm4:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint4:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm4:s,graphDataAlarmPoint4:e,loading:!1})})},t.prototype.selectAlarmPoint5=function(e){var t=this,n=this.state,a=n.graphData5,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"EnergySumNR"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("EnergySumNR"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EnergySumNR:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint5:r,graphDataAlarmPoint5:e,indicateAlarm5:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint5:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm5:s,graphDataAlarmPoint5:e,loading:!1})})},t.prototype.selectAlarmPoint6=function(e){var t=this,n=this.state,a=n.graphData6,l=n.alarmSensedPoints,i=n.deviceAlarms,r=l.find(function(t){return t.sensedValue===e}),s=i.length>0&&i.findIndex(function(e){return"EnergyPosSumNR"==e.sensedValueKey})>-1;this.setState({loading:!0},function(){var e={x:"x",columns:[],regions:{},colors:{}};if(r){if("EnergyPosSumNR"==r.sensedValue){for(var n=["Low-Low"],l=["Low"],i=["High"],o=["High-High"],u=0;u<a.columns[1].length-1;u++)n.push(r.minimumExtremeValue),l.push(r.minimumNormalValue),i.push(r.maximumNormalValue),o.push(r.maximumExtremeValue);e={x:"x",columns:[a.columns[0],n,l,a.columns[1],i,o],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:{"Low-Low":"red",Low:"grey",EnergyPosSumNR:"#e3e3e3",High:"grey","High-High":"red"}}}else e=a;t.setState({selectedAlarmPoint6:r,graphDataAlarmPoint6:e,indicateAlarm6:s,loading:!1})}else e=a,t.setState({selectedAlarmPoint6:{sensedValue:"",maximumExtremeValue:"",minimumExtremeValue:"",maximumNormalValue:"",minimumNormalValue:""},indicateAlarm6:s,graphDataAlarmPoint6:e,loading:!1})})},t.prototype.callLiveUpdate=function(e){var t,n=this,a=this.state,l=a.graphData,i=a.graphData2,r=a.graphData3,s=a.graphData4,o=a.graphData5,u=a.graphData6,m=a.axis1,c=a.grid,d=a.alarmSensedPoints,h=a.selectedAlarmPoint1,p=a.selectedAlarmPoint2,g=a.selectedAlarmPoint3,f=a.selectedAlarmPoint4,v=a.selectedAlarmPoint5,x=a.selectedAlarmPoint6,E=this.props.showAlarmPoints;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var V=this.props.liveGraphRange;if(l.columns.length>1&&t){l.columns[0].splice(1,1),l.columns[0].push(t),l.columns[1].splice(1,1),l.columns[1].push(null===e||void 0===e?void 0:e.PowerA),l.columns[2].splice(1,1),l.columns[2].push(null===e||void 0===e?void 0:e.PowerB),l.columns[3].splice(1,1),l.columns[3].push(null===e||void 0===e?void 0:e.PowerC),l.columns[4].splice(1,1),l.columns[4].push(null===e||void 0===e?void 0:e.PowerSum),i.columns[1].splice(1,1),i.columns[1].push(null===e||void 0===e?void 0:e.VoltAB),i.columns[2].splice(1,1),i.columns[2].push(null===e||void 0===e?void 0:e.VoltAC),i.columns[3].splice(1,1),i.columns[3].push(null===e||void 0===e?void 0:e.VoltBC),r.columns[1].splice(1,1),r.columns[1].push(null===e||void 0===e?void 0:e.VoltA),r.columns[2].splice(1,1),r.columns[2].push(null===e||void 0===e?void 0:e.VoltB),r.columns[3].splice(1,1),r.columns[3].push(null===e||void 0===e?void 0:e.VoltC),s.columns[1].splice(1,1),s.columns[1].push(null===e||void 0===e?void 0:e.Freq),o.columns[1].splice(1,1),o.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.EnergySumNR)/1e3),u.columns[1].splice(1,1),u.columns[1].push(parseFloat(null===e||void 0===e?void 0:e.EnergyPosSumNR)/1e3),(t.getTime()-l.columns[0][2].getTime())/6e4>V&&l.columns[0].splice(1,1),m.x.tick.values[2]&&m.x.tick.values[1].getTime()&&m.x.tick.values[2].getTime()-m.x.tick.values[1].getTime()<t.getTime()-m.x.tick.values[m.x.tick.values.length-1]&&(m.x.tick.values.splice(0,1),c.x.lines.splice(0,1),t.setSeconds(0),V>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),m.x.tick.values.push(t),c.x.lines.push({value:t,class:"grid4"}));var w=null===t||void 0===t?void 0:t.toLocaleString();E?this.setState({grid:c,axis1:m,graphData:l,graphData2:i,graphData3:r,graphData4:s,graphData5:o,graphData6:u,lastUpdatedAt:w},function(){var e=d.filter(function(e){return"PowerA"==e.sensedValue||"PowerB"==e.sensedValue||"PowerB"==e.sensedValue||"PowerC"==e.sensedValue||"PowerSum"==e.sensedValue}),t=h.sensedValue.length>1?h.sensedValue:(null===e||void 0===e?void 0:e.length)>0?e[e.length-1].sensedValue:"";n.selectAlarmPoint1(t);var a=d.filter(function(e){return"VoltAB"==e.sensedValue||"VoltAC"==e.sensedValue||"VoltAB"==e.sensedValue}),l=p.sensedValue.length>1?p.sensedValue:(null===a||void 0===a?void 0:a.length)>0?a[a.length-1].sensedValue:"";n.selectAlarmPoint2(l);var i=d.filter(function(e){return"VoltA"==e.sensedValue||"VoltB"==e.sensedValue||"VoltC"==e.sensedValue}),r=g.sensedValue.length>1?g.sensedValue:(null===i||void 0===i?void 0:i.length)>0?i[i.length-1].sensedValue:"";n.selectAlarmPoint3(r);var s=d.filter(function(e){return"Freq"==e.sensedValue}),o=f.sensedValue.length>1?f.sensedValue:(null===s||void 0===s?void 0:s.length)>0?s[s.length-1].sensedValue:"";n.selectAlarmPoint4(o);var u=d.filter(function(e){return"EnergySumNR"==e.sensedValue}),m=v.sensedValue.length>1?v.sensedValue:(null===u||void 0===u?void 0:u.length)>0?u[u.length-1].sensedValue:"";n.selectAlarmPoint5(m);var c=d.filter(function(e){return"EnergyPosSumNR"==e.sensedValue}),E=x.sensedValue.length>1?x.sensedValue:(null===c||void 0===c?void 0:c.length)>0?c[c.length-1].sensedValue:"";n.selectAlarmPoint6(E)}):this.setState({grid:c,axis1:m,graphData:l,graphData2:i,graphData3:r,graphData4:s,graphData5:o,graphData6:u,lastUpdatedAt:w})}},t.prototype.fetchEquipmentFromPoints=function(e,t){var n=this.props.devicePoints,a=Object(),l=[];if(n&&n.length>0)for(var i=function(e){var a=t[e],i=n.find(function(e){return Object(o.g)(e.sensedValue)==a});!i||!Object(o.g)(i.point)||l&&l.length&&l.find(function(e){return e.value==Object(o.g)(i.relatedEquipment)})||l.push({value:Object(o.g)(i.relatedEquipment),label:Object(o.g)(i.relatedEquipmentLabel),space:Object(o.g)(i.relatedEquipmentSpaceLabel)})},r=0;r<t.length;r++)i(r);return a.graph=e,a.pointEquip=l,a},t.prototype._fetchData=function(){var e;return g(this,void 0,void 0,function(){var t,n,a,l,i,u,m,c,h,p,g,v,x,E,V,w,y,b,L,H,A,N,D,P,_,S,O,j,k,q,F,R,C,G,T,I,M,U,B,K,W,z,Z,Y,$,J=this;return f(this,function(f){switch(f.label){case 0:return t=this.props,n=t.device,a=t.from,l=t.to,i=t.showAlarmPoints,u=t.graphsList,m=this.state,c=m.grid,h=m.axis1,p=m.axis2,g=m.axis3,v=m.axis4,x=m.axis5,E=m.axis6,V=m.graphData,w=m.graphData2,y=m.graphData3,b=m.graphData4,L=m.graphData5,H=m.graphData6,A=m.lastUpdatedAt,n&&n.moncondevice?(N=Object(o.g)(n.topic),(D=N?N.split(","):[]).length&&D[0]?[4,Object(r.n)(D[0],a,l,V.columns.length>1)]:[3,2]):[3,2];case 1:P=f.sent(),S=["EnergyPOSSUM"],O=["EnergySumNR"],j=["EnergyPosSumNR"],k=["PowerSum"],q=["Power A"],F=["Power B"],R=["Power C"],C=["Volts A"],G=["Volts B"],T=["Volts C"],I=["VoltsAvgLL"],M=["Volts AB"],U=["Volts AC"],B=["Volts BC"],K=["Freq"],W=["x"],(_=["EnerygySum"]).push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(null),T.push(null),I.push(null),M.push(null),U.push(null),B.push(null),K.push(null),W.push(new Date(a)),P.length>0&&P.forEach(function(e){e&&(_.push(e.EnergySum),S.push(e.EnergyPosSum),O.push(+e.EnergySumNR/1e3),j.push(+e.EnergyPosSumNR/1e3),k.push(e.PowerSum),q.push(e.PowerA),F.push(e.PowerB),R.push(e.PowerC),C.push(e.VoltA),G.push(e.VoltB),T.push(e.VoltC),I.push(e.VoltAvgLL),M.push(e.VoltAB),U.push(e.VoltAC),B.push(e.VoltBC),K.push(e.Freq),W.push(new Date(e.timestamp)))}),A=P.length>0?null===(e=W[W.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",_.push(null),S.push(null),O.push(null),j.push(null),k.push(null),q.push(null),F.push(null),R.push(null),C.push(null),G.push(null),T.push(null),I.push(null),M.push(null),U.push(null),B.push(null),K.push(null),W.push(new Date(l)),z=[],u&&u.length&&(z.push(this.fetchEquipmentFromPoints(u[0]||"Power",["powerA","powerB","powerC","powerSum"])),z.push(this.fetchEquipmentFromPoints(u[1]||"Phase Voltage",["voltAB","voltBC","voltAC"])),z.push(this.fetchEquipmentFromPoints(u[2]||"Voltage",["voltA","voltB","voltC"])),z.push(this.fetchEquipmentFromPoints(u[3]||"Frequency",["freq"])),z.push(this.fetchEquipmentFromPoints(u[4]||"Energy Sum Resettable",["energySumNR"])),z.push(this.fetchEquipmentFromPoints(u[5]||"Positive Energy Sum Non-resettable",["energyPosSumNR"]))),V={x:"x",columns:[W,q,F,R,k]},w={x:"x",columns:[W,M,B,U]},y={x:"x",columns:[W,C,G,T]},b={x:"x",columns:[W,K]},L={x:"x",columns:[W,O]},H={x:"x",columns:[W,j]},h.y.label="Watts",p.y.label="Volts",g.y.label="Volts",v.y.label="Hz",x.y.label="MWh",E.y.label="MWh",Z=Object(s.a)(5,a,l),Y="",Z.length>1?($=((new Date).getTime()-Z[0].getTime())/1e3,Y=($/=3600)>24?"%m-%d %H:%M":$<.3?"%H:%M:%S":"%H:%M"):Y="%H:%M:%S",c.x.lines=[],Z.forEach(function(e){c.x.lines.push({value:e,class:"grid4"})}),h.y.tick.format=function(e){return parseFloat(e).toFixed(1)},p.y.tick.format=function(e){return parseFloat(e).toFixed(0)},g.y.tick.format=function(e){return parseFloat(e).toFixed(0)},v.y.tick.format=function(e){return parseFloat(e).toFixed(1)},x.y.tick.format=function(e){return parseFloat(e).toFixed(1)},E.y.tick.format=function(e){return parseFloat(e).toFixed(1)},h.y.tick.values=[0,1e4,2e4,3e4,4e4],p.y.tick.values=[0,50,100,150,200,250],g.y.tick.values=[0,50,100,150],v.y.tick.values=[0,20,40,60,80],x.y.tick.values=[0,40,80,120,160],E.y.tick.values=[0,40,80,120,160],h.y.max=4e4,h.y.min=0,p.y.max=250,p.y.min=0,g.y.max=150,g.y.min=0,v.y.max=80,v.y.min=0,x.y.max=160,x.y.min=0,E.y.max=160,E.y.min=0,h.x.tick.format=Y,p.x.tick.format=Y,g.x.tick.format=Y,v.x.tick.format=Y,x.x.tick.format=Y,E.x.tick.format=Y,h.x.tick.values=Z,p.x.tick.values=Z,g.x.tick.values=Z,v.x.tick.values=Z,x.x.tick.values=Z,E.x.tick.vawlues=Z,this.props.loadNextInsight(),Object(d.h)(D,this.callLiveUpdate),this.setState({grid:c,axis1:h,axis2:p,axis3:g,axis4:v,axis5:x,axis6:E,graphData:V,graphData2:w,graphData3:y,graphData4:b,graphData5:L,graphData6:H,lastUpdatedAt:A,loading:!1,graphEquipment:z},function(){i&&J.changeAlarmStatus(!0)}),f.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e,t,n,l,r,s,u=this,m=this.state,c=m.loading,d=m.graphData,h=m.graphData2,p=m.graphData3,g=m.graphData4,f=m.graphData5,v=m.graphData6,x=m.axis1,E=m.axis2,V=m.axis3,w=m.axis4,y=m.axis5,b=m.axis6,L=m.grid,H=m.lastUpdatedAt,A=m.graphDataAlarmPoint1,N=m.graphDataAlarmPoint2,D=m.graphDataAlarmPoint3,P=m.graphDataAlarmPoint4,_=m.graphDataAlarmPoint5,S=m.graphDataAlarmPoint6,O=m.indicateAlarm1,j=m.indicateAlarm2,k=m.indicateAlarm3,q=m.indicateAlarm4,F=m.indicateAlarm5,R=m.indicateAlarm6,C=m.alarmSensedPoints,G=m.selectedAlarmPoint1,T=m.selectedAlarmPoint2,I=m.selectedAlarmPoint3,M=m.selectedAlarmPoint4,U=m.selectedAlarmPoint5,B=m.selectedAlarmPoint6,K=m.graphEquipment,W=this.props,z=W.graphsList,Z=W.instance,Y=W.buildingName,$=W.device,J=W.showAlarmPoints,Q=W.equipment,X=z&&z.length&&z[0]?z[0]:"Power",ee=z&&z.length&&z[1]?z[1]:"Phase Voltage",te=z&&z.length&&z[2]?z[1]:"Voltage",ne=z&&z.length&&z[3]?z[1]:"Frequency",ae=z&&z.length&&z[4]?z[1]:"Energy Sum Resettable",le=z&&z.length&&z[5]?z[1]:"Positive Energy Sum Non-resettable";return a.createElement(a.Fragment,null,z.indexOf("Power")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(O&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:G.sensedValue,onChange:function(e){u.selectAlarmPoint1(e.target.value)}},C.filter(function(e){return"PowerA"==e.sensedValue||"PowerB"==e.sensedValue||"PowerB"==e.sensedValue||"PowerC"==e.sensedValue||"PowerSum"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),O&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==X})?K.find(function(e){return e.graph==X}).pointEquip.length&&K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Power"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==X})?K.find(function(e){return e.graph==X}).pointEquip.length&&K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==X})?K.find(function(e){return e.graph==X}).pointEquip.length&&K.find(function(e){return e.graph==X}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(e=A.columns)||void 0===e?void 0:e.length)>1?A:d,size:{height:300},axis:x,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})),z.indexOf("Phase Voltage")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(j&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:T.sensedValue,onChange:function(e){u.selectAlarmPoint2(e.target.value)}},C.filter(function(e){return"VoltAB"==e.sensedValue||"VoltAC"==e.sensedValue||"VoltAB"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),j&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ee})?K.find(function(e){return e.graph==ee}).pointEquip.length&&K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Phase Voltage"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ee})?K.find(function(e){return e.graph==ee}).pointEquip.length&&K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ee})?K.find(function(e){return e.graph==ee}).pointEquip.length&&K.find(function(e){return e.graph==ee}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(t=N.columns)||void 0===t?void 0:t.length)>1?N:h,size:{height:300},axis:E,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Voltage")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(k&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:I.sensedValue,onChange:function(e){u.selectAlarmPoint3(e.target.value)}},C.filter(function(e){return"VoltA"==e.sensedValue||"VoltB"==e.sensedValue||"VoltC"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),k&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==te})?K.find(function(e){return e.graph==te}).pointEquip.length&&K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Voltage"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==te})?K.find(function(e){return e.graph==te}).pointEquip.length&&K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==te})?K.find(function(e){return e.graph==te}).pointEquip.length&&K.find(function(e){return e.graph==te}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(n=D.columns)||void 0===n?void 0:n.length)>1?D:p,size:{height:300},axis:V,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Frequency")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(q&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:M.sensedValue,onChange:function(e){u.selectAlarmPoint4(e.target.value)}},C.filter(function(e){return"Freq"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),q&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ne})?K.find(function(e){return e.graph==ne}).pointEquip.length&&K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-3 sentence-break"}," ","Frequency"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ne})?K.find(function(e){return e.graph==ne}).pointEquip.length&&K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ne})?K.find(function(e){return e.graph==ne}).pointEquip.length&&K.find(function(e){return e.graph==ne}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(l=P.columns)||void 0===l?void 0:l.length)>1?P:g,size:{height:300},axis:w,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Energy Sum Resettable")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(F&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:U.sensedValue,onChange:function(e){u.selectAlarmPoint5(e.target.value)}},C.filter(function(e){return"EnergySumNR"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),F&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==ae})?K.find(function(e){return e.graph==ae}).pointEquip.length&&K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-4 sentence-break"}," ","Energy Sum Resettable"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==ae})?K.find(function(e){return e.graph==ae}).pointEquip.length&&K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==ae})?K.find(function(e){return e.graph==ae}).pointEquip.length&&K.find(function(e){return e.graph==ae}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(r=_.columns)||void 0===r?void 0:r.length)>1?_:f,size:{height:300},axis:y,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),z.indexOf("Positive Energy Sum Non-resettable")>-1&&a.createElement("div",{className:"row col-md-12 device-graphs "+(R&&J?"alarm-graph":""),id:"divGraphs"},a.createElement("br",null),J&&a.createElement("div",{className:"alarm-limit-select"},"Limits For: "," ",C&&C.length>0?a.createElement("select",{className:"alarm-points-list",id:"spaces",value:B.sensedValue,onChange:function(e){u.selectAlarmPoint6(e.target.value)}},C.filter(function(e){return"EnergyPosSumNR"==e.sensedValue}).map(function(e,t){return a.createElement("option",{key:t,value:e.sensedValue},e.sensedValue," ")})):a.createElement(a.Fragment,null,"No Alarm points created"),R&&a.createElement("a",{href:"#"+Z+"/"+Y+"/Alarms/OperationalAlarms/Device/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},a.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),a.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},a.createElement("a",{className:"col-md-5 sentence-break",href:"#"+Z+"/"+Y+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(o.g)($.moncondevice),target:"_blank",rel:"noreferrer noopener"},K&&K.length&&K.find(function(e){return e.graph==le})?K.find(function(e){return e.graph==le}).pointEquip.length&&K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),a.createElement("span",{className:"col-md-4 sentence-break"}," ","Pos. Energy Sum Non-resettable"),a.createElement("div",{className:"tooltiptextDashboard"},a.createElement("span",null,"Equipment: ",K&&K.length&&K.find(function(e){return e.graph==le})?K.find(function(e){return e.graph==le}).pointEquip.length&&K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),a.createElement("br",null),a.createElement("span",null,"Space: ",K&&K.length&&K.find(function(e){return e.graph==le})?K.find(function(e){return e.graph==le}).pointEquip.length&&K.find(function(e){return e.graph==le}).pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),a.createElement("br",null),a.createElement("span",null,"Floor: ",Object(o.g)($.floorRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Zone: ",Object(o.g)($.zoneRdfsLabel)," "),a.createElement("br",null),a.createElement("span",null,"Device Rel. Equip.: ",null===Q||void 0===Q?void 0:Q.map(function(e,t){return e.rdfsLabel+(t<Q.length-1?", ":" ")})," "),a.createElement("br",null),a.createElement("span",null,"Device: ",Object(o.g)($.rdfsLabel)||"No device assigned"," "),a.createElement("br",null),a.createElement("span",null,"Device Space: ",Object(o.g)($.spaceRdfsLabel)," ")),a.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",H)),c?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(i.a,{data:J&&(null===(s=S.columns)||void 0===s?void 0:s.length)>1?S:v,size:{height:300},axis:b,grid:L,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=v},2974:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(743)),i=n(1012),r=n(772),s=n.n(r),o=n(760),u=(n.n(o),n(715)),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,i){function r(e){try{o(a.next(e))}catch(e){i(e)}}function s(e){try{o(a.throw(e))}catch(e){i(e)}}function o(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}o((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(l=2&i[0]?a.return:i[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,i[1])).done)return l;switch(a=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={asisData:[],seasonList:[],graphData1:{x:"Date",columns:[],type:"bar"},grid1:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{count:30,format:"%m-%d"}},y:{label:"kWh",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},graphData2:{x:"Date",columns:[],type:"bar"},grid2:{x:{lines:[{}]},y:{show:!0}},axis2:{x:{type:"timeseries",tick:{count:30,format:"%m-%d"}},y:{label:"kWh",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}},y2:{show:!0,label:"$",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,selectedSeason:""},n._fetchData=n._fetchData.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return c(this,void 0,void 0,function(){return d(this,function(e){return this._fetchData(),[2]})})},t.prototype.fetchVeifyDetail=function(e){return c(this,void 0,void 0,function(){return d(this,function(e){return[2]})})},t.prototype._fetchData=function(){return c(this,void 0,void 0,function(){var e,t,n=this;return d(this,function(a){switch(a.label){case 0:return e=this.props.buildingName,t=this.props.projectName,[4,Object(l.o)(e,"",t).then(function(e){return c(n,void 0,void 0,function(){var t,n,a,r,s,o,u,m,c,h,p,g,f,v,x=this;return d(this,function(d){switch(d.label){case 0:return e&&e[0]&&e[0].ontology?(t=[],0,0,0,0,n=[],a=e[0],[4,Object(l.l)(a.ontology)]):[3,7];case 1:if(!((r=d.sent())&&r.length>0))return[3,7];for((t=r.sort(function(e,t){return e.seasonSequence>t.seasonSequence?1:t.seasonSequence>e.seasonSequence?-1:0})).map(function(e){var t=e.analysisName+": "+(e.seasonType&&"both"==e.seasonType.toLocaleLowerCase().trim()?e.seasonType+": "+("cooling"==e.selectedAnalysis?"Cooling":"Heating"):e.seasonType);n.push({label:t,value:e.ontology})}),s=0;s<t.length;s++)o=t[s],o.totalConsumedEnergyASIS,o.totalConsumedEnergyECM,o.totalConsumedEnergyCostASIS,o.totalConsumedEnergyCostECM;return 0==a.measureAnalysis.length?a.measureAnalysis=[{staticSeasonName:"Summer",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value},{staticSeasonName:"Fall",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value},{staticSeasonName:"Winter",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value},{staticSeasonName:"Spring",selectedSeasonName:n[0].label,selectedSeasonOntology:n[0].value}]:a.measureAnalysis.length,u=[],m=[],t&&t.length>0?(c=[],h=[],(p=t.sort(function(e,t){return new Date(e.asisStartDate)>new Date(t.asisStartDate)?1:new Date(t.asisStartDate)>new Date(e.asisStartDate)?-1:0}))&&p.length>0?(g=p[0],[4,Object(l.k)(g.importDataASISOntology).then(function(e){u=e?e[0].fileData:[]})]):[3,6]):[3,7];case 2:return d.sent(),[4,Object(l.k)(g.importDataECMOntology).then(function(e){m=e?e[0].fileData:[]})];case 3:return d.sent(),[4,Object(i.c)(u,new Date(g.asisStartDate),new Date(g.asisEndDate),g.noaaStation.value,parseFloat(g.basepointCD),parseFloat(g.basepointHD),g.isMeasureFile)];case 4:return f=d.sent(),[4,Object(i.c)(m,new Date(g.ecmStartDate),new Date(g.ecmEndDate),g.noaaStation.value,parseFloat(g.basepointCD),parseFloat(g.basepointHD),g.isMeasureFile)];case 5:v=d.sent(),c.push.apply(c,f),h.push.apply(h,v),d.label=6;case 6:this.setState({seasonList:t,asisData:u},function(){x.energyConsumptionGraph()}),d.label=7;case 7:return[2]}})})}).catch(function(e){console.log(e)})];case 1:return a.sent(),[2]}})})},t.prototype.energyConsumptionGraph=function(){return c(this,void 0,void 0,function(){var e,t,n,a,l,i,r,s,o,m,c,h,p,g,f,v,x,E,V,w,y,b,L,H;return d(this,function(d){switch(d.label){case 0:e=this.state.asisData,t=this.state,n=t.graphData1,a=t.axis1,l=t.grid1,i=t.graphData2,r=t.axis2,s=t.grid2,o=new Date,m=new Date,o.setMonth(o.getMonth()-1),o.setHours(0,0,0,0),c=["ECM Energy Consumption (Metered)"],h=["Date"],p=["Asis Consumption (Projected)"],g=["Energy Saving"],f=["Energy Savings $ at 10.42 cents per unit"],v=["Tons CO2 emission reduction at 0.000709 tons per unit"],x=new Date(o),d.label=1;case 1:return x<=m?((E=new Date(x)).setHours(23,59,59,0),[4,Object(u.n)("michaels/5_125/wn_basicreg1",x,E,!1)]):[3,4];case 2:V=d.sent(),w=V[0],y=V[V.length-1],w&&y?c.push(""+(y.EnergyPosSum-w.EnergyPosSum)):c.push("0"),h.push(new Date(x)),d.label=3;case 3:return x.setDate(x.getDate()+1),[3,1];case 4:for(b=function(t){var n=new Date(h[t]),a=0;e.filter(function(e){if(+e.Date.split("/")[1]==n.getDate())return e}).forEach(function(e){a+=+e.ValueSum}),p.push(a),l.x.lines.push({value:n,class:"grid4"}),s.x.lines.push({value:n,class:"grid4"})},L=1;L<h.length-1;L++)b(L);for(L=1;L<p.length-1;L++)+p[L]&&+c[L]?(H=+p[L]-+c[L],g.push(H),f.push(.01042*H),v.push(709e-6*H)):(g.push(0),f.push(0));return n={x:"Date",columns:[h,c,p],type:"bar"},i={x:"Date",columns:[h,g,f],groups:[["Energy Saving"]],axes:{"Energy Savings $ at 10.42 cents per unit":"y"},type:"bar",types:{"Energy Savings $ at 10.42 cents per unit":"line"}},a.y.label="KwH",r.y.tick.values=[-2e3,-1e3,0,1e3,2e3],r.y.tick.max=2e3,r.y.tick.min=-2e3,r.y2.tick.values=[-40,-20,0,20,40],r.y2.tick.max=40,r.y2.tick.min=-40,this.setState({loading:!1,graphData1:n,axis1:a,grid1:l,graphData2:i,grid2:s}),[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,n=e.graphData1,l=e.grid1,i=e.axis1,r=e.graphData2,o=e.axis2,u=e.grid2;return a.createElement(a.Fragment,null,a.createElement("div",{className:"row col-md-12 device-graphs mt-22 ",id:"divGraphs"},t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(s.a,{data:n,size:{height:500},axis:i,grid:l,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),a.createElement("div",{className:"row col-md-12 device-graphs mt-22 ",id:"divGraphs"},t?a.createElement("div",{className:"graph-box-loader"},a.createElement("div",{className:"loader center-object"})):a.createElement(s.a,{data:r,size:{height:500},axis:o,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(a.Component);t.a=h}});