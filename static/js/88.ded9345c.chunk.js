webpackJsonp([88],{1117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=(n.n(o),n(1062)),a=n(99),l=n(634),r=n(21),c=n(29),s=n(633),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function l(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(l,r)}c((o=o.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var n,o,i,a,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){l=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){l.label=a[1];break}if(6===a[0]&&l.label<i[1]){l.label=i[1],i=a;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(a);break}i[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}},d=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],l=0,r=a.length;l<r;l++,i++)o[i]=a[l];return o},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_allPoints:[],_plannedPoints:[],pointObj:Object(),isEdit:!1,isView:!1,isDeviceForm:!1,ImportFileData:[],point:Object(),monconDevices:[],selectedMonconDeviceFilter:"",search:""},n.handlePointChange=n.handlePointChange.bind(n),n._fetchPoints=n._fetchPoints.bind(n),n.openEditForm=n.openEditForm.bind(n),n.closePointFormDailoge=n.closePointFormDailoge.bind(n),n.save=n.save.bind(n),n.handlePointForm=n.handlePointForm.bind(n),n.setPointState=n.setPointState.bind(n),n.handleMonconFilterChange=n.handleMonconFilterChange.bind(n),n.search_filter=n.search_filter.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return u(this,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return this.props.buildingName?(this.props.asset?(e={point:"",tag:"",pointId:"",notes:"",unit:"",pointDevice:"",pointType:"Sensor",pointLabel:"",asset:this.props.asset,space:"",s3FileName:"",commissioningDate:"",installDate:"",link1:"",link2:"",monconDevice:"",sinkPointDescription:"",softwarePointDescription:"",sourcePointDescription:"",webhook:"",component:"",floor:"",assetLabel:"",componentLabel:"",floorLabel:"",spaceLabel:"",pointState:""},this.setState({pointObj:e})):(e={point:"",tag:"",pointId:"",notes:"",unit:"",pointDevice:"",pointType:"Sensor",pointLabel:"",asset:"",space:"",s3FileName:"",commissioningDate:"",installDate:"",link1:"",link2:"",monconDevice:"",sinkPointDescription:"",softwarePointDescription:"",sourcePointDescription:"",webhook:"",component:"",floor:"",assetLabel:"",componentLabel:"",floorLabel:"",spaceLabel:"",pointState:""},this.setState({pointObj:e})),[4,this._fetchPoints()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.closePointFormDailoge=function(e,t){var n=this.state.pointObj;n.pointDevice=t?t.monitoringControl:n.pointDevice,this.setState({isDeviceForm:e,pointObj:n})},t.prototype.save=function(){},t.prototype._fetchPoints=function(){return u(this,void 0,void 0,function(){var e,t,n,o,i,s,p,u,h;return m(this,function(m){switch(m.label){case 0:return e=this.props,t=e.asset,n=e.buildingName,o=e.equipmentName,i=e.spaceName,s=this.state.monconDevices,s=[],p=[],u=[],Object(a.a)(!0),t&&t.length>0?[4,Object(l.i)(n,null,t).then(function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++){var n=e[t];Object(r.g)(n.point)&&Object(r.g)(n.pointLabel)&&Object(c.y)(Object(r.g)(n.point),Object(r.g)(n.pointLabel))}p=d(e),u=d(e)}).catch(function(e){return e})]:[3,2];case 1:return m.sent(),[3,4];case 2:return[4,Object(l.i)(n).then(function(e){p=d(e),u=d(e)}).catch(function(e){return e})];case 3:m.sent(),m.label=4;case 4:return p.forEach(function(e){-1==s.findIndex(function(t){return t.ontology==Object(r.g)(e.monconDevice)})&&s.push({ontology:Object(r.g)(e.monconDevice),rdfsLabel:Object(r.g)(e.monconRdfsLabel)})}),h=p&&p.filter(function(e){return Object(r.g)(e.asset)==o}),(o||i)&&(p=h.length>0?h:p&&p.filter(function(e){return Object(r.g)(e.space)==i}),this.setState({_allPoints:d(p),_plannedPoints:d(p),monconDevices:s})),o||i||this.setState({_allPoints:d(p),_plannedPoints:d(u),monconDevices:s}),Object(a.a)(!1),[2]}})})},t.prototype.handleMonconFilterChange=function(e){var t=this.state,n=t._plannedPoints,o=t._allPoints,i=t.point;o&&o.length>0&&(n=o,i.pointState?(n=o.filter(function(e){return Object(r.g)(e.pointState)==i.pointState}),i.pointType&&(n=n.filter(function(e){return Object(r.g)(e.pointType)==i.pointType}))):i.pointType&&(n=o.filter(function(e){return Object(r.g)(e.pointType)==i.pointType}))),e&&(n=n.filter(function(t){return Object(r.g)(t.monconDevice)==e})),this.setState({_plannedPoints:n,selectedMonconDeviceFilter:e})},t.prototype.handlePointChange=function(e){this.setState({pointObj:e})},t.prototype.openEditForm=function(e){var t=this.props,n=t.buildingName,o=t.instance;e?this.setState({isEdit:!1,isView:!0},function(){window.location.hash=o+"/"+n+"/PointForm"}):this.setState({isEdit:!0,isView:!1},function(){window.location.hash=o+"/"+n+"/PointForm"})},t.prototype.handlePointForm=function(e){return u(this,void 0,void 0,function(){var t,n,o,i;return m(this,function(a){return t=[],n=this.state.point,o=e.target.name,e.target.value&&""!=e.target.value?(n[""+o]=e.target.value,(i=this.state._allPoints)&&i&&i.length>0&&(t=i,n.pointState?(t=i.filter(function(e){return Object(r.g)(e.pointState)==n.pointState}),n.pointType&&(t=t.filter(function(e){return Object(r.g)(e.pointType)==n.pointType}))):n.pointType&&(t=i.filter(function(e){return Object(r.g)(e.pointType)==n.pointType}))),t||t.length>0?this.setState({point:n,_plannedPoints:t}):this.setState({point:n,_plannedPoints:[]})):this.setState({point:Object(),_plannedPoints:this.state._allPoints}),[2]})})},t.prototype.setPointState=function(){return u(this,void 0,void 0,function(){var e,t,n,o,i;return m(this,function(a){for(e=this.state._allPoints,t=[],n=this.state.point,o=0;o<e.length;o++)e&&e[o]&&e.length>0&&e[o]&&e[o].pointState&&Object(r.g)(e[o].pointState)&&Object(r.g)(e[o].pointState)==n.pointState&&(t||(t=[]),i=e[o],t.push(i));return t&&t.length,this.setState({_plannedPoints:t}),[2]})})},t.prototype.search_filter=function(e){return u(this,void 0,void 0,function(){return m(this,function(t){switch(t.label){case 0:return[4,this.setState({search:e.target.value})];case 1:return t.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,a=t.instance,l=this.state,c=l._plannedPoints,p=l.point,u=l.monconDevices,m=l.selectedMonconDeviceFilter,d=l.search,h=c.filter(function(e){return Object(r.g)(e.pointLabel).toLowerCase().includes(d.toLowerCase().trim())});return o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-4 col-xs-12"},o.createElement("div",{className:"col-md-4 col-xs-12 px-0"},o.createElement("h6",{style:{marginTop:"10px"}},"Point State:")),o.createElement("div",{className:"col-md-8 col-xs-12"},o.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(t){return e.handlePointForm(t)},value:p.pointState?p.pointState:""},o.createElement("option",{value:""},"Select Point State"),o.createElement("option",{value:"Planned"},"Planned"),o.createElement("option",{value:"Ordered"},"Ordered"),o.createElement("option",{value:"InInventory"},"In Inventory"),o.createElement("option",{value:"ReleasedForInstall"},"Released for Install"),o.createElement("option",{value:"Installed"},"Installed"),o.createElement("option",{value:"Testing"},"Testing"),o.createElement("option",{value:"Existing"},"Existing"),o.createElement("option",{value:"Retired"},"Retired"),o.createElement("option",{value:"CommittedToSell"},"Committed to Sell"),o.createElement("option",{value:"Sold"},"Sold")))),o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("div",{className:"col-md-4 col-xs-12 px-0"},o.createElement("h6",{style:{marginTop:"10px"}},"Point Type:")),o.createElement("div",{className:"col-md-8 col-xs-12"},o.createElement("select",{className:"form-control",id:"pointType",name:"pointType",onChange:function(t){return e.handlePointForm(t)},value:p.pointType?p.pointType:""},o.createElement("option",{value:""},"Select Point Type"),o.createElement("option",{value:"Sensed"},"Sensed"),o.createElement("option",{value:"Manual"},"Manual"),o.createElement("option",{value:"Virtual"},"Virtual"),o.createElement("option",{value:"Wired"},"Wired")))),o.createElement("div",{className:"col-md-5 col-xs-12"},o.createElement("div",{className:"dropdown pull-right"},o.createElement(s.a,{filename:"PointsList",data:c,ElementID:"PointsList"})),o.createElement("button",{type:"button",className:"btn btn-dark pull-right",style:{marginLeft:"5px"},onClick:function(){window.location.hash=a+"/"+n+"/AddMultiplePoints"}},o.createElement("i",{className:"fa fa-plus"}),"Add Multiple Points"),o.createElement("div",{className:"pull-right"},o.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){window.location.hash=a+"/"+n+"/PointForm"}},o.createElement("i",{className:"fa fa-plus"})," Create New Point ")),"\xa0")),o.createElement("div",{className:"row",style:{marginTop:"5px"}},o.createElement("div",{className:"col-md-4 col-xs-12"},o.createElement("div",{className:"col-md-4 col-xs-12 px-0"},o.createElement("h6",{style:{marginTop:"10px"}},"Moncon Device:")),o.createElement("div",{className:"col-md-8 col-xs-12"},o.createElement("select",{className:"form-control",id:"monconDevice",name:"monconDevice",onChange:function(t){return e.handleMonconFilterChange(t.target.value)},value:m},o.createElement("option",{value:""},"Select Moncon Device"),u&&u.length>0&&u.map(function(e){return o.createElement("option",{value:e.ontology},e.rdfsLabel)})))),o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("div",{className:"col-md-4 col-xs-12 px-0"},o.createElement("h6",{style:{marginTop:"10px"}},"Filter : \xa0")),o.createElement("div",{className:"col-md-8 col-xs-12"},o.createElement("input",{style:{outline:"green"},className:"form-control pull-right",onChange:function(t){e.search_filter(t)},id:"myInput",type:"text",placeholder:"Search.."})))),o.createElement("div",{className:"row no-padding",id:"PointsList"},o.createElement("div",{className:"padding-10 small"},o.createElement(i.a,{instance:a,buildingName:n,points:h||c,handlePointChange:this.handlePointChange,_fetchPoints:this._fetchPoints,openEditDialog:this.openEditForm,isPlanned:p.pointState}))))},t}(o.Component);t.default=h}});