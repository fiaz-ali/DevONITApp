webpackJsonp([56],{2004:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),n(8)),r=n(815),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(l,a)}s((o=o.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,selectedSteps:[],modelDetails:Object(),spaceDetails:[],currentSweep:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:!1,prevSweepIndex:0,onPropsReceivedStateChanged:!1,linkBimism:n.props.bimURL,sdk:Object(),locationModel:Object()},n.getSweeps=n.getSweeps.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.removeSweep=n.removeSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.loadSDK=n.loadSDK.bind(n),n.initFrame=n.initFrame.bind(n),n}return l(t,e),t.prototype.componentDidMount=function(){return a(this,void 0,void 0,function(){var e,t,n;return s(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,n=e.space,[4,this.getSweeps(t,n)];case 1:return o.sent(),[2]}})})},t.prototype.componentWillReceiveProps=function(e){e.bimURL&&this.setState({linkBimism:e.bimURL})},t.prototype.getSweeps=function(e,t){return a(this,void 0,void 0,function(){var n,o=this;return s(this,function(l){switch(l.label){case 0:return n=[],[4,Object(r.c)(e,t).then(function(e){return a(o,void 0,void 0,function(){return s(this,function(t){return e.forEach(function(e){var t=Object();t.assignedSpace=Object(i.g)(e.assignedSpace),t.buildingName=Object(i.g)(e.buildingName),t.ontology=Object(i.g)(e.ontology),t.uuid=Object(i.g)(e.uuid),t.uuidIndex=parseInt(Object(i.g)(e.uuidIndex)),t.stepNo=parseInt(Object(i.g)(e.stepNo)),n.push(t)}),this.setState({selectedSteps:n}),[2]})})}).catch(function(e){return e})];case 1:return l.sent(),[2]}})})},t.prototype.toggleAddingSweep=function(){window.toggleStartStopAddingSweep()},t.prototype.toggleTourStartStop=function(){window.toggleTourSelectedSweep()},t.prototype.toggleTourSweepsStartStop=function(e){window.toggleTourSweepsSelectedSweep(e)},t.prototype.addCurrentSweep=function(){window.addCurrentSweep()},t.prototype.removeSweep=function(e){window.removeSweep(e)},t.prototype.setDialogState=function(e,t,n,o,i,r,l,a,s){null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&(this.setState({selectedSteps:n}),this.props.onSaveSteps(n)),null!=o&&this.setState({modelDetails:o}),null!=i&&this.setState({currentSweep:i}),null!=r&&this.setState({logMessage:r}),null!=a&&this.setState({prevSweepIndex:a}),null!=s&&(this.setState({sdk:s}),this.initFrame(s,this.setDialogState,this.state)),null!=l&&this.setState({sdkReady:l})},t.prototype.loadSDK=function(e,t){var o=n(803),i=o.APIKey,r=o.Version,l=document.getElementById("showcase");window.MP_SDK.connect(l,i,r).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.initFrame=function(e,t,n){var o=!1,i=n.modelDetails,r=n.currentSweep,l=n.isStarted,a=n.isTourSelected,s=n.selectedSteps,u=n.sdkReady,c=n.startSweep,d=n.hasStartSweep,p=n.isViewForm,f=n.prevSweepIndex;function h(n,o){l?(console.log("Tour Stopped"),t(null,null,null,null,null,"Tour Stopped")):(o.length>0&&o.length>n?(a=!0,e.Sweep.moveTo(o[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var i="Arrived at sweep "+e+"at index "+o[n].uuidIndex;console.log(i),t(null,null,null,null,null,i),h(n+=1,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(a=!1,console.log("Tour Ended"),t(null,null,null,null,null,"Tour Ended")),t(null,a))}u||e.App.state.subscribe(function(n){n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase===e.App.Phase.PLAYING&&(console.log("The app is ready to take user input now!"),u=!0,t(null,null,null,null,null,null,!0),d&&window.goToSweep(c.uuid))}),e.Model.getData().then(function(e){console.log("Model data loaded for sid:",e.sid),t(null,null,null,i=e)}),window.toggleStartStopAddingSweep=function(){t(l=!l),l&&window.addCurrentSweep()},window.toggleTourSelectedSweep=function(){(t(null,a=!0),a)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),h(0,s.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,a),t(null,null,null,null,null,"Tour Stopped"))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,a=!0),a)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),h(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,a),t(null,null,null,null,null,"Tour Stopped"))},window.addCurrentSweep=function(){e.Camera.getPose().then(function(e){var n=i.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,r=n);var o=i.sweeps.indexOf(n);if(!function(e){if(s.length>0){var n=s.find(function(t){return t.uuid==e});if(null!=n||""+n!="undefined"){var o="Sweep "+n.uuid+" of index "+n.uuidIndex+" is already added in the current list";return console.log(o),t(null,null,null,null,null,o),!0}}return!1}(r.uuid)){s.push({uuid:r.uuid,uuidIndex:o,stepNo:s.length}),t(null,null,s);var l="Sweep "+r.uuid+" of index "+o+" is added in the current list";console.log(l),t(null,null,null,null,null,l)}})},window.removeSweep=function(e){var n=s.find(function(t){return t.uuid==e}),o=s.indexOf(n);if(o>-1){s.splice(o,1),t(null,null,s);var i="Sweep "+n.uuid+" of index "+n.uuidIndex+" is removed from the current list";console.log(i),t(null,null,null,null,null,i)}},window.goToSweep=function(n){e.Sweep.moveTo(n,{transition:e.Sweep.Transition.FLY}).then(function(e){var o="Moved to sweep "+n;console.log(o),t(null,null,null,null,null,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},e.on(e.Sweep.Event.ENTER,function(){if(a)return!1;e.Camera.getPose().then(function(e){if("mode.inside"==e.mode||"mode.outside"==e.mode)if(p&&s.length>0){var n=s.find(function(t){return t.uuid==e.sweep});if(null!=n&&""+n!="undefined"){var i="Moved to sweep "+n.uuid;console.log(i),t(null,null,null,null,null,i),f=s.indexOf(n),t(null,null,null,null,null,null,null,f)}else{i="Not allowed in the current step ";if(console.log(i),t(null,null,null,null,null,i),o)return setTimeout(function(){o=!1},1500),o=!1,!1;o=!0,window.goToSweep(s[f].uuid)}}else console.log("Current Sweep is: "+JSON.stringify(e.sweep)),l&&window.addCurrentSweep()})})},t.prototype.render=function(){var e=this,t=this.props.isViewForm,n=this.state,i=n.isStarted,r=n.selectedSteps,l=n.isTourSelected,a=n.logMessage,s=n.sdkReady,u=this.state.linkBimism;u&&!u.includes("&utm_source=sdkdebug&play=1&tourcta=0")&&(u+="&utm_source=sdkdebug&play=1&tourcta=0");var c=0,d=!1,p=!1;return s?(d=l,p=i):(d=!0,p=!0),o.createElement("div",{className:"card dataCard padding-10 no-margin"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-xs-12"},o.createElement("iframe",{id:"showcase",src:u,onLoad:function(){e.loadSDK(e.setDialogState,e.state)},width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0}))),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-7 col-xs-12"},o.createElement("button",{type:"button",id:"btnStartStop",disabled:d,title:1==i?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:this.toggleAddingSweep},o.createElement("i",{className:1==i?"fa fa-stop":"fa fa-plus"})),o.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:d&&p,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:this.addCurrentSweep},o.createElement("i",{className:"fa fa-thumb-tack"})),o.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:p,title:1==i?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:this.toggleTourStartStop},o.createElement("i",{className:1==l?"fa fa-stop":"fa fa-play"})),o.createElement("br",null),o.createElement("br",null),!t&&o.createElement("span",{className:"small-font-list"},a)),o.createElement("div",{className:"col-md-5 col-xs-12"},o.createElement("table",null,o.createElement("tr",null,o.createElement("th",null,"Steps"),o.createElement("th",null)),r&&r.map(function(n){return c+=1,o.createElement("tr",null,o.createElement("td",{className:"link",onClick:function(){s&&window.goToSweep(n.uuid)}},"Step ",c,": ",n.uuid),o.createElement("td",null,!t&&s&&o.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(n.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"}))))}))))))},t}(o.Component);t.a=u},2005:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),n(2006)),r=n(815),l=n(8),a=n(106),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(l,a)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,sdkReady:!1,locationModel:Object(),sdk:Object(),linkBimism:n.props.bimURL,currentSweep:Object(),modelDetails:Object(),selectedSteps:[],inBuildingRoutes:[],selectedRouteIndex:0,allSweeps:[]},n.getRoutes=n.getRoutes.bind(n),n.onRouteChange=n.onRouteChange.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.loadSDK=n.loadSDK.bind(n),n.initFrame=n.initFrame.bind(n),n}return s(t,e),t.prototype.componentWillReceiveProps=function(e){e.bimURL&&this.setState({linkBimism:e.bimURL})},t.prototype.getRoutes=function(e){return u(this,void 0,void 0,function(){var t,n,o,i,a,s,d=this;return c(this,function(p){switch(p.label){case 0:return t=this.props,n=t.buildingName,o=t.space,i=[],a=[],s=[],[4,Object(r.a)(n,o).then(function(t){return u(d,void 0,void 0,function(){var n,r,u,d,p,f,h;return c(this,function(c){for(n=0;n<t.length;n++){for(r=t[n],(u=Object()).description=Object(l.g)(r.description),u.ontology=Object(l.g)(r.ontology),u.space=Object(l.g)(r.space),u.routeName=Object(l.g)(r.routeName),a=Object(l.g)(r.sweeps).split(","),s=Object(l.g)(r.stepNo).split(","),d=Object(),p=[],f=function(t){var n=a[t],i=Object();(d=e.find(function(e){return e.uuid==n}))&&(i.uuid=d.uuid,i.assignedSpace=o,i.stepNo=s[t],p.push(i))},h=0;h<a.length;h++)f(h);u.sweeps=p,i.push(u)}return this.setState({inBuildingRoutes:i}),this.props.onSaveRoutes(i),i.length>0&&this.initFrame(this.state.sdk,this.setDialogState,this.state),[2]})})}).catch(function(e){return e})];case 1:return p.sent(),[2]}})})},t.prototype.onRouteChange=function(e){this.setState({inBuildingRoutes:e}),this.props.onSaveRoutes(e),this.initFrame(this.state.sdk,this.setDialogState,this.state)},t.prototype.toggleTourSweepsStartStop=function(e){window.toggleTourSweepsSelectedSweep(e)},t.prototype.toggleAddingSweep=function(e,t){this.setState({inBuildingRoutes:e,selectedRouteIndex:t}),window.toggleStartStopAddingSweepByIndex(t)},t.prototype.addCurrentSweep=function(e,t){this.setState({inBuildingRoutes:e,selectedRouteIndex:t}),window.addCurrentSweepByIndex(t)},t.prototype.setDialogState=function(e,t,n,o,i,r,l,s,d){return u(this,void 0,void 0,function(){return c(this,function(u){switch(u.label){case 0:return null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&this.setState({selectedSteps:n}),null==o?[3,2]:(this.setState({modelDetails:o}),0!=this.state.inBuildingRoutes.length?[3,2]:(Object(a.a)(!0),[4,this.getRoutes(o.sweeps)]));case 1:u.sent(),Object(a.a)(!1),u.label=2;case 2:return null!=i&&this.setState({currentSweep:i}),null!=l&&(this.setState({sdk:l}),this.initFrame(l,this.setDialogState,this.state)),null!=r&&this.setState({sdkReady:r}),null!=s&&this.setState({inBuildingRoutes:s}),null!=d&&this.setState({selectedRouteIndex:d}),[2]}})})},t.prototype.loadSDK=function(e){var t=n(803),o=t.APIKey,i=t.Version,r=document.getElementById("showcase");window.MP_SDK.connect(r,o,i).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.initFrame=function(e,t,n){var o=n.modelDetails,i=n.currentSweep,r=n.isStarted,l=n.isTourSelected,a=n.selectedSteps,s=n.sdkReady,u=n.inBuildingRoutes,c=n.selectedRouteIndex;function d(n,o){r?console.log("Tour Stopped"):(o.length>0&&o.length>n?(l=!0,e.Sweep.moveTo(o[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+o[n].uuidIndex;console.log(t),d(n+=1,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(l=!1,console.log("Tour Ended")),t(null,l))}s||e.App.state.subscribe(function(n){n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase===e.App.Phase.PLAYING&&(console.log("The app is ready to take user input now!"),s=!0,t(null,null,null,null,null,!0))}),e.Model.getData().then(function(e){console.log("Model data loaded for sid:",e.sid),t(null,null,null,o=e)}),window.toggleStartStopAddingSweepByIndex=function(e){c=e,t(r=!r,null,null,null,null,null,null,null,e),r&&window.addCurrentSweepByIndex(e)},window.toggleTourSelectedSweep=function(){(t(null,l=!0),l)?(console.log("Tour Started"),d(0,a.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,l))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,l=!0),l)?(console.log("Tour Started"),d(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,l))},window.addCurrentSweepByIndex=function(n){c=n,t(null,null,null,null,null,null,null,null,n),e.Camera.getPose().then(function(e){var r=o.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,i=r);var l=o.sweeps.indexOf(r);if(!function(e,t){if(u&&u.length>0){var n=u[t].sweeps;if(n.length>0){var o=n.find(function(t){return t.uuid==e});if(null!=o||""+o!="undefined"){var i="Sweep "+o.uuid+" of index "+o.uuidIndex+" is already added in the current list";return console.log(i),!0}}}return!1}(i.uuid,n)){var a=u[n].sweeps;a.push({uuid:i.uuid,uuidIndex:l,stepNo:a.length}),u[n].sweeps=a,t(null,null,null,null,null,null,null,u);var s="Sweep "+i.uuid+" of index "+l+" is added in the current list";console.log(s)}})},window.removeSweep=function(e){var n=a.find(function(t){return t.uuid==e}),o=a.indexOf(n);if(o>-1){a.splice(o,1),t(null,null,a);var i="Sweep "+n.uuid+" of index "+n.uuidIndex+" is removed from the current list";console.log(i)}},window.goToSweep=function(t){e.Sweep.moveTo(t,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+t;console.log(n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},e.on(e.Sweep.Event.ENTER,function(){if(l)return!1;e.Camera.getPose().then(function(e){if("mode.inside"==e.mode||"mode.outside"==e.mode)if(a.length>0){var t=a.find(function(t){return t.uuid==e.sweep});if(null!=t&&""+t!="undefined"){var n="Moved to sweep "+t.uuid;console.log(n)}else{n="Not allowed in the current step ";console.log(n)}}else console.log("Current Sweep is: "+JSON.stringify(e.sweep)),r&&window.addCurrentSweepByIndex(c)})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,r=t.space,l=this.state,a=l.inBuildingRoutes,s=l.sdkReady,u=l.isTourSelected,c=l.isStarted,d=this.state.linkBimism;d&&!d.includes("&utm_source=sdkdebug&play=1&tourcta=0")&&(d+="&utm_source=sdkdebug&play=1&tourcta=0");var p=!1,f=!1;return s?(p=u,f=c):(p=!0,f=!0),o.createElement("div",{className:"card dataCard padding-10 no-margin"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-xs-12"},o.createElement("iframe",{id:"showcase",src:d,onLoad:function(){e.loadSDK(e.setDialogState)},width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0}))),o.createElement("br",null),o.createElement(i.a,{building:n,space:r,items:a,onItemChange:this.onRouteChange,onTour:this.toggleTourSweepsStartStop,onAddCurrentSweep:this.addCurrentSweep,onToggleAddingSweep:this.toggleAddingSweep,isStarted:f,isTourSelected:p,sdkReady:s})))},t}(o.Component);t.a=d},2006:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),r=function(e){function t(t){var n=e.call(this,t)||this;return n.state={items:[],selectedRowIndex:0,isAddDisable:!1,sdkReady:!1,isStarted:!1,isTourSelected:!1},n.addItem=n.addItem.bind(n),n.handleRouteNameChange=n.handleRouteNameChange.bind(n),n.removeSweep=n.removeSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.removeItem=n.removeItem.bind(n),n.hideSweeps=n.hideSweeps.bind(n),n}return i(t,e),t.prototype.componentWillReceiveProps=function(e){e.items&&this.setState({items:e.items}),e.destinationSweeps&&this.setState({destinationSweeps:e.destinationSweeps}),e.isStarted!=this.state.isStarted&&this.setState({isStarted:e.isStarted}),e.isTourSelected!=this.state.isTourSelected&&this.setState({isTourSelected:e.isTourSelected}),e.sdkReady!=this.state.sdkReady&&this.setState({sdkReady:e.sdkReady})},t.prototype.addItem=function(){var e=this.state.items;e.push({space:this.props.space,description:"",sweeps:[],hideRoutesView:!1}),this.setState({items:e,isAddDisable:!0}),this.props.onItemChange(e)},t.prototype.handleRouteNameChange=function(e,t){var n=this.state.items;n[t].routeName=e,this.setState({items:n}),this.props.onItemChange(n)},t.prototype.removeItem=function(e,t){t>-1&&(e.splice(t,1),this.setState({items:e}),this.props.onItemChange(e))},t.prototype.hideSweeps=function(e,t,n){e[t].hideRoutesView=!n,this.setState({items:e})},t.prototype.removeSweep=function(e,t,n){var o=e[t].sweeps.find(function(e){return e.uuid==n}),i=e[t].sweeps.indexOf(o);i>-1&&(e[t].sweeps.splice(i,1),this.setState({items:e}),this.props.onItemChange(e))},t.prototype.toggleAddingSweep=function(e,t){this.props.onToggleAddingSweep(e,t),this.setState({isAddDisable:!1})},t.prototype.addCurrentSweep=function(e,t){this.props.onAddCurrentSweep(e,t),this.setState({isAddDisable:!1})},t.prototype.toggleTourStartStop=function(e,t){var n=e[t].sweeps;this.props.onTour(n)},t.prototype.render=function(){var e=this,t=this.state,n=t.items,i=t.isAddDisable,r=t.sdkReady,l=t.isStarted,a=t.isTourSelected,s=!1,u=!1;return r?(s=a,u=l):(s=!0,u=!0),o.createElement(o.Fragment,null,o.createElement("div",{className:"container-fluid"},n&&n.length>0&&n.map(function(t,i){return o.createElement(o.Fragment,null,o.createElement("div",{key:i,className:"row matterport-margin-row"},o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("button",{type:"button",id:"btnStartStop",disabled:s,title:1==l?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:function(){e.toggleAddingSweep(n,i)}},o.createElement("i",{className:1==l?"fa fa-stop":"fa fa-plus"})),o.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:s&&u,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:function(){e.addCurrentSweep(n,i)}},o.createElement("i",{className:"fa fa-thumb-tack"})),o.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:u,title:1==l?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:function(){e.toggleTourStartStop(n,i)}},o.createElement("i",{className:1==a?"fa fa-stop":"fa fa-play"}))),o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("div",{className:"row"},o.createElement("span",{className:"hidden visible-xs-inline headingText"},o.createElement("label",{htmlFor:"description"},"Route Name")),o.createElement("span",{className:"fullWidth"},o.createElement("input",{type:"text",className:"form-control",value:t.routeName,placeholder:"Route Name",name:"description",onChange:function(t){return e.handleRouteNameChange(t.target.value,i)}})))),o.createElement("div",{className:"col-md-4 col-xs-10"},o.createElement("table",null,o.createElement("tr",null,o.createElement("th",null,"Steps: ",t.hideRoutesView?t.sweeps.length+" Steps Added":""),o.createElement("th",null)),!t.hideRoutesView&&t.sweeps&&t.sweeps.map(function(t,l){return o.createElement("tr",null,o.createElement("td",{className:"link",onClick:function(){r&&window.goToSweep(t.uuid)}},"Step ",l+1,": ",t.uuid),o.createElement("td",null,r&&o.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(n,i,t.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"}))))}))),o.createElement("div",{className:"col-md-1 col-xs-1"},o.createElement("button",{type:"button",title:"Hide Route Sweeps",onClick:function(){e.hideSweeps(n,i,t.hideRoutesView)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-minus"}))),o.createElement("div",{className:"col-md-1 col-xs-1"},o.createElement("button",{type:"button",title:"Remove Item",onClick:function(){e.removeItem(n,i)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"})))),o.createElement("hr",null))})),o.createElement("br",null),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("button",{disabled:i,type:"button",className:"btn btn-dark btn-fill btn-sm",onClick:this.addItem},o.createElement("i",{className:"fa fa-plus"}),n.length>0?"More":"Add"))))},t}(o.Component);t.a=r},676:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=(n.n(o),n(106)),r=n(711),l=n(8),a=n(2004),s=n(2005),u=n(815),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(l,a)}s((o=o.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={currentView:"Space",linkBimism:"",locationModel:Object(),spaceInBuildingRoutes:[],spaceSteps:[]},n.getSpace=n.getSpace.bind(n),n.onSaveHandle=n.onSaveHandle.bind(n),n.onSpaceStepsChange=n.onSpaceStepsChange.bind(n),n.onInBuildingRouteChange=n.onInBuildingRouteChange.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e,t,n;return p(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,n=e.space,[4,this.getSpace(t,n)];case 1:return o.sent(),[2]}})})},t.prototype.onSaveHandle=function(){return d(this,void 0,void 0,function(){var e,t,n,o,r=this;return p(this,function(l){switch(l.label){case 0:return e=this.state,t=e.currentView,n=e.spaceSteps,o=e.spaceInBuildingRoutes,Object(i.a)(!0),"Space"!=t?[3,3]:n&&n.length>0?(n.map(function(e){return e.assignedSpace=r.props.space}),[4,Object(u.g)(this.props.buildingName,n,!1)]):[3,2];case 1:l.sent(),l.label=2;case 2:return[3,5];case 3:return[4,Object(u.e)(this.props.buildingName,o)];case 4:l.sent(),l.label=5;case 5:return Object(i.a)(!1),[2]}})})},t.prototype.onSpaceStepsChange=function(e){this.setState({spaceSteps:e})},t.prototype.onInBuildingRouteChange=function(e){this.setState({spaceInBuildingRoutes:e})},t.prototype.getSpace=function(e,t){return d(this,void 0,void 0,function(){var n,o,a=this;return p(this,function(s){switch(s.label){case 0:return n=Object(),o=this.state.locationModel,Object(i.a)(!0),[4,Object(r.g)(e,t).then(function(e){return d(a,void 0,void 0,function(){return p(this,function(t){return""==Object(l.g)(e[0].space)&&(e=[]),n=e[0],[2]})})}).catch(function(e){return e})];case 1:return s.sent(),n&&(o.buildingName=e,o.floor=Object(l.g)(n.floor&&n.floor),o.type=Object(l.g)(n.type),o.name=Object(l.g)(n.space),o.rdfsLabel=Object(l.g)(n.rdfsLabel),o.ceilingType=Object(l.g)(n.ceilingtype),o.ceilingHeight=Object(l.g)(n.ceilingheight),o.description=Object(l.g)(n.description),o.notes=Object(l.g)(n.notes),o.panelID=Object(l.g)(n.panelID),o.virtualBIM=Object(l.g)(n.virtualBIM),o.cadBIM=Object(l.g)(n.cadBIM),o.profileFileName=Object(l.g)(n.profileFileName).split(","),o.isDirectional="true"===Object(l.g)(n.isDirectional),this.setState({locationModel:o,linkBimism:o.virtualBIM})),Object(i.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.currentView,i=t.linkBimism,r=this.props,l=r.instance,u=r.buildingName,c=r.space;return o.createElement("div",{className:"content"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-3 padding-5"},o.createElement("div",{className:"btn-group"},o.createElement("button",{className:"btn "+("Space"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"Space"})}},"Space Steps"),o.createElement("button",{className:"btn "+("InBuilding"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"InBuilding"})}},"In Building Routes"))),o.createElement("div",{className:"col-md-9 padding-5"},o.createElement("div",{className:"pull-right"},o.createElement("div",{className:"col-md-6"},o.createElement("button",{type:"button",className:"btn btn-primary btn-fill",onClick:this.onSaveHandle}," Save ","Space"==n?"Space Steps":"In building Route")),o.createElement("div",{className:"col-md-6"},o.createElement("button",{type:"button",className:"btn btn-default btn-fill",onClick:function(){window.location.hash=l+"/"+u+"/Space"}}," Back To Spaces"))))),o.createElement("br",null),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},"Space"==n&&o.createElement("div",null,o.createElement(a.a,{buildingName:u,space:c,bimURL:i,onSaveSteps:this.onSpaceStepsChange})),"InBuilding"==n&&o.createElement("div",null,o.createElement(s.a,{buildingName:u,space:c,bimURL:i,onSaveRoutes:this.onInBuildingRouteChange}))))))},t}(o.Component);t.default=f},711:function(e,t,n){"use strict";t.g=function(e,t,n,i){return l(this,void 0,void 0,function(){return a(this,function(l){switch(l.label){case 0:return[4,Object(r.e)({buildingName:e,spaceName:t,spaceWithCalendar:n},r.a.SPACES.GETSPACES,o.b.SPACE,i)];case 1:return[2,l.sent()]}})})},t.c=function(e,t,n){return l(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,Object(r.e)({floor:e,buildingName:t},r.a.SPACES.GetLocationsList,o.b.SPACE,n)];case 1:return[2,i.sent()]}})})},t.d=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(r.e)({zone:e,buildingName:t},r.a.SPACES.getLocationsListSpacesByZones,o.b.SPACE)];case 1:return[2,n.sent()]}})})},t.b=function(e,t,n){void 0===n&&(n=!0);return l(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,Object(r.e)({buildingName:e,type:t},r.a.SPACES.GetAllLocationsList,o.b.SPACE,n)];case 1:return[2,i.sent()]}})})},t.a=function(e,t,n,s,u){return l(this,void 0,void 0,function(){return a(this,function(l){switch(l.label){case 0:return[4,Object(r.f)({buildingName:e,model:t,floor:n,isEdit:s,spacetoUpdate:u},r.a.SPACES.SAVESPACE,o.b.SPACE).then(function(){Object(i.b)("Space "+(s?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Space.")})];case 1:return[2,l.sent()]}})})},t.f=function(e){return l(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,Object(r.e)({buildingName:e},r.a.SPACES.GetSpaceTypesList,o.b.SPACE)];case 1:return[2,t.sent()]}})})},t.e=function(e){return l(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,Object(r.e)({spaceName:e},r.a.SPACES.GetSpaceOptimalInfo,o.b.SPACE)];case 1:return[2,t.sent()]}})})},t.h=function(e){return l(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,Object(r.f)({spaceToUpdate:e},r.a.SPACES.UpdateSpaceOptimalInfo,o.b.SPACE).then(function(){Object(i.b)("Space Updated Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Space.")})];case 1:return[2,t.sent()]}})})};var o=n(7),i=n(6),r=n(5),l=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(l,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}},803:function(e,t){e.exports={APIKey:"f51abd3013784ac6a0985f87f5ecbf03",Version:"3.2"}},815:function(e,t,n){"use strict";t.c=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,space:t},o.a.MATTERPORT.FETCHSWEEPS,i.b.SPACE,!0)];case 1:return[2,n.sent()]}})})},t.g=function(e,t,n){return l(this,void 0,void 0,function(){return a(this,function(l){switch(l.label){case 0:return[4,Object(o.f)({buildingName:e,model:t,isEdit:n},o.a.MATTERPORT.UPDATESWEEP,i.b.SPACE).then(function(){Object(r.b)("Sweep "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Sweep.")})];case 1:return[2,l.sent()]}})})},t.d=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,task:t},o.a.MATTERPORT.FETCHSTASKROUTE,i.b.TASK,!0)];case 1:return[2,n.sent()]}})})},t.h=function(e,t,n){return l(this,void 0,void 0,function(){return a(this,function(l){switch(l.label){case 0:return[4,Object(o.f)({buildingName:e,model:t,isEdit:n},o.a.MATTERPORT.UPDATETASKROUTE,i.b.TASK).then(function(){Object(r.b)("Task Route "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Task Route.")})];case 1:return[2,l.sent()]}})})},t.b=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,floorOntology:t},o.a.MATTERPORT.FETCHMATTERPORTIMAGE,i.b.ZONE,!0)];case 1:return[2,n.sent()]}})})},t.f=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({model:e},o.a.MATTERPORT.UPDATEMATTERPORTIMAGE,i.b.ZONE).then(function(e){Object(r.b)("Image "+(t?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving Image.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,space:t},o.a.MATTERPORT.FETCHSINBUILDINGROUTE,i.b.SPACE,!0)];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return l(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,model:t},o.a.MATTERPORT.UPDATEINBUILDINGROUTE,i.b.SPACE).then(function(){Object(r.b)("In Building Routes Updated Successfully.")}).catch(function(e){Object(r.a)("Error occured while saving In Building Routes.")})];case 1:return[2,n.sent()]}})})};var o=n(5),i=n(7),r=n(6),l=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function l(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(l,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=(i=l.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}}});