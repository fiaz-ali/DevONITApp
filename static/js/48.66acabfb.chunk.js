webpackJsonp([48],{1163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=(n.n(a),n(116)),i=n(1164),c=n(31),s=n(653),l=n(11),o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),d=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function c(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,s)}l((a=a.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var n,a,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,a=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=n(1276),u=p.CardNumberElement,h=p.CardExpiryElement,f=p.CardCvcElement,g=p.injectStripe,b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={payment:Object(),card:Object(),selectedPricingPackage:Object()},n.handleChange=n.handleChange.bind(n),n.handlePayment=n.handlePayment.bind(n),n.getStripeToken=n.getStripeToken.bind(n),n.getPayment=n.getPayment.bind(n),n.onDeletePayment=n.onDeletePayment.bind(n),n.deletePayment=n.deletePayment.bind(n),n.handleSubscription=n.handleSubscription.bind(n),n.handleSpacePayment=n.handleSpacePayment.bind(n),n}return o(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return e=JSON.parse(l.a.getItem("user")),[4,this.getPayment()];case 1:return n.sent(),(t=this.state.payment).name=e.name,t.email=e.email,t.phoneNo=e.mobile,t.postalCode=e.zipcode,this.setState({payment:t,selectedPricingPackage:this.props.selectedPricingPackage?this.props.selectedPricingPackage:Object()}),[2]}})})},t.prototype.componentWillReceiveProps=function(e){this.props.selectedPricingPackage&&this.props.selectedPricingPackage.stripePlanId&&this.setState({selectedPricingPackage:this.props.selectedPricingPackage})},t.prototype.handleChange=function(e){var t=this.state.payment;t[e.target.name]=e.target.value,this.setState({payment:t})},t.prototype.getPayment=function(){return d(this,void 0,void 0,function(){var e,t,n,a;return m(this,function(r){switch(r.label){case 0:return e=JSON.parse(l.a.getItem("user")),(t=e.stripePaymentMethodId)?(n=this.state.card,[4,Object(i.b)(t)]):[3,2];case 1:return a=r.sent(),n.last4=a.card.last4,n.exp_month=a.card.exp_month,n.exp_year=a.card.exp_year,n.brand=a.card.brand,n.paymentId=a.id,this.setState({card:n}),[3,3];case 2:this.setState({card:Object()}),r.label=3;case 3:return[2]}})})},t.prototype.onDeletePayment=function(){document.getElementById("btnConfirm").click()},t.prototype.deletePayment=function(){return d(this,void 0,void 0,function(){var e,t,n,a;return m(this,function(r){switch(r.label){case 0:return e=JSON.parse(l.a.getItem("user")),t=e.stripePaymentMethodId,[4,Object(i.a)(t,e)];case 1:return n=r.sent(),a="",e.stripePaymentMethodId=a,l.a.setItem("user",JSON.stringify(e)),n&&(Object(c.b)("Successfully Deleted"),window.location.reload()),this.getPayment(),[2]}})})},t.prototype.handleSpacePayment=function(e){return d(this,void 0,void 0,function(){var e,t,n,a,r,s;return m(this,function(l){switch(l.label){case 0:return e=this.state.payment,t=e.postalCode,n=e.name,a=this.props.totalPrice,r=this.props.spaceName,t||!isNaN(parseInt(t))?[3,1]:(Object(c.a)("Please enter a valid zipcode"),[3,4]);case 1:return[4,this.props.stripe.createToken({name:n,address_zip:t})];case 2:return s=l.sent(),[4,Object(i.d)(a,r,e,s)];case 3:l.sent(),l.label=4;case 4:return this.props.saveReservation(),[2]}})})},t.prototype.handlePayment=function(e){this.getStripeToken(e)},t.prototype.getStripeToken=function(e){return d(this,void 0,void 0,function(){var e,t,n,a,s,o,d,p,u,h;return m(this,function(m){switch(m.label){case 0:return e=JSON.parse(l.a.getItem("user")),Object(r.a)(!0),t=this.state.payment,(n=t.postalCode)||!isNaN(parseInt(n))?[3,1]:(Object(c.a)("Please enter a valid zipcode"),[3,9]);case 1:return[4,this.props.stripe.createToken({name:this.state.payment.name,address_zip:n})];case 2:return a=m.sent(),[4,Object(i.c)(e,t,a)];case 3:return s=m.sent(),o=s.id,e.stripePaymentMethodId=o,[4,Object(i.e)(o,e)];case 4:return d=m.sent(),p=d,e.stripeCustomerId=p,u=this.props.selectedPricingPackage,1==this.props.selectedPricingPackage.autoRenewal&&this.props.buildingName?[4,Object(i.f)(u,p,e,this.props.buildingName)]:[3,6];case 5:return h=m.sent(),e.stripeSubscriptionId=h,h?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!"),[3,8];case 6:return[4,Object(i.g)(this.props.selectedPricingPackage,p,e,this.props.buildingName)];case 7:m.sent()?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!"),m.label=8;case 8:l.a.setItem("user",JSON.stringify(e)),Object(r.a)(!1),this.getPayment(),m.label=9;case 9:return[2]}})})},t.prototype.handleSubscription=function(){return d(this,void 0,void 0,function(){var e,t,n,a;return m(this,function(r){switch(r.label){case 0:return e=JSON.parse(l.a.getItem("user")),t=e.stripeCustomerId,n=this.props.selectedPricingPackage,1==this.props.selectedPricingPackage.autoRenewal&&this.props.buildingName?[4,Object(i.f)(n,t,e,this.props.buildingName)]:[3,2];case 1:return a=r.sent(),e.stripeSubscriptionId=a,a?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!"),[3,4];case 2:return[4,Object(i.g)(this.props.selectedPricingPackage,t,e,this.props.buildingName)];case 3:r.sent()?(Object(c.b)("Successfully Subscribed"),window.location.reload()):Object(c.a)("Something goes wrong!"),r.label=4;case 4:return l.a.setItem("user",JSON.stringify(e)),[2]}})})},t.prototype.render=function(){var e=this,t=this.props.id,n=this.props.entityName,r=this.props.totalPrice,i=this.state,c=i.payment,o=i.card,d=JSON.parse(l.a.getItem("user"));return a.createElement(a.Fragment,null,a.createElement("div",{id:t,className:"content"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"card"},a.createElement("div",{className:"content",style:{textAlign:"center"}},a.createElement("div",{className:""},a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("div",{className:"dataCard"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px",marginLeft:"10px"}}," Name: "),a.createElement("div",{className:"col-md-5 headingText"},a.createElement("input",{type:"text",name:"name",value:c.name,className:"form-control",style:{border:"1px solid gray"},onChange:function(t){e.handleChange(t)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px",marginLeft:"10px"}}," Email: "),a.createElement("div",{className:"col-md-5 headingText"},a.createElement("input",{type:"text",name:"email",value:c.email,className:"form-control",style:{border:"1px solid gray"},onChange:function(t){e.handleChange(t)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Phone: "),a.createElement("div",{className:"col-md-5 headingText"},a.createElement("input",{type:"text",name:"phoneNo",value:c.phoneNo,className:"form-control",style:{border:"1px solid gray",marginLeft:"10px"},onChange:function(t){e.handleChange(t)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Postal code: "),a.createElement("div",{className:"col-md-5 headingText"},a.createElement("input",{type:"text",name:"postalCode",value:c.postalCode,className:"form-control",style:{border:"1px solid gray",marginLeft:"10px"},onChange:function(t){e.handleChange(t)}})))),n?a.createElement("div",null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Card Number: "),a.createElement("div",{className:"col-md-5 "},a.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},a.createElement(u,null))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Expiry date: "),a.createElement("div",{className:"col-md-5 "},a.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},a.createElement(h,null))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Cvc: "),a.createElement("div",{className:"col-md-5 "},a.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},a.createElement(f,null))))),a.createElement("div",{className:"row",style:{marginTop:"50px"}},a.createElement("div",{className:"col-md-12"},a.createElement("button",{className:"btn btn-success btn-fill center",style:{paddingRight:"60px",paddingLeft:"60px"},onClick:function(t){e.handleSpacePayment(t)}}," $",r," ")))):a.createElement(a.Fragment,null,d.stripePaymentMethodId&&a.createElement("div",null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Last 4 Digit: ",o.last4," "),a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Exp_Month:  ",o.exp_month," "),a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Exp_Year:  ",o.exp_year," "),a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Brand:  ",o.brand," "),a.createElement("div",{className:"col-md-1 headingText",style:{paddingTop:"10px"}},a.createElement("button",{className:"btn-sm btn-danger active pull-right custom-outline-btn",title:"Delete",onClick:function(){e.onDeletePayment()}},a.createElement("i",{className:"fa fa-trash"}))))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-offset-3"},a.createElement("div",{className:"col-md-2 col-md-offset-2 col-xs-12 headingText",style:{textAlign:"center",paddingLeft:"63px"}},a.createElement("button",{className:"btn btn-success btn-fill",onClick:function(){e.handleSubscription()}}," \xa0 \xa0 \xa0 Subscribe \xa0 \xa0 \xa0 ")))),a.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),a.createElement(s.a,{instance:"",id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Card?",heading:"Confirm...",onConfirmButtonClick:function(){e.deletePayment()}})),!d.stripePaymentMethodId&&a.createElement("div",null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Card Number: "),a.createElement("div",{className:"col-md-5 "},a.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},a.createElement(u,null))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Expiry date: "),a.createElement("div",{className:"col-md-5 "},a.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},a.createElement(h,null))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-9 col-md-offset-3"},a.createElement("div",{className:"col-md-2 headingText",style:{paddingTop:"10px"}}," Cvc: "),a.createElement("div",{className:"col-md-5 "},a.createElement("div",{className:"",style:{paddingTop:"10px",marginLeft:"10px",paddingRight:"110px"}},a.createElement(f,null))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-offset-3"},a.createElement("div",{className:"col-md-2 col-md-offset-2 col-xs-12 headingText",style:{textAlign:"center",paddingLeft:"63px"}},a.createElement("button",{className:"btn btn-success btn-fill",onClick:function(t){e.handlePayment(t)}}," \xa0 \xa0 \xa0 Subscribe \xa0 \xa0 \xa0 ")))))))))))))},t}(a.Component);t.default=g(b)},1164:function(e,t,n){"use strict";t.c=function(e,t,n){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(a.e)({user:e,payment:t,token:n},a.a.Stripe.PaymentMethod,"")];case 1:return[2,r.sent()]}})})},t.e=function(e,t){return r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,Object(a.e)({pmId:e,user:t},a.a.Stripe.StripeCustomer,"")];case 1:return[2,n.sent()]}})})},t.f=function(e,t,n,c){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(a.e)({planItem:e,customerId:t,user:n,buildingName:c},a.a.Stripe.StripeSubscription,"")];case 1:return[2,r.sent()]}})})},t.b=function(e){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,Object(a.e)({pmId:e},a.a.Stripe.GetPaymentMethod,"")];case 1:return[2,t.sent()]}})})},t.a=function(e,t){return r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,Object(a.e)({pmId:e,user:t},a.a.Stripe.DeletePaymentMethod,"")];case 1:return[2,n.sent()]}})})},t.g=function(e,t,n,c){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(a.e)({planItem:e,customerId:t,user:n,buildingName:c},a.a.Stripe.StripeCreateInvoice,"")];case 1:return[2,r.sent()]}})})},t.d=function(e,t,n,c){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,Object(a.e)({totalPrice:e,spaceName:t,payment:n,token:c},a.a.Stripe.SpaceReservatioCharges,"")];case 1:return[2,r.sent()]}})})};var a=n(12),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,i){function c(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,s)}l((a=a.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,a,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,a=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}}});