webpackJsonp([45],{1477:function(e,t,a){"use strict";t.d=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(n.e)({calendarObj:e},n.a.Calendar.SaveCalendar,r.b.Calendar)];case 1:return[2,t.sent()]}})})},t.c=function(){return l(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,Object(n.d)(n.a.Calendar.GetCalendarList)];case 1:return[2,e.sent()]}})})},t.a=function(e,t){return l(this,void 0,void 0,function(){return c(this,function(a){switch(a.label){case 0:return[4,Object(n.f)({calendarId:e,buildingName:t},n.a.Calendar.SaveBuildingCalendar,r.b.Calendar)];case 1:return[2,a.sent()]}})})},t.b=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(n.e)({calendarObj:e},n.a.Calendar.DeleteCalendar,r.b.Calendar)];case 1:return[2,t.sent()]}})})};var n=a(12),r=a(19),l=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,l){function c(e){try{s(n.next(e))}catch(e){l(e)}}function i(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(c,i)}s((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var a,n,r,l,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return c.label++,{value:l[1],done:!1};case 5:c.label++,n=l[1],l=[0];continue;case 7:l=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){c=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){c.label=l[1];break}if(6===l[0]&&c.label<r[1]){c.label=r[1],r=l;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(l);break}r[2]&&c.ops.pop(),c.trys.pop();continue}l=t.call(e,c)}catch(e){l=[6,e],n=0}finally{a=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}}},3303:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=(a.n(n),a(22)),l=a(652),c=a(1477),i=a(23),s=a(669),o=a(11),d=a(117),u=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),m=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(r,l){function c(e){try{s(n.next(e))}catch(e){l(e)}}function i(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){e.done?r(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(c,i)}s((n=n.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var a,n,r,l,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return c.label++,{value:l[1],done:!1};case 5:c.label++,n=l[1],l=[0];continue;case 7:l=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===l[0]||2===l[0])){c=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){c.label=l[1];break}if(6===l[0]&&c.label<r[1]){c.label=r[1],r=l;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(l);break}r[2]&&c.ops.pop(),c.trys.pop();continue}l=t.call(e,c)}catch(e){l=[6,e],n=0}finally{a=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}},f=function(e){function t(t){var a=e.call(this,t)||this;return a.state={calendarObj:Object(),calendar:[],selectedCalendar:""},a.onChangeHandler=a.onChangeHandler.bind(a),a.saveCalendar=a.saveCalendar.bind(a),a.handleSaveCalendarBtn=a.handleSaveCalendarBtn.bind(a),a.handleSelectCalendar=a.handleSelectCalendar.bind(a),a.getCalendarList=a.getCalendarList.bind(a),a.handleExistingCalendarBtn=a.handleExistingCalendarBtn.bind(a),a}return u(t,e),t.prototype.componentDidMount=function(){return m(this,void 0,void 0,function(){var e,t,a;return h(this,function(n){switch(n.label){case 0:return[4,this.getCalendarList()];case 1:return n.sent(),e=this.state.selectedCalendar,[4,Object(s.d)(this.props.buildingName)];case 2:return t=n.sent(),a=t[0],e=Object(o.g)(a.calendarId),this.setState({selectedCalendar:e}),[2]}})})},t.prototype.onChangeHandler=function(e,t){var a=this.state.calendarObj;a[e]=t,this.setState({calendarObj:a})},t.prototype.getCalendarList=function(){return m(this,void 0,void 0,function(){var e;return h(this,function(t){switch(t.label){case 0:return e=this.state.calendar,[4,Object(c.c)()];case 1:return t.sent().forEach(function(t){var a=Object();a.calendarName=t.summary,a.calendarId=t.id,e.push(a)}),this.setState({calendar:e}),[2]}})})},t.prototype.handleSaveCalendarBtn=function(){var e=this.state.calendarObj;e.calendarName="",this.setState({calendarObj:e}),document.getElementById("NewCalendarbtn").click()},t.prototype.handleExistingCalendarBtn=function(){var e=this.state.calendarObj;e.calendarName="",this.setState({calendarObj:e}),document.getElementById("existingCalendarbtn").click()},t.prototype.handleSelectCalendar=function(e){var t=this.state,a=t.calendarObj,n=t.selectedCalendar;a.calendarId=e.target.value,n=e.target.value,this.setState({calendarObj:a,selectedCalendar:n})},t.prototype.saveBuilingCalendar=function(){return m(this,void 0,void 0,function(){var e;return h(this,function(t){switch(t.label){case 0:return e=this.state.calendarObj,Object(d.a)(!0),e.calendarId?[4,Object(c.a)(e.calendarId,this.props.buildingName)]:[3,2];case 1:return t.sent(),Object(i.b)("Calendar saved to Building."),[3,3];case 2:Object(i.a)("Please select Calendar. "),t.label=3;case 3:return Object(d.a)(!1),[2]}})})},t.prototype.saveCalendar=function(){return m(this,void 0,void 0,function(){var e,t;return h(this,function(a){switch(a.label){case 0:return e=this.state.calendarObj,[4,Object(c.d)(e)];case 1:return(t=a.sent())&&Object(i.b)(t),this.getCalendarList(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,a=t.instance,c=t.buildingName,i=this.state,s=i.calendarObj,o=i.calendar,d=i.selectedCalendar,u=Object(r.t)(this.props.buildingName);return n.createElement(n.Fragment,null,n.createElement("div",{className:"content"},n.createElement("div",{className:"container-fluid"},n.createElement("div",{className:"row padding-10"},n.createElement("div",{className:"col-md-12"},n.createElement("button",{className:"btn btn-success",style:{float:"right"},onClick:function(){e.handleSaveCalendarBtn()}},"Create New Calendar"),n.createElement("button",{className:"btn btn-success",style:{float:"right",marginRight:2},onClick:function(){e.handleExistingCalendarBtn()}},"Add Existing Calendar"),n.createElement("button",{className:"btn btn-success",style:{float:"left"},onClick:function(){window.location.hash="/"+a+"/"+c+"/Settings/CalendarList"}},"  Calendar List "))),n.createElement("div",{className:"content"},n.createElement("div",{className:"card padding-10"},n.createElement("div",{className:"padding-10"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-12"},n.createElement("label",null,n.createElement("h4",null,"Please Share Your Calendar with this Email ")," "))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-12"},n.createElement("b",null,"calenderapi@api2sheet-260810.iam.gserviceaccount.com")))),n.createElement("div",{className:"row padding-10"},n.createElement("div",{className:"col-md-12"},n.createElement("div",{className:"col-md-3 col-sm-3"},n.createElement("div",{className:"form-group"},n.createElement("label",{htmlFor:"hvac"},u))),n.createElement("div",{className:"col-md-4 col-sm-3"},n.createElement("div",{className:"form-group"},n.createElement("select",{className:"form-control",value:d||"",onChange:function(t){return e.handleSelectCalendar(t)}},!d&&n.createElement("option",{value:"",key:-2},"Select Calendar"),o.map(function(e,t){return n.createElement("option",{key:t,value:e.calendarId},e.calendarName," ")})))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-offset-1 col-md-10"},n.createElement("button",{className:"btn btn-primary",onClick:function(){e.saveBuilingCalendar()}},"Save"))))))),n.createElement("button",{id:"NewCalendarbtn",className:"hidden","data-toggle":"modal","data-target":"#NewCalendar",title:"Add"}," ",n.createElement("i",{className:"fa fa-plus"})," "),n.createElement(l.a,{id:"NewCalendar",heading:"Add Calendar",saveButtonText:"Save",isEditForm:!0,onSaveButtonClick:function(){e.saveCalendar()},disableSaveButton:!s.calendarName},n.createElement("div",{className:"content dataCard"},n.createElement("div",{className:""},n.createElement("div",{className:" row padding-10"},n.createElement("div",{className:"col-md-12"},n.createElement("label",null," Calendar add in Service Acccount "))),n.createElement("div",{className:"row padding-10"},n.createElement("div",{className:"col-md-12"},n.createElement("div",{className:"col-md-2 headingText padding-10"},"Calendar Name:"),n.createElement("div",{className:"col-md-6"},n.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"calendarName",value:s.calendarName,className:"form-control cell_border"}))))))),n.createElement("button",{id:"existingCalendarbtn",className:"hidden","data-toggle":"modal","data-target":"#ExistingCalendar",title:"Add"}," ",n.createElement("i",{className:"fa fa-plus"})," "),n.createElement(l.a,{id:"ExistingCalendar",heading:"Add Existing Calendar",saveButtonText:"Save",isEditForm:!0,onSaveButtonClick:function(){e.saveCalendar()},disableSaveButton:!s.calendarId},n.createElement("div",{className:"content dataCard"},n.createElement("div",{className:""},n.createElement("div",{className:" row padding-10"},n.createElement("div",{className:"col-md-12"},n.createElement("label",null,"Shara email: calenderapi@api2sheet-260810.iam.gserviceaccount.com "))),n.createElement("div",{className:"row padding-10"},n.createElement("div",{className:"col-md-12"},n.createElement("div",{className:"col-md-2 headingText padding-10"},"Calendar Id:"),n.createElement("div",{className:"col-md-6"},n.createElement("input",{onChange:function(t){e.onChangeHandler(t.target.name,t.target.value)},type:"text",name:"calendarId",value:s.calendarId,className:"form-control cell_border"}))))))))))},t}(n.Component);t.default=f}});