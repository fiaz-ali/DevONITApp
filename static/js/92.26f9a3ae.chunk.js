webpackJsonp([92],{820:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,c=n(1),o=(n.n(c),n(14)),i=n(10),l=n(7),r=n(13),s=n(99),d=n(3),m=n(11),u=n(21),p=n(25),f=n(98),h=n(9),b=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(c,o){function i(e){try{r(a.next(e))}catch(e){o(e)}}function l(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){e.done?c(e.value):new n(function(t){t(e.value)}).then(i,l)}r((a=a.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var n,a,c,o,i={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(c=2&o[0]?a.return:o[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,o[1])).done)return c;switch(a=0,c&&(o=[2&o[0],c.value]),o[0]){case 0:case 1:c=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(c=(c=i.trys).length>0&&c[c.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!c||o[1]>c[0]&&o[1]<c[3])){i.label=o[1];break}if(6===o[0]&&i.label<c[1]){i.label=c[1],c=o;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(o);break}c[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=c=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isEdit:!1,documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},Documents:[],DocumentTypes:f.a,itemToDelete:Object(),files:[]},a=n,n.handleTypeFilters=n.handleTypeFilters.bind(n),n.handleDocumentForm=n.handleDocumentForm.bind(n),n.saveDocument=n.saveDocument.bind(n),n.fetchDocuments=n.fetchDocuments.bind(n),n.onDeleteDocument=n.onDeleteDocument.bind(n),n.deleteDocument=n.deleteDocument.bind(n),n}return b(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this.fetchDocuments()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.fetchDocuments=function(){return v(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,Object(s.b)(this.props.buildingName).then(function(e){a.setState({Documents:e})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.handleTypeFilters=function(e){var t=e.target.checked,n=this.state.DocumentTypes;n[n.findIndex(function(t){return t.Type===e.target.value})].visible=t,this.setState({DocumentTypes:n});for(var a=[],c=f.b,o=0;o<c.length;o++)for(var i=0;i<n.length;i++)n[i].Type==c[o].Type&&1==n[i].visible&&a.push(c[o]);this.setState({Documents:a})},t.prototype.saveDocument=function(){return v(this,void 0,void 0,function(){var e,t,n,c,o,i,d,m,u,f=this;return y(this,function(b){switch(b.label){case 0:return e=this.state,t=e.documentObject,n=e.isEdit,c=e.itemToDelete,t&&t.infoEntity?(Object(r.a)(!0),1!=n?[3,2]:[4,Object(s.e)(this.props.buildingName,t,this.state.isEdit,c)]):[3,5];case 1:return b.sent(),[3,4];case 2:return o=JSON.parse(h.a.getItem("user")),t.enteredBy=o.contact,[4,Object(s.e)(this.props.buildingName,t,this.state.isEdit)];case 3:b.sent(),b.label=4;case 4:if(i=new p.b,(d=Object(l.d)())&&d.length)for(m=0;m<d.length;m++)(u=d[m])||(u=d[m].file),u&&i.UploadFile(p.a.COMMUNITYDOCS,t.s3FileName[m],u,function(e,t){e?console.log(e):console.log(t)});this.setState({documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},files:[],isEdit:!1},function(){return v(f,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,a.fetchDocuments()];case 1:return e.sent(),[2]}})})}),Object(r.a)(!1),b.label=5;case 5:return[2]}})})},t.prototype.onDeleteDocument=function(e){return v(this,void 0,void 0,function(){return y(this,function(t){return this.setState({itemToDelete:e}),[2]})})},t.prototype.deleteDocument=function(){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=this.state.itemToDelete).documentName.value?[4,Object(m.d)(e.documentName.value,l.b.DOCS)]:[3,3];case 1:return t.sent(),[4,this.fetchDocuments()];case 2:t.sent(),Object(s.c)(e.rdfsLabel.value).then(function(t){t&&0==t.length&&(new p.b).DeleteFile(p.a.COMMUNITYDOCS,e.rdfsLabel.value)}),t.label=3;case 3:return[2]}})})},t.prototype.onEditDocument=function(e){return v(this,void 0,void 0,function(){var t;return y(this,function(n){return(t=this.state.documentObject).infoEntity=[],t.documentType=e.documentType&&e.documentType.value,t.rdfsLabel=e.rdfsLabel&&e.rdfsLabel.value,t.documentName=e.documentName&&e.documentName.value,t.enteredBy=e.enteredBy&&e.enteredBy.value,t.enteredByName=e.enteredByName&&e.enteredByName.value,this.setState({documentObject:t,isEdit:!0,itemToDelete:e}),document.getElementById("btnDocumentForm").click(),[2]})})},t.prototype.handleDocumentForm=function(e,t){this.setState({documentObject:e,files:t})},t.prototype.render=function(){var e=this,t=this.state,n=t.Documents,a=t.DocumentTypes,r=t.documentObject,s=(this.props,Object(l.c)()),m=r.rdfsLabel&&(r.s3FileName&&s||r.linkToDocument)&&!0;return c.createElement("div",{className:"content"},c.createElement("div",{className:"container-fluid"},c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement(i.a,{id:"filterDocumentsModal",heading:"Filter Documents",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},a&&a.length>0&&a.map(function(t,n){return!0===t.visible?c.createElement("div",{key:t+"-"+n},c.createElement("input",{checked:!0,type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",c.createElement("label",null,t.Type)):c.createElement("div",null,c.createElement("input",{type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",c.createElement("label",null,t.Type))})),c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement("button",{type:"button",className:"btn btn-dark pull-right","data-toggle":"modal","data-target":"#documentFormDialog",onClick:function(){e.setState({isEdit:!1,files:[],documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""}})}},c.createElement("i",{className:"fa fa-plus"})," Add "))),c.createElement("br",null),c.createElement("div",{className:"card padding-10"},c.createElement("div",{className:""},c.createElement("h4",{className:"title"},"Community Documents")),c.createElement("div",{className:"content"},c.createElement(o.AppContext.Consumer,null,function(t){return c.createElement("div",{className:"dataCard"},c.createElement("div",{className:"row hidden-xs no-padding"},c.createElement("div",{className:"col-md-10 col-sm-12  no-padding dataCard"},c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header-left"},"Name"),c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header"},"Link"),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small grid-header"},"Date"),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small grid-header"},"Entered By")),c.createElement("div",{className:"col-md-1 col-sm-12 headingText"})),n&&n.length>0&&n.map(function(t,n){var a=Object(d.g)(t.linkToDocument);return a=a?a.indexOf("ttp")>0?a:"http://"+a:"",c.createElement("div",{key:t.documentName+"-"+n,className:"row no-padding"},""!=Object(d.g)(t.rdfsLabel)&&c.createElement("div",{className:"no-padding"},c.createElement("div",{className:"col-md-10 col-sm-12  no-padding"},c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(d.g)(t.rdfsLabel)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Name"),c.createElement("a",{href:p.c+"/"+p.a.COMMUNITYDOCS+"/"+encodeURIComponent(Object(d.g)(t.s3FileName?t.s3FileName:t.rdfsLabel)),target:"_blank"},Object(d.g)(t.rdfsLabel))),c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(d.g)(t.linkToDocument)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Link"),c.createElement("a",{href:a,target:"_blank"},a)),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(d.g)(t.date)?new Date(Object(d.g)(t.date)).YYMMDDHHMM():""},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Date"),Object(d.g)(t.date)?new Date(Object(d.g)(t.date)).YYMMDDHHMM():""),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(d.g)(t.enteredByName)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Entered By"),Object(d.g)(t.enteredByName))),c.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12",style:{paddingTop:"3px"}},c.createElement("button",{className:"btn-sm btn-danger active pull-right","data-toggle":"modal","data-target":"#ConfirmDeleteDialog",onClick:function(n){e.onDeleteDocument(t)}},c.createElement("i",{className:"fa fa-trash"})," Delete "))))}),c.createElement("button",{type:"button",id:"btnDocumentForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#documentFormDialog"}," ."),c.createElement(i.a,{id:"documentFormDialog",onSaveButtonClick:function(){e.saveDocument()},saveButtonText:"Save",disableSaveButton:!m}),c.createElement(u.a,{instance:e.props.instance,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this item?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteDocument()}}))})))))))},t}(c.Component);t.default=g}});