webpackJsonp([37],{3217:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(2),s=(n.n(i),n(704)),c=n(709),l=n(3218),o=n(20),r=n(122),u=n(928),h=n(725),d=n(11),p=n(125),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function c(e){try{o(a.next(e))}catch(e){s(e)}}function l(e){try{o(a.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,l)}o((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,a=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){c=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){c.label=s[1];break}if(6===s[0]&&c.label<i[1]){c.label=i[1],i=s;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(s);break}i[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_equipments:[],isEdit:!1,_hardPoints:[],_spaces:[],checklist:Object(),isForTask:!1,_tasks:[],selectedTask:""},n._fetchEquipments=n._fetchEquipments.bind(n),n._fetchSpaces=n._fetchSpaces.bind(n),n.handleTitleChange=n.handleTitleChange.bind(n),n.handleAssetRadioChange=n.handleAssetRadioChange.bind(n),n.handleAssetChange=n.handleAssetChange.bind(n),n.handleActivityAdder=n.handleActivityAdder.bind(n),n.handleTaskChange=n.handleTaskChange.bind(n),n.handleForTaskCheck=n.handleForTaskCheck.bind(n),n.fetchChecklist=n.fetchChecklist.bind(n),n._fetchPoints=n._fetchPoints.bind(n),n._fetchTasks=n._fetchTasks.bind(n),n.saveChecklistToTask=n.saveChecklistToTask.bind(n),n.saveChecklist=n.saveChecklist.bind(n),a=n,n}return m(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchEquipments()]:[3,6];case 1:return e.sent(),[4,this._fetchSpaces()];case 2:return e.sent(),[4,this._fetchPoints()];case 3:return e.sent(),[4,this.fetchChecklist()];case 4:return e.sent(),[4,this._fetchTasks()];case 5:e.sent(),e.label=6;case 6:return[2]}})})},t.prototype.fetchChecklist=function(){return f(this,void 0,void 0,function(){var e,t,n,a=this;return v(this,function(i){switch(i.label){case 0:return e=this.props,t=e.buildingName,(n=e.checklistID)?[4,Object(u.g)(t,n).then(function(e){return f(a,void 0,void 0,function(){var n,a,i,s,c,l;return v(this,function(o){switch(o.label){case 0:return n=e[0],(a=Object()).ontology=Object(d.g)(n.ontology),a.asset=Object(d.g)(n.asset),a.templateID=Object(d.g)(n.templateID),a.assetType=Object(d.g)(n.assetType),a.lastUsed=Object(d.g)(n.lastUsed),a.rdfsLabel=Object(d.g)(n.rdfsLabel),a.uses=parseInt(Object(d.g)(n.uses)),a.activities=[],i=Object(d.g)(n.activities).split(","),[4,Object(u.e)(t,i)];case 1:for(s=o.sent(),c=0;c<s.length;c++)(l=Object()).ontology=Object(d.g)(s[c].ontology),l.action=Object(d.g)(s[c].action),l.point=Object(d.g)(s[c].point),l.pointTag=Object(d.g)(s[c].pointTag),l.reading=Object(d.g)(s[c].reading),l.unit=Object(d.g)(s[c].unit),l.notes=Object(d.g)(s[c].notes),a.activities.push(l);return this.setState({checklist:a,isEdit:!0}),[2]}})})})]:[3,2];case 1:return i.sent(),[3,3];case 2:this.setState({checklist:{activities:[],asset:"",assetType:"None",ontology:Object(o.F)(7),rdfsLabel:"",lastUsed:"",uses:0,module:"",templateID:Object(o.D)(7).toString()},isEdit:!1}),i.label=3;case 3:return[2]}})})},t.prototype._fetchPoints=function(){return f(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=this.props.buildingName,[4,Object(h.l)(e).then(function(e){}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._fetchTasks=function(){return f(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.state._tasks.length<1?(Object(r.a)(!0),[4,Object(p.q)(this.props.buildingName,"",!1,!0).then(function(e){a.setState({_tasks:e})}).catch(function(e){return e})]):[3,2];case 1:e.sent(),Object(r.a)(!1),e.label=2;case 2:return[2]}})})},t.prototype.handleActivityAdder=function(e){var t=this.state.checklist;t.activities=e,this.setState({checklist:t})},t.prototype._fetchEquipments=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return[4,Object(s.i)(this.props.buildingName).then(function(t){e.setState({_equipments:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype._fetchSpaces=function(){return f(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return[4,Object(c.b)(this.props.buildingName).then(function(t){e.setState({_spaces:t})}).catch(function(e){return e})];case 1:return t.sent(),[2]}})})},t.prototype.handleTitleChange=function(e){var t=this.state.checklist;t.rdfsLabel=e,this.setState({checklist:t})},t.prototype.handleAssetRadioChange=function(e){var t=this.state.checklist;t.assetType=e,this.setState({checklist:t})},t.prototype.handleAssetChange=function(e){var t=this.state.checklist;t.asset=e,this.setState({checklist:t})},t.prototype.saveChecklist=function(){return f(this,void 0,void 0,function(){var e,t,n,a;return v(this,function(i){switch(i.label){case 0:return e=this.state,t=e.checklist,n=e.isEdit,a=this.props.buildingName,t?(Object(r.a)(!0),[4,Object(u.i)(t,a,n)]):[3,2];case 1:i.sent(),Object(r.a)(!1),i.label=2;case 2:return window.location.hash="/"+this.props.instance+"/"+this.props.buildingName+"/Checklist",[2]}})})},t.prototype.saveChecklistToTask=function(){return f(this,void 0,void 0,function(){var e,t,n,a,i,s,c,l=this;return v(this,function(h){switch(h.label){case 0:if(e=this.state,t=e.checklist,n=e.selectedTask,a=this.props.buildingName,!t)return[3,2];for(Object(r.a)(!0),(i=Object()).ontology=Object(o.F)(6),i.checklistID=""+Object(o.D)(7),i.rdfsLabel=t.rdfsLabel,i.asset=t.asset,i.assetType=t.assetType,i.activities=[],s=0;s<t.activities.length;s++)(c=Object()).ontology=t.activities[s].ontology,c.action=t.activities[s].action,c.point=t.activities[s].point,c.pointTag=t.activities[s].pointTag,c.reading=t.activities[s].reading,c.unit=t.activities[s].unit,c.notes=t.activities[s].notes,c.status="Pending",i.activities.push(c);return[4,Object(u.h)(i,a,!1).then(function(){return f(l,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,Object(p.k)(n,i.ontology)];case 1:return e.sent(),[2]}})})})];case 1:h.sent(),Object(r.a)(!1),h.label=2;case 2:return window.location.hash="/"+this.props.instance+"/"+this.props.buildingName+"/Checklist",[2]}})})},t.prototype.handleTaskChange=function(e){this.setState({selectedTask:e})},t.prototype.handleForTaskCheck=function(e){var t=this.state.selectedTask;e||(t=""),this.setState({isForTask:e,selectedTask:t})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,a=t.buildingName,s=this.state,c=s._equipments,o=s._spaces,r=s.checklist,u=s.isEdit,h=s.isForTask,p=s._tasks,m=s.selectedTask,f=""!=r.rdfsLabel&&""!=r.assetType&&r.activities&&r.activities.length>0&&!1===r.activities.map(function(e){return""==e.action}).find(function(e){return!1===e}),v=""!=r.rdfsLabel&&""!=r.assetType&&""!=m&&r.activities&&r.activities.length>0&&!1===r.activities.map(function(e){return""==e.action}).find(function(e){return!1===e}),b="None"!=r.assetType;return i.createElement("div",{className:"content"},i.createElement("div",{className:"card"},i.createElement("div",{className:"container-fluid"},i.createElement("div",{className:"row padding-10"},i.createElement("div",{className:"col-md-6"},i.createElement("h4",{className:"title"},"Checklist Template Build")),i.createElement("div",{className:"col-md-3"},u&&i.createElement("label",null,"Checklist Template ID: ",r.templateID)),i.createElement("div",{className:"col-md-3"},i.createElement("button",{className:"btn btn-secondary btn-fill pull-right",onClick:function(){window.location.hash=n+"/"+a+"/Checklist"}},i.createElement("i",{className:"fa fa-angle-double-left"}),"  Back "),!h&&i.createElement("button",{className:"btn btn-success btn-fill pull-right",style:{marginRight:3},disabled:!f,onClick:function(){e.saveChecklist()}},i.createElement("i",{className:"fa fa-save"})," Save Template"),h&&i.createElement("button",{className:"btn btn-success btn-fill pull-right",style:{marginRight:3},disabled:!v,onClick:function(){e.saveChecklistToTask()}},i.createElement("i",{className:"fa fa-save"})," Save To Task"))),i.createElement("br",null),i.createElement("br",null),i.createElement("div",{className:"col-md-12"},i.createElement("div",{className:"row form-group"},i.createElement("div",{className:"col-md-2 col-xs-12"},i.createElement("label",{htmlFor:"title"},"Title")),i.createElement("div",{className:"col-md-4 col-xs-12"},i.createElement("input",{id:"title",type:"text",className:"form-control",name:"title",value:r.rdfsLabel,onChange:function(t){e.handleTitleChange(t.target.value)}})))),i.createElement("div",{className:"col-md-12"},i.createElement("div",{className:"row form-group"},i.createElement("div",{className:"col-md-2 col-xs-12"},i.createElement("label",{htmlFor:"assettype"},"Select Asset Type")),i.createElement("div",{className:"col-md-4 col-xs-12"},i.createElement("label",{className:"radio-inline"}," ",i.createElement("input",{type:"radio",name:"rdEquipment",value:"Equipment",checked:"Equip"==r.assetType,onChange:function(t){e.handleAssetRadioChange("Equip")}}),"Equipment"),i.createElement("br",null),i.createElement("label",{className:"radio-inline"}," ",i.createElement("input",{type:"radio",name:"rdSpace",value:"Space",checked:"Space"==r.assetType,onChange:function(t){e.handleAssetRadioChange("Space")}}),"Space"),i.createElement("br",null),i.createElement("label",{className:"radio-inline"}," ",i.createElement("input",{type:"radio",name:"rdNone",value:"None",checked:"None"==r.assetType,onChange:function(t){e.handleAssetRadioChange("None")}}),"None"),i.createElement("br",null)),"Equip"==r.assetType&&i.createElement("div",{className:"col-md-4 col-xs-12"},i.createElement("select",{className:"form-control",id:"equip",name:"equip",value:r.asset,onChange:function(t){e.handleAssetChange(t.target.value)}},i.createElement("option",{value:""},"Select Equipment"),c.map(function(e,t){return i.createElement("option",{key:t,value:e.equip.value},e.equipRdfsLabel.value)}))),"Space"==r.assetType&&i.createElement("div",{className:"col-md-4 col-xs-12"},i.createElement("select",{className:"form-control",id:"equip",name:"equip",value:r.asset,onChange:function(t){e.handleAssetChange(t.target.value)}},i.createElement("option",{value:""},"Select Space"),o.map(function(e,t){return i.createElement("option",{key:t,value:e.ontology.value},e.rdfsLabel.value)}))))),i.createElement("div",{className:"col-md-12"},i.createElement("div",{className:"row form-group"},i.createElement("div",{className:"col-md-2 col-xs-12"},i.createElement("label",null,"Assign Checklist to Task")),i.createElement("div",{className:"col-md-4 col-xs-12"},i.createElement("div",{className:"form-group"},i.createElement("input",{type:"checkbox",checked:h,onChange:function(t){e.handleForTaskCheck(t.target.checked)}}))),h&&i.createElement("div",{className:"col-md-4 col-xs-12"},i.createElement("select",{className:"form-control",id:"task",name:"task",value:m,onChange:function(t){e.handleTaskChange(t.target.value)}},i.createElement("option",{value:""},"Select Task"),p&&p.filter(function(e){return"Completed"!=Object(d.g)(e.status)}).map(function(e,t){return i.createElement("option",{key:t,value:Object(d.g)(e.task)},Object(d.g)(e.taskNumber)+"-"+Object(d.g)(e.description))}))))),i.createElement("div",{className:"col-md-12 hidden-xs"},i.createElement("div",{className:"col-md-3 col-sm-3 small grid-header-left"},"Action"),b&&i.createElement("div",{className:"col-md-3 col-sm-3 small grid-header-left"},"Point"),b&&i.createElement("div",{className:"col-md-2 col-sm-2 small grid-header-left"},"Point/Status Tag"),b&&i.createElement("div",{className:"col-md-1 col-sm-1 small grid-header-left"},"Units"),i.createElement("div",{className:"col-md-3 col-sm-3 small grid-header-left"},"Data Entry")),i.createElement("div",{className:"col-md-12"},i.createElement(l.a,{checklist:r,instance:n,buildingName:a,activities:r.activities,handleActivityAdder:this.handleActivityAdder})))))},t}(i.Component);t.default=b},3218:function(e,t,n){"use strict";var a=n(2),i=(n.n(a),n(122)),s=n(20),c=n(725),l=n(11),o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,s){function c(e){try{o(a.next(e))}catch(e){s(e)}}function l(e){try{o(a.throw(e))}catch(e){s(e)}}function o(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,l)}o((a=a.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var n,a,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,a=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){c=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){c.label=s[1];break}if(6===s[0]&&c.label<i[1]){c.label=i[1],i=s;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(s);break}i[2]&&c.ops.pop(),c.trys.pop();continue}s=t.call(e,c)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={activities:n.props.activities,_points:[],filter_points:[]},n._fetchManualPoints=n._fetchManualPoints.bind(n),n.addItem=n.addItem.bind(n),n.handleActionChange=n.handleActionChange.bind(n),n.handlePointChange=n.handlePointChange.bind(n),n.handlePointTagChange=n.handlePointTagChange.bind(n),n.handleReadingChange=n.handleReadingChange.bind(n),n.handleNotesChange=n.handleNotesChange.bind(n),n}return o(t,e),t.prototype.componentDidMount=function(){return r(this,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchManualPoints()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.state,n=t._points,a=t.filter_points;a=[],n&&n.length>0&&e.checklist&&e.checklist.asset&&e.checklist.asset.length>0&&("Equip"==e.checklist.assetType?a=n.filter(function(t){return Object(l.g)(t.asset)==e.checklist.asset}):"Space"==e.checklist.assetType&&(a=n.filter(function(t){return Object(l.g)(t.space)==e.checklist.asset}))),this.setState({filter_points:a,activities:e.activities})},t.prototype._fetchManualPoints=function(){return r(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return e=this.props.buildingName,Object(i.a)(!0),[4,Object(c.l)(e).then(function(e){}).catch(function(e){return e})];case 1:return t.sent(),Object(i.a)(!1),[2]}})})},t.prototype.addItem=function(){var e={ontology:Object(s.F)(7),point:"",pointTag:"",action:"",reading:"",unit:"",notes:""},t=this.state.activities;t?t.push(e):t=[e],this.setState({activities:t}),this.props.handleActivityAdder(t)},t.prototype.handleActionChange=function(e,t){var n=this.state.activities;n[e].action=t,this.setState({activities:n}),this.props.handleActivityAdder(n)},t.prototype.handlePointChange=function(e,t){var n=this.state,a=n.activities,i=n._points;if(t&&i.length>0){var s=i&&i.find(function(e){return Object(l.g)(e.point)==t});a[e].unit=Object(l.g)(s.unit),a[e].pointTag=Object(l.g)(s.tag),a[e].point=t}else a[e].unit="",a[e].point="";this.setState({activities:a}),this.props.handleActivityAdder(a)},t.prototype.handlePointTagChange=function(e,t){var n=this.state.activities;n[e].pointTag=t,this.setState({activities:n}),this.props.handleActivityAdder(n)},t.prototype.handleReadingChange=function(e,t){var n=this.state.activities;n[e].reading=t,this.setState({activities:n}),this.props.handleActivityAdder(n)},t.prototype.handleNotesChange=function(e,t){var n=this.state.activities;n[e].notes=t,this.setState({activities:n}),this.props.handleActivityAdder(n)},t.prototype.render=function(){var e=this,t=this.state,n=t.activities,i=t.filter_points,s=this.props.checklist,c=n&&!1===n.map(function(e){return""!==e.action&&""!==e.ontology}).find(function(e){return!1===e}),o=n&&!c||!n,r="None"!=s.assetType;return a.createElement(a.Fragment,null,n&&n.map(function(t,n){return a.createElement("div",{key:n,className:"row"},a.createElement("br",null),a.createElement("div",{className:"col-md-3 col-sm-3"},a.createElement("div",{className:"form-group"},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Action"),a.createElement("input",{type:"text ",id:"action",className:"form-control",value:t.action,onChange:function(t){return e.handleActionChange(n,t.target.value)}}))),r&&a.createElement("div",{className:"col-md-3 col-sm-3"},a.createElement("div",{className:"form-group"},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Point"),a.createElement("select",{className:"form-control",value:t.point,onChange:function(t){return e.handlePointChange(n,t.target.value)}},a.createElement("option",{value:"",key:-2},"Select Point"),i.map(function(e,t){return a.createElement("option",{key:t,value:Object(l.g)(e.point)},Object(l.g)(e.pointLabel))})))),r&&a.createElement("div",{className:"col-md-2 col-sm-2"},a.createElement("div",{className:"form-group"},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Point/Status Tag"),a.createElement("input",{type:"text ",id:"tag",className:"form-control",disabled:!0,value:t.pointTag,onChange:function(t){return e.handlePointTagChange(n,t.target.value)}}))),r&&a.createElement("div",{className:"col-md-1 col-sm-1"},a.createElement("div",{className:"form-group"},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Unit"),a.createElement("input",{type:"text ",id:"units",disabled:!0,className:"form-control",value:t.unit}))),a.createElement("div",{className:"col-md-3 col-sm-3"},a.createElement("div",{className:"form-group"},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Date Entry"),a.createElement("input",{type:"text ",id:"notes",className:"form-control",value:t.notes,onChange:function(t){return e.handleNotesChange(n,t.target.value)}}))),a.createElement("hr",{className:"visible-xs"}))}),a.createElement("br",null),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-1"},a.createElement("label",null,"Add:")),a.createElement("div",{className:"col-md-11 col-xs-11"},a.createElement("button",{type:"button",disabled:!o,className:"btn btn-dark btn-fill btn-sm",onClick:this.addItem},a.createElement("i",{className:"fa fa-plus"})))),a.createElement("br",null))},t}(a.Component);t.a=h}});