webpackJsonp([71],{737:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,c=n(2),i=(n.n(c),n(15)),o=n(10),r=n(7),l=n(30),s=n(829),u=n(5),d=n(11),m=n(31),f=n(56),h=n(165),b=n(9),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(c,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function r(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?c(e.value):new n(function(t){t(e.value)}).then(o,r)}l((a=a.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var n,a,c,i,o={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(c=2&i[0]?a.return:i[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,i[1])).done)return c;switch(a=0,c&&(i=[2&i[0],c.value]),i[0]){case 0:case 1:c=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(c=(c=o.trys).length>0&&c[c.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!c||i[1]>c[0]&&i[1]<c[3])){o.label=i[1];break}if(6===i[0]&&o.label<c[1]){o.label=c[1],c=i;break}if(c&&o.label<c[2]){o.label=c[2],o.ops.push(i);break}c[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=c=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}},D=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isEdit:!1,documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},Documents:[],DocumentTypes:h.a,itemToDelete:Object(),files:[]},a=n,n.handleTypeFilters=n.handleTypeFilters.bind(n),n.handleDocumentForm=n.handleDocumentForm.bind(n),n.saveDocument=n.saveDocument.bind(n),n.fetchDocuments=n.fetchDocuments.bind(n),n.onDeleteDocument=n.onDeleteDocument.bind(n),n.deleteDocument=n.deleteDocument.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this.fetchDocuments()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.fetchDocuments=function(){return v(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,Object(s.b)(this.props.buildingName).then(function(e){a.setState({Documents:e})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.handleTypeFilters=function(e){var t=e.target.checked,n=this.state.DocumentTypes;n[n.findIndex(function(t){return t.Type===e.target.value})].visible=t,this.setState({DocumentTypes:n});for(var a=[],c=h.b,i=0;i<c.length;i++)for(var o=0;o<n.length;o++)n[o].Type==c[i].Type&&1==n[o].visible&&a.push(c[i]);this.setState({Documents:a})},t.prototype.saveDocument=function(){return v(this,void 0,void 0,function(){var e,t,n,c,i,o,u,d,m,h=this;return y(this,function(p){switch(p.label){case 0:return e=this.state,t=e.documentObject,n=e.isEdit,c=e.itemToDelete,t&&t.infoEntity?(Object(l.a)(!0),1!=n?[3,2]:[4,Object(s.e)(this.props.buildingName,t,this.state.isEdit,c)]):[3,5];case 1:return p.sent(),[3,4];case 2:return i=JSON.parse(b.a.getItem("user")),t.enteredBy=i.contact,[4,Object(s.e)(this.props.buildingName,t,this.state.isEdit)];case 3:p.sent(),p.label=4;case 4:if(o=new f.b,(u=Object(r.d)())&&u.length)for(d=0;d<u.length;d++)(m=u[d])||(m=u[d].file),m&&o.UploadFile(f.a.COMMUNITYDOCS,t.s3FileName[d],m,function(e,t){e?console.log(e):console.log(t)});this.setState({documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},files:[],isEdit:!1},function(){return v(h,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,a.fetchDocuments()];case 1:return e.sent(),[2]}})})}),Object(l.a)(!1),p.label=5;case 5:return[2]}})})},t.prototype.onDeleteDocument=function(e){return v(this,void 0,void 0,function(){return y(this,function(t){return this.setState({itemToDelete:e}),[2]})})},t.prototype.deleteDocument=function(){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=this.state.itemToDelete).documentName.value?[4,Object(d.d)(e.documentName.value,r.b.DOCS)]:[3,3];case 1:return t.sent(),[4,this.fetchDocuments()];case 2:t.sent(),Object(s.c)(e.rdfsLabel.value).then(function(t){t&&0==t.length&&(new f.b).DeleteFile(f.a.COMMUNITYDOCS,e.rdfsLabel.value)}),t.label=3;case 3:return[2]}})})},t.prototype.onEditDocument=function(e){return v(this,void 0,void 0,function(){var t;return y(this,function(n){return(t=this.state.documentObject).infoEntity=[],t.documentType=e.documentType&&e.documentType.value,t.rdfsLabel=e.rdfsLabel&&e.rdfsLabel.value,t.documentName=e.documentName&&e.documentName.value,t.enteredBy=e.enteredBy&&e.enteredBy.value,t.enteredByName=e.enteredByName&&e.enteredByName.value,this.setState({documentObject:t,isEdit:!0,itemToDelete:e}),document.getElementById("btnDocumentForm").click(),[2]})})},t.prototype.handleDocumentForm=function(e,t){this.setState({documentObject:e,files:t})},t.prototype.render=function(){var e=this,t=this.state,n=t.Documents,a=t.DocumentTypes,l=t.documentObject,s=(this.props,Object(r.c)()),d=l.rdfsLabel&&(l.s3FileName&&s||l.linkToDocument)&&!0;return c.createElement("div",{className:"content"},c.createElement("div",{className:"container-fluid"},c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement(o.a,{id:"filterDocumentsModal",heading:"Filter Documents",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},a&&a.length>0&&a.map(function(t,n){return!0===t.visible?c.createElement("div",{key:t+"-"+n},c.createElement("input",{checked:!0,type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",c.createElement("label",null,t.Type)):c.createElement("div",null,c.createElement("input",{type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",c.createElement("label",null,t.Type))})),c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement("button",{type:"button",className:"btn btn-dark pull-right","data-toggle":"modal","data-target":"#documentFormDialog",onClick:function(){e.setState({isEdit:!1,files:[],documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""}})}},c.createElement("i",{className:"fa fa-plus"})," Add "))),c.createElement("br",null),c.createElement("div",{className:"card padding-10"},c.createElement("div",{className:""},c.createElement("h4",{className:"title"},"Community Documents")),c.createElement("div",{className:"content"},c.createElement(i.AppContext.Consumer,null,function(t){return c.createElement("div",{className:"dataCard"},c.createElement("div",{className:"row hidden-xs no-padding"},c.createElement("div",{className:"col-md-10 col-sm-12  no-padding dataCard"},c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header-left"},"Name"),c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header"},"Link"),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small grid-header"},"Date"),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small grid-header"},"Entered By")),c.createElement("div",{className:"col-md-1 col-sm-12 headingText"})),n&&n.length>0&&n.map(function(t,n){var a=Object(u.g)(t.linkToDocument);return a=a?a.indexOf("ttp")>0?a:"http://"+a:"",c.createElement("div",{key:t.documentName+"-"+n,className:"row no-padding"},""!=Object(u.g)(t.rdfsLabel)&&c.createElement("div",{className:"no-padding"},c.createElement("div",{className:"col-md-10 col-sm-12  no-padding"},c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(u.g)(t.rdfsLabel)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Name"),c.createElement("a",{href:f.c+"/"+f.a.COMMUNITYDOCS+"/"+encodeURIComponent(Object(u.g)(t.s3FileName?t.s3FileName:t.rdfsLabel)),target:"_blank"},Object(u.g)(t.rdfsLabel))),c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(u.g)(t.linkToDocument)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Link"),c.createElement("a",{href:a,target:"_blank"},a)),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(u.g)(t.date)?new Date(Object(u.g)(t.date)).YYMMDDHHMM():""},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Date"),Object(u.g)(t.date)?new Date(Object(u.g)(t.date)).YYMMDDHHMM():""),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(u.g)(t.enteredByName)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Entered By"),Object(u.g)(t.enteredByName))),c.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12",style:{paddingTop:"3px"}},c.createElement("button",{className:"btn-sm btn-danger active pull-right","data-toggle":"modal","data-target":"#ConfirmDeleteDialog",onClick:function(n){e.onDeleteDocument(t)}},c.createElement("i",{className:"fa fa-trash"})," Delete "))))}),c.createElement("button",{type:"button",id:"btnDocumentForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#documentFormDialog"}," ."),c.createElement(o.a,{id:"documentFormDialog",onSaveButtonClick:function(){e.saveDocument()},saveButtonText:"Save",disableSaveButton:!d}),c.createElement(m.a,{instance:e.props.instance,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this item?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteDocument()}}))})))))))},t}(c.Component);t.default=D},829:function(e,t,n){"use strict";t.f=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({model:e},i.a.DOCUMENTS.SaveDocument,a.b.DOCS).then(function(){Object(c.b)("Document Added Successfully.")}).catch(function(e){Object(c.a)("Error occured while saving Document.")})];case 1:return[2,t.sent()]}})})},t.d=function(e,t,n){return o(this,void 0,void 0,function(){return r(this,function(c){switch(c.label){case 0:return[4,Object(i.e)({buildingName:e,entityType:t,entityOntology:n},i.a.DOCUMENTS.GetDocuments,a.b.DOCS,!0)];case 1:return[2,c.sent()]}})})},t.a=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.f)({ontology:e},i.a.DOCUMENTS.DeleteDocument,a.b.DOCS)];case 1:return[2,t.sent()]}})})},t.e=function(e,t,n,l){return o(this,void 0,void 0,function(){return r(this,function(o){switch(o.label){case 0:return[4,Object(i.f)({buildingName:e,model:t,isEdit:n,itemToUpdate:l},i.a.DOCUMENTS.SaveCommunityDoc,a.b.DOCS).then(function(){Object(c.b)("Community Document "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(c.a)("Error occured while saving Community Document.")})];case 1:return[2,o.sent()]}})})},t.b=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({buildingName:e},i.a.DOCUMENTS.GetCommunityDocs,a.b.DOCS,!0)];case 1:return[2,t.sent()]}})})},t.c=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Object(i.e)({fileName:e},i.a.DOCUMENTS.GetDocumentFilesList,a.b.DOCS,!0)];case 1:return[2,t.sent()]}})})};var a=n(7),c=n(3),i=n(4),o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(c,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function r(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?c(e.value):new n(function(t){t(e.value)}).then(o,r)}l((a=a.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,a,c,i,o={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(i){return function(r){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(c=2&i[0]?a.return:i[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,i[1])).done)return c;switch(a=0,c&&(i=[2&i[0],c.value]),i[0]){case 0:case 1:c=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(c=(c=o.trys).length>0&&c[c.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!c||i[1]>c[0]&&i[1]<c[3])){o.label=i[1];break}if(6===i[0]&&o.label<c[1]){o.label=c[1],c=i;break}if(c&&o.label<c[2]){o.label=c[2],o.ops.push(i);break}c[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=c=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,r])}}}}});