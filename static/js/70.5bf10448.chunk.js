webpackJsonp([70],{1182:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=(n.n(r),n(678)),o=n(651),i=n(24),c=n(683),l=n(117),s=n(650),u=n(11),d=n(725),m=n(671),f=n(10),p=n(659),h=n(721),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=this&&this.__assign||function(){return(b=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},v=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{l(r.next(e))}catch(e){o(e)}}function c(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?a(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,c)}l((r=r.apply(e,t||[])).next())})},E=this&&this.__generator||function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={CbW406BoardInfo:Object(),Old_Cbw406BoardInfo:Object(),modelChanged:!1,Moncon:{monitoringControl:"",monitoringControlDeviceType:"",deviceName:"",floor:"",rdfsLabel:"",manufacturer:"",model:"",location:"",computingDevice:"",connectionType:"",notes:"",wirelessConfig:{ipAddress:"",controllerIPAddress:"",thermostatMacAddress:"",ssid:"",password:""},isSchedule:!1,relatedEquipment:[],deviceNumber:"",enclosure:""},EquipmentList:[],currentChange:"",detailsExpanded:!1,localBTNState:!1,showErrorOnce:!1,spaces:[],intervalId:Object(),intervalCounter:0,computingDevice:Object()},n,n._fetchData=n._fetchData.bind(n),n._fetchCBW406BoardInfo=n._fetchCBW406BoardInfo.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){return E(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchData()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.setIntervalStart(),[2]}})})},t.prototype.setIntervalStart=function(){var e=this,t=this.state.intervalId;t&&clearInterval(t),t=setInterval(function(){return v(e,void 0,void 0,function(){var e;return E(this,function(t){return e=this.state.intervalCounter,++e>=1&&(this._fetchCBW406BoardInfo(!1),e=0),this.setState({intervalCounter:e}),[2]})})},1e3),this.setState({intervalId:t})},t.prototype.componentWillUnmount=function(){return v(this,void 0,void 0,function(){return E(this,function(e){return this.state.intervalId&&clearInterval(this.state.intervalId),this.setState({intervalId:null}),[2]})})},t.prototype._fetchData=function(){return v(this,void 0,void 0,function(){var e,t,n,r,a,i,c,d,f,p,h=this;return E(this,function(g){switch(g.label){case 0:return this.state,e=this.props,t=e.deviceName,n=e.buildingName,t?(Object(l.a)(!0),[4,Object(s.h)(this.props.buildingName)]):[3,6];case 1:return r=g.sent(),a=r&&r.length>0&&r.map(function(e){return{value:Object(u.g)(e.ontology),label:Object(u.g)(e.rdfsLabel)}}),i=Object(),c=Object(),[4,Object(o.v)(t,n)];case 2:return(i=g.sent())&&i.computingDevice?[4,Object(m.f)(i.computingDevice)]:[3,5];case 3:return d=g.sent(),[4,Object(m.d)(d)];case 4:(f=g.sent())&&f.length>0&&(c=f[0]),g.label=5;case 5:localStorage.getItem(i.deviceID)&&localStorage.getItem(i.deviceID).length>0&&(p=JSON.parse(localStorage.getItem(i.deviceID)),this.setState({CbW406BoardInfo:p,Old_Cbw406BoardInfo:b({},p),modelChanged:!1,currentChange:""})),this.setState({Moncon:i,computingDevice:c,EquipmentList:a},function(){return v(h,void 0,void 0,function(){return E(this,function(e){return this._fetchCBW406BoardInfo(!0),[2]})})}),Object(l.a)(!1),g.label=6;case 6:return[2]}})})},t.prototype._fetchCBW406BoardInfo=function(e){return v(this,void 0,void 0,function(){var t,n,r,o,c=this;return E(this,function(s){switch(s.label){case 0:return e&&Object(l.a)(!0),t=this.state,n=t.Moncon,r=t.showErrorOnce,[4,Object(a.f)(n.topic,new Date,new Date,!0).then(function(e){var t=e[0];return!t||t&&t.error?(r||(Object(i.a)("Error occurred while fetching CBW406 sensor board info."),c.setState({showErrorOnce:!0})),Object()):(c.setState({showErrorOnce:!1}),localStorage.setItem(n.deviceID,JSON.stringify(e)),t)}).catch(function(e){return Object()})];case 1:return o=s.sent(),this.setState({CbW406BoardInfo:o,Old_Cbw406BoardInfo:b({},o),modelChanged:!1,currentChange:""}),e&&Object(l.a)(!1),[2]}})})},t.prototype.resetChanges=function(e){return v(this,void 0,void 0,function(){var t=this;return E(this,function(n){return this.setState({modelChanged:!1,currentChange:""},function(){return v(t,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,this._fetchCBW406BoardInfo(e)];case 1:return t.sent(),[2]}})})}),[2]})})},t.prototype.getRelatedEquipmentLabel=function(e){var t=this.state.EquipmentList,n=Object();return(n=t&&t.find(function(t){return t.value==e}))&&n.label},t.prototype.bootDevice=function(){return v(this,void 0,void 0,function(){var e,t,n,r=this;return E(this,function(a){switch(a.label){case 0:return e=this.props.buildingName,t=this.state.computingDevice,!(n=JSON.parse(f.a.getItem("user")))||!n.role||"1"!=n.role&&"2"!=n.role?[3,2]:(Object(l.a)(!0,"Booting Device"),[4,Object(p.L)(t,e).then(function(e){return v(r,void 0,void 0,function(){return E(this,function(t){return 0==e.responseCode?Object(i.b)(e.responseMessage):Object(i.a)(e.responseMessage),[2]})})}).catch(function(e){Object(i.a)("Some error orccured. ")})]);case 1:a.sent(),Object(l.a)(!1),a.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.deviceName,a=t.instance,o=t.buildingName,i=t.type,l=t.hideTabs,s=this.state,u=s.CbW406BoardInfo,m=s.Moncon,p=s.detailsExpanded,g="not refreshed",b=JSON.parse(f.a.getItem("user"));return u&&u.timestamp&&(g=new Date(u.timestamp).toLocaleString()),r.createElement("div",{className:"content"},r.createElement("div",{className:"container-fluid"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12"},!l&&r.createElement(c.a,{InsightName:n,ControlName:"CBW406",buildingName:o,instance:a,type:i,hideADP:!0,hideSchedule:!0,hideAlarms:!0}),r.createElement("div",{className:"card",id:"InsightsList"},r.createElement("div",{className:"container-fluid"},r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-12"},r.createElement("div",{className:"header"},r.createElement("h3",{className:"title"},r.createElement("strong",null,m.rdfsLabel)," "),r.createElement("h4",{className:"title"},r.createElement("strong",null,this.props.type.toUpperCase(),":",m&&m.relatedEquipment&&m.relatedEquipment.map(function(t,n){return r.createElement("span",{key:n},e.getRelatedEquipmentLabel(t.value),n+1==m.relatedEquipment.length?"":",")}))),r.createElement("h4",{className:"title mt-2"},r.createElement("strong",null,"Voltage In: ",u.vin)),b&&b.role&&("1"==b.role||"2"==b.role)&&r.createElement("div",{className:"row"},r.createElement("button",{className:"btn btn-success active pull-right custom-outline-btn m-3",title:"Boot PI Board","data-toggle":"modal","data-target":"#bootDevice"}," ",r.createElement("i",{className:"fa fa-refresh"})," Boot PI Board")),r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-6 col-xs-12 tempCounter roomTemp"},r.createElement("b",{className:"devcieCard-h"},"Refrigerator 1"),r.createElement("div",{className:"devicesCard"},r.createElement("h4",{className:"padding-5 margin-5"},"T3 Front: ",r.createElement("b",null,u&&u.t3frontRefrigerator1?u.t3frontRefrigerator1.toFixed(2):0)),r.createElement("h4",{className:"padding-5 margin-5"},"T6 Compresssor In: ",r.createElement("b",null,u&&u.t6comprinRefrigerator1?u.t6comprinRefrigerator1.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T4 Back: ",r.createElement("b",null,u&&u.t4backRefrigerator1?u.t4backRefrigerator1.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T7 Compresssor Out: ",r.createElement("b",null,u&&u.t7comproutRefrigerator1?u.t7comproutRefrigerator1.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T5 Evap Fan: ",r.createElement("b",null,u&&u.t5evapfanRefrigerator1?u.t5evapfanRefrigerator1.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T8 Wax Probe: ",r.createElement("b",null,u&&u.t8probeRefrigerator1?u.t8probeRefrigerator1.toFixed(2):"-")))),r.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},r.createElement("b",{className:"devcieCard-h"},"Refrigerator 2"),r.createElement("div",{className:"devicesCard"},r.createElement("h4",{className:"padding-5 margin-5"},"T3 Front: ",r.createElement("b",null,u&&u.t3frontRefrigerator2?u.t3frontRefrigerator2.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T6 Compresssor In: ",r.createElement("b",null,u&&u.t6comprinRefrigerator2?u.t6comprinRefrigerator2.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T4 Back: ",r.createElement("b",null,u&&u.t4backRefrigerator2?u.t4backRefrigerator2.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T7 Compresssor Out: ",r.createElement("b",null,u&&u.t7comproutRefrigerator2?u.t7comproutRefrigerator2.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T5 Evap Fan: ",r.createElement("b",null,u&&u.t5evapfanRefrigerator2?u.t5evapfanRefrigerator2.toFixed(2):"-")),r.createElement("h4",{className:"padding-5 margin-5"},"T8 Wax Probe: ",r.createElement("b",null,u&&u.t8probeRefrigerator2?u.t8probeRefrigerator2.toFixed(2):"-"))))))))),r.createElement("div",{className:"content"},m.monitoringControl&&m.monitoringControlDeviceType&&r.createElement(d.a,{instance:a,buildingName:o,monconType:m.monitoringControlDeviceType,moncon:m.monitoringControl,deviceId:m.deviceID,monconRDFsLabel:m.rdfsLabel}),r.createElement("div",{className:"accordion row padding-10",id:"accordionExample"+n,style:{paddingLeft:"30px",border:"1px solid #80808066",margin:"10px",borderRadius:"7px"}},r.createElement("div",{className:"",id:"headingOne"},r.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne"+n,style:{border:0,left:"-25px",position:"relative"},"aria-expanded":"true","aria-controls":"collapseOne"+n,onClick:function(){e.setState({detailsExpanded:!p})}},r.createElement("i",{className:p?"fa fa-minus":"fa fa-plus","aria-hidden":"true"}),"\xa0 Device Info")),r.createElement("div",{id:"collapseOne"+n,className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"+n},r.createElement("div",{className:"col-md-6 col-xs-12 padding-10"},r.createElement("h5",{className:"title"},r.createElement("strong",null,"IP Address:")," ",m&&m.wirelessConfig&&m.wirelessConfig.ipAddress),r.createElement("h5",{className:"title"},r.createElement("strong",null,"Controller IP Address:")," ",m.wirelessConfig&&m.wirelessConfig.controllerIPAddress),r.createElement("h5",{className:"title"},r.createElement("strong",null,"Manufacturer:")," ",m.manufacturer),r.createElement("h5",{className:"title"},r.createElement("strong",null,"Model:")," ",m.model),r.createElement("h5",{className:"title"},r.createElement("strong",null,"Device ID:")," ",m&&m.deviceID?m.deviceID:""),r.createElement("h5",{className:"title"},r.createElement("strong",null,"Last Data Synced At:")," ",g))))),r.createElement(h.a,{id:"bootDevice",heading:"Boot Device",cancelButtonText:"Cancel",showCreateButton:!0,createButtonText:"Boot",showRestoreButton:!0,showCancelButton:!0,onSaveButtonClick:function(){return e.bootDevice()}},r.createElement("h4",null,"Are you sure you want to boot device?")))))))},t}(r.Component);t.default=N}});