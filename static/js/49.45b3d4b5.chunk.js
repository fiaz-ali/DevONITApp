webpackJsonp([49],{1181:function(e,t,n){"use strict";var a=n(2),o=n.n(a),i=n(854),r=n(1004),l=(n.n(r),n(671)),c=n(53),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),d=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,l)}c((a=a.apply(e,t||[])).next())})},m=this&&this.__generator||function(e,t){var n,a,o,i,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(o=2&i[0]?a.return:i[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:!1,photoIndex:0,filesName:n.props.filesName},n}return s(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({filesName:e.filesName})},t.prototype.deleteFile=function(e){return d(this,void 0,void 0,function(){var t,n,a,o,i=this;return m(this,function(r){switch(r.label){case 0:return t=this.props.filesName,n=this.props.buildingName,a=this.props.equipment,o=t&&t[e],t.splice(e,1),(new c.b).DeleteFile(c.a.DOCUMENT(),o),this.props.isFromEquipment?[4,Object(l.z)(n,a,!0,!0).then(function(){i.props.onChangeFiles(t)})]:[3,2];case 1:return r.sent(),[3,3];case 2:this.props.isFromComponent?this.props.saveComponent():this.props.onChangeFiles(t),r.label=3;case 3:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.filesName,a=t.showDownloadLink,r=t.showRemoveButton,l=t.showImageViewer,s=this.state,d=s.isOpen,m=s.photoIndex,u=new c.b,p=n&&n[m],f=u.GetSignedURL(c.a.DOCUMENT(),n&&n[m]),h="";return p?(p.toLowerCase().indexOf(".mp4")>0&&(h="assets/img/video-file-icon.png"),p.toLowerCase().indexOf(".pdf")>0&&(h="assets/img/pdf-file-icon.png"),!(p.toLowerCase().indexOf(".pdf")>0||p.toLowerCase().indexOf(".mp4")>0||p.toLowerCase().indexOf(".png")>0||p.toLowerCase().indexOf(".jpeg")>0||p.toLowerCase().indexOf(".jpg")>0)&&(h=f)):h=f,o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"col-md-12 no-padding",style:{display:"grid"}},n&&n.length>0&&n.map(function(t,n){var i=u.GetSignedURL(c.a.DOCUMENT(),t);if(t)return o.a.createElement("div",{key:"image",className:"col-md-3 mb-2",style:{paddingRight:"0px",lineHeight:"3"}},o.a.createElement("div",null,r&&o.a.createElement("div",{className:"discobtn headingText files-delete-cross pull-right",title:"Delete",onClick:function(){e.deleteFile(n)}},o.a.createElement("i",{className:"fa fa-close"})),o.a.createElement("div",{className:"row"},o.a.createElement("div",{onClick:function(){e.setState({isOpen:!0,photoIndex:n})},style:{cursor:"pointer",marginLeft:"10px"}},t.toLowerCase().indexOf(".mp4")>0&&o.a.createElement("img",{className:"img-thumbnail",style:{width:"200px",height:"200px"},src:"assets/img/video-file-icon.png"}),t.toLowerCase().indexOf(".pdf")>0&&o.a.createElement("img",{className:"img-thumbnail",style:{width:"200px",height:"200px"},src:"assets/img/pdf-file-icon.png"}),!(t.toLowerCase().indexOf(".pdf")>0||t.toLowerCase().indexOf(".mp4")>0||t.toLowerCase().indexOf(".png")>0||t.toLowerCase().indexOf(".jpeg")>0||t.toLowerCase().indexOf(".jpg")>0)&&o.a.createElement("img",{className:"img-thumbnail",style:{width:"200px",height:"200px"},src:"assets/img/office-file-icon.png"}),(t.toLowerCase().indexOf(".jpg")>0||t.toLowerCase().indexOf(".jpeg")>0||t.toLowerCase().indexOf(".png")>0)&&o.a.createElement("img",{className:"img-thumbnail",style:{width:"200px",height:"200px"},src:i})),a&&o.a.createElement("div",{className:" discobtn trim-data center"},o.a.createElement("a",{className:"downloadImageBtn discobtn trim-data",href:i},!l&&o.a.createElement("span",null," Download File "))))))})),d&&n&&o.a.createElement("div",null,o.a.createElement(i.a,{mainSrc:h||f,nextSrc:h||f,prevSrc:h||f,onCloseRequest:function(){e.setState({isOpen:!1,photoIndex:0})},onMovePrevRequest:function(){return e.setState({photoIndex:(m+n.length-1)%n.length})},onMoveNextRequest:function(){return e.setState({photoIndex:(m+1)%n.length})}})))},t}(o.a.Component);t.a=u},2697:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=(n.n(a),n(744)),i=n(702),r=n(19),l=n(729),c=n(20),s=n(53),d=n(664),m=n(1181),u=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,l)}c((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,o,i,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(o=2&i[0]?a.return:i[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],a=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={projectInformation:Object(),files:[],fileTitle:"",recentSelectedFiles:[]},n.fetchProjectInformation=n.fetchProjectInformation.bind(n),n.saveProjectInformation=n.saveProjectInformation.bind(n),n.handlefileAttached=n.handlefileAttached.bind(n),n.handleTitleChange=n.handleTitleChange.bind(n),n.deleteFile=n.deleteFile.bind(n),n.onFileChange=n.onFileChange.bind(n),n}return u(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this.fetchProjectInformation()];case 1:return e.sent(),[2]}})})},t.prototype.onFileChange=function(e){return p(this,void 0,void 0,function(){return f(this,function(t){return this.state.projectInformation.filesNames=e,this.saveProjectInformation(),[2]})})},t.prototype.fetchProjectInformation=function(){return p(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return[4,Object(i.m)(this.props.projectName)];case 1:return(e=t.sent())&&e.projectID&&this.setState({projectInformation:e}),[2]}})})},t.prototype.saveProjectInformation=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r,l,d=this;return f(this,function(m){switch(m.label){case 0:if(e=this.props.projectName,t=this.state.projectInformation,n=this.state.recentSelectedFiles,t.projectID=e,t.lastUpdated=(new Date).toString(),a=new s.b,!(o=Object(c.d)())||!o.length)return[3,4];r=0,m.label=1;case 1:return r<o.length?(l=o[r],[4,a.UploadFile(s.a.DOCUMENT(),n[r],l,function(e,t){d.fetchProjectInformation()})]):[3,4];case 2:m.sent(),m.label=3;case 3:return r++,[3,1];case 4:return[4,Object(i.a)(t).then(function(e){d.setState({fileTitle:"",files:[]},function(){return p(d,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this.fetchProjectInformation()];case 1:return e.sent(),[2]}})})})}).catch(function(e){return e})];case 5:return m.sent(),[2]}})})},t.prototype.handlefileAttached=function(e){var t=this;if(e&&e.length>0){var n=this.state,a=n.projectInformation,o=n.recentSelectedFiles;if(a.filesNames||(a.filesNames=[]),o=[],e&&e.length>0){for(var i=0;i<e.length;i++){var r=e[i].name.split(".").pop(),l=(new Date).YYMMDDHHMMSS2()+"-"+this.state.fileTitle+"."+r.toLowerCase();a.filesNames&&(a.filesNames.push(l),o[i]=l)}Object(c.g)(e),this.setState({files:e,projectInformation:a,recentSelectedFiles:o},function(){return p(t,void 0,void 0,function(){return f(this,function(e){return[2]})})})}}},t.prototype.handleTitleChange=function(e){this.setState({fileTitle:e.replace(new RegExp(" ","g"),"")},function(){document.getElementById("fileTitle").style.boxShadow=e?"0px 0px 15px gainsboro":"0px 0px 15px red"})},t.prototype.deleteFile=function(e){return p(this,void 0,void 0,function(){var t,n=this;return f(this,function(a){switch(a.label){case 0:return(t=this.state.projectInformation).filesNames.splice(e,1),[4,Object(i.a)(t).then(function(e){n.fetchProjectInformation()}).catch(function(e){return e})];case 1:return a.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,i=t.instance,c=t.projectName,s=this.state,u=s.projectInformation,p=s.files,f=s.fileTitle;return document.getElementById("warningText")&&(document.getElementById("warningText").style.display="none"),a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},a.createElement(o.a,{data:[u],ElementID:"filesPage",projectName:c,buildingName:n,instance:i}),a.createElement("div",{className:"card",id:"filesPage"},a.createElement("div",{className:"container-fluid"},a.createElement("br",null),a.createElement("div",{className:"padding-10"},a.createElement("div",{className:"card"},a.createElement("div",{className:"content",style:{paddingTop:"0px",paddingBottom:"0px"}},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 col-sm-12 no-padding cell_border headingText padding-5",style:{backgroundColor:"#366092",height:"40px"}},"`")),a.createElement("div",{className:"row  b-row-background"},a.createElement("div",{className:"col-md-12 col-sm-12 cell_border headingText center padding-5"},"  ",a.createElement("h4",{style:{margin:"0px",fontWeight:"bold"}},"PROJECT DETAILS")," ")),a.createElement("div",{className:"row"},a.createElement("div",{className:"no-padding col-md-6 col-sm-6 b-row-background"},a.createElement("div",{className:"col-md-4 col-sm-4 padding-5 cell_border headingText"}," Project Name  "),a.createElement("div",{className:"col-md-8 col-sm-8 padding-5 cell_border b-long-col-background headingText trim-data"},Object(r.u)(this.props.projectName)," \xa0")),a.createElement("div",{className:"no-padding col-md-6 b-row-background"},a.createElement("div",{className:"col-md-4 col-sm-4 padding-5 cell_border headingText b-row-background"},"Project #"),a.createElement("div",{className:"col-md-8 col-sm-8 padding-5 cell_border b-long-col-background headingText"},u.projectNumber," \xa0",a.createElement("br",null)))),a.createElement("div",{className:"row"},a.createElement("div",{className:"no-padding col-md-6 col-sm-6 b-row-background"},a.createElement("div",{className:"col-md-4 col-sm-4 padding-5 cell_border headingText"},"Project Manager"),a.createElement("div",{className:"col-md-8 col-sm-8 padding-5 cell_border b-long-col-background headingText"},u.projectManager," \xa0")),a.createElement("div",{className:"no-padding col-md-6 b-row-background"},a.createElement("div",{className:"col-md-4 col-sm-4 padding-5 cell_border headingText"},"Last Updated"),a.createElement("div",{className:"col-md-8 col-sm-8 padding-5 cell_border b-long-col-background headingText"},u.lastUpdated&&u.lastUpdated.length>0&&u.lastUpdated.ToEasternDateTime()," \xa0")))),a.createElement("br",null),a.createElement("div",{className:"card no-margin",style:{background:"gainsboro"}},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("h5",{className:""},a.createElement("strong",null,"Upload Files:"))),a.createElement("div",{className:"col-md-10"},a.createElement("button",{className:"margin-5 btn btn-primary btn-fill",title:"Upload File","data-toggle":"modal","data-target":"#filesUploadDailogeBox"},a.createElement("i",{className:"fa fa-plus"}))))))),u.filesNames&&u.filesNames.length>0&&a.createElement("br",null),u.filesNames&&u.filesNames.length>0&&a.createElement("div",{className:"card",style:{background:"gainsboro"}},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row",style:{marginBottom:"0px"}},a.createElement(m.a,{colSize:4,saveComponent:function(){e.saveProjectInformation()},filesName:u.filesNames,onChangeFiles:this.onFileChange,showDownloadLink:!0,showRemoveButton:!0,showImageViewer:!0,isFromComponent:!0}))))),a.createElement("div",{className:""},a.createElement(d.a,{id:"filesUploadDailogeBox",heading:"File Upload",saveButtonText:"Done",isEditForm:!1,onSaveButtonClick:function(){e.saveProjectInformation()},disableSaveButton:!f||0==p.length},a.createElement("div",{className:"card no-margin"},a.createElement("div",{className:"container-fluid dataCard"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-3 headingText padding-10"},"Title:"),a.createElement("div",{className:"col-md-9"},a.createElement("input",{onChange:function(t){e.handleTitleChange(t.target.value)},type:"text",name:"fileTitle",id:"fileTitle",value:f,className:"form-control cell_border"})),!f&&a.createElement("div",{id:"warningText",className:"col-md-12 d-none center"},a.createElement("h5",{className:"text-danger headingText"}," File Title is empty!!!  ")))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-3 headingText padding-10"},"File Upload:"),a.createElement("div",{className:"col-md-9",onClick:function(){f?(document.getElementById("fileTitle").style.boxShadow="0px 0px 15px gainsboro",document.getElementById("warningText").style.display="none"):(document.getElementById("fileTitle").style.boxShadow="0px 0px 15px red",document.getElementById("warningText").style.display="block")}},a.createElement(l.a,{disable:!f,single:!0,handleAttachedFile:this.handlefileAttached,files:p}))))))))))))))))))},t}(a.Component);t.default=h}});