webpackJsonp([23],{1242:function(e,t,a){"use strict";var s=a(2),n=(a.n(s),a(1243)),l=a(677),o=a(721),r=a(12),i=a(699),c=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}(),m=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))(function(n,l){function o(e){try{i(s.next(e))}catch(e){l(e)}}function r(e){try{i(s.throw(e))}catch(e){l(e)}}function i(e){e.done?n(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(o,r)}i((s=s.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var a,s,n,l,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return l={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(l){return function(r){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,s&&(n=2&l[0]?s.return:l[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,l[1])).done)return n;switch(s=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,s=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){o.label=l[1];break}if(6===l[0]&&o.label<n[1]){o.label=n[1],n=l;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(l);break}n[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],s=0}finally{a=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,r])}}},d=function(e){function t(t){var a=e.call(this,t)||this;return a.state={isStarted:!1,isTourSelected:!1,selectedSteps:a.props.sweeps,modelDetails:Object(),mapModelDetails:Object(),spaceDetails:[],currentSweep:Object(),matterTags:[],floorDetails:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:a.props.isViewForm,prevSweepIndex:0,prevSweepModel:Object(),onPropsReceivedStateChanged:!1,linkBimism:a.props.bimURL,routes:a.props.routes,locationDropdownList:[],destinationSpace:a.props.selectedSpace,destinationSweeps:a.props.sweeps,isTaskView:a.props.isTaskView,currentView:"TaskRoute",floor:Object(),hideMap:!0,hideInBuildingRoutes:!0,allSweeps:[],inBuildingRoutes:[],space:a.props.space,currentFloor:"",floorsBimList:[]},a.loadSDK=a.loadSDK.bind(a),a.loadFrame=a.loadFrame.bind(a),a.toggleTourStartStop=a.toggleTourStartStop.bind(a),a.toggleTourSweepsStartStop=a.toggleTourSweepsStartStop.bind(a),a.addCurrentSweep=a.addCurrentSweep.bind(a),a.toggleAddingSweep=a.toggleAddingSweep.bind(a),a.removeSweep=a.removeSweep.bind(a),a.setDialogState=a.setDialogState.bind(a),a.onSaveHandle=a.onSaveHandle.bind(a),a.handleRouteChange=a.handleRouteChange.bind(a),a.getRoutes=a.getRoutes.bind(a),a.checkPreviousRoutesWithCurrentRoutes=a.checkPreviousRoutesWithCurrentRoutes.bind(a),a.fetchFloorListImages=a.fetchFloorListImages.bind(a),a.getFloorsList=a.getFloorsList.bind(a),a}return c(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;if((0==this.state.selectedSteps.length&&e.sweeps.length>0||e.isSweepChangeable)&&(this.setState({selectedSteps:JSON.parse(JSON.stringify(e.sweeps)),hasStartSweep:!0,startSweep:e.sweeps.find(function(e){return 0==e.stepNo}),onPropsReceivedStateChanged:!0},function(){t.state.sdk&&t.loadFrame(t.state.sdk,t.setDialogState,t.state)}),e.isSweepChangeable&&this.props.onSweepChangeable(e.isSweepChangeable)),e.bimURL&&this.state.linkBimism!=e.bimURL&&this.setState({linkBimism:e.bimURL}),e.locationDropdownList&&this.setState({locationDropdownList:e.locationDropdownList}),e.sweeps&&e.sweeps.length>0&&this.state.destinationSweeps!=e.sweeps){var a=e.sweeps.sort(function(e){return e.stepNo});this.setState({destinationSweeps:e.sweeps,hasStartSweep:!0,startSweep:a[0]})}if(e.selectedSpace&&this.state.destinationSpace.value!=e.selectedSpace.value&&this.setState({destinationSpace:e.selectedSpace}),e.routes&&e.routes.length>0){var s=this.state.selectedSteps;e.routes.forEach(function(e){e.sweeps.forEach(function(e){null==e&&""+e=="undefined"||s.push(e)})}),this.setState({routes:e.routes,onPropsReceivedStateChanged:!0,selectedSteps:s}),this.state.sdk&&this.loadFrame(this.state.sdk,this.setDialogState,this.state)}e.floor&&e.floor.bimSid&&this.setState({floor:e.floor,floorsBimList:[]},function(){t.getFloorsList(e.floor)}),e.space&&e.space!=this.state.space&&(this.setState({space:e.space}),this.state.sdk&&this.loadFrame(this.state.sdk,this.setDialogState,this.state))},t.prototype.componentDidUpdate=function(){this.state.onPropsReceivedStateChanged&&this.setState({onPropsReceivedStateChanged:!1})},t.prototype.getRoutes=function(e){return m(this,void 0,void 0,function(){var t,a,s,n,l,i,c,d=this;return u(this,function(p){switch(p.label){case 0:return t=this.props.buildingName,a=this.state,s=a.space,n=a.selectedSteps,l=[],i=[],c=[],s?[4,Object(o.a)(t,s).then(function(t){return m(d,void 0,void 0,function(){var a,o,m,d,p,f,b,h;return u(this,function(u){for(a=0;a<t.length;a++){for(o=t[a],(m=Object()).description=Object(r.g)(o.description),m.ontology=Object(r.g)(o.ontology),m.space=Object(r.g)(o.space),m.routeName=Object(r.g)(o.routeName),i=Object(r.g)(o.sweeps).split(","),c=Object(r.g)(o.stepNo).split(","),d=Object(),p=[],f=function(t){var a=i[t],l=Object();(d=e.find(function(e){return e.uuid==a}))&&(l.uuid=d.uuid,l.assignedSpace=s,l.stepNo=c[t],p.push(l),n.push(l))},b=0;b<i.length;b++)f(b);m.sweeps=p,l.push(m)}return h=this.state.inBuildingRoutes,this.setState({inBuildingRoutes:l,selectedSteps:n}),l.length>0&&(this.checkPreviousRoutesWithCurrentRoutes(l,h)||this.loadFrame(this.state.sdk,this.setDialogState,this.state)),[2]})})}).catch(function(e){return e})]:[2];case 1:return p.sent(),[2]}})})},t.prototype.checkPreviousRoutesWithCurrentRoutes=function(e,t){if(e.length!=t.length)return!1;for(var a=0;a<e.length;a++){if(e[a].description!=t[a].description||e[a].floorBimUrl!=t[a].floorBimUrl||e[a].hideRoutesView!=t[a].hideRoutesView||e[a].ontology!=t[a].ontology||e[a].routeName!=t[a].routeName||e[a].space!=t[a].space)return!1;if(e[a].sweeps.length!=t[a].sweeps.length)return!1;for(var s=0;s<e[a].sweeps.length;s++)if(e[a].sweeps[s].assignedSpace!=t[a].sweeps[s].assignedSpace||e[a].sweeps[s].buildingName!=t[a].sweeps[s].buildingName||e[a].sweeps[s].ontology!=t[a].sweeps[s].ontology||e[a].sweeps[s].stepNo!=t[a].sweeps[s].stepNo||e[a].sweeps[s].uuid!=t[a].sweeps[s].uuid||e[a].sweeps[s].uuidIndex!=t[a].sweeps[s].uuidIndex)return!1}},t.prototype.getFloorsList=function(e){return m(this,void 0,void 0,function(){var t,a,s=this;return u(this,function(n){switch(n.label){case 0:return t=this.props.buildingName,a=this.state.floorsBimList,(a=[]).push({floor:e.floor,linkBimism:e.linkBimism,rdfsLabel:e.rdfsLabel+" (Default)",bimFloor:e.bimFloor,bimSid:e.bimSid,xScaleMap:e.xScaleMap,yOffsetMap:e.yOffsetMap,xOffsetMap:e.xOffsetMap,yScaleMap:e.yScaleMap}),this.setState({floorsBimList:a},function(){return m(s,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this.fetchFloorListImages()];case 1:return e.sent(),[2]}})})}),e.bimSid?[4,Object(i.a)(t,"",e.bimSid).then(function(t){return m(s,void 0,void 0,function(){var a,s,n,l=this;return u(this,function(o){for(a=this.state.floorsBimList,s=function(s){var n=t[s];if(Object(r.g)(n.bimFloor)==e.bimFloor)return"continue";if(a.find(function(e){return e.bimFloor==Object(r.g)(n.bimFloor)}))return"continue";var l=Object();l.floor=Object(r.g)(n.zone),l.linkBimism=Object(r.g)(n.linkBimism),l.rdfsLabel=Object(r.g)(n.rdfsLabel),l.bimFloor=Object(r.g)(n.bimFloor),l.bimSid=Object(r.g)(n.bimSid),l.xScaleMap=Object(r.g)(n.xScaleMap),l.yOffsetMap=Object(r.g)(n.yOffsetMap),l.xOffsetMap=Object(r.g)(n.xOffsetMap),l.yScaleMap=Object(r.g)(n.yScaleMap),l.imgFloorMap="",a.push(l)},n=0;n<t.length;n++)s(n);return this.setState({floorsBimList:a},function(){return m(l,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this.fetchFloorListImages()];case 1:return e.sent(),[2]}})})}),[2]})})})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.fetchFloorListImages=function(){return m(this,void 0,void 0,function(){var e,t,s,n,l,r;return u(this,function(i){switch(i.label){case 0:e=this.state.floorsBimList,t=this.props.buildingName,s=0,i.label=1;case 1:return s<e.length?(n=e[s],[4,Object(o.b)(t,n.floor)]):[3,4];case 2:l=i.sent(),r=l&&l[0]?""+l[0].bimImageBase:a(759),n.imgFloorMap=r,e[s]=n,i.label=3;case 3:return s++,[3,1];case 4:return this.setState({floorsBimList:e},function(){console.log("floor bim list with images loaded")}),[2]}})})},t.prototype.onFloorChange=function(e){return m(this,void 0,void 0,function(){var t,a,s,n,l,o,r;return u(this,function(i){return t=this.state,a=t.currentFloor,s=t.floor,n=t.floorsBimList,l=t.currentSweep,o=n.find(function(t){return t.bimFloor==e}),s=o,r=parseInt(e.split(" ")[1]),r-=1,window.moveToFloor(r),a="Floor "+(r+1),this.setState({currentFloor:a,floor:s},function(){window.sweepsMappingFloor(s,l.uuid)}),[2]})})},t.prototype.onSaveHandle=function(){if(this.props.isTaskForm){var e=this.state.routes;this.props.onSaveRouteClickButton(e)}else{var t=this.state.selectedSteps;this.props.onSaveClickButton(t)}},t.prototype.toggleAddingSweep=function(){window.toggleStartStopAddingSweep()},t.prototype.toggleTourStartStop=function(){window.toggleTourSelectedSweep()},t.prototype.toggleTourSweepsStartStop=function(e,t){window.toggleTourSweepsSelectedSweepNew(e,t)},t.prototype.addCurrentSweep=function(){window.addCurrentSweep()},t.prototype.removeSweep=function(e){window.removeSweep(e)},t.prototype.setDialogState=function(e,t,a,s,n,l,o,r,i,c,d,p){var f=this;null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=a&&this.setState({selectedSteps:a}),null!=s&&(this.setState({modelDetails:s}),this.getRoutes(s.sweeps)),null!=d&&this.setState({mapModelDetails:d}),null!=n&&this.setState({currentSweep:n}),null!=l&&this.setState({logMessage:l}),null!=r&&this.setState({prevSweepIndex:r}),null!=i&&this.setState({prevSweepModel:i}),null!=p&&this.state.currentFloor!=p&&this.setState({currentFloor:p},function(){return m(f,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this.onFloorChange(p)];case 1:return e.sent(),[2]}})})}),null!=o&&this.setState({sdkReady:o}),null!=c&&(this.setState({sdk:c}),this.loadFrame(this.state.sdk,this.setDialogState,this.state))},t.prototype.loadSDK=function(e){var t=a(823),s=t.APIKey,n=t.Version,l=document.getElementById("showcase");window.MP_SDK.connect(l,s,n).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.loadFrame=function(e,t,a){var s,n,l,o=document.getElementById("map"),r=0,i={sweep:"",mode:"INSIDE",transition:"FLY"},c=this.state,d=c.modelDetails,p=c.currentSweep,f=c.isStarted,b=c.isTourSelected,h=c.selectedSteps,g=c.sdkReady,v=c.startSweep,w=c.hasStartSweep,N=c.prevSweepIndex,E=c.prevSweepModel,S=c.isTaskView,k=c.mapModelDetails,y=c.currentFloor;function O(){return m(this,void 0,void 0,function(){return u(this,function(a){switch(a.label){case 0:return[4,e.Model.getData().then(function(a){e.Camera.getPose().then(function(s){e.Renderer.getWorldPositionData(s.position).then(function(e){console.log("Model data loaded for sid:",a.sid),console.log("Current floor:",e.floor),y="Floor "+(parseInt(e.floor)+1),d=a,k.sweeps=a.sweeps.filter(function(t){return t.floor==parseInt(e.floor)}),p.uuid=s.sweep,t(null,null,null,d,p,null,null,null,null,null,null,y)})})})];case 1:return a.sent(),[2]}})})}function x(a,s){f?console.log("Tour Stopped"):(s.length>0&&s.length>a?(b=!0,e.Sweep.moveTo(s[a].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+s[a].uuidIndex;console.log(t),x(a+=1,s)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(b=!1,console.log("Tour Ended")),t(null,b))}function T(e,t){var a=document.getElementById("p"+t),s=document.getElementById("p"+e)||a;i.sweep=a&&a.value||"",function(e,t){t&&t.classList.remove("active");e&&(e.classList+=" active")}(a,s)}function j(e,t,a,s,n){return(e-t)/(a-t)*s+n}g||e.App.state.subscribe(function(a){return m(this,void 0,void 0,function(){return u(this,function(s){switch(s.label){case 0:return a.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),a.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),a.phase!==e.App.Phase.PLAYING?[3,2]:(console.log("The app is ready to take user input now!"),g=!0,t(null,null,null,null,null,null,!0),[4,function e(t){return m(this,void 0,void 0,function(){return u(this,function(a){switch(a.label){case 0:return[4,t()];case 1:return a.sent(),d.sweeps&&d.sweeps.length>0&&y?[2]:[3,2];case 2:return[4,e(O)];case 3:a.sent(),a.label=4;case 4:return[2]}})})}(O)]);case 1:s.sent(),w&&window.goToSweep(v.uuid),s.label=2;case 2:return[2]}})})}),window.sweepsMappingFloor=function(e,t){if(k.sweeps&&k.sweeps.length>0){s=0,l=0,n=0,r=0;var a=k.sweeps.map(function(e){if(e.position){var t={pid:e.uuid,x:e.position.x||0,y:e.position.z||0};return function(e,t){s=Math.min(s,e),l=Math.max(l,e),n=Math.min(n,t),r=Math.max(l,t)}(t.x,t.y),0==t.x&&0==t.y&&(i.sweep=e.uuid),t}});o.innerHTML="",a.map(function(t){return function(e,t){if(e){var a=document.createElement("BUTTON"),i=0,c=0,m=0,u=0,d=0,p=0;if(!t)return;m=t.xScaleMap&&parseInt(t.xScaleMap)?parseInt(t.xScaleMap):70,u=t.xOffsetMap&&parseInt(t.xOffsetMap)?parseInt(t.xOffsetMap):13,d=t.yScaleMap&&parseInt(t.yScaleMap)?parseInt(t.yScaleMap):70,p=t.yOffsetMap&&parseInt(t.yOffsetMap)?parseInt(t.yOffsetMap):45,i=j(e.x,s,l,m,u),c=j(e.y,n,r,d,p),a.setAttribute("id","p"+e.pid),a.setAttribute("value",e.pid),a.style.left=i+"%",a.style.top=c+"%",a.setAttribute("class","sweep z-depth-3"),a.addEventListener("click",function(e){window.goToSweep(e.target.value),e.stopPropagation()}),o.appendChild(a)}}(t,e)})}},window.toggleStartStopAddingSweep=function(){t(f=!f),f&&window.addCurrentSweep()},window.toggleTourSelectedSweep=function(){(t(null,b=!0),b)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),x(0,h.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,b))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,b=!0),b)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),x(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,b))},window.toggleTourSweepsSelectedSweepNew=function(a,s){for(var n=1;n<=a.length;n++){var l=document.getElementById(s+"_chkstep_"+n);l&&(l.checked=!1)}(0==s&&++s,t(null,b=!0),b)?(t(null,null,null,null,null,"Tour Started"),function a(s,n,l){f?console.log("Tour Stopped"):(n.length>0&&n.length>s?(b=!0,e.Sweep.moveTo(n[s].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+n[s].uuidIndex;console.log(t),s+=1;var o=document.getElementById(l+"_chkstep_"+s);o&&(o.checked=!0),a(s,n,l)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(b=!1,console.log("Tour Ended")),t(null,b))}(0,a.sort(function(e,t){return e.stepNo-t.stepNo}),s)):t(null,b)},window.addCurrentSweep=function(){e.Camera.getPose().then(function(e){var a=d.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,p=a);var s=d.sweeps.indexOf(a);if(!function(e){if(h.length>0){var t=h.find(function(t){return t.uuid==e});if(null!=t||""+t!="undefined"){var a="Sweep "+t.uuid+" of index "+t.uuidIndex+" is already added in the current list";return console.log(a),!0}}return!1}(p.uuid)){h.push({uuid:p.uuid,uuidIndex:s,stepNo:h.length}),t(null,null,h);var n="Sweep "+p.uuid+" of index "+s+" is added in the current list";console.log(n)}})},window.removeSweep=function(e){var a=h.find(function(t){return t.uuid==e}),s=h.indexOf(a);if(s>-1){h.splice(s,1),t(null,null,h);var n="Sweep "+a.uuid+" of index "+a.uuidIndex+" is removed from the current list";console.log(n)}},window.goToSweep=function(t){e.Sweep.moveTo(t,{transition:e.Sweep.Transition.FLY}).then(function(e){var a="Moved to sweep "+t;console.log(a)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},window.moveToFloor=function(t){e.Floor.moveTo(t).then(function(e){console.log("Current floor: "+e),y="Floor "+(-1==e?1:e+1)}).catch(function(e){})},e.on(e.Sweep.Event.ENTER,function(){if(b)return!1;e.Camera.getPose().then(function(a){if("mode.inside"==a.mode||"mode.outside"==a.mode){if(h.length>0){var s=h.find(function(e){return e.uuid==a.sweep});if(null!=s&&""+s!="undefined"){var n="Moved to sweep "+s.uuid;console.log(n),S?(T(E.uuid,a.sweep),E=s):(T(h[N].uuid,a.sweep),N=h.indexOf(s)),t(null,null,null,null,null,null,null,N)}else{n="Not allowed in the current step ";console.log(n),S&&E.uuid?window.goToSweep(E.uuid):window.goToSweep(h[N].uuid)}}e.Renderer.getWorldPositionData(a.position).then(function(e){return m(this,void 0,void 0,function(){var s;return u(this,function(n){return s="Floor "+(parseInt(e.floor)+1),y&&y!=s&&(y=s,p.uuid=a.sweep,d.sweeps&&(k.sweeps=d.sweeps.filter(function(t){return t.floor==parseInt(e.floor)}),t(null,null,null,null,p,null,null,null,null,null,k,y))),[2]})})})}})})},t.prototype.handleRouteChange=function(e){for(var t=[],a=0;a<e.length;a++)for(var s=e[a].sweeps,n=0;n<s.length;n++){var l=s[n];t.push(l)}this.setState({routes:e,selectedSteps:t});var o=this.state,r=o.floor,i=o.currentSweep;window.sweepsMappingFloor(r,i.uuid)},t.prototype.render=function(){var e=this;this.props.isRefreshDialog&&(this.setState({isStarted:!1,isTourSelected:!1,selectedSteps:[],modelDetails:Object(),spaceDetails:[],currentSweep:Object(),matterTags:[],floorDetails:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:this.props.isViewForm,prevSweepIndex:0,onPropsReceivedStateChanged:!1,linkBimism:this.props.bimURL,destinationSpace:{label:"",value:""},destinationSweeps:[],routes:[],locationDropdownList:[],hideInBuildingRoutes:!0,hideMap:!0}),this.props.onRefreshMatterport(!1),document.getElementById("map").innerHTML="");var t=this.props,o=t.id,r=t.heading,i=t.isViewForm,c=t.isTaskForm,m=t.isTaskView,u=t.sweeps,d=t.selectedSpace,p=t.showSaveButton,f=this.state,b=f.isStarted,h=f.selectedSteps,g=f.isTourSelected,v=f.logMessage,w=f.sdkReady,N=f.linkBimism,E=f.routes,S=f.locationDropdownList,k=f.currentView,y=f.floor,O=f.hideMap,x=f.inBuildingRoutes,T=f.hideInBuildingRoutes,j=0,D=0,C=!1,L=!1;w?(C=g,L=b):(C=!0,L=!0);var M=y&&y.imgFloorMap?y.imgFloorMap:a(759);return s.createElement(l.a,{id:o,saveButtonText:"Save",heading:r,showSaveButton:p,showCancelButton:i,onSaveButtonClick:function(){e.onSaveHandle()},isFullWidth:!0},"TaskRoute"==k&&s.createElement("div",{className:"card dataCard no-margin"},s.createElement("div",{className:"container-fluid"},s.createElement("div",{className:""},c&&s.createElement("div",{className:"col-md-7 col-xs-12 matterport-dialog-task-margin-bottom"},!c&&!m&&s.createElement(s.Fragment,null,!i&&s.createElement("button",{type:"button",id:"btnStartStop",disabled:C,title:1==b?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:this.toggleAddingSweep},s.createElement("i",{className:1==b?"fa fa-stop":"fa fa-plus"})),!i&&s.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:C&&L,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:this.addCurrentSweep},s.createElement("i",{className:"fa fa-thumb-tack"})),s.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:L,title:1==b?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:this.toggleTourStartStop},s.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})),s.createElement("br",null),s.createElement("br",null)),!c&&!m&&s.createElement("span",{className:"small-font-list"},v),c&&s.createElement(n.a,{building:this.props.buildingName,items:E,onItemChange:this.handleRouteChange,isView:!1,spaces:S,destinationSpace:d,destinationSweeps:u})),!m&&s.createElement("div",{className:"col-md-5 col-xs-12"},s.createElement("table",null,s.createElement("tr",null,s.createElement("th",null,"Steps"),s.createElement("th",null)),h&&h.map(function(t){return j+=1,s.createElement("tr",null,s.createElement("td",{className:"link",onClick:function(){w&&window.goToSweep(t.uuid)}},"Step ",j,": ",t.uuid),s.createElement("td",null,!i&&w&&s.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(t.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},s.createElement("i",{className:"fa fa-times"}))))}))),m&&s.createElement("div",{className:"col-md-5 col-xs-12"},E&&E.map(function(t,a){return j=0,D+=1,s.createElement(s.Fragment,null,s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-6"},s.createElement("b",null,"Route ",D)),s.createElement("div",{className:"col-md-6"},s.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:L,title:1==b?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill btn-sm float-right matterport-dialog-btn-play-sm",onClick:function(){e.toggleTourSweepsStartStop(t.sweeps,a+1)}},s.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})))),s.createElement("span",{className:"small-font-list"},t.description),c&&s.createElement("table",null,s.createElement("tr",null,s.createElement("th",null,"Steps")),t.sweeps.map(function(e){return j+=1,s.createElement("tr",null,s.createElement("td",{className:"link",onClick:function(){w&&window.goToSweep(e.uuid)}}," Step ",j,": ",s.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:D+"_chkstep_"+j.toString()})))})),s.createElement("br",null),s.createElement("br",null))}))),s.createElement("div",{className:"col-md-12"},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2"},s.createElement("button",{type:"button",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:function(){e.setState({hideMap:!O})}},O?"Show Map":"Hide Map")),x&&x.length>0&&s.createElement("div",{className:"col-md-3"},s.createElement("button",{type:"button",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin pull-left",onClick:function(){e.setState({hideInBuildingRoutes:!T})}},T?"Show In Building Routes":"Hide In Building Routes"))),s.createElement("br",null),!T&&x.map(function(t,a){return s.createElement(s.Fragment,null,s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-3"},s.createElement("b",null,t.routeName)),s.createElement("div",{className:"col-md-1"},s.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:L,title:1==b?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill btn-sm float-right matterport-dialog-btn-play-sm",onClick:function(){e.toggleTourSweepsStartStop(t.sweeps,a)}},s.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})))),s.createElement("br",null))})),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12 col-xs-12"},s.createElement("iframe",{id:"showcase",src:N,onLoad:function(){e.loadSDK(e.setDialogState)},width:"100%",height:"500",frameBorder:"0",allowFullScreen:!0})),s.createElement("div",{className:O?"col-md-12 display-none":"col-md-12"},s.createElement("div",{className:"map-container"},s.createElement("img",{className:"responsive-img",src:M,alt:""}),s.createElement("div",{id:"map",className:"map"})))))))},t}(s.Component);t.a=d},1243:function(e,t,a){"use strict";var s=a(2),n=(a.n(s),a(721)),l=a(12),o=a(681),r=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}(),i=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))(function(n,l){function o(e){try{i(s.next(e))}catch(e){l(e)}}function r(e){try{i(s.throw(e))}catch(e){l(e)}}function i(e){e.done?n(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(o,r)}i((s=s.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var a,s,n,l,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return l={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(l){return function(r){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,s&&(n=2&l[0]?s.return:l[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,l[1])).done)return n;switch(s=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,s=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){o.label=l[1];break}if(6===l[0]&&o.label<n[1]){o.label=n[1],n=l;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(l);break}n[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],s=0}finally{a=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,r])}}},m=function(e){function t(t){var a=e.call(this,t)||this;return a.state={items:[],spaces:[],selectedRowIndex:0,spacesDropDownList:[],isAddDisable:!1},a.addItem=a.addItem.bind(a),a.handleDescriptionChange=a.handleDescriptionChange.bind(a),a.handleSpaceChange=a.handleSpaceChange.bind(a),a.getSweeps=a.getSweeps.bind(a),a.handleSpaceDropdownListChange=a.handleSpaceDropdownListChange.bind(a),a}return r(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.items&&this.setState({items:e.items}),e.spaces&&this.setState({spaces:e.spaces}),e.destinationSpace&&this.setState({destinationSpace:e.destinationSpace}),e.destinationSweeps&&this.setState({destinationSweeps:e.destinationSweeps},function(){console.log("Destination sweeps updated")})},t.prototype.addItem=function(){var e=this.state.items;e.push({space:[this.state.destinationSpace],description:"",sweeps:this.state.destinationSweeps}),this.setState({items:e,isAddDisable:!0}),this.props.onItemChange(e)},t.prototype.handleSpaceChange=function(e){return i(this,void 0,void 0,function(){var t,a,s,n,l;return c(this,function(o){switch(o.label){case 0:if(this.props.isView)return[3,5];for((t=this.state.items)[this.state.selectedRowIndex].space=e,a=[],s=e.reverse(),n=0;n<s.length;n++)l=s[n],a.push(l);n=0,o.label=1;case 1:return n<a.length?(l=a[n],[4,this.getSweeps(this.props.building,l.value,t,n)]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:this.state.selectedRowIndex==t.length-1&&this.setState({isAddDisable:!1}),o.label=5;case 5:return[2]}})})},t.prototype.handleSpaceDropdownListChange=function(){this.setState({spacesDropDownList:this.state.spaces.map(function(e){return{value:e.ontology.value,label:e.rdfsLabel.value}})})},t.prototype.handleDescriptionChange=function(e,t){if(!this.props.isView){var a=this.state.items;a[t].description=e,this.setState({items:a}),this.props.onItemChange(a)}},t.prototype.getSweeps=function(e,t,a,s){return i(this,void 0,void 0,function(){var o=this;return c(this,function(r){switch(r.label){case 0:return[4,Object(n.c)(e,t).then(function(e){return i(o,void 0,void 0,function(){var t,n,o,r,i;return c(this,function(c){for(t=[],n=0==s?0:a[this.state.selectedRowIndex].sweeps.length,o=0;o<e.length;o++)r=e[o],(i=Object()).assignedSpace=Object(l.g)(r.assignedSpace),i.buildingName=Object(l.g)(r.buildingName),i.ontology=Object(l.g)(r.ontology),i.uuid=Object(l.g)(r.uuid),i.uuidIndex=parseInt(Object(l.g)(r.uuidIndex)),i.stepNo=parseInt(r.stepNo.value)+n,t.push(i);return 0!=s&&a[this.state.selectedRowIndex].sweeps.forEach(function(e){t.push(e)}),a[this.state.selectedRowIndex].sweeps=t,this.setState({items:a}),this.props.onItemChange(a),[2]})})}).catch(function(e){return e})];case 1:return r.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,a=t.items,n=t.spaces,l=t.spacesDropDownList,r=t.isAddDisable,i=this.props.isView;return l=n.map(function(e){return{value:e.ontology.value,label:e.rdfsLabel.value}}),s.createElement(s.Fragment,null,s.createElement("div",{className:"dataCard"},s.createElement("div",{className:"row hidden-xs"},s.createElement("div",{className:"col-sm-6 headingText"},"Routes"),s.createElement("div",{className:"col-sm-6 headingText"},"Description")),a.map(function(t,a){return s.createElement("div",{key:a,className:"row"},s.createElement("div",{className:"col-sm-6 col-xs-12"},s.createElement("span",{className:"hidden visible-xs-inline headingText col-xs-6"},s.createElement("label",{htmlFor:"space"},"Routes")),s.createElement("span",{className:"fullWidth"},s.createElement(o.a,{isMulti:!0,closeMenuOnSelect:!1,value:t.space,onChange:e.handleSpaceChange,onFocus:function(){e.setState({selectedRowIndex:a})},placeholder:"Directions",options:l}))),s.createElement("div",{className:"col-sm-6 col-xs-12"},s.createElement("span",{className:"hidden visible-xs-inline headingText col-xs-3"},s.createElement("label",{htmlFor:"description"},"Description")),s.createElement("span",{className:"fullWidth"},s.createElement("input",{type:"text",className:"form-control",id:"description",value:t.description,placeholder:"Description",name:"description",onChange:function(t){return e.handleDescriptionChange(t.target.value,a)}}))))})),s.createElement("br",null),!i&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-11"},s.createElement("button",{disabled:r,type:"button",className:"btn btn-dark btn-fill btn-sm",onClick:this.addItem},s.createElement("i",{className:"fa fa-plus"}),a.length>0?"More":"Add"))))},t}(s.Component);t.a=m},2838:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,n=a(2),l=(a.n(n),a(121)),o=a(12),r=a(118),i=a(717),c=a(890),m=a(757),u=a(20),d=a(119),p=a(1242),f=a(699),b=a(721),h=a(687),g=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}(),v=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))(function(n,l){function o(e){try{i(s.next(e))}catch(e){l(e)}}function r(e){try{i(s.throw(e))}catch(e){l(e)}}function i(e){e.done?n(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(o,r)}i((s=s.apply(e,t||[])).next())})},w=this&&this.__generator||function(e,t){var a,s,n,l,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return l={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(l){return function(r){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,s&&(n=2&l[0]?s.return:l[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,l[1])).done)return n;switch(s=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,s=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){o.label=l[1];break}if(6===l[0]&&o.label<n[1]){o.label=n[1],n=l;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(l);break}n[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],s=0}finally{a=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,r])}}},N=function(e){function t(t){var a=e.call(this,t)||this;return a.state={subTask:Object(),workerNotes:"",actions:[],people:[],floorDetails:Object(),refreshMatterportDialog:!1,onSweepChangeableStatus:!1,bimSweeps:[],locations:[],routeSpaces:[],showDialog:!1},s=a,a.handleWorkerNotesChange=a.handleWorkerNotesChange.bind(a),a._getFloorDetails=a._getFloorDetails.bind(a),a._getSweeps=a._getSweeps.bind(a),a.handleRefreshMatterport=a.handleRefreshMatterport.bind(a),a.onSweepChangeable=a.onSweepChangeable.bind(a),a._fetchPeople=a._fetchPeople.bind(a),a}return g(t,e),t.prototype.UNSAFE_componentWillMount=function(){return v(this,void 0,void 0,function(){return w(this,function(e){return this.props.buildingName&&(s=s),[2]})})},t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Object(r.a)(!0),this.props.buildingName?[4,this._fetchPeople()]:[3,3];case 1:return e=t.sent(),this.setState({people:e}),[4,this._fetchSubTask()];case 2:t.sent(),t.label=3;case 3:return this.state.subTask.floor&&this.state.subTask.floor.length>0&&(this._getFloorDetails(),this._getLocations()),""!=this.state.subTask.spaceSubject&&this._getSweeps(this.state.subTask.buildingName,this.state.subTask.spaceSubject),Object(r.a)(!1),[2]}})})},t.prototype._fetchPeople=function(){return v(this,void 0,void 0,function(){return w(this,function(e){switch(e.label){case 0:return[4,Object(d.y)(this.props.buildingName)];case 1:return[2,e.sent()]}})})},t.prototype._getLocations=function(){return v(this,void 0,void 0,function(){var e,t;return w(this,function(a){switch(a.label){case 0:return e=this.state.subTask,[4,Object(h.d)(e.floor,e.building)];case 1:return t=a.sent(),this.setState({locations:t}),[2]}})})},t.prototype._getFloorDetails=function(){return v(this,void 0,void 0,function(){var e,t,s=this;return w(this,function(n){switch(n.label){case 0:return e=this.state.subTask,t=this.state.floorDetails,[4,Object(f.a)(e.building,e.floor).then(function(n){return v(s,void 0,void 0,function(){var s=this;return w(this,function(l){switch(l.label){case 0:return[4,Object(b.b)(e.building,e.floor).then(function(e){if(n&&n.length>0){var l=e&&e[0]?""+e[0].bimImageBase:a(759);t.linkBimism=Object(o.g)(n[0].linkBimism),t.xOffsetMap=Object(o.g)(n[0].xOffsetMap),t.yOffsetMap=Object(o.g)(n[0].yOffsetMap),t.xScaleMap=Object(o.g)(n[0].xScaleMap),t.yScaleMap=Object(o.g)(n[0].yScaleMap),t.bimFloor=Object(o.g)(n[0].bimFloor),t.bimSid=Object(o.g)(n[0].bimSid),t.floor=Object(o.g)(n[0].zone),t.rdfsLabel=Object(o.g)(n[0].rdfsLabel),t.imgFloorMap=l,s.setState({floorDetails:t,refreshMatterportDialog:!0})}})];case 1:return l.sent(),[2]}})})}).catch(function(e){return e})];case 1:return n.sent(),[2]}})})},t.prototype._fetchSubTask=function(){return v(this,void 0,void 0,function(){var e,t,a,s=this;return w(this,function(n){switch(n.label){case 0:return e=this.props.subTaskID,t=this.state.subTask,a=this.state.workerNotes,Object(r.a)(!0),[4,Object(l.q)(this.props.buildingName,"",e).then(function(e){var n=e[0];t.subTask=Object(o.g)(n.subTask),t.taskNumber=Object(o.g)(n.taskNumber),t.floor=Object(o.g)(n.floor),t.description=Object(o.g)(n.description),t.action=Object(o.g)(n.action),t.assignedTo=Object(o.g)(n.assignedTo),t.assignedDepartment=Object(o.g)(n.assignedDepartment),t.index=parseInt(Object(o.g)(n.index)),t.parentTask=Object(o.g)(n.parentTask),t.entryTimeStamp=Object(o.g)(n.entryTimeStamp),t.workOrder=Object(o.g)(n.workOrder),t.note=Object(o.g)(n.note),t.workerNote=Object(o.g)(n.workerNote),a=Object(o.g)(n.workerNote),t.relatedLink=n.relatedLink?n.relatedLink.value.indexOf(",")>0?n.relatedLink.value.split(","):[n.relatedLink.value]:[""],t.duration=n.duration&&-1!=n.duration.value.indexOf("-")?n.duration.value.split("-")[0]:"1",t.durationUnit=n.duration&&-1!=n.duration.value.indexOf("-")?n.duration.value.split("-")[1]:"Hours",t.workerDuration=n.workerDuration&&-1!=n.workerDuration.value.indexOf("-")?n.workerDuration.value.split("-")[0]:"1",t.workerDurationUnit=n.workerDurationUnit&&-1!=n.workerDurationUnit.value.indexOf("-")?n.workerDurationUnit.value.split("-")[1]:"Hours",t.fileName=Object(o.g)(n.fileName).split(","),t.oldFileName=Object(o.g)(n.fileName).split(","),t.enteredBy=Object(o.g)(n.enteredBy),t.enteredByName=Object(o.g)(n.enteredByName),t.startTime=Object(o.g)(n.startTime),t.workType=Object(o.g)(n.workType),t.status=Object(o.g)(n.status),t.checklistID=Object(o.g)(n.checklistID),t.isQRTask="true"==Object(o.g)(n.isQRTask),t.QRTag=Object(o.g)(n.QRTag),t.notifyViaEmail="true"==Object(o.g)(n.notifyViaEmail),t.notifyViaSMS="true"==Object(o.g)(n.notifyViaSMS),t.estimatedStartTime=""!=Object(o.g)(n.estimatedStartTime)?new Date(Object(o.g)(n.estimatedStartTime)):void 0,t.estimatedEndTime=""!=Object(o.g)(n.estimatedEndTime)?new Date(Object(o.g)(n.estimatedEndTime)):void 0,t.equipRdfsLabel=Object(o.g)(n.equipRdfsLabel),t.component=Object(o.g)(n.component),t.componentLabel=Object(o.g)(n.componentLabel),t.spaceSubject=Object(o.g)(n.spaceSubject),t.spaceRdfsLabel=Object(o.g)(n.spaceRdfsLabel),t.building=Object(o.g)(n.building),t.buildingName=Object(o.g)(n.buildingName),t.buildingAddress=Object(o.g)(n.buildingAddress),t.workflowType=Object(o.g)(n.workflowType),t.redirectionLink=Object(o.g)(n.redirectionLink),t.isStage="true"==Object(o.g)(n.isStage),t.isActivated="true"==Object(o.g)(n.isActivated),t.acknowledged="true"==Object(o.g)(n.acknowledged),t.archived="true"==Object(o.g)(n.archived),t.ticketOntology=Object(o.g)(n.ticketOntology),t.ticketIssue=Object(o.g)(n.ticketIssue),t.ticketTypeOntology=Object(o.g)(n.ticketTypeOntology),t.ticketType=Object(o.g)(n.ticketType),t.wfOntology=Object(o.g)(n.wfOntology),t.workflowDescription=Object(o.g)(n.workflowDescription),t.suggestionFix=Object(o.g)(n.suggestionFix),Object(m.c)(s.props.buildingName,[t.subTask]).then(function(e){return v(s,void 0,void 0,function(){var t,a,s;return w(this,function(n){switch(n.label){case 0:t=function(t){var s,n,l,r,i;return w(this,function(c){switch(c.label){case 0:if("done"!=e[t].directiveType)return[3,5];s=e[t].pointOntology.split(","),e[t].pointOntology="",n="",l=0,c.label=1;case 1:return l<s.length?(r=n,[4,Object(u.D)(s[l])]):[3,4];case 2:n=r+c.sent()+", ",c.label=3;case 3:return l++,[3,1];case 4:return n=n.substring(0,n.length-2),e[t].pointOntology=n,[3,8];case 5:return"customer"!=e[t].directiveType?[3,6]:(a.state.people.length>0&&(e[t].pointOntology=Object(o.g)(a.state.people.find(function(a){return Object(o.g)(a.contact)==e[t].pointOntology}).name)),[3,8]);case 6:return i=e[t],[4,Object(u.D)(e[t].pointOntology)];case 7:i.pointOntology=c.sent(),c.label=8;case 8:return[2]}})},a=this,s=0,n.label=1;case 1:return s<e.length?[5,t(s)]:[3,4];case 2:n.sent(),n.label=3;case 3:return s++,[3,1];case 4:return this.setState({actions:e}),[2]}})})}),s.setState({subTask:t,workerNotes:a})}).catch(function(e){return e})];case 1:return n.sent(),Object(r.a)(!1),[2]}})})},t.prototype._getSweeps=function(e,t){return v(this,void 0,void 0,function(){var a,s=this;return w(this,function(n){switch(n.label){case 0:return a=[],[4,Object(b.c)(e,t).then(function(e){return v(s,void 0,void 0,function(){var t,s,n,l,r,i,c;return w(this,function(m){for(t=0;t<e.length;t++)s=e[t],(n=Object()).assignedSpace=Object(o.g)(s.assignedSpace),n.buildingName=Object(o.g)(s.buildingName),n.ontology=Object(o.g)(s.ontology),n.uuid=Object(o.g)(s.uuid),n.uuidIndex=parseInt(Object(o.g)(s.uuidIndex)),n.stepNo=parseInt(Object(o.g)(s.stepNo)),a.push(n);if((l=this.state.bimSweeps).length==a.length){for(r=0,i=0;i<l.length;i++)(c=l[i]).assignedSpace==a[i].assignedSpace&&c.buildingName==a[i].buildingName&&c.ontology==a[i].ontology&&c.stepNo==a[i].stepNo&&c.uuid==a[i].uuid&&c.uuidIndex==a[i].uuidIndex&&(r+=1);r!=l.length&&this.setState({bimSweeps:a,onSweepChangeableStatus:!0,refreshMatterportDialog:!0})}else this.setState({bimSweeps:a,onSweepChangeableStatus:!0,refreshMatterportDialog:!0});return[2]})})}).catch(function(e){return e})];case 1:return n.sent(),[2]}})})},t.prototype.onSweepChangeable=function(e){this.setState({onSweepChangeableStatus:!e})},t.prototype.handleWorkerNotesChange=function(e){this.setState({workerNotes:e})},t.prototype.handleRefreshMatterport=function(e){this.setState({refreshMatterportDialog:e})},t.prototype.render=function(){var e=this,t=this.props,a=t.instance,s=t.buildingName,o=this.state,m=o.subTask,d=o.floorDetails,f=o.onSweepChangeableStatus,b=o.bimSweeps,h=o.locations,g=o.refreshMatterportDialog,N=d.linkBimism?d.linkBimism:localStorage.getItem("BIMURL"),E={value:"",label:""};if(m.spaceSubject){var S=m.spaceRdfsLabel?m.spaceRdfsLabel:h&&h.length>0&&h.find(function(e){return e.ontology.value==m.spaceSubject})?h.find(function(e){return e.ontology.value==m.spaceSubject}).rdfsLabel.value:"";E={value:m.spaceSubject,label:S}}return n.createElement("div",{className:"content"},n.createElement("div",{className:"padding-20 card"},m.taskNumber&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Task Number:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.taskNumber)))),m.buildingName&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Building:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.buildingName,m.buildingAddress&&n.createElement("img",{className:"icon-img",style:{cursor:"pointer"},src:"assets/img/googlemaplinkicon.png",width:"3px",height:"3px",onClick:function(){window.open(""+m.buildingAddress,"_blank")}}))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("p",{className:"label-black"},"Virtual Routes:")),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("button",{className:"btn-xs btn-object-form-view btn-fill",title:"Matter Port","data-toggle":"modal","data-target":"#showMatterPortDialog"+m.taskNumber,onClick:function(){e.setState({showDialog:!0})}},n.createElement("img",{style:{width:20,height:17},src:"assets/img/virtual-bim.png"})))),n.createElement(p.a,{id:"showMatterPortDialog"+m.taskNumber,heading:"Virtual Routes",bimURL:N,isViewForm:!1,isSweepChangeable:f,sweeps:b,isTaskForm:!1,isTaskView:!0,onSweepChangeable:this.onSweepChangeable,isRefreshDialog:g,buildingName:this.props.buildingName,onRefreshMatterport:this.handleRefreshMatterport,locationDropdownList:h,showSaveButton:!1,selectedSpace:E,floor:d,space:m.spaceSubject})),m.spaceRdfsLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Space:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.spaceRdfsLabel)))),m.equipRdfsLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Asset:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.equipRdfsLabel)))),m.component&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Component:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.componentLabel)))),m.action&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Action:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.action)))),m.description&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Description:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("textarea",{className:"form-control",disabled:!0,id:"note",name:"note",rows:4,value:m.description})))),m.criticality&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Concern:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},m.criticality," - ",c.e&&c.e[""+parseInt(m.criticality)].name)))),m.workType&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Work Type:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},m.workType)))),m.ticketIssue&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," Ticket Issue:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("a",{className:"pull-left label-black",style:{color:"black"},title:m.ticketIssue,href:"#"+a+"/"+s+"/TicketForm/"+m.ticketOntology},m.ticketIssue)))),m.ticketType&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," Ticket Type:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.ticketType)))),m.workflowDescription&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," Workflow Description:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("a",{className:"pull-left label-black",style:{color:"black"},title:m.workflowDescription,href:"http://"+Object(u.y)()+"/#"+a+"/"+s+"/Deploy/WorkflowView/"+m.wfOntology},m.workflowDescription)))),m.assignedDepartment&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," Department:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.assignedDepartment)))),m.enteredByName&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Assigned By:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},m.enteredByName)))),m.duration&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Estimated Duration Length:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.isStage?60*parseFloat(m.duration)+" Minutes":m.duration+" Hours")))),m.estimatedStartTime&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Estimated Start Time:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",new Date(m.estimatedStartTime).toString())))),m.workerDuration&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Worker Estimation:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.isStage?60*parseFloat(m.workerDuration)+" Minutes":m.workerDuration+" Hours")))),m.workOrder&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Related Work Order:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.workOrder)))),m.note&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Instructions:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("pre",{style:{backgroundColor:"white"},className:"label-black"}," ",m.note)))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-12"},n.createElement(i.a,{showUploader:!1,buildingName:s,assetOntology:this.props.subTaskID,entityType:"Task"}))),m.relatedLink&&m.relatedLink.length&&""!=m.relatedLink[0]&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Related Links:"))),n.createElement("div",{className:"col-md-8 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},m.relatedLink&&m.relatedLink.map(function(e,t){return n.createElement(n.Fragment,null,n.createElement(n.Fragment,null,n.createElement("a",{href:e.indexOf("ttp")>0?e:"http://"+e,target:"_blank"},n.createElement("p",{className:"label-black"}," Link ",t+1,": ",n.createElement("span",{style:{color:"blue"}},e))),n.createElement("br",null)))})))),"Done"==m.status&&n.createElement("div",{className:"row form-group"},n.createElement("div",{className:"col-md-9 col-md-offset-2"},n.createElement("h4",{style:{color:"#33cc66"}},n.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Entry Notes:"))),n.createElement("div",{className:"col-md-8"},n.createElement("div",{className:"form-group"},n.createElement("textarea",{className:"form-control",id:"note",name:"note",rows:4,value:this.state.workerNotes,onChange:function(t){e.handleWorkerNotesChange(t.target.value)}}))),n.createElement("div",{className:"col-md-2"},n.createElement("div",{className:"form-group"},n.createElement("button",{className:"btn btn-primary btn-fill",onClick:function(){return v(e,void 0,void 0,function(){var e,t=this;return w(this,function(a){switch(a.label){case 0:return e=this.state.workerNotes,Object(r.a)(!0),[4,Object(l.f)(this.props.subTaskID,e).then(function(){t._fetchSubTask()})];case 1:return a.sent(),Object(r.a)(!1),[2]}})})}},n.createElement("i",{className:"fa fa-save"})," Save")))),m.suggestionFix&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Suggested Fix:"))),n.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",m.suggestionFix)))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-12"},n.createElement(i.a,{showUploader:!0,buildingName:s,assetOntology:this.props.subTaskID,entityType:"WorkerTaskAttachment"}))),n.createElement("div",{className:"row"},this.state.actions&&this.state.actions.length>0&&n.createElement("h3",{className:"text-center"},"Do What Tasks"),n.createElement("div",{className:"row mx-1 p-2"},this.state.actions&&this.state.actions.map(function(e,t){return n.createElement("div",{key:t,className:"content"},n.createElement("div",{className:"padding-20 card row"},n.createElement("div",{className:"col-md-6"},""!=e.directive&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Do What:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.directive)))),""!=e.directiveType&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"What Type:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.directiveType)))),""!=e.floorLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Floor:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.floorLabel)))),""!=e.spaceLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Space:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.spaceLabel)))),""!=e.assetLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Asset:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.assetLabel)))),""!=e.componentLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Component:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.componentLabel)))),""!=e.pointLabel&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Point/Tenant:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.pointLabel))))),n.createElement("div",{className:"col-md-6"},""!=e.dataEntered&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Captured Data:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"}," ",e.dataEntered)))),"done"==e.directiveType&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Captured Data:"))),n.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},e.isDone?n.createElement("h4",{style:{color:"#33cc66",marginTop:-10}},n.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"):n.createElement("h4",{style:{color:"red",marginTop:-10}},n.createElement("i",{className:"fa fa-times",style:{margin:8}}),"Pending"))))),"upload"==e.directiveType&&n.createElement("div",{className:"row col-md-12"},n.createElement("div",{className:"col-md-3 col-sm-6 col-xs-6"},n.createElement("div",{className:"form-group"},n.createElement("p",{className:"label-black"},"Captured Data:"))),n.createElement("div",{className:"col-md-9 col-sm-12 col-xs-12"},n.createElement("div",{className:"form-group"},n.createElement(i.a,{showUploader:!1,showGrid:!0,buildingName:s,assetOntology:e.ontology,entityType:"ObjectAttachment"}))))))}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-12"},n.createElement("button",{className:"btn btn-secondary btn-fill",onClick:function(){window.location.hash=a+"/"+s+"/Tasks"}},n.createElement("i",{className:"fa fa-angle-double-left"}),"  Back to Task list")))))},t}(n.Component);t.default=N}});