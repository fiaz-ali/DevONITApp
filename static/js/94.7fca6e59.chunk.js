webpackJsonp([94],{2590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,l=n(2),a=(n.n(l),n(654)),i=n(662),s=n(117),c=n(663),r=n(10),m=n(23),u=n(751),d=n(987),p=n(678),h=n(11),g=n(661),f=n(652),b=n(647),v=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(l,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,s)}c((o=o.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var n,o,l,a,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(l=2&a[0]?o.return:a[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,a[1])).done)return l;switch(o=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){i.label=a[1];break}if(6===a[0]&&i.label<l[1]){i.label=l[1],l=a;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(a);break}l[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},S=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),l=0;for(t=0;t<n;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,l++)o[l]=a[i];return o},N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={currentView:"CompletedSolutions",solutionEquipments:[],completedSolutionEquipments:[],inspectionOntology:"",columns:[{name:"Equipment",selected:!0},{name:"Floor",selected:!0},{name:"Space",selected:!0},{name:"Equipment Type",selected:!0},{name:"Virtual BIM",selected:!0},{name:"CAD BIM",selected:!0},{name:"Inspections",selected:!0}],solutionTemplates:[],solutionTemplatesName:"",deleteOntology:"",solutionsList:[],esolutionName:"",search:"",showLogs:!1},n._fetchSolutionTemplate=n._fetchSolutionTemplate.bind(n),n.fetchIncompleteSolutions=n.fetchIncompleteSolutions.bind(n),n.handleESolutionChange=n.handleESolutionChange.bind(n),n.removeIncompleteSolution=n.removeIncompleteSolution.bind(n),n}return v(t,e),t.prototype.componentWillUnmount=function(){return E(this,void 0,void 0,function(){return y(this,function(e){return clearInterval(o),[2]})})},t.prototype.componentDidMount=function(){return E(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.props.buildingName?[4,this.fetchIncompleteSolutions()]:[3,4];case 1:return t.sent(),[4,this.fetchCompletedSolutions(!1)];case 2:return t.sent(),[4,this._fetchSolutionTemplate()];case 3:t.sent(),o=setInterval(function(){var t=Object(u.a)("inspectionOntology");e.state.inspectionOntology!=t&&e.setState({inspectionOntology:t})},1e3),t.label=4;case 4:return[2]}})})},t.prototype.search_filter=function(e){this.setState({search:e.target.value})},t.prototype.fetchIncompleteSolutions=function(){return E(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=[],[4,Object(p.u)()];case 1:return e=t.sent(),this.setState({solutionEquipments:e}),[2]}})})},t.prototype.fetchCompletedSolutions=function(e){return E(this,void 0,void 0,function(){var t,n,o,l,a,i;return y(this,function(s){switch(s.label){case 0:return t=[],n=[],o=[],[4,Object(p.r)(this.props.buildingName,"",e)];case 1:if(t=s.sent())for(l=0;l<t.length;l++)a=t[l],i={createdBy:Object(r.g)(a.createdBy),equipmentTemplatesOntology:Object(r.g)(a.equipmentTemplatesOntology),isCompleted:!0,equipmentsOntology:Object(r.g)(a.equipmentsOntology),ontology:Object(r.g)(a.ontology),rdfsLabel:Object(r.g)(a.rdfsLabel),templateOntology:Object(r.g)(a.templateOntology),timestamp:a.timestamp&&Object(r.g)(a.timestamp)?new Date(Object(r.g)(a.timestamp)):void 0,equipmentByTemplate:[],isDeleted:e,controllerGUI:!(!a||!a.controllerGUI||"true"!=Object(r.g)(a.controllerGUI)),floorPlanGUI:!(!a||!a.floorPlanGUI||"true"!=Object(r.g)(a.floorPlanGUI)),oneLineGUI:!(!a||!a.oneLineGUI||"true"!=Object(r.g)(a.oneLineGUI)),devices:[],points:[],isTemplate:!(!a||!a.controllerGUI||"true"!=Object(r.g)(a.isTemplate))},o.push({label:Object(r.g)(a.rdfsLabel),value:Object(r.g)(a.ontology)}),n.push(i);return this.setState({completedSolutionEquipments:n,solutionsList:o}),[2]}})})},t.prototype._fetchSolutionTemplate=function(){return E(this,void 0,void 0,function(){var e,t,n,o;return y(this,function(l){switch(l.label){case 0:return Object(s.a)(!0),[4,Object(d.e)()];case 1:if(e=l.sent(),t=this.state.solutionTemplates,t=[],e){for(n=0;n<e.length;n++)o=e[n],t.push({label:Object(r.g)(o.rdfsLabel),value:Object(r.g)(o.ontology)});this.setState({solutionTemplates:t})}return Object(s.a)(!1),[2]}})})},t.prototype.removeIncompleteSolution=function(){return E(this,void 0,void 0,function(){var e,t=this;return y(this,function(n){switch(n.label){case 0:return(e=this.state.deleteOntology)?[4,Object(p.b)(e).then(function(){t.fetchIncompleteSolutions(),t.setState({deleteOntology:""})})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.handleSolutionTemplateChange=function(e){var t=this.state.solutionTemplatesName;t=e.value,this.setState({solutionTemplatesName:t})},t.prototype.handleESolutionChange=function(e){var t=this.state.esolutionName;t=e.value,this.setState({esolutionName:t})},t.prototype.restoreSolution=function(e){return E(this,void 0,void 0,function(){var t=this;return y(this,function(n){switch(n.label){case 0:return Object(s.a)(!0),[4,Object(p.a)(this.props.buildingName,e,!1).then(function(){return E(t,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return Object(s.a)(!1),[4,this.fetchCompletedSolutions(!0)];case 1:return e.sent(),[2]}})})})];case 1:return n.sent(),Object(s.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.currentView,o=t.completedSolutionEquipments,s=t.solutionEquipments,u=t.inspectionOntology,d=t.columns,p=t.solutionTemplates,v=t.solutionTemplatesName,E=t.solutionsList,y=t.esolutionName,N=t.search,x=t.showLogs,w=this.props,C=w.instance,O=w.buildingName,T=JSON.parse(h.a.getItem("user")),j=Object(g.b)(T,"info-equip","write"),L=d.find(function(e){return"Inspections"==e.name&&1==e.selected})&&u,k=o&&o.filter(function(e){return Object(r.g)(e.rdfsLabel).toLowerCase().includes(N.toLowerCase().trim())}),I=s&&s.filter(function(e){return Object(r.g)(e.rdfsLabel).toLowerCase().includes(N.toLowerCase().trim())});return x?l.createElement(i.a,{instance:C,buildingName:"",hideBuildingDDL:!0,fromEntityList:!0,module:c.a.Assets,entityName:"Solution",entityList:S(s,o).map(function(e){return{label:Object(r.g)(e.rdfsLabel),value:Object(r.g)(e.ontology)}}),onLogClose:function(){return e.setState({showLogs:!1})}}):l.createElement("div",null,l.createElement("div",{className:"content"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row gx-0"},l.createElement("div",{className:"col-md-6 col-sm-12 col-xs-12 no-padding"},l.createElement("div",{className:"btn-group"},l.createElement("a",{className:"btn-sm btn-success pull-left custom-icon-btn",title:"Archived Solutions",style:{marginTop:"3px",height:"32px"},onClick:function(t){e.setState({currentView:"ArchivedSolutions"},function(){e.fetchCompletedSolutions(!0)})}},l.createElement("img",{className:"icon-img",style:{backgroundColor:"#B3A2C7"},src:"assets/img/archive.png"})),l.createElement("button",{className:"btn "+("CompletedSolutions"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"CompletedSolutions"},function(){e.fetchCompletedSolutions(!1)})}},"Completed Solutions"),l.createElement("button",{className:"btn "+("IncompleteSolutions"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"IncompleteSolutions"})}},"Incomplete Solutions"),l.createElement("div",{style:{display:"flex",justifyContent:"flex-end",paddingLeft:"0px",paddingRight:"0px"}},l.createElement("div",null,l.createElement("h6",{style:{marginTop:"15px",marginRight:"10px",marginLeft:"10px"}},"Filter:")),l.createElement("div",null,l.createElement("input",{style:{outline:"green"},className:"form-control pull-right",onChange:function(t){e.search_filter(t)},id:"soultionfilter",type:"text",placeholder:"Search.."}))))),l.createElement("div",{className:"col-md-6 col-sm-12 col-xs-12"},T&&"1"==T.role&&l.createElement("button",{className:"btn btn-md btn-primary btn-fill pull-right",style:{marginLeft:5},title:"Logs",onClick:function(){e.setState({showLogs:!0})}}," ",l.createElement("img",{src:"assets/img/Logs.png",style:{width:25,height:18}})),l.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){window.location.hash=C+"/"+O+"/NewSolution"}},l.createElement("i",{className:"fa fa-plus"}),l.createElement("span",null,"Create Solution")),l.createElement("button",{type:"button",className:"btn btn-dark pull-right",style:{marginRight:"3px"},onClick:function(){document.getElementById("btnSolutionTemplateDialog").click()}},l.createElement("i",{className:"fa fa-plus"}),l.createElement("span",null,"Create Solution From Template")),l.createElement("button",{type:"button",className:"btn btn-success btn-fill pull-right",style:{marginRight:"3px"},onClick:function(){window.location.hash=C+"/"+O+"/SolutionTemplates"}}," ",l.createElement("span",null,"Templates")))),l.createElement("br",null),l.createElement("div",{className:"card"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row m-0"},l.createElement("div",{className:"col-md-12 p-0"},"IncompleteSolutions"==n&&l.createElement("div",{className:"content",style:{paddingTop:"10px"}},l.createElement("div",{className:"dataCard"},l.createElement("div",{className:"row hidden-xs no-padding"},l.createElement("div",{className:"col-md-12 no-padding"},l.createElement("div",{className:"col-md-12 dataCard"},l.createElement("div",{className:L?"col-md-8":"col-md-8 col-sm-4 small grid-header-left"},l.createElement("i",{className:"fa fas fa-sort"})," Solution"),l.createElement("div",{className:L?"col-md-2":"col-md-2 col-sm-4 small grid-header"}," ",l.createElement("i",{className:"fa fas fa-sort"}),"Last Updated At "),l.createElement("div",{id:"actionremove",style:{justifyContent:"center"},className:L?"col-md-2":"col-md-2 col-sm-4 small grid-header"}," Action ")))),I&&I.length>0&&I.map(function(t,n){var o=Object(m.F)(new Date(t.timestamp)).toLocaleString();return l.createElement("div",{className:"row clickable no-padding"},l.createElement("div",{className:"col-md-10 no-padding"},l.createElement("div",{className:"col-md-12 no-padding"},l.createElement("div",{className:"col-md-10 col-sm-6 padding-5 trim-data small grid-left margin-top"},l.createElement("span",{className:"hidden visible-xs-inline headingText"},"Equipment"),l.createElement("a",{href:"javascript:void(0)",title:t.rdfsLabel},t.rdfsLabel)),l.createElement("div",{className:"col-md-2 col-sm-6 padding-5 small grid margin-top",title:t.ontology},l.createElement("span",{className:"hidden visible-xs-inline headingText"},"Timestamp"),o))),j&&l.createElement("div",{"data-html2canvas-ignore":"true",className:"col-md-2 col-xs-2 pull-right",style:{paddingLeft:"0px",display:"flex",justifyContent:"flex-end"}},l.createElement("a",{className:"btn-sm btn-danger active pull-right",title:"Edit",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(n){document.getElementById("btnConfirmDeleteDialog").click(),e.setState({deleteOntology:t._id})}},l.createElement("i",{className:"fa fa-trash"})," "),l.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Edit",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(e){setTimeout(function(){window.location.hash=C+"/"+O+"/NewSolution/SolutionTemplate/Edit/"+t.ontology},500)}},l.createElement("i",{className:"fa fa-edit"})," ")))}))),("ArchivedSolutions"==n||"CompletedSolutions"==n)&&l.createElement("div",{className:"content",style:{paddingTop:"10px"}},l.createElement("div",{className:"dataCard"},l.createElement("div",{className:"row hidden-xs no-padding"},l.createElement("div",{className:"col-md-12 no-padding"},l.createElement("div",{className:"col-md-12 dataCard"},l.createElement("div",{className:L?"col-md-8":"col-md-8 col-sm-4 small grid-header-left"},l.createElement("i",{className:"fa fas fa-sort"})," Solution"),l.createElement("div",{className:L?"col-md-2":"col-md-2 col-sm-4 small grid-header"}," ",l.createElement("i",{className:"fa fas fa-sort"}),"Last Updated At "),l.createElement("div",{style:{paddingLeft:"10px"},className:L?"col-md-2 ":"col-md-2 col-sm-4 small grid-header"}," Action ")))),k&&k.length>0&&k.map(function(t,o){var a=new Date(t.timestamp).toLocaleString();return l.createElement("div",{className:"row clickable no-padding"},l.createElement("div",{className:"col-md-10 no-padding"},l.createElement("div",{className:"col-md-12 no-padding"},l.createElement("div",{className:"col-md-10 col-sm-6 padding-5 trim-data small grid-left margin-top"},l.createElement("span",{className:"hidden visible-xs-inline headingText"},"Solution"),l.createElement("a",{onClick:function(){window.location.hash="ArchivedSolutions"==n?C+"/"+O+"/ArchiveSolutionView/"+t.ontology:C+"/"+O+"/CompleteSolutionView/"+t.ontology},title:t.rdfsLabel},t.rdfsLabel)),l.createElement("div",{className:"col-md-2 col-sm-6 padding-5 small grid margin-top",title:a},l.createElement("span",{className:"hidden visible-xs-inline headingText"},"Timestamp"),a))),j&&l.createElement("div",{"data-html2canvas-ignore":"true",className:"col-md-2 col-xs-2 pull-right",style:{paddingLeft:"0px",display:"flex",justifyContent:"flex-end"}},"CompletedSolutions"==n&&l.createElement(l.Fragment,null,l.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Diagram",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(e){window.location.hash=C+"/"+O+"/SolutionTemplates/Diagram/"+t.ontology}},l.createElement("i",{className:"fa fa-bar-chart"})),l.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Edit Solution",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(e){window.location.hash=C+"/"+O+"/CompleteSolution/Edit/"+t.ontology}},l.createElement("i",{className:"fa fa-edit"}))),"ArchivedSolutions"==n&&l.createElement(l.Fragment,null,l.createElement("a",{className:"btn-sm btn-success active pull-right",title:"Restore Solution",style:{margin:"3px",padding:"6.5px",border:"1px solid",borderRadius:"5px",width:"31px",height:"31px"},onClick:function(n){e.restoreSolution(t.ontology)}},l.createElement("i",{className:"fa fa-upload"})))))}))))))),l.createElement("button",{type:"button",id:"btnSolutionTemplateDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#solutionTemplateDialog"}," ."),l.createElement(b.a,{id:"solutionTemplateDialog",heading:"Select Solution Template",saveButtonText:"Create Solution",cancelButtonText:"Cancel",disableSaveButton:!v,showCancelButton:!0,showSaveButton:!0,onSaveButtonClick:function(){window.location.hash=e.props.instance+"/"+e.props.buildingName+"/NewSolution/SolutionTemplate/"+v}},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},l.createElement("label",{htmlFor:"point"},"Solution Templates"),l.createElement("div",{className:"form-group"},l.createElement(a.a,{closeMenuOnSelect:!0,isMulti:!1,onChange:function(t){e.handleSolutionTemplateChange(t)},placeholder:"Select Solution Template",options:p}))))),l.createElement("button",{type:"button",id:"btnESolutionDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#eSolutionDialog"}," ."),l.createElement(b.a,{id:"eSolutionDialog",heading:"Select Solution",saveButtonText:"Create E-Solution",cancelButtonText:"Cancel",disableSaveButton:!y,showCancelButton:!0,showSaveButton:!0,onSaveButtonClick:function(){window.location.hash=e.props.instance+"/"+e.props.buildingName+"/ESolution/"+y}},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},l.createElement("label",{htmlFor:"point"},"Solution"),l.createElement("div",{className:"form-group"},l.createElement(a.a,{closeMenuOnSelect:!0,isMulti:!1,onChange:function(t){e.handleESolutionChange(t)},placeholder:"Select Solution",options:E}))))),l.createElement("button",{type:"button",id:"btnConfirmDeleteDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"}," ."),l.createElement(f.a,{instance:"",id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete inprogress solution template?",heading:"Confirm...",onConfirmButtonClick:function(){e.removeIncompleteSolution()}}),l.createElement("br",null))))},t}(l.Component);t.default=N}});