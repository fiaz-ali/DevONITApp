webpackJsonp([28],{2037:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),n(6)),l=n(843),r=n(4),a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,l){function r(e){try{s(o.next(e))}catch(e){l(e)}}function a(e){try{s(o.throw(e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,a)}s((o=o.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var n,o,i,l,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(a){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,a])}}},c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,selectedSteps:[],modelDetails:Object(),spaceDetails:[],currentSweep:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:!1,prevSweepIndex:0,onPropsReceivedStateChanged:!1,linkBimism:n.props.bimURL,sdk:Object(),locationModel:Object()},n.getSweeps=n.getSweeps.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.removeSweep=n.removeSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.loadSDK=n.loadSDK.bind(n),n.initFrame=n.initFrame.bind(n),n}return a(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,function(){var e,t,n;return u(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,n=e.space,[4,this.getSweeps(t,n)];case 1:return o.sent(),[2]}})})},t.prototype.componentWillReceiveProps=function(e){var t=this.state.selectedSteps;e.bimURL&&this.setState({linkBimism:e.bimURL}),this.state.selectedSteps&&this.setState({selectedSteps:t})},t.prototype.getSweeps=function(e,t){return s(this,void 0,void 0,function(){var n,o=this;return u(this,function(r){switch(r.label){case 0:return n=[],[4,Object(l.c)(e,t).then(function(e){return s(o,void 0,void 0,function(){return u(this,function(t){return e.forEach(function(e){var t=Object();t.assignedSpace=Object(i.g)(e.assignedSpace),t.buildingName=Object(i.g)(e.buildingName),t.ontology=Object(i.g)(e.ontology),t.uuid=Object(i.g)(e.uuid),t.uuidIndex=parseInt(Object(i.g)(e.uuidIndex)),t.stepNo=parseInt(Object(i.g)(e.stepNo)),n.push(t)}),this.setState({selectedSteps:n}),[2]})})}).catch(function(e){return e})];case 1:return r.sent(),[2]}})})},t.prototype.toggleAddingSweep=function(){window.toggleStartStopAddingSweep()},t.prototype.toggleTourStartStop=function(){window.toggleTourSelectedSweep()},t.prototype.toggleTourSweepsStartStop=function(e){window.toggleTourSweepsSelectedSweep(e)},t.prototype.addCurrentSweep=function(){window.addCurrentSweep()},t.prototype.removeSweep=function(e,t){window.removeSweep(e)},t.prototype.setDialogState=function(e,t,n,o,i,l,r,a,s){null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&(this.setState({selectedSteps:n}),this.props.onSaveSteps(n)),null!=o&&this.setState({modelDetails:o}),null!=i&&this.setState({currentSweep:i}),null!=l&&this.setState({logMessage:l}),null!=a&&this.setState({prevSweepIndex:a}),null!=s&&(this.setState({sdk:s}),this.initFrame(s,this.setDialogState,this.state)),null!=r&&this.setState({sdkReady:r})},t.prototype.loadSDK=function(e,t){var o=n(160),i=o.APIKey,l=o.Version,r=document.getElementById("showcase");window.MP_SDK.connect(r,i,l).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.initFrame=function(e,t,n){var o=!1,i=n.modelDetails,l=n.currentSweep,a=n.isStarted,s=n.isTourSelected,u=n.selectedSteps,c=n.sdkReady,d=n.startSweep,p=n.hasStartSweep,f=n.isViewForm,h=n.prevSweepIndex;function S(n,o){a?(console.log("Tour Stopped"),t(null,null,null,null,null,"Tour Stopped")):(o.length>0&&o.length>n?(s=!0,e.Sweep.moveTo(o[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var i="Move to Step No : "+(n+=1);console.log(i),t(null,null,null,null,null,i),document.getElementById("chkStep_"+n).checked=!0,S(n,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(s=!1,console.log("Tour Ended"),t(null,null,null,null,null,"Tour Ended")),t(null,s))}c||e.App.state.subscribe(function(n){n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase===e.App.Phase.PLAYING&&(console.log("The app is ready to take user input now!"),c=!0,t(null,null,null,null,null,null,!0),p&&window.goToSweep(d.uuid))}),e.Model.getData().then(function(e){console.log("Model data loaded for sid:",e.sid),t(null,null,null,i=e)}),window.toggleStartStopAddingSweep=function(){t(a=!a),a&&window.addCurrentSweep()},window.toggleTourSelectedSweep=function(){if(t(null,s=!0),s){console.log("Tour Started"),t(null,null,null,null,null,"Tour Started");for(var e=u.sort(function(e,t){return e.stepNo-t.stepNo}),n=1;n<=e.length;n++){document.getElementById("chkStep_"+n).checked=!1}S(0,e)}else console.log("Tour Stopped"),t(null,s),t(null,null,null,null,null,"Tour Stopped")},window.toggleTourSweepsSelectedSweep=function(e){for(var n=0;n<e.length;n++){document.getElementById("chkStep_"+n).checked=!1}(t(null,s=!0),s)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),S(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,s),t(null,null,null,null,null,"Tour Stopped"))},window.addCurrentSweep=function(){e.Camera.getPose().then(function(e){var n=i.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,l=n);var o=i.sweeps.indexOf(n);if(!function(e){if(u.length>0){var n=u.find(function(t){return t.uuid==e});if(null!=n||""+n!="undefined"){var o="Step No : "+(n.stepNo+1)+" is already added in the current list";return console.log(o),t(null,null,null,null,null,o),!0}}return!1}(l.uuid)){u.push({uuid:l.uuid,uuidIndex:o,stepNo:u.length}),t(null,null,u);var r="Step No "+u.length+" Added";console.log(r),t(null,null,null,null,null,r)}})},window.removeSweep=function(e){var n=u.find(function(t){return t.uuid==e}),o=u.indexOf(n);if(o>-1){u.splice(o,1),t(null,null,u);var i="Step No : "+(o+1)+" Removed";console.log(i),Object(r.b)(i),t(null,null,null,null,null,i)}},window.goToSweep=function(n){var o=u.find(function(e){return e.uuid==n});e.Sweep.moveTo(n,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+(o.stepNo+1);console.log(n),t(null,null,null,null,null,n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},e.on(e.Sweep.Event.ENTER,function(){if(s)return!1;e.Camera.getPose().then(function(e){if("mode.inside"==e.mode||"mode.outside"==e.mode)if(f&&u.length>0){var n=u.find(function(t){return t.uuid==e.sweep});if(null!=n&&""+n!="undefined"){var i="Moved to sweep "+n.uuid;console.log(i),t(null,null,null,null,null,i),h=u.indexOf(n),t(null,null,null,null,null,null,null,h)}else{i="Not allowed in the current step ";if(console.log(i),t(null,null,null,null,null,i),o)return setTimeout(function(){o=!1},1500),o=!1,!1;o=!0,window.goToSweep(u[h].uuid)}}else console.log("Current Sweep is: "+JSON.stringify(e.sweep)),a&&window.addCurrentSweep()})})},t.prototype.render=function(){var e=this,t=this.props.isViewForm,n=this.state,i=n.isStarted,l=n.selectedSteps,r=n.isTourSelected,a=n.logMessage,s=n.sdkReady,u=this.state.linkBimism;u&&!u.includes("&utm_source=sdkdebug&play=1&tourcta=0")&&(u+="&utm_source=sdkdebug&play=1&tourcta=0");var c=0,d=!1,p=!1;return s?(d=r,p=i):(d=!0,p=!0),o.createElement("div",{className:"card dataCard padding-10 no-margin"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-xs-12"},o.createElement("iframe",{id:"showcase",src:u,onLoad:function(){e.loadSDK(e.setDialogState,e.state)},width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0}))),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-7 col-xs-12"},o.createElement("button",{type:"button",id:"btnStartStop",disabled:d,title:1==i?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:this.toggleAddingSweep},o.createElement("i",{className:1==i?"fa fa-stop":"fa fa-plus"})),o.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:d&&p,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:this.addCurrentSweep},o.createElement("i",{className:"fa fa-thumb-tack"})),o.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:p,title:1==i?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:this.toggleTourStartStop},o.createElement("i",{className:1==r?"fa fa-stop":"fa fa-play"})),o.createElement("br",null),o.createElement("br",null),!t&&o.createElement("span",{className:"small-font-list"},a)),o.createElement("div",{className:"col-md-5 col-xs-12"},o.createElement("table",null,o.createElement("tr",null,o.createElement("th",null,"Steps"),o.createElement("th",null)),l&&l.map(function(n,i){return c+=1,o.createElement("tr",null,o.createElement("td",{className:"link",onClick:function(){s&&window.goToSweep(n.uuid)}},"Step ",c,": ",o.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:"chkStep_"+c.toString()})),o.createElement("td",null,!t&&s&&o.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(n.uuid,i)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"}))))}))))))},t}(o.Component);t.a=c},2038:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),n(2039)),l=n(843),r=n(6),a=n(30),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,l){function r(e){try{s(o.next(e))}catch(e){l(e)}}function a(e){try{s(o.throw(e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,a)}s((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,i,l,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(a){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,a])}}},d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,sdkReady:!1,locationModel:Object(),sdk:Object(),linkBimism:n.props.bimURL,currentSweep:Object(),modelDetails:Object(),selectedSteps:[],inBuildingRoutes:[],selectedRouteIndex:0,allSweeps:[]},n.getRoutes=n.getRoutes.bind(n),n.onRouteChange=n.onRouteChange.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.loadSDK=n.loadSDK.bind(n),n.initFrame=n.initFrame.bind(n),n}return s(t,e),t.prototype.componentWillReceiveProps=function(e){e.bimURL&&this.setState({linkBimism:e.bimURL})},t.prototype.getRoutes=function(e){return u(this,void 0,void 0,function(){var t,n,o,i,a,s,d=this;return c(this,function(p){switch(p.label){case 0:return t=this.props,n=t.buildingName,o=t.space,i=[],a=[],s=[],[4,Object(l.a)(n,o).then(function(t){return u(d,void 0,void 0,function(){var n,l,u,d,p,f,h;return c(this,function(c){for(n=0;n<t.length;n++){for(l=t[n],(u=Object()).description=Object(r.g)(l.description),u.ontology=Object(r.g)(l.ontology),u.space=Object(r.g)(l.space),u.routeName=Object(r.g)(l.routeName),a=Object(r.g)(l.sweeps).split(","),s=Object(r.g)(l.stepNo).split(","),d=Object(),p=[],f=function(t){var n=a[t],i=Object();(d=e.find(function(e){return e.uuid==n}))&&(i.uuid=d.uuid,i.assignedSpace=o,i.stepNo=s[t],p.push(i))},h=0;h<a.length;h++)f(h);u.sweeps=p,i.push(u)}return this.setState({inBuildingRoutes:i}),this.props.onSaveRoutes(i),i.length>0&&this.initFrame(this.state.sdk,this.setDialogState,this.state),[2]})})}).catch(function(e){return e})];case 1:return p.sent(),[2]}})})},t.prototype.onRouteChange=function(e){this.setState({inBuildingRoutes:e}),this.props.onSaveRoutes(e),this.initFrame(this.state.sdk,this.setDialogState,this.state)},t.prototype.toggleTourSweepsStartStop=function(e,t){window.toggleTourRouteSweepsSelectedSweep(e,t)},t.prototype.toggleAddingSweep=function(e,t){this.setState({inBuildingRoutes:e,selectedRouteIndex:t}),window.toggleStartStopAddingSweepByIndex(t)},t.prototype.addCurrentSweep=function(e,t){this.setState({inBuildingRoutes:e,selectedRouteIndex:t}),window.addCurrentSweepByIndex(t)},t.prototype.setDialogState=function(e,t,n,o,i,l,r,s,d){return u(this,void 0,void 0,function(){return c(this,function(u){switch(u.label){case 0:return null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&this.setState({selectedSteps:n}),null==o?[3,2]:(this.setState({modelDetails:o}),0!=this.state.inBuildingRoutes.length?[3,2]:(Object(a.a)(!0),[4,this.getRoutes(o.sweeps)]));case 1:u.sent(),Object(a.a)(!1),u.label=2;case 2:return null!=i&&this.setState({currentSweep:i}),null!=r&&(this.setState({sdk:r}),this.initFrame(r,this.setDialogState,this.state)),null!=l&&this.setState({sdkReady:l}),null!=s&&this.setState({inBuildingRoutes:s}),null!=d&&this.setState({selectedRouteIndex:d}),[2]}})})},t.prototype.loadSDK=function(e){var t=n(160),o=t.APIKey,i=t.Version,l=document.getElementById("showcase");window.MP_SDK.connect(l,o,i).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.initFrame=function(e,t,n){var o=n.modelDetails,i=n.currentSweep,l=n.isStarted,r=n.isTourSelected,a=n.selectedSteps,s=n.sdkReady,u=n.inBuildingRoutes,c=n.selectedRouteIndex;function d(n,o,i){l?console.log("Tour Stopped"):(o.length>0&&o.length>n?(r=!0,e.Sweep.moveTo(o[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+o[n].uuidIndex;(console.log(t),i||0==i)&&(document.getElementById(i+"_chkStep_"+n).checked=!0);d(n+=1,o,i)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(r=!1,console.log("Tour Ended")),t(null,r))}s||e.App.state.subscribe(function(n){n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase===e.App.Phase.PLAYING&&(console.log("The app is ready to take user input now!"),s=!0,t(null,null,null,null,null,!0))}),e.Model.getData().then(function(e){console.log("Model data loaded for sid:",e.sid),t(null,null,null,o=e)}),window.toggleStartStopAddingSweepByIndex=function(e){c=e,t(l=!l,null,null,null,null,null,null,null,e),l&&window.addCurrentSweepByIndex(e)},window.toggleTourSelectedSweep=function(){(t(null,r=!0),r)?(console.log("Tour Started"),d(0,a.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,r))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,r=!0),r)?d(0,e.sort(function(e,t){return e.stepNo-t.stepNo})):t(null,r)},window.toggleTourRouteSweepsSelectedSweep=function(e,n){for(var o=0;o<e.length;o++){document.getElementById(n+"_chkStep_"+o).checked=!1}(t(null,r=!0),r)?d(0,e.sort(function(e,t){return e.stepNo-t.stepNo}),n):t(null,r)},window.addCurrentSweepByIndex=function(n){c=n,t(null,null,null,null,null,null,null,null,n),e.Camera.getPose().then(function(e){var l=o.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,i=l);var r=o.sweeps.indexOf(l);if(!function(e,t){if(u&&u.length>0){var n=u[t].sweeps;if(n.length>0){var o=n.find(function(t){return t.uuid==e});if(null!=o||""+o!="undefined"){var i="Sweep "+o.uuid+" of index "+o.uuidIndex+" is already added in the current list";return console.log(i),!0}}}return!1}(i.uuid,n)){var a=u[n].sweeps;a.push({uuid:i.uuid,uuidIndex:r,stepNo:a.length}),u[n].sweeps=a,t(null,null,null,null,null,null,null,u);var s="Sweep "+i.uuid+" of index "+r+" is added in the current list";console.log(s)}})},window.removeSweep=function(e){var n=a.find(function(t){return t.uuid==e}),o=a.indexOf(n);if(o>-1){a.splice(o,1),t(null,null,a);var i="Sweep "+n.uuid+" of index "+n.uuidIndex+" is removed from the current list";console.log(i)}},window.goToSweep=function(t){e.Sweep.moveTo(t,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+t;console.log(n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},e.on(e.Sweep.Event.ENTER,function(){if(r)return!1;e.Camera.getPose().then(function(e){if("mode.inside"==e.mode||"mode.outside"==e.mode)if(a.length>0){var t=a.find(function(t){return t.uuid==e.sweep});if(null!=t&&""+t!="undefined"){var n="Moved to sweep "+t.uuid;console.log(n)}else{n="Not allowed in the current step ";console.log(n)}}else console.log("Current Sweep is: "+JSON.stringify(e.sweep)),l&&window.addCurrentSweepByIndex(c)})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,l=t.space,r=this.state,a=r.inBuildingRoutes,s=r.sdkReady,u=r.isTourSelected,c=r.isStarted,d=this.state.linkBimism;d&&!d.includes("&utm_source=sdkdebug&play=1&tourcta=0")&&(d+="&utm_source=sdkdebug&play=1&tourcta=0");var p=!1,f=!1;return s?(p=u,f=c):(p=!0,f=!0),o.createElement("div",{className:"card dataCard padding-10 no-margin"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-xs-12"},o.createElement("iframe",{id:"showcase",src:d,onLoad:function(){e.loadSDK(e.setDialogState)},width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0}))),o.createElement("br",null),o.createElement(i.a,{building:n,space:l,items:a,onItemChange:this.onRouteChange,onTour:this.toggleTourSweepsStartStop,onAddCurrentSweep:this.addCurrentSweep,onToggleAddingSweep:this.toggleAddingSweep,isStarted:f,isTourSelected:p,sdkReady:s})))},t}(o.Component);t.a=d},2039:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={items:[],selectedRowIndex:0,isAddDisable:!1,sdkReady:!1,isStarted:!1,isTourSelected:!1,playChecked:!1},n.addItem=n.addItem.bind(n),n.handleRouteNameChange=n.handleRouteNameChange.bind(n),n.removeSweep=n.removeSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.removeItem=n.removeItem.bind(n),n.hideSweeps=n.hideSweeps.bind(n),n}return i(t,e),t.prototype.componentWillReceiveProps=function(e){e.items&&this.setState({items:e.items}),e.destinationSweeps&&this.setState({destinationSweeps:e.destinationSweeps}),e.isStarted!=this.state.isStarted&&this.setState({isStarted:e.isStarted}),e.isTourSelected!=this.state.isTourSelected&&this.setState({isTourSelected:e.isTourSelected}),e.sdkReady!=this.state.sdkReady&&this.setState({sdkReady:e.sdkReady})},t.prototype.addItem=function(){var e=this.state.items;e.push({space:this.props.space,description:"",sweeps:[],hideRoutesView:!1}),this.setState({items:e,isAddDisable:!0}),this.props.onItemChange(e)},t.prototype.handleRouteNameChange=function(e,t){var n=this.state.items;n[t].routeName=e,this.setState({items:n}),this.props.onItemChange(n)},t.prototype.removeItem=function(e,t){t>-1&&(e.splice(t,1),this.setState({items:e}),this.props.onItemChange(e))},t.prototype.hideSweeps=function(e,t,n){e[t].hideRoutesView=!n,this.setState({items:e})},t.prototype.removeSweep=function(e,t,n){var o=e[t].sweeps.find(function(e){return e.uuid==n}),i=e[t].sweeps.indexOf(o);i>-1&&(e[t].sweeps.splice(i,1),this.setState({items:e}),this.props.onItemChange(e))},t.prototype.toggleAddingSweep=function(e,t){this.props.onToggleAddingSweep(e,t),this.setState({isAddDisable:!1})},t.prototype.addCurrentSweep=function(e,t){this.props.onAddCurrentSweep(e,t),this.setState({isAddDisable:!1})},t.prototype.toggleTourStartStop=function(e,t){var n=e[t].sweeps;this.props.onTour(n,t)},t.prototype.render=function(){var e=this,t=this.state,n=t.items,i=t.isAddDisable,l=t.sdkReady,r=t.isStarted,a=t.isTourSelected,s=!1,u=!1;return l?(s=a,u=r):(s=!0,u=!0),o.createElement(o.Fragment,null,o.createElement("div",{className:"container-fluid"},n&&n.length>0&&n.map(function(t,i){return o.createElement(o.Fragment,null,o.createElement("div",{key:i,className:"row matterport-margin-row"},o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("button",{type:"button",id:"btnStartStop",disabled:s,title:1==r?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:function(){e.toggleAddingSweep(n,i)}},o.createElement("i",{className:1==r?"fa fa-stop":"fa fa-plus"})),o.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:s&&u,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:function(){e.addCurrentSweep(n,i)}},o.createElement("i",{className:"fa fa-thumb-tack"})),o.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:u,title:1==r?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:function(){e.toggleTourStartStop(n,i)}},o.createElement("i",{className:1==a?"fa fa-stop":"fa fa-play"}))),o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("div",{className:"row"},o.createElement("span",{className:"hidden visible-xs-inline headingText"},o.createElement("label",{htmlFor:"description"},"Route Name")),o.createElement("span",{className:"fullWidth"},o.createElement("input",{type:"text",className:"form-control",value:t.routeName,placeholder:"Route Name",name:"description",onChange:function(t){return e.handleRouteNameChange(t.target.value,i)}})))),o.createElement("div",{className:"col-md-4 col-xs-10"},o.createElement("table",null,o.createElement("tr",null,o.createElement("th",null,"Steps: ",t.hideRoutesView?t.sweeps.length+" Steps Added":""),o.createElement("th",null)),t.sweeps&&t.sweeps.map(function(r,a){return o.createElement("tr",{style:{display:t.hideRoutesView?"none":"block"}},o.createElement("td",{className:"link",onClick:function(){l&&window.goToSweep(r.uuid)}},"Step ",a+1,": ",o.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:i+"_chkStep_"+a.toString()})),o.createElement("td",null,l&&o.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(n,i,r.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"}))))}))),o.createElement("div",{className:"col-md-1 col-xs-1"},o.createElement("button",{type:"button",title:"Hide Route Sweeps",onClick:function(){e.hideSweeps(n,i,t.hideRoutesView)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-minus"}))),o.createElement("div",{className:"col-md-1 col-xs-1"},o.createElement("button",{type:"button",title:"Remove Item",onClick:function(){e.removeItem(n,i)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"})))),o.createElement("hr",null))})),o.createElement("br",null),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("button",{disabled:i,type:"button",className:"btn btn-dark btn-fill btn-sm",onClick:this.addItem},o.createElement("i",{className:"fa fa-plus"}),n.length>0?"More":"Add"))))},t}(o.Component);t.a=l},787:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=(n.n(o),n(30)),l=n(79),r=n(6),a=n(2037),s=n(2038),u=n(843),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,l){function r(e){try{s(o.next(e))}catch(e){l(e)}}function a(e){try{s(o.throw(e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,a)}s((o=o.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var n,o,i,l,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(a){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,a])}}},f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={currentView:"Space",linkBimism:"",locationModel:Object(),spaceInBuildingRoutes:[],spaceSteps:[]},n.getSpace=n.getSpace.bind(n),n.onSaveHandle=n.onSaveHandle.bind(n),n.onSpaceStepsChange=n.onSpaceStepsChange.bind(n),n.onInBuildingRouteChange=n.onInBuildingRouteChange.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e,t,n;return p(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,n=e.space,[4,this.getSpace(t,n)];case 1:return o.sent(),[2]}})})},t.prototype.onSaveHandle=function(){return d(this,void 0,void 0,function(){var e,t,n,o,l=this;return p(this,function(r){switch(r.label){case 0:return e=this.state,t=e.currentView,n=e.spaceSteps,o=e.spaceInBuildingRoutes,Object(i.a)(!0),"Space"!=t?[3,3]:n&&n.length>0?(n.map(function(e){return e.assignedSpace=l.props.space}),[4,Object(u.g)(this.props.buildingName,n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return[4,Object(u.e)(this.props.buildingName,o)];case 4:r.sent(),r.label=5;case 5:return Object(i.a)(!1),[2]}})})},t.prototype.onSpaceStepsChange=function(e){this.setState({spaceSteps:e})},t.prototype.onInBuildingRouteChange=function(e){this.setState({spaceInBuildingRoutes:e})},t.prototype.getSpace=function(e,t){return d(this,void 0,void 0,function(){var n,o,a=this;return p(this,function(s){switch(s.label){case 0:return n=Object(),o=this.state.locationModel,Object(i.a)(!0),[4,Object(l.g)(e,t).then(function(e){return d(a,void 0,void 0,function(){return p(this,function(t){return""==Object(r.g)(e[0].space)&&(e=[]),n=e[0],[2]})})}).catch(function(e){return e})];case 1:return s.sent(),n&&(o.buildingName=e,o.floor=Object(r.g)(n.floor&&n.floor),o.type=Object(r.g)(n.type),o.name=Object(r.g)(n.space),o.rdfsLabel=Object(r.g)(n.rdfsLabel),o.ceilingType=Object(r.g)(n.ceilingtype),o.ceilingHeight=Object(r.g)(n.ceilingheight),o.description=Object(r.g)(n.description),o.notes=Object(r.g)(n.notes),o.panelID=Object(r.g)(n.panelID),o.virtualBIM=Object(r.g)(n.virtualBIM),o.cadBIM=Object(r.g)(n.cadBIM),o.profileFileName=Object(r.g)(n.profileFileName).split(","),o.isDirectional="true"===Object(r.g)(n.isDirectional),this.setState({locationModel:o,linkBimism:o.virtualBIM})),Object(i.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.currentView,i=t.linkBimism,l=this.props,r=l.instance,u=l.buildingName,c=l.space;return o.createElement("div",{className:"content"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-3 padding-5"},o.createElement("div",{className:"btn-group"},o.createElement("button",{className:"btn "+("Space"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"Space"})}},"Space Steps"),o.createElement("button",{className:"btn "+("InBuilding"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"InBuilding"})}},"In Building Routes"))),o.createElement("div",{className:"col-md-9 padding-5"},o.createElement("div",{className:"pull-right"},o.createElement("div",{className:"col-md-6"},o.createElement("button",{type:"button",className:"btn btn-primary btn-fill",onClick:this.onSaveHandle}," Save ","Space"==n?"Space Steps":"In building Route")),o.createElement("div",{className:"col-md-6"},o.createElement("button",{type:"button",className:"btn btn-default btn-fill",onClick:function(){window.location.hash=r+"/"+u+"/Space"}}," Back To Spaces"))))),o.createElement("br",null),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},"Space"==n&&o.createElement("div",null,o.createElement(a.a,{buildingName:u,space:c,bimURL:i,onSaveSteps:this.onSpaceStepsChange})),"InBuilding"==n&&o.createElement("div",null,o.createElement(s.a,{buildingName:u,space:c,bimURL:i,onSaveRoutes:this.onInBuildingRouteChange}))))))},t}(o.Component);t.default=f},843:function(e,t,n){"use strict";t.c=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,space:t},o.a.MATTERPORT.FETCHSWEEPS,i.b.SPACE,!0)];case 1:return[2,n.sent()]}})})},t.g=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,model:t},o.a.MATTERPORT.UPDATESWEEP,i.b.SPACE).then(function(){Object(l.b)("Sweep Updated Successfully.")}).catch(function(e){Object(l.a)("Error occured while saving Sweep.")})];case 1:return[2,n.sent()]}})})},t.d=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,task:t},o.a.MATTERPORT.FETCHSTASKROUTE,i.b.TASK,!0)];case 1:return[2,n.sent()]}})})},t.h=function(e,t,n){return r(this,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,Object(o.f)({buildingName:e,model:t,isEdit:n},o.a.MATTERPORT.UPDATETASKROUTE,i.b.TASK).then(function(){Object(l.b)("Task Route "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(l.a)("Error occured while saving Task Route.")})];case 1:return[2,r.sent()]}})})},t.b=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,floorOntology:t},o.a.MATTERPORT.FETCHMATTERPORTIMAGE,i.b.ZONE,!0)];case 1:return[2,n.sent()]}})})},t.f=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({model:e},o.a.MATTERPORT.UPDATEMATTERPORTIMAGE,i.b.ZONE).then(function(e){Object(l.b)("Image "+(t?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(l.a)("Error occured while saving Image.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,space:t},o.a.MATTERPORT.FETCHSINBUILDINGROUTE,i.b.SPACE,!0)];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return r(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,model:t},o.a.MATTERPORT.UPDATEINBUILDINGROUTE,i.b.SPACE).then(function(){Object(l.b)("In Building Routes Updated Successfully.")}).catch(function(e){Object(l.a)("Error occured while saving In Building Routes.")})];case 1:return[2,n.sent()]}})})};var o=n(3),i=n(8),l=n(4),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,l){function r(e){try{s(o.next(e))}catch(e){l(e)}}function a(e){try{s(o.throw(e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,a)}s((o=o.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,o,i,l,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(l){return function(a){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(6===l[0]&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,a])}}}}});