webpackJsonp([11],{2965:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=(a.n(n),a(127)),r=a(1291),s=a(11),o=a(707),l=a(2966),u=a(20),c=a(2967),m=a(2968),p=a(2969),h=a(2970),g=a(2971),d=a(2972),f=a(2973),v=a(2974),x=a(2975),y=a(2976),b=a(1680),A=(a.n(b),a(744)),E=a(2977),D=a(725),w=a(13),S=a(124),_=a(8),O=a(749),L=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),P=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},N=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},V=this&&this.__spreadArrays||function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<a;t++)for(var r=arguments[t],s=0,o=r.length;s<o;s++,i++)n[i]=r[s];return n},j=function(e){function t(t){var a=e.call(this,t)||this,n=new Date(new Date(Date.now()).setMinutes(new Date(Date.now()).getMinutes()-30)),i=new Date(Date.now());return a.state={from:n,to:i,dashboardURL:"",insights:[],templatesList:[],selectedTemplate:"",loadingDevices:!0,liveGraphRange:30,filteredInsights:[],showInsights:[],selectedTemplateGraphs:{},showAlarmPoints:!1,enableYAxis:!1,insightsLoaded:0,verifyList:[],insightPoints:[],assets:[],isEquipment:!1,filteredAssets:[],showAssets:[],isAnyGraphLoaded:[],showAllGraphs:!1},a.isGraphLoaded=a.isGraphLoaded.bind(a),a}return L(t,e),t.prototype.componentDidMount=function(){return P(this,void 0,void 0,function(){var e;return N(this,function(t){switch(t.label){case 0:return e=JSON.parse(_.a.getItem("user")),[4,Promise.all([Object(S.b)(e.contact),this._fetchInsights(),this._fetchEquipment()])];case 1:return t.sent(),[2]}})})},t.prototype.moreInsights=function(){var e=this.state,t=e.showInsights,a=e.filteredInsights,n=e.isEquipment,i=e.filteredAssets,r=e.showAssets;if(n){var s=i.slice(r.length-1,r.length+4),o=V(r,s);this.setState({showAssets:o},function(){window.dispatchEvent(new Event("reLoadGraph"))})}else{s=a.slice(t.length-1,t.length+4),o=V(t,s);this.setState({showInsights:o},function(){window.dispatchEvent(new Event("reLoadGraph"))})}},t.prototype.loadNextInsight=function(){var e=this.state,t=e.showInsights,a=e.insightsLoaded,n=e.isEquipment,i=e.showAssets;n?a<i.length&&this.setState({insightsLoaded:a+1}):a<t.length&&this.setState({insightsLoaded:a+1})},t.prototype._fetchInsights=function(){return P(this,void 0,void 0,function(){var e,t,a,n,i,l,u=this;return N(this,function(c){switch(c.label){case 0:return e=this.props.buildingName,t=[],a=[],[4,Object(A.o)(e)];case 1:return n=(n=c.sent()).filter(function(e){return"Measure"==e.verifyType}),e?[4,Object(o.u)(e)]:[3,6];case 2:return(i=(i=c.sent()).filter(function(e){var t,a,n,i,r,o,l;return-1!=(null===(t=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===t?void 0:t.toLowerCase().indexOf("thermostat"))||-1!=(null===(a=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===a?void 0:a.toLowerCase().indexOf("ceiling"))||-1!=(null===(n=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===n?void 0:n.toLowerCase().indexOf("intesis"))||-1!=(null===(i=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("ats"))||-1!=(null===(r=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===r?void 0:r.toLowerCase().indexOf("generator"))||"CBW406"==Object(s.g)(null===e||void 0===e?void 0:e.moncontype)||"CBW418"==Object(s.g)(null===e||void 0===e?void 0:e.moncontype)||-1!=(null===(o=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===o?void 0:o.toLowerCase().indexOf("relayv4"))||-1!=(null===(l=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===l?void 0:l.toLowerCase().indexOf("relayi1"))||"WattNode"==Object(s.g)(null===e||void 0===e?void 0:e.moncontype)}))&&i.length?(l=i.map(function(e){return Object(s.g)(e.moncondevice)}),[4,Object(D.l)(e,"Sensed",l)]):[3,4];case 3:a=c.sent(),c.label=4;case 4:return[4,Object(r.b)(e).then(function(e){if(e&&e.length>0)e.map(function(e){t.push({ontology:Object(s.g)(e.ontology),label:Object(s.g)(e.label),deviceGraphs:Object(s.g)(e.deviceGraphs)})}),u.setState({insightPoints:a,templatesList:t,insights:i,selectedTemplate:(t.length-1).toString(),filteredInsights:[],showInsights:[]},function(){var e=JSON.parse(t[t.length-1].deviceGraphs),a=Object.keys(e),r=null===i||void 0===i?void 0:i.filter(function(e){return a.indexOf(Object(s.g)(e.moncondevice))>-1}),o=r.slice(0,10);u.setState({filteredInsights:r,showInsights:o,selectedTemplateGraphs:e,verifyList:n,loadingDevices:!1})});else{var r=null===i||void 0===i?void 0:i.filter(function(e){return e.moncondevice}),o=r.slice(0,10);u.setState({insightPoints:a,insights:i,filteredInsights:r,showInsights:o,verifyList:n,loadingDevices:!1})}})];case 5:c.sent(),c.label=6;case 6:return[2]}})})},t.prototype._fetchEquipment=function(){return P(this,void 0,void 0,function(){var e;return N(this,function(t){switch(t.label){case 0:return[4,Object(O.g)(this.props.buildingName,w.b.POINT)];case 1:return e=t.sent(),this.setState({assets:e}),[2]}})})},t.prototype.changeAlarmStatus=function(){this.setState({showAlarmPoints:!this.state.showAlarmPoints}),window.dispatchEvent(new Event("ShowAlarms"))},t.prototype.changeYAxisStatus=function(){this.setState({enableYAxis:!this.state.enableYAxis})},t.prototype.liveGraphRangeChange=function(e){var t=this,a=new Date,n=new Date;n.setMinutes(n.getMinutes()-+e),this.setState({from:n,to:a,liveGraphRange:+e,loadingDevices:!0,insightsLoaded:0},function(){t.setState({loadingDevices:!1})})},t.prototype.selectTemplate=function(e){var t=this,a=this.state,n=a.templatesList,i=a.insights,r=a.verifyList,o=a.assets;if(isNaN(+e))if("default"==e){var l=i,u=l.slice(0,10);this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0,isEquipment:!1,isAnyGraphLoaded:[]},function(){t.setState({selectedTemplate:e,filteredInsights:l,showInsights:u,loadingDevices:!1,isAnyGraphLoaded:[],showAllGraphs:!1})})}else if("defaultAll"==e){var c=i,m=c.slice(0,10);this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0,isEquipment:!1,isAnyGraphLoaded:[]},function(){t.setState({selectedTemplate:e,filteredInsights:c,showInsights:m,loadingDevices:!1,isAnyGraphLoaded:[],showAllGraphs:!0})})}else if("equipmentGraphsAll"==e){var p=o,h=p.slice(0,10);this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0,isEquipment:!0,isAnyGraphLoaded:[]},function(){t.setState({selectedTemplate:e,filteredAssets:p,showAssets:h,loadingDevices:!1,isAnyGraphLoaded:[],showAllGraphs:!0})})}else if("equipmentGraphs"==e){var g=o,d=g.slice(0,10);this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0,isEquipment:!0,isAnyGraphLoaded:[]},function(){t.setState({selectedTemplate:e,filteredAssets:g,showAssets:d,loadingDevices:!1,isAnyGraphLoaded:[],showAllGraphs:!1})})}else{if(!r.find(function(t){return t._id==e}))return;this.setState({loadingDevices:!0,showAlarmPoints:!1,insightsLoaded:0,isEquipment:!1,isAnyGraphLoaded:[]},function(){t.setState({loadingDevices:!1,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],liveGraphRange:1,isAnyGraphLoaded:[]})})}else this.setState({loadingDevices:!0,showAlarmPoints:!1,selectedTemplate:e,filteredInsights:[],showInsights:[],insightsLoaded:0,isEquipment:!1,isAnyGraphLoaded:[]},function(){var a=JSON.parse(n[+e].deviceGraphs),r=Object.keys(a),o=i.filter(function(e){return r.indexOf(Object(s.g)(e.moncondevice))>-1}),l=o.slice(0,10);t.setState({showInsights:l,filteredInsights:o,loadingDevices:!1,selectedTemplateGraphs:a,isAnyGraphLoaded:[]})})},t.prototype.isGraphLoaded=function(e){this.setState({isAnyGraphLoaded:V(this.state.isAnyGraphLoaded,[e])})},t.prototype.render=function(){var e,t=this,a=this.state,r=a.verifyList,o=a.from,b=a.to,A=a.showInsights,D=a.filteredInsights,w=a.templatesList,S=a.selectedTemplate,_=a.loadingDevices,O=a.liveGraphRange,L=a.selectedTemplateGraphs,P=a.showAlarmPoints,N=a.insightsLoaded,V=a.insightPoints,j=a.isEquipment,k=a.filteredAssets,R=a.showAssets,q=a.insights,F=a.enableYAxis,M=a.isAnyGraphLoaded,K=a.showAllGraphs,G=this.props,C=G.buildingName,Y=G.instance,T=!M||!M.length||(null===M||void 0===M?void 0:M.find(function(e){return 1==e}));return n.createElement("div",{className:"dashboard"},n.createElement("div",{className:"dashboard-header sticky"},!_&&n.createElement("div",{className:"col-md-4 float-left"},n.createElement("div",{className:"col-md-8 no-padding"},n.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(e){t.selectTemplate(e.target.value)},value:S,placeholder:"Select Template"},0==w.length&&n.createElement("option",{value:""},"Select Template"),n.createElement("option",{value:"default"},"Insight Graphs"),n.createElement("option",{value:"defaultAll"},"All Insight Graphs"),n.createElement("option",{value:"equipmentGraphs"},"Equipment Graphs"),n.createElement("option",{value:"equipmentGraphsAll"},"All Equipment Graphs"),(null===w||void 0===w?void 0:w.length)>0&&w.map(function(e,t){return n.createElement("option",{value:t,key:t},e.label)}),(null===r||void 0===r?void 0:r.length)>0&&r.map(function(e,t){return n.createElement("option",{value:e._id,key:t},e.projectName)}))),n.createElement(i.b,{target:"_blank",to:"/"+Y+"/"+C+"/Dashboard/Templates",className:"btn btn-fill btn-secondary btn-secondary-dark margin-left-20 btn-fix-height"},"Create Template")),n.createElement("h3",{className:"dashboard-title"},Object(u.A)(C)),!_&&n.createElement("div",{className:"col-md-4 float-right margin-top-10"},n.createElement("div",{className:"col-md-3 padding-5 mr-5"},(j&&N==R.length||!j&&N===A.length)&&!r.find(function(e){return e._id==S})&&n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-7"},n.createElement("label",{style:{color:"#fff",cursor:"default"}},"Show Alarm:")),n.createElement("div",{className:"col-md-5 no-padding"},n.createElement("label",null,n.createElement("input",{name:"showError",onChange:function(e){t.changeAlarmStatus()},className:"switchDashboard",type:"checkbox",checked:P}),n.createElement("div",null,n.createElement("div",null)))))),n.createElement("div",{className:"col-md-4 padding-5 mr-5"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-7 text-align-end"},n.createElement("label",{style:{color:"#fff",cursor:"default"}},"Y axis:")),n.createElement("div",{className:"col-md-5 no-padding"},n.createElement("label",null,n.createElement("input",{onChange:function(e){t.changeYAxisStatus()},className:"switchDashboard",type:"checkbox",checked:F}),n.createElement("div",null,n.createElement("div",null)))))),n.createElement("div",{className:"col-md-5 padding-5"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-4 no-padding text-align-end"},n.createElement("label",{style:{color:"#fff",cursor:"default"}},"X axis:")),n.createElement("div",{className:"col-md-8"},n.createElement("select",{className:"form-control",id:"pointState",name:"pointState",onChange:function(e){t.liveGraphRangeChange(e.target.value)},value:O},r.find(function(e){return e._id==S})?n.createElement(n.Fragment,null,n.createElement("option",{value:1},"1 Month"),n.createElement("option",{value:2},"2 Months"),n.createElement("option",{value:3},"3 Months"),n.createElement("option",{value:4},"4 Months"),n.createElement("option",{value:5},"5 Months"),n.createElement("option",{value:6},"6 Months")):n.createElement(n.Fragment,null,n.createElement("option",{value:5},"5 Mins"),n.createElement("option",{value:15},"15 Mins"),n.createElement("option",{value:30},"30 Mins"),n.createElement("option",{value:60},"1 Hour"),n.createElement("option",{value:180},"3 Hours"),n.createElement("option",{value:360},"6 Hours"),n.createElement("option",{value:720},"12 Hours"),n.createElement("option",{value:1440},"24 Hours")))))))),_||""!=S||0!=w.length?_?n.createElement("div",{className:"graph-box-loader full-screen"},n.createElement("div",{className:"center-object loader"})):r.find(function(e){return e._id==S})?n.createElement("div",{className:""},n.createElement(E.a,{instance:Y,buildingName:C,from:o,to:b,projectName:S,measureAnalysis:r.find(function(e){return e._id==S}).measureAnalysis})):j?n.createElement(c.a,{dataLength:R.length,className:"graph-boxes",next:function(){return t.moreInsights()},hasMore:R.length<k.length,loader:n.createElement("div",{className:"graph-box-loader full-screen"},n.createElement("div",{className:"center-object loader"}))},R.map(function(e){var a=q.filter(function(t){return Object(s.g)(t.equipmentsRdfsLabel)&&Object(s.g)(t.equipmentsRdfsLabel).indexOf(Object(s.g)(e.ontology))>-1});return a&&a.length?a&&a.length&&a.map(function(a){for(var i,r,u,c,A,E,D,w=-1!=(null===(i=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("thermostat")),S=-1!=(null===(r=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===r?void 0:r.toLowerCase().indexOf("ceiling")),_=-1!=(null===(u=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===u?void 0:u.toLowerCase().indexOf("intesis")),N=-1!=(null===(c=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===c?void 0:c.toLowerCase().indexOf("ats")),j=-1!=(null===(A=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===A?void 0:A.toLowerCase().indexOf("generator")),k="CBW406"==Object(s.g)(null===a||void 0===a?void 0:a.moncontype),R="CBW418"==Object(s.g)(null===a||void 0===a?void 0:a.moncontype),q=-1!=(null===(E=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===E?void 0:E.toLowerCase().indexOf("relayv4")),M=-1!=(null===(D=Object(s.g)(null===a||void 0===a?void 0:a.moncontype))||void 0===D?void 0:D.toLowerCase().indexOf("relayi1")),G="WattNode"==Object(s.g)(null===a||void 0===a?void 0:a.moncontype),T={ontology:Object(s.g)(e.ontology),rdfsLabel:Object(s.g)(e.rdfsLabel)},H=Object(s.g)(a.equipmentsRdfsLabel).split(","),B=Object(s.g)(a.relatedEquipmentsLabel).split(","),U=[],I=0;I<H.length;I++){var W=H[I],z=B&&B[I]?B[I]:"";U.push({ontology:W,rdfsLabel:z})}var J=null===V||void 0===V?void 0:V.filter(function(e){return Object(s.g)(e.monconDevice)==Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)||Object(s.g)(e.sinkSourceAsset)==Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)});return n.createElement(n.Fragment,null,w&&n.createElement(l.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),S&&n.createElement(p.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]?L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]:["Temp & Humidity","Pressure","Illuminance","Air Particles","Gas Resistance","Other Parameters"],insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),_&&n.createElement(h.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,space:Object(s.g)(a.spaceRdfsLabel),zone:Object(s.g)(a.zoneRdfsLabel),floor:Object(s.g)(a.floorRdfsLabel),equipment:U,loadNextInsight:function(){return t.loadNextInsight()},device:a,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),N&&n.createElement(g.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),j&&n.createElement(d.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]?L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]:["Voltages","Currents","Powers","Power Factor","Other Parameters","Binary Parameters"],insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),k&&n.createElement(f.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]?L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]:["Refrigerator 1","Refrigerator 2","Refrigerator 3","Refrigerator 4"],insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),R&&n.createElement(v.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]?L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]:["Refrigerator 1","Refrigerator 2","Refrigerator 3","Refrigerator 4"],insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),q&&n.createElement(x.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),M&&n.createElement(m.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]?L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]:["Totalized Energy","Frequency and Voltage","Current and Power","State and Power Factor"],insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),G&&n.createElement(y.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]?L[Object(s.g)(null===a||void 0===a?void 0:a.moncondevice)]:["Power","Phase Voltage","Voltage","Frequency","Energy Sum Resettable","Positive Energy Sum Non-resettable"],insightRelEquipment:U,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:J,device:a,isEquipment:!0,equipment:T,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}))}):n.createElement(n.Fragment,null)}),(0==(null===R||void 0===R?void 0:R.length)||!T)&&n.createElement("div",{className:"full-screen"},n.createElement("h1",{className:"no-graph-heading"}," ",0==(null===R||void 0===R?void 0:R.length)?"No graphs":"No latest data for graphs"," "))):n.createElement(c.a,{dataLength:A.length,className:"graph-boxes",next:function(){return t.moreInsights()},hasMore:A.length<D.length,loader:n.createElement("div",{className:"graph-box-loader full-screen"},n.createElement("div",{className:"center-object loader"}))},null===(e=null===A||void 0===A?void 0:A.slice(0,N+1))||void 0===e?void 0:e.map(function(e,a){for(var i,r,u,c,A,E,D,w=-1!=(null===(i=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===i?void 0:i.toLowerCase().indexOf("thermostat")),S=-1!=(null===(r=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===r?void 0:r.toLowerCase().indexOf("ceiling")),_=-1!=(null===(u=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===u?void 0:u.toLowerCase().indexOf("intesis")),N=-1!=(null===(c=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===c?void 0:c.toLowerCase().indexOf("ats")),j=-1!=(null===(A=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===A?void 0:A.toLowerCase().indexOf("generator")),k="CBW406"==Object(s.g)(null===e||void 0===e?void 0:e.moncontype),R="CBW418"==Object(s.g)(null===e||void 0===e?void 0:e.moncontype),q=-1!=(null===(E=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===E?void 0:E.toLowerCase().indexOf("relayv4")),M=-1!=(null===(D=Object(s.g)(null===e||void 0===e?void 0:e.moncontype))||void 0===D?void 0:D.toLowerCase().indexOf("relayi1")),G="WattNode"==Object(s.g)(null===e||void 0===e?void 0:e.moncontype),T=Object(s.g)(e.equipmentsRdfsLabel).split(","),H=Object(s.g)(e.relatedEquipmentsLabel).split(","),B=[],U=0;U<T.length;U++){var I=T[U],W=H&&H[U]?H[U]:"";B.push({ontology:I,rdfsLabel:W})}var z=null===V||void 0===V?void 0:V.filter(function(t){return Object(s.g)(t.monconDevice)==Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)||Object(s.g)(t.sinkSourceAsset)==Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)}),J=["Refrigerator 1","Refrigerator 2"];return R&&Object(s.g)(e.applicationLabel)&&Object(s.g)(e.applicationLabel).indexOf("3")>-1&&(J=["Refrigerator 3","Refrigerator 4"]),n.createElement(n.Fragment,null,w&&n.createElement(l.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),S&&n.createElement(p.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]?L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Temp & Humidity","Pressure","Illuminance","Air Particles","Gas Resistance","Other Parameters"],insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,isEquipment:!1,equipment:Object(),enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),_&&n.createElement(h.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,space:Object(s.g)(e.spaceRdfsLabel),zone:Object(s.g)(e.zoneRdfsLabel),floor:Object(s.g)(e.floorRdfsLabel),equipment:B,loadNextInsight:function(){return t.loadNextInsight()},device:e,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),N&&n.createElement(g.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),j&&n.createElement(d.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]?L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Voltages","Currents","Powers","Power Factor","Other Parameters","Binary Parameters"],insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),k&&n.createElement(f.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]?L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Refrigerator 1","Refrigerator 2","Refrigerator 3","Refrigerator 4"],insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),R&&n.createElement(v.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]?L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]:J,insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),q&&n.createElement(x.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),M&&n.createElement(m.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]?L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Totalized Energy","Frequency and Voltage","Current and Power","State and Power Factor"],insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}),G&&n.createElement(y.a,{buildingName:C,instance:Y,from:o,to:b,liveGraphRange:O,graphsList:L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]?L[Object(s.g)(null===e||void 0===e?void 0:e.moncondevice)]:["Power","Phase Voltage","Voltage","Frequency","Energy Sum Resettable","Positive Energy Sum Non-resettable"],insightRelEquipment:B,showAlarmPoints:P,loadNextInsight:function(){return t.loadNextInsight()},devicePoints:z,device:e,enableYAxis:F,isGraphLoaded:t.isGraphLoaded,showAllGraphs:K}))})):n.createElement("div",{className:"full-screen"},n.createElement("h1",{className:"no-graph-heading"}," No Template Created ")))},t}(n.Component);t.default=j},2966:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(11),o=a(707),l=a(804),u=a(20),c=a(835),m=a(797),p=a(122),h=a(736),g=a(124),d=a(760),f=(a.n(d),a(834)),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(s.g)(e)&&Object(g.g)(Object(s.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,o,l,u,c,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,o=a.device,Object(p.a)(!0),r&&!e?[3,2]:(l=[],i&&i.length&&i.forEach(function(e){l.push({sensedValue:Object(s.g)(e.sensedValue),maximumExtremeValue:Object(s.g)(e.maximumExtremeValue),maximumNormalValue:Object(s.g)(e.maximumNormalValue),minimumExtremeValue:Object(s.g)(e.minimumExtremeValue),minimumNormalValue:Object(s.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(s.g)(e.ifMaximumExtremeValue)||"true"!=Object(s.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(s.g)(e.ifMaximumNormalValue)||"true"!=Object(s.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(s.g)(e.ifMinimumExtremeValue)||"true"!=Object(s.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(s.g)(e.ifMinimumNormalValue)||"true"!=Object(s.g)(e.ifMinimumNormalValue))})}),[4,Object(m.e)(h.a.OperationalAlarm,n,!1,0,50,null,null,[Object(s.g)(o.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(c=t[0].graphData.columns,g=new Date(c[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:l,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===l||void 0===l?void 0:l.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(p.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,u=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",u.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:u,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=c.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,o=n.alarmSensedPoints,l=this.props,c=l.showAlarmPoints,m=l.device,p=new Date,h=Object(s.g)(m.moncontype),g=f.c.filter(function(e){return h.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(p=new Date(e["@timestamp"]));var d=this.props.liveGraphRange;if(i&&i.length&&p){for(var v=0;v<i.length;v++){var x=i[v],y=x.graphData.columns.map(function(e){return e[0]});if(x.graphData.columns&&x.graphData.columns.length){if(x.graphData.columns[0].push(p),e&&Object.keys(e).length)for(var b=Object.keys(e),A=function(a){var n=b[a];if(x.sensedKeys&&x.sensedKeys.length&&x.sensedKeys.find(function(e){return e==n})){var i=null===(t=g.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=y.findIndex(function(e){return e==i});1!=(null===e||void 0===e?void 0:e.tempunits)||"cooltemp"!=n&&"heattemp"!=n&&"spacetemp"!=n?x.graphData.columns[r].push(e[n]):x.graphData.columns[r].push(Object(u.a)(e[n]).toFixed(1)),x.graphData.columns[r].splice(1,1)}}},E=0;E<b.length;E++)A(E);(p.getTime()-x.graphData.columns[0][2].getTime())/6e4>d&&x.graphData.columns[0].splice(1,1),x.axis.x.tick.values[2]&&x.axis.x.tick.values[1].getTime()&&x.axis.x.tick.values[2].getTime()-x.axis.x.tick.values[1].getTime()<p.getTime()-x.axis.x.tick.values[x.axis.x.tick.values.length-1]&&(x.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),p.setSeconds(0),d>10&&p.setMinutes(p.getMinutes()-p.getMinutes()%5),x.axis.x.tick.values.push(p),r.x.lines.push({value:p,class:"grid4"}))}}var D=null===p||void 0===p?void 0:p.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:D},function(){if(c){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&o.length>0&&o.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),s=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,s,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,o,l=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(s.g)(i.moncontype),(o=f.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&o.value&&(n.axis.y.tick.values=o.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){l.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,o,c,m,p,h,g,d,f,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,o=i.buildingName,c=i.device,m=i.isEquipment,p=i.equipment,h=this.state.graphYAxisSettings,g="",d="",f="",m?(f="equipment",g=p.ontology,d=p.rdfsLabel):(f="device",g=Object(s.g)(c.moncondevice),d=Object(s.g)(c.rdfsLabel)),v=h.find(function(t){return t.graphName==e}),x=Object(u.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:o,ontology:x,assetOntology:g,ontologyLabel:d,ontologyAssetType:f,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(l.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,o;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(s.g)(i.moncondevice),[4,Object(l.a)(t,r)];case 1:return o=u.sent(),this.setState({graphYAxisSettings:o}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(s.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(s.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(s.g)(r.relatedEquipment)})||i.push({value:Object(s.g)(r.relatedEquipment),label:Object(s.g)(r.relatedEquipmentLabel),space:Object(s.g)(r.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)r(o);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,c,m,p,h,d,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.from,a=e.to,n=e.device,i=e.showAlarmPoints,r=e.devicePoints,c=e.isEquipment,m=e.equipment,p=e.isGraphLoaded,h=e.showAllGraphs,d=this.state,v=d.grid,x=d.graphData,y=d.lastUpdatedAt,A=d.graphYAxisSettings,E=[],c&&(E=r.filter(function(e){return Object(s.g)(e.relatedEquipment)==m.ontology})),n&&n.moncondevice?(D=Object(s.g)(n.moncontype),w=Object(s.g)(n.topic),S=f.b.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=f.c.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),O=[],!c||c&&E.length?[4,Object(o.G)(w,t,a,!1)]:[3,2]):[3,3];case 1:O=b.sent(),b.label=2;case 2:if(L={cooltemp:[_.find(function(e){return"cooltemp"==e.sensedKey}).des],heattemp:[_.find(function(e){return"heattemp"==e.sensedKey}).des],spacetemp:[_.find(function(e){return"spacetemp"==e.sensedKey}).des],fan:[_.find(function(e){return"fan"==e.sensedKey}).des],fanstate:[_.find(function(e){return"fanstate"==e.sensedKey}).des],mode:[_.find(function(e){return"mode"==e.sensedKey}).des],state:[_.find(function(e){return"state"==e.sensedKey}).des]},P=["x"],L.cooltemp.push(null),L.heattemp.push(null),L.spacetemp.push(null),L.fan.push(null),L.fanstate.push(null),L.mode.push(null),L.state.push(null),P.push(new Date(t)),O.length>0&&(null===O||void 0===O||O.forEach(function(e){(null===e||void 0===e?void 0:e.cooltemp)&&(1==e.tempunits?(L.cooltemp.push(Object(u.a)(e.cooltemp).toFixed(1)),L.heattemp.push(Object(u.a)(e.heattemp).toFixed(1)),L.spacetemp.push(Object(u.a)(e.spacetemp).toFixed(1))):(L.cooltemp.push(e.cooltemp),L.heattemp.push(e.heattemp),L.spacetemp.push(e.spacetemp)),L.fan.push(e.fan),L.fanstate.push(e.fanstate),L.mode.push(e.mode),L.state.push(e.state),P.push(new Date(e.timestamp)))})),y=O.length>0?null===(C=P[P.length-1])||void 0===C?void 0:C.toLocaleString():"No Data",P.length>1){if(N=Object(l.c)(5,t,a),V="",N.length>1?(j=((new Date).getTime()-N[0].getTime())/1e3,V=(j/=3600)>24?"%m-%d %H:%M":j<.3?"%H:%M:%S":"%H:%M"):V="%H:%M:%S",v.x.lines=[],N.forEach(function(e){v.x.lines.push({value:e,class:"grid4"})}),c){for((k=JSON.parse(JSON.stringify(f.a))).name="Thermostat",k.graphData.columns=[P],k.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},k.axis.x.tick.format=V,k.axis.x.tick.values=N,k.graphData.axes={"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},k.axis.y.label="State, Mode, Fan, Fan State",k.axis.y.tick.values=[0,1,2,3],k.axis.y.tick.max=3,k.axis.y.tick.min=0,k.graphData.x="x",G=0;G<E.length;G++)R=E[G],q=Object(s.g)(R.sensedValue),k.sensedKeys.push(q),k.graphData.columns.push(L[""+q]);S.find(function(e){return e.name==k.name})&&(k.axis.y.tick.values=S.find(function(e){return e.name==k.name}).value,k.axis.y.min=k.axis.y.tick.values[0],k.axis.y.max=k.axis.y.tick.values[k.axis.y.tick.values.length-1]),A&&A.length&&(F=A.find(function(e){return e.graphName==k.name}))&&F.yAxisSettings&&("Fixed"==F.yAxisSettings?(delete k.axis.y.tick.values,k.axis.y.min=F.yAxisMin,k.axis.y.max=F.yAxisMax):"Floating"==F.yAxisSettings&&(delete k.axis.y.tick.values,delete k.axis.y.max,delete k.axis.y.min),k.yAxisSettings=F.yAxisSettings,k.yAxisFixedValues={max:F.yAxisMax,min:F.yAxisMin}),k.graphEquipment=this.fetchEquipmentFromPoints(k.name,k.sensedKeys),x.push(k)}else for(M=function(e){var t,a="Thermostat",n=JSON.parse(JSON.stringify(f.a));if(n.name=a,n.sensedKeys=["cooltemp","heattemp","spacetemp","fan","fanstate","mode","state"],t=[P,L.cooltemp,L.heattemp,L.spacetemp,L.fan,L.fanstate,L.mode,L.state],n.axis={x:{type:"timeseries",tick:{fit:!1,count:5,values:N,format:V}},y:{label:{text:"Temperature \xb0F",position:"outer-middle"},tick:{fit:!0,values:[0,20,40,60,80,100],count:6,format:function(e){return parseFloat(e).toFixed(1)}},max:100,min:0},y2:{show:!0,label:{text:"State, Mode, Fan, Fan State",position:"outer-middle"},tick:{fit:!0,values:[0,1,2,3],count:6,format:function(e){return parseFloat(e).toFixed(0)}},max:3,min:0}},S.find(function(e){return e.name==a})&&(n.axis.y.tick.values=S.find(function(e){return e.name==a}).value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1]),A&&A.length){var i=A.find(function(e){return e.graphName==a});i&&i.yAxisSettings&&("Fixed"==i.yAxisSettings?(delete n.axis.y.tick.values,n.axis.y.min=i.yAxisMin,n.axis.y.max=i.yAxisMax):"Floating"==i.yAxisSettings&&(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min),n.yAxisSettings=i.yAxisSettings,n.yAxisFixedValues={max:i.yAxisMax,min:i.yAxisMin})}n.graphData.x="x",n.graphData.columns=t,n.graphData.axes={"Fan 0: Auto 1: On":"y2","Fan State 1: On":"y2","Mode 0: Heat 1: Cool 2: Auto":"y2",state:"y2"},n.graphData.colors={"Cool setpoint":"yellow","Heat setpoint":"green","Space Temp":"blue","Fan 0: Auto 1: On":"pink","Fan State 1: On":"yellow","Mode 0: Heat 1: Cool 2: Auto":"magenta","State 1: Heat 2: Cool":"#06cfa4"},n.graphData.types={"Cool setpoint":"line","Heat setpoint":"line","Space Temp":"line","Fan 0: Auto 1: On":"step","Fan State 1: On":"step","Mode 0: Heat 1: Cool 2: Auto":"step","State 1: Heat 2: Cool":"step"},n.graphEquipment=K.fetchEquipmentFromPoints(a,n.sensedKeys),x.push(n)},K=this,G=0;G<1;G++)M(G);this.props.loadNextInsight(),Object(g.h)(w,this.callLiveUpdate),this.setState({grid:v,graphData:x,lastUpdatedAt:y,loading:!1},function(){p(!!h||O.length>0),i&&Y.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,o=t.grid,l=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.device,g=c.insightRelEquipment,d=c.showAlarmPoints,f=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=l||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,f="";return d&&t.alarmStatus&&("active"==t.alarmStatus?f="alarm-graph":"ack"==t.alarmStatus?f="alarm-ack-graph":"clear"==t.alarmStatus&&(f="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+f,id:"divGraphs"},n.createElement("br",null),(d||u)&&n.createElement("div",{className:"alarm-limit-select"},d&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(s.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/InsightControl/"+Object(s.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(s.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(s.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",g.map(function(e,t){return e.rdfsLabel+(t<g.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(s.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(s.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",l)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:d&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:o,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2967:function(e,t,a){"use strict";var n=a(2),i=a.n(n),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)};var s=function(){return(s=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var o={Pixel:"Pixel",Percent:"Percent"},l={unit:o.Percent,value:.8};function u(e){return"number"===typeof e?{unit:o.Percent,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:o.Pixel,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:o.Percent,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),l):(console.warn("scrollThreshold should be string or number"),l)}var c=function(e){function t(t){var a=e.call(this,t)||this;return a.lastScrollTop=0,a.actionTriggered=!1,a.startY=0,a.currentY=0,a.dragging=!1,a.maxPullDownDistance=0,a.getScrollableTarget=function(){return a.props.scrollableTarget instanceof HTMLElement?a.props.scrollableTarget:"string"===typeof a.props.scrollableTarget?document.getElementById(a.props.scrollableTarget):(null===a.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},a.onStart=function(e){a.lastScrollTop||(a.dragging=!0,e instanceof MouseEvent?a.startY=e.pageY:e instanceof TouchEvent&&(a.startY=e.touches[0].pageY),a.currentY=a.startY,a._infScroll&&(a._infScroll.style.willChange="transform",a._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},a.onMove=function(e){a.dragging&&(e instanceof MouseEvent?a.currentY=e.pageY:e instanceof TouchEvent&&(a.currentY=e.touches[0].pageY),a.currentY<a.startY||(a.currentY-a.startY>=Number(a.props.pullDownToRefreshThreshold)&&a.setState({pullToRefreshThresholdBreached:!0}),a.currentY-a.startY>1.5*a.maxPullDownDistance||a._infScroll&&(a._infScroll.style.overflow="visible",a._infScroll.style.transform="translate3d(0px, "+(a.currentY-a.startY)+"px, 0px)")))},a.onEnd=function(){a.startY=0,a.currentY=0,a.dragging=!1,a.state.pullToRefreshThresholdBreached&&(a.props.refreshFunction&&a.props.refreshFunction(),a.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){a._infScroll&&(a._infScroll.style.overflow="auto",a._infScroll.style.transform="none",a._infScroll.style.willChange="unset")})},a.onScrollListener=function(e){"function"===typeof a.props.onScroll&&setTimeout(function(){return a.props.onScroll&&a.props.onScroll(e)},0);var t=a.props.height||a._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;a.actionTriggered||((a.props.inverse?a.isElementAtTop(t,a.props.scrollThreshold):a.isElementAtBottom(t,a.props.scrollThreshold))&&a.props.hasMore&&(a.actionTriggered=!0,a.setState({showLoader:!0}),a.props.next&&a.props.next()),a.lastScrollTop=t.scrollTop)},a.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},a.throttledOnScrollListener=function(e,t,a,n){var i,r=!1,s=0;function o(){i&&clearTimeout(i)}function l(){var l=this,u=Date.now()-s,c=arguments;function m(){s=Date.now(),a.apply(l,c)}r||(n&&!i&&m(),o(),void 0===n&&u>e?m():!0!==t&&(i=setTimeout(n?function(){i=void 0}:m,void 0===n?e-u:e)))}return"boolean"!==typeof t&&(n=a,a=t,t=void 0),l.cancel=function(){o(),r=!0},l}(150,a.onScrollListener).bind(a),a.onStart=a.onStart.bind(a),a.onMove=a.onMove.bind(a),a.onEnd=a.onEnd.bind(a),a}return function(e,t){function a(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}(t,e),t.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?s(s({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var a=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,n=u(t);return n.unit===o.Pixel?e.scrollTop<=n.value+a-e.scrollHeight+1:e.scrollTop<=n.value/100+a-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var a=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,n=u(t);return n.unit===o.Pixel?e.scrollTop+a>=e.scrollHeight-n.value:e.scrollTop+a>=n.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=s({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),a=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),n=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return i.a.createElement("div",{style:n,className:"infinite-scroll-component__outerdiv"},i.a.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&i.a.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},i.a.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!a&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(n.Component);t.a=c},2968:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(11),o=a(707),l=a(804),u=a(835),c=a(797),m=a(122),p=a(736),h=a(124),g=a(760),d=(a.n(g),a(834)),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(s.g)(e)&&Object(h.g)(Object(s.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,o,l,u,h,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,o=a.device,Object(m.a)(!0),r&&!e?[3,2]:(l=[],i&&i.length&&i.forEach(function(e){l.push({sensedValue:Object(s.g)(e.sensedValue),maximumExtremeValue:Object(s.g)(e.maximumExtremeValue),maximumNormalValue:Object(s.g)(e.maximumNormalValue),minimumExtremeValue:Object(s.g)(e.minimumExtremeValue),minimumNormalValue:Object(s.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(s.g)(e.ifMaximumExtremeValue)||"true"!=Object(s.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(s.g)(e.ifMaximumNormalValue)||"true"!=Object(s.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(s.g)(e.ifMinimumExtremeValue)||"true"!=Object(s.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(s.g)(e.ifMinimumNormalValue)||"true"!=Object(s.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(s.g)(o.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(h=t[0].graphData.columns,g=new Date(h[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:l,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===l||void 0===l?void 0:l.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,o=n.alarmSensedPoints,l=this.props,u=l.showAlarmPoints,c=l.device,m=new Date,p=Object(s.g)(c.moncontype),h=d.c.filter(function(e){return p.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(m=new Date(e["@timestamp"]));var g=this.props.liveGraphRange;if(i&&i.length&&m){for(var f=0;f<i.length;f++){var v=i[f],x=v.graphData.columns.map(function(e){return e[0]});if(v.graphData.columns&&v.graphData.columns.length){if(v.graphData.columns[0].push(m),e&&Object.keys(e).length)for(var y=Object.keys(e),b=function(a){var n=y[a];if(v.sensedKeys&&v.sensedKeys.length&&v.sensedKeys.find(function(e){return e==n})){var i=null===(t=h.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=x.findIndex(function(e){return e==i});"import_active_energy_Wh"==n?v.graphData.columns[r].push(+e[n]/1e3):v.graphData.columns[r].push(e[n]),v.graphData.columns[r].splice(1,1)}}},A=0;A<y.length;A++)b(A);(m.getTime()-v.graphData.columns[0][2].getTime())/6e4>g&&v.graphData.columns[0].splice(1,1),v.axis.x.tick.values[2]&&v.axis.x.tick.values[1].getTime()&&v.axis.x.tick.values[2].getTime()-v.axis.x.tick.values[1].getTime()<m.getTime()-v.axis.x.tick.values[v.axis.x.tick.values.length-1]&&(v.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),m.setSeconds(0),g>10&&m.setMinutes(m.getMinutes()-m.getMinutes()%5),v.axis.x.tick.values.push(m),r.x.lines.push({value:m,class:"grid4"}))}}var E=null===m||void 0===m?void 0:m.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:E},function(){if(u){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&o.length>0&&o.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),s=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,s,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,o,l=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(s.g)(i.moncontype),(o=d.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&o.value&&(n.axis.y.tick.values=o.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){l.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,o,u,c,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,o=i.buildingName,u=i.device,c=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",c?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(s.g)(u.moncondevice),g=Object(s.g)(u.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:o,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(l.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,o;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(s.g)(i.moncondevice),[4,Object(l.a)(t,r)];case 1:return o=u.sent(),this.setState({graphYAxisSettings:o}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(s.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(s.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(s.g)(r.relatedEquipment)})||i.push({value:Object(s.g)(r.relatedEquipment),label:Object(s.g)(r.relatedEquipmentLabel),space:Object(s.g)(r.relatedEquipmentSpaceLabel)})},o=0;o<t.length;o++)r(o);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,c,m,p,g,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.showAlarmPoints,r=e.graphsList,u=e.devicePoints,c=e.isEquipment,m=e.equipment,p=e.isGraphLoaded,g=e.showAllGraphs,f=this.state,v=f.grid,x=f.graphData,y=f.lastUpdatedAt,A=f.graphYAxisSettings,E=[],c&&(E=u.filter(function(e){return Object(s.g)(e.relatedEquipment)==m.ontology})),t&&t.moncondevice?(D=Object(s.g)(t.moncontype),w=Object(s.g)(t.topic),S=d.b.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=d.c.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),O=[],!c||c&&E.length?[4,Object(o.g)(w,a,n,!1)]:[3,2]):[3,3];case 1:O=b.sent(),b.label=2;case 2:if(L={i1relay_state:[_.find(function(e){return"i1relay_state"==e.sensedKey}).des],active_power_Watts:[_.find(function(e){return"active_power_Watts"==e.sensedKey}).des],current_Amperes:[_.find(function(e){return"current_Amperes"==e.sensedKey}).des],frequency_Hz:[_.find(function(e){return"frequency_Hz"==e.sensedKey}).des],import_active_energy_Wh:[_.find(function(e){return"import_active_energy_Wh"==e.sensedKey}).des],power_factor:[_.find(function(e){return"power_factor"==e.sensedKey}).des],voltage_volts:[_.find(function(e){return"voltage_volts"==e.sensedKey}).des]},P=["x"],L.i1relay_state.push(null),L.active_power_Watts.push(null),L.current_Amperes.push(null),L.frequency_Hz.push(null),L.import_active_energy_Wh.push(null),L.power_factor.push(null),L.voltage_volts.push(null),P.push(new Date(a)),O.length>0&&O.forEach(function(e){e&&(L.i1relay_state.push(e.i1relay_state||"0"),L.active_power_Watts.push(e.active_power_Watts||"0"),L.current_Amperes.push(e.current_Amperes||"0"),L.frequency_Hz.push(e.frequency_Hz||"0"),L.import_active_energy_Wh.push(""+ +e.import_active_energy_Wh/1e3||"0"),L.power_factor.push(e.power_factor||"0"),L.voltage_volts.push(e.voltage_volts||"0"),P.push(new Date(e.timestamp)))}),y=O.length>0?null===(C=P[P.length-1])||void 0===C?void 0:C.toLocaleString():"No Data",L.i1relay_state.push(null),L.active_power_Watts.push(null),L.current_Amperes.push(null),L.frequency_Hz.push(null),L.import_active_energy_Wh.push(null),L.power_factor.push(null),L.voltage_volts.push(null),P.push(new Date(n)),P.length>1){if(N=Object(l.c)(5,a,n),V="",N.length>1?(j=((new Date).getTime()-N[0].getTime())/1e3,V=(j/=3600)>24?"%m-%d %H:%M":j<.3?"%H:%M:%S":"%H:%M"):V="%H:%M:%S",v.x.lines=[],N.forEach(function(e){v.x.lines.push({value:e,class:"grid4"})}),c){for((k=JSON.parse(JSON.stringify(d.a))).name="Relay i1",k.graphData.columns=[P],k.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},k.axis.x.tick.format=V,k.axis.x.tick.values=N,k.graphData.x="x",G=0;G<E.length;G++)R=E[G],q=Object(s.g)(R.sensedValue),k.sensedKeys.push(q),k.graphData.columns.push(L[""+q]);S.find(function(e){return e.name==k.name})&&(k.axis.y.tick.values=S.find(function(e){return e.name==k.name}).value,k.axis.y.min=k.axis.y.tick.values[0],k.axis.y.max=k.axis.y.tick.values[k.axis.y.tick.values.length-1]),A&&A.length&&(F=A.find(function(e){return e.graphName==k.name}))&&F.yAxisSettings&&("Fixed"==F.yAxisSettings?(delete k.axis.y.tick.values,k.axis.y.min=F.yAxisMin,k.axis.y.max=F.yAxisMax):"Floating"==F.yAxisSettings&&(delete k.axis.y.tick.values,delete k.axis.y.max,delete k.axis.y.min),k.yAxisSettings=F.yAxisSettings,k.yAxisFixedValues={max:F.yAxisMax,min:F.yAxisMin}),k.graphEquipment=this.fetchEquipmentFromPoints(k.name,k.sensedKeys),x.push(k)}else for(M=function(e){var t=r[e],a=JSON.parse(JSON.stringify(d.a)),n=1,i=[];if(a.name=t,"Totalized Energy"==t?(a.sensedKeys=["import_active_energy_Wh"],i=[P,L.import_active_energy_Wh],a.axis.y.label="kWh",n=0):"Frequency and Voltage"==t?(a.sensedKeys=["frequency_Hz","voltage_volts"],i=[P,L.frequency_Hz,L.voltage_volts],a.axis.y.label="Hz/Volts"):"Current and Power"==t?(a.sensedKeys=["active_power_Watts","current_Amperes"],i=[P,L.active_power_Watts,L.current_Amperes],a.axis.y.label="Watts/Amps"):"State and Power Factor"==t&&(a.sensedKeys=["relay_state","power_factor"],i=[P,L.i1relay_state,L.power_factor],a.axis.y.label="",n=2),S.find(function(e){return e.name==t})&&(a.axis.y.tick.values=S.find(function(e){return e.name==t}).value,a.axis.y.min=a.axis.y.tick.values[0],a.axis.y.max=a.axis.y.tick.values[a.axis.y.tick.values.length-1]),A&&A.length){var s=A.find(function(e){return e.graphName==t});s&&s.yAxisSettings&&("Fixed"==s.yAxisSettings?(delete a.axis.y.tick.values,a.axis.y.min=s.yAxisMin,a.axis.y.max=s.yAxisMax):"Floating"==s.yAxisSettings&&(delete a.axis.y.tick.values,delete a.axis.y.max,delete a.axis.y.min),a.yAxisSettings=s.yAxisSettings,a.yAxisFixedValues={max:s.yAxisMax,min:s.yAxisMin})}a.axis.y.tick.format=function(e){return parseFloat(e).toFixed(n)},a.axis.x.tick.format=V,a.axis.x.tick.values=N,a.graphData.x="x",a.graphData.columns=i,a.graphEquipment=K.fetchEquipmentFromPoints(t,a.sensedKeys),x.push(a)},K=this,G=0;G<r.length;G++)M(G);this.props.loadNextInsight(),Object(h.h)(w,this.callLiveUpdate),this.setState({grid:v,graphData:x,lastUpdatedAt:y,loading:!1},function(){p(!!g||O.length>0),i&&Y.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,o=t.grid,l=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.device,g=c.showAlarmPoints,d=c.insightRelEquipment,f=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=l||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,f="";return g&&t.alarmStatus&&("active"==t.alarmStatus?f="alarm-graph":"ack"==t.alarmStatus?f="alarm-ack-graph":"clear"==t.alarmStatus&&(f="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+f,id:"divGraphs"},n.createElement("br",null),(g||u)&&n.createElement("div",{className:"alarm-limit-select"},g&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(s.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/RelayControl/"+Object(s.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(s.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(s.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(s.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(s.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",l)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:g&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:o,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2969:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(707),o=a(1009),l=a(804),u=a(835),c=a(11),m=a(797),p=a(736),h=a(122),g=a(124),d=a(760),f=(a.n(d),a(834)),v=a(20),x=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),y=this&&this.__assign||function(){return(y=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},A=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},E=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return x(t,e),t.prototype.componentDidMount=function(){return b(this,void 0,void 0,function(){var e=this;return A(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return b(this,void 0,void 0,function(){var e,t=this;return A(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(c.g)(e)&&Object(g.g)(Object(c.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return b(this,void 0,void 0,function(){var t,a,n,i,r,s,o,l,u,g,d,f,v,x=this;return A(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(h.a)(!0),r&&!e?[3,2]:(o=[],i&&i.length&&i.forEach(function(e){o.push({sensedValue:Object(c.g)(e.sensedValue),maximumExtremeValue:Object(c.g)(e.maximumExtremeValue),maximumNormalValue:Object(c.g)(e.maximumNormalValue),minimumExtremeValue:Object(c.g)(e.minimumExtremeValue),minimumNormalValue:Object(c.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(c.g)(e.ifMaximumExtremeValue)||"true"!=Object(c.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(c.g)(e.ifMaximumNormalValue)||"true"!=Object(c.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(c.g)(e.ifMinimumExtremeValue)||"true"!=Object(c.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(c.g)(e.ifMinimumNormalValue)||"true"!=Object(c.g)(e.ifMinimumNormalValue))})}),[4,Object(m.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(c.g)(s.moncondevice)],null)]);case 1:return l=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(u=t[0].graphData.columns,g=new Date(u[0][1]),l=l.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:o,deviceAlarms:l},function(){var e=t[0].graphData.columns;if((null===o||void 0===o?void 0:o.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(h.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],x=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),x.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],x,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=y({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=y({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.changeYAxisSettings=function(e,t){return b(this,void 0,void 0,function(){var a,n,i,r,s,o=this;return A(this,function(l){switch(l.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(c.g)(i.moncontype),(s=f.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return l.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){o.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return b(i,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return b(this,void 0,void 0,function(){var i,r,s,o,u,m,p,h,g,d,f,x,y,b=this;return A(this,function(A){switch(A.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,o=i.device,u=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",u?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(c.g)(o.moncondevice),g=Object(c.g)(o.rdfsLabel)),f=p.find(function(t){return t.graphName==e}),x=Object(v.E)(12),f&&f.ontology&&(x=f.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(l.b)(y).then(function(){b.fetchGraphYAxisSettings()})];case 1:return A.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return b(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return A(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(c.g)(i.moncondevice),[4,Object(l.a)(t,r)];case 1:return s=o.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(c.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});r&&Object(c.g)(r.point)&&Object(c.g)(r.relatedEquipment)&&!(i&&i.length&&i.find(function(e){return e.value==Object(c.g)(r.relatedEquipment)}))&&i.push({value:Object(c.g)(r.relatedEquipment),label:Object(c.g)(r.relatedEquipmentLabel),space:Object(c.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return b(e,void 0,void 0,function(){var e,t,a,n,i,r,u,m,p,h,d,v,x,y,b,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y,T,H,B=this;return A(this,function(A){switch(A.label){case 0:return e=this.props,t=e.from,a=e.to,n=e.device,i=e.showAlarmPoints,r=e.graphsList,u=e.devicePoints,m=e.isEquipment,p=e.equipment,h=e.isGraphLoaded,d=e.showAllGraphs,v=this.state,x=v.grid,y=v.lastUpdatedAt,b=v.graphYAxisSettings,E=[],D=[],m&&(D=u.filter(function(e){return Object(c.g)(e.relatedEquipment)==p.ontology})),n&&n.moncondevice?(w=Object(c.g)(n.moncontype),S=Object(c.g)(n.topic),_=Object(c.g)(n.firmwareVersion),O=Object(c.g)(n.csbCallibration)?parseInt(Object(c.g)(n.csbCallibration)):0,L=f.b.filter(function(e){return w.toLowerCase().indexOf(e.type.toLowerCase())>-1}),P=f.c.filter(function(e){return w.toLowerCase().indexOf(e.type.toLowerCase())>-1}),N=[],!m||m&&D.length?[4,Object(s.d)(S,t,a,!1)]:[3,2]):[3,3];case 1:N=A.sent(),A.label=2;case 2:if(V={temp_celsius:[P.find(function(e){return"temp_celsius"==e.sensedKey}).des],relhumidity_pct:[P.find(function(e){return"relhumidity_pct"==e.sensedKey}).des],altitude_m:[P.find(function(e){return"altitude_m"==e.sensedKey}).des],equiCO2_ppm:[P.find(function(e){return"equiCO2_ppm"==e.sensedKey}).des],tvoc_ppm:[P.find(function(e){return"tvoc_ppm"==e.sensedKey}).des],gasResistance_kOhm:[P.find(function(e){return"gasResistance_kOhm"==e.sensedKey}).des],illuminance_lux:[P.find(function(e){return"illuminance_lux"==e.sensedKey}).des],motion_sensed:[P.find(function(e){return"motion_sensed"==e.sensedKey}).des],num_BTdev:[P.find(function(e){return"num_BTdev"==e.sensedKey}).des],pressure_hPa:[P.find(function(e){return"pressure_hPa"==e.sensedKey}).des]},j=["x"],V.temp_celsius.push(null),V.relhumidity_pct.push(null),V.altitude_m.push(null),V.equiCO2_ppm.push(null),V.tvoc_ppm.push(null),V.gasResistance_kOhm.push(null),V.illuminance_lux.push(null),V.motion_sensed.push(null),V.num_BTdev.push(null),V.pressure_hPa.push(null),j.push(new Date(t)),N.length>0&&N.forEach(function(e){e&&(V.temp_celsius.push(Object(o.a)(e.temp_celsius,_||"",O)),V.relhumidity_pct.push(e.relhumidity_pct||"0"),V.altitude_m.push(e.altitude_m||"0"),V.equiCO2_ppm.push(e.equiCO2_ppm||"0"),V.tvoc_ppm.push(e.tvoc_ppm||"0"),V.pressure_hPa.push(e.pressure_hPa||"0"),V.gasResistance_kOhm.push(e.gasResistance_kOhm||"0"),V.illuminance_lux.push(e.illuminance_lux||"0"),V.motion_sensed.push(e.motion_sensed||"0"),V.num_BTdev.push(e.num_BTdev||"0"),j.push(new Date(e.timestamp)))}),y=N.length>0?null===(H=j[j.length-1])||void 0===H?void 0:H.toLocaleString():"No Data",0===N.length&&(V.temp_celsius.push(null),V.relhumidity_pct.push(null),V.altitude_m.push(null),V.equiCO2_ppm.push(null),V.tvoc_ppm.push(null),V.gasResistance_kOhm.push(null),V.illuminance_lux.push(null),V.motion_sensed.push(null),V.num_BTdev.push(null),V.pressure_hPa.push(null),j.push(new Date(a))),j.length>1){if(k=Object(l.c)(5,t,a),R="",k.length>1?(q=((new Date).getTime()-k[0].getTime())/1e3,R=(q/=3600)>24?"%m-%d %H:%M":q<.3?"%H:%M:%S":"%H:%M"):R="%H:%M:%S",x.x.lines=[],k.forEach(function(e){x.x.lines.push({value:e,class:"grid4"})}),m){for((F=JSON.parse(JSON.stringify(f.a))).name="Ceiling Sensor",F.graphData.columns=[j],F.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},F.axis.x.tick.format=R,F.axis.x.tick.values=k,F.graphData.x="x",T=0;T<D.length;T++)M=D[T],K=Object(c.g)(M.sensedValue),F.sensedKeys.push(K),F.graphData.columns.push(V[""+K]);F.graphEquipment=this.fetchEquipmentFromPoints(F.name,F.sensedKeys),L.find(function(e){return e.name==F.name})&&(F.axis.y.tick.values=L.find(function(e){return e.name==F.name}).value,F.axis.y.min=F.axis.y.tick.values[0],F.axis.y.max=F.axis.y.tick.values[F.axis.y.tick.values.length-1]),b&&b.length&&(G=b.find(function(e){return e.graphName==F.name}))&&G.yAxisSettings&&("Fixed"==G.yAxisSettings?(delete F.axis.y.tick.values,F.axis.y.min=G.yAxisMin,F.axis.y.max=G.yAxisMax):"Floating"==G.yAxisSettings&&(delete F.axis.y.tick.values,delete F.axis.y.max,delete F.axis.y.min),F.yAxisSettings=G.yAxisSettings,F.yAxisFixedValues={max:G.yAxisMax,min:G.yAxisMin}),E.push(F)}else for(C=function(e){var t=r[e],a=JSON.parse(JSON.stringify(f.a)),n=0,i=[];if(a.name=t,"Temp & Humidity"==t?(a.axis.y.label="\xb0F / %",n=1,a.sensedKeys=["temp_celsius","relhumidity_pct"],i=[j,V.temp_celsius,V.relhumidity_pct]):"Pressure"==t?(a.axis.y.label="hPa",a.sensedKeys=["pressure_hPa"],i=[j,V.pressure_hPa]):"Illuminance"==t?(a.axis.y.label="Lux",a.sensedKeys=["illuminance_lux"],i=[j,V.illuminance_lux]):"Gas Resistance"==t?(a.axis.y.label="kOhm",a.sensedKeys=["gasResistance_kOhm"],i=[j,V.gasResistance_kOhm]):"Air Particles"==t?(a.axis.y.label="PPM",a.sensedKeys=["equiCO2_ppm","tvoc_ppm"],i=[j,V.equiCO2_ppm,V.tvoc_ppm]):"Other Parameters"==t&&(a.axis.y.label="",a.sensedKeys=["motion_sensed","num_BTdev"],i=[j,V.motion_sensed,V.num_BTdev]),L.find(function(e){return e.name==t})&&(a.axis.y.tick.values=L.find(function(e){return e.name==t}).value,a.axis.y.min=a.axis.y.tick.values[0],a.axis.y.max=a.axis.y.tick.values[a.axis.y.tick.values.length-1]),b&&b.length){var s=b.find(function(e){return e.graphName==t});s&&s.yAxisSettings&&("Fixed"==s.yAxisSettings?(delete a.axis.y.tick.values,a.axis.y.min=s.yAxisMin,a.axis.y.max=s.yAxisMax):"Floating"==s.yAxisSettings&&(delete a.axis.y.tick.values,delete a.axis.y.max,delete a.axis.y.min),a.yAxisSettings=s.yAxisSettings,a.yAxisFixedValues={max:s.yAxisMax,min:s.yAxisMin})}a.axis.y.tick.format=function(e){return parseFloat(e).toFixed(n)},a.axis.x.tick.format=R,a.axis.x.tick.values=k,a.graphData.x="x",a.graphData.columns=i,a.graphEquipment=Y.fetchEquipmentFromPoints(t,a.sensedKeys),E.push(a)},Y=this,T=0;T<r.length;T++)C(T);this.props.loadNextInsight(),Object(g.h)(S,this.callLiveUpdate),this.setState({grid:x,graphData:E,lastUpdatedAt:y,loading:!1},function(){h(!!d||N.length>0),i&&B.changeAlarmStatus(!0)})}A.label=3;case 3:return[2]}})})})},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,s=n.alarmSensedPoints,l=this.props,u=l.device,m=l.showAlarmPoints,p=new Date,h=Object(c.g)(u.firmwareVersion),g=Object(c.g)(u.csbCallibration)?parseInt(Object(c.g)(u.csbCallibration)):0,d=Object(c.g)(u.moncontype),v=f.c.filter(function(e){return d.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(p=new Date(e["@timestamp"]));var x=this.props.liveGraphRange;if(i&&i.length&&p){for(var y=0;y<i.length;y++){var b=i[y],A=b.graphData.columns.map(function(e){return e[0]});if(b.graphData.columns&&b.graphData.columns.length){if(b.graphData.columns[0].push(p),e&&Object.keys(e).length)for(var E=Object.keys(e),D=function(a){var n=E[a];if(b.sensedKeys&&b.sensedKeys.length&&b.sensedKeys.find(function(e){return e==n})){var i=null===(t=v.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=A.findIndex(function(e){return e==i});"temp_celsius"==n?b.graphData.columns[r].push(Object(o.a)(null===e||void 0===e?void 0:e.temp_celsius,h||"",g)):b.graphData.columns[r].push(e[n]),b.graphData.columns[r].splice(1,1)}}},w=0;w<E.length;w++)D(w);(p.getTime()-b.graphData.columns[0][2].getTime())/6e4>x&&b.graphData.columns[0].splice(1,1),b.axis.x.tick.values[2]&&b.axis.x.tick.values[1].getTime()&&b.axis.x.tick.values[2].getTime()-b.axis.x.tick.values[1].getTime()<p.getTime()-b.axis.x.tick.values[b.axis.x.tick.values.length-1]&&(b.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),p.setSeconds(0),x>10&&p.setMinutes(p.getMinutes()-p.getMinutes()%5),b.axis.x.tick.values.push(p),r.x.lines.push({value:p,class:"grid4"}))}}var S=null===p||void 0===p?void 0:p.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:S},function(){if(m){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&s.length>0&&s.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),o=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,o,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,o=t.lastUpdatedAt,l=t.enableYAxis,u=this.props,m=u.instance,p=u.buildingName,h=u.device,g=u.showAlarmPoints,d=u.insightRelEquipment,f=u.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=o||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,u,f="";return g&&t.alarmStatus&&("active"==t.alarmStatus?f="alarm-graph":"ack"==t.alarmStatus?f="alarm-ack-graph":"clear"==t.alarmStatus&&(f="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+f,id:"divGraphs"},n.createElement("br",null),(g||l)&&n.createElement("div",{className:"alarm-limit-select"},g&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(c.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),l&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/CeilingSensor/"+Object(c.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(c.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(c.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(c.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(c.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",o)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:g&&(null===(u=t.graphDataAlarmPoint.columns)||void 0===u?void 0:u.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=E},2970:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(707),o=a(804),l=a(124),u=a(760),c=(a.n(u),a(11)),m=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),p=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},g=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:{x:"x",columns:[]},grid:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{fit:!1,count:5,format:"%m-%d/%H:%M:%S"}},y:{label:"\xb0F",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,lastUpdatedAt:"No Data"},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return m(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){var e=this;return h(this,function(t){return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){e.state.loading||e.setState({loading:!0},function(){return e.setState({loading:!1})})}),this._fetchData(),[2]})})},t.prototype.componentWillUnmount=function(){return p(this,void 0,void 0,function(){var e,t=this;return h(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){t.state.loading||t.setState({loading:!0},function(){return t.setState({loading:!1})})}),Object(c.g)(e)&&Object(l.g)(Object(c.g)(e)),[2]})})},t.prototype.changeAlarmStatus=function(){},t.prototype.callLiveUpdate=function(e){var t,a=this.state,n=a.graphData,i=a.axis1,r=a.grid;e["@timestamp"]&&(t=new Date(e["@timestamp"]),t=new Date(t.setHours(t.getHours()+10)));var s=this.props.liveGraphRange;if(n.columns.length>1&&t){n.columns[0].splice(1,1),n.columns[0].push(t),n.columns[1].splice(1,1),n.columns[1].push(null===e||void 0===e?void 0:e.setpoint),n.columns[2].splice(1,1),n.columns[2].push(null===e||void 0===e?void 0:e.roomtemp),n.columns[3].splice(1,1),n.columns[3].push(null===e||void 0===e?void 0:e.fanspeed),n.columns[4].splice(1,1),n.columns[4].push(null===e||void 0===e?void 0:e.horizontalvans),n.columns[5].splice(1,1),n.columns[5].push(null===e||void 0===e?void 0:e.usermode),n.columns[6].splice(1,1),n.columns[6].push(null===e||void 0===e?void 0:e.verticalvans),n.columns[7].splice(1,1),n.columns[7].push(null===e||void 0===e?void 0:e.wifiSignal),(t.getTime()-n.columns[0][2].getTime())/6e4>s&&n.columns[0].splice(1,1),i.x.tick.values[2]&&i.x.tick.values[1].getTime()&&i.x.tick.values[2].getTime()-i.x.tick.values[1].getTime()<t.getTime()-i.x.tick.values[i.x.tick.values.length-1]&&(i.x.tick.values.splice(0,1),r.x.lines.splice(0,1),t.setSeconds(0),s>10&&t.setMinutes(t.getMinutes()-t.getMinutes()%5),i.x.tick.values.push(t),r.x.lines.push({value:t,class:"grid4"}));var o=null===t||void 0===t?void 0:t.toLocaleString();this.setState({grid:r,axis1:i,graphData:n,lastUpdatedAt:o})}},t.prototype._fetchData=function(){var e;return p(this,void 0,void 0,function(){var t,a,n,i,r,u,m,p,g,d,f,v,x,y,b,A,E,D,w,S,_,O,L,P;return h(this,function(h){switch(h.label){case 0:return t=this.props,a=t.device,n=t.from,i=t.to,r=t.isGraphLoaded,u=t.showAllGraphs,m=this.state,p=m.grid,g=m.axis1,d=m.graphData,f=m.lastUpdatedAt,a&&a.moncondevice?(v=Object(c.g)(a.topic),[4,Object(s.e)(v,n,i,d.columns.length>1)]):[3,2];case 1:x=h.sent(),y=["setpoint"],A=["mode"],E=["fanspeed"],D=["horizontalvans"],w=["verticalvans"],S=["wifiSignal"],_=["x"],(b=["roomtemp"]).push(null),y.push(null),E.push(null),D.push(null),A.push(null),w.push(null),S.push(null),_.push(new Date(n)),x.length>0&&x.forEach(function(e){e&&(1!=isNaN(e.roomtemp)&&b.push(e.roomtemp),1!=isNaN(e.setpoint)&&y.push(e.setpoint),e.fanspeed?E.push(e.fanspeed):E.push("undefined"),e.horizontalvans?D.push(e.horizontalvans):D.push("undefined"),e.usermode?A.push(e.usermode):A.push("undefined"),e.verticalvans?w.push(e.verticalvans):w.push("undefined"),e.wifiSignal?S.push(e.wifiSignal):S.push("undefined"),_.push(new Date(e.timestamp)))}),f=x.length>0?null===(e=_[_.length-1])||void 0===e?void 0:e.toLocaleString():"No Data",b.push(null),y.push(null),E.push(null),D.push(null),A.push(null),w.push(null),S.push(null),_.push(new Date(i)),d={x:"x",columns:[_,y,b,E,D,A,w,S]},g.y.label="\xb0F",O=Object(o.c)(5,n,i),L="",O.length>1?(P=((new Date).getTime()-O[0].getTime())/1e3,L=(P/=3600)>24?"%m-%d %H:%M":P<.3?"%H:%M:%S":"%H:%M"):L="%H:%M:%S",p.x.lines=[],O.forEach(function(e){p.x.lines.push({value:e,class:"grid4"})}),g.y.tick.format=function(e){return parseFloat(e).toFixed(2)},g.y.tick.values=[0,20,40,60,80,100],g.y.max=100,g.y.min=0,g.x.tick.format=L,g.x.tick.values=O,this.props.loadNextInsight(),Object(l.h)(v,this.callLiveUpdate),this.setState({grid:p,axis1:g,graphData:d,loading:!1,lastUpdatedAt:f},function(){r(!!u||x.length>0)}),h.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,a=e.graphData,i=e.axis1,s=e.grid,o=e.lastUpdatedAt,l=this.props,u=l.instance,m=l.buildingName,p=l.device,h=l.equipment,g=l.showAllGraphs;return"No Data"!=o||g?n.createElement("div",{className:"row col-md-12 device-graphs",id:"divGraphs"},n.createElement("br",null),n.createElement("h5",{className:"no-padding no-margin-color-textalign tooltipDashboard graphHeading"},n.createElement("a",{className:"col-md-8 sentence-break",onClick:function(){window.location.hash=u+"/"+m+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(c.g)(p.moncondevice)}},h.length>0&&h[0].rdfsLabel?h[0].rdfsLabel:"No equipment assigned"),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Space: ",Object(c.g)(p.spaceRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(c.g)(p.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(c.g)(p.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Equipment: ",null===h||void 0===h?void 0:h.map(function(e,t){return e.rdfsLabel+(t<h.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(c.g)(p.rdfsLabel)||"No device assigned"," ")),n.createElement("span",{className:"lastUpdated"},"Last: ",o)),t?n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})):n.createElement(r.a,{data:a,size:{height:300},axis:i,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0},colors:{spaceTemp:"red",cooltemp:"blue",fan:"pink"}})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=g},2971:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(715),o=a(804),l=a(124),u=a(760),c=(a.n(u),a(11)),m=a(835),p=a(834),h=a(122),g=a(736),d=a(797),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(c.g)(e)&&Object(l.g)(Object(c.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,s,o,l,u,m,p,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(h.a)(!0),r&&!e?[3,2]:(o=[],i&&i.length&&i.forEach(function(e){o.push({sensedValue:Object(c.g)(e.sensedValue),maximumExtremeValue:Object(c.g)(e.maximumExtremeValue),maximumNormalValue:Object(c.g)(e.maximumNormalValue),minimumExtremeValue:Object(c.g)(e.minimumExtremeValue),minimumNormalValue:Object(c.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(c.g)(e.ifMaximumExtremeValue)||"true"!=Object(c.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(c.g)(e.ifMaximumNormalValue)||"true"!=Object(c.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(c.g)(e.ifMinimumExtremeValue)||"true"!=Object(c.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(c.g)(e.ifMinimumNormalValue)||"true"!=Object(c.g)(e.ifMinimumNormalValue))})}),[4,Object(d.e)(g.a.OperationalAlarm,n,!1,0,50,null,null,[Object(c.g)(s.moncondevice)],null)]);case 1:return l=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(u=t[0].graphData.columns,m=new Date(u[0][1]),l=l.filter(function(e){return new Date(e.timeofalarm)>m})),this.setState({alarmSensedPoints:o,deviceAlarms:l},function(){var e=t[0].graphData.columns;if((null===o||void 0===o?void 0:o.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(p=[],f=0;f<t.length;f++)v=t[f],p.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:p}),y.label=3;case 3:return Object(h.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,u=s.graphData,c=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},c){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(c.minimumExtremeValue),v.push(c.minimumNormalValue),y.push(c.maximumNormalValue),b.push(c.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!c.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!c.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!c.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!c.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=c,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",u.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:u,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=m.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,s=n.alarmSensedPoints,o=this.props.device,l=new Date,u=Object(c.g)(o.moncontype),m=p.c.filter(function(e){return u.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(l=new Date(e["@timestamp"]));var h=this.props,g=h.liveGraphRange,d=h.showAlarmPoints;if(i&&i.length&&l){for(var f=0;f<i.length;f++){var v=i[f],x=v.graphData.columns.map(function(e){return e[0]});if(v.graphData.columns&&v.graphData.columns.length){if(v.graphData.columns[0].push(l),e&&Object.keys(e).length)for(var y=Object.keys(e),b=function(a){var n=y[a];if(v.sensedKeys&&v.sensedKeys.length&&v.sensedKeys.find(function(e){return e==n})){var i=null===(t=m.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=x.findIndex(function(e){return e==i});v.graphData.columns[r].push(e[n]),v.graphData.columns[r].splice(1,1)}}},A=0;A<y.length;A++)b(A);(l.getTime()-v.graphData.columns[0][2].getTime())/6e4>g&&v.graphData.columns[0].splice(1,1),v.axis.x.tick.values[2]&&v.axis.x.tick.values[1].getTime()&&v.axis.x.tick.values[2].getTime()-v.axis.x.tick.values[1].getTime()<l.getTime()-v.axis.x.tick.values[v.axis.x.tick.values.length-1]&&(v.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),l.setSeconds(0),g>10&&l.setMinutes(l.getMinutes()-l.getMinutes()%5),v.axis.x.tick.values.push(l),r.x.lines.push({value:l,class:"grid4"}))}}var E=null===l||void 0===l?void 0:l.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:E},function(){if(d){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&s.length>0&&s.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),o=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,o,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,s,o=this;return b(this,function(l){switch(l.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(c.g)(i.moncontype),(s=p.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return l.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){o.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,s,l,u,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,l=i.device,u=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",u?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(c.g)(l.moncondevice),g=Object(c.g)(l.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(o.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return b(this,function(l){switch(l.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(c.g)(i.moncondevice),[4,Object(o.a)(t,r)];case 1:return s=l.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(c.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(c.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(c.g)(r.relatedEquipment)})||i.push({value:Object(c.g)(r.relatedEquipment),label:Object(c.g)(r.relatedEquipmentLabel),space:Object(c.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,m,h,g,d,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.devicePoints,r=e.isEquipment,u=e.equipment,m=e.showAlarmPoints,h=e.isGraphLoaded,g=e.showAllGraphs,d=this.state,f=d.grid,v=d.lastUpdatedAt,x=d.graphYAxisSettings,y=[],A=[],r&&(A=i.filter(function(e){return Object(c.g)(e.relatedEquipment)==u.ontology})),t&&t.moncondevice?(E=Object(c.g)(t.moncontype),D=Object(c.g)(t.topic),w=p.b.filter(function(e){return E.toLowerCase().indexOf(e.type.toLowerCase())>-1}),S=p.c.filter(function(e){return E.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=[],!r||r&&A.length?[4,Object(s.j)(D,a,n,!1)]:[3,2]):[3,3];case 1:_=b.sent(),b.label=2;case 2:if(O={Normal_Frequency:[S.find(function(e){return"Normal_Frequency"==e.sensedKey}).des],Emergency_Frequency:[S.find(function(e){return"Emergency_Frequency"==e.sensedKey}).des]},L=["x"],O.Normal_Frequency.push(null),O.Emergency_Frequency.push(null),L.push(new Date(a)),_.length>0&&_.forEach(function(e){e&&(O.Normal_Frequency.push(e.Normal_Frequency||"0"),O.Emergency_Frequency.push(e.Emergency_Frequency||"0"),L.push(new Date(e.timestamp)))}),v=_.length>0?null===(G=L[L.length-1])||void 0===G?void 0:G.toLocaleString():"No Data",O.Normal_Frequency.push(null),O.Emergency_Frequency.push(null),L.push(new Date(n)),L.length>1){if(P=Object(o.c)(5,a,n),N="",P.length>1?(V=((new Date).getTime()-P[0].getTime())/1e3,N=(V/=3600)>24?"%m-%d %H:%M":V<.3?"%H:%M:%S":"%H:%M"):N="%H:%M:%S",f.x.lines=[],P.forEach(function(e){f.x.lines.push({value:e,class:"grid4"})}),r){for((j=JSON.parse(JSON.stringify(p.a))).name="ATS Frequency",j.graphData.columns=[L],j.graphData.x="x",K=0;K<A.length;K++)k=A[K],R=Object(c.g)(k.sensedValue),j.sensedKeys.push(R),j.graphData.columns.push(O[""+R]);w.find(function(e){return e.name==j.name})&&(j.axis.y.tick.values=w.find(function(e){return e.name==j.name}).value,j.axis.y.min=j.axis.y.tick.values[0],j.axis.y.max=j.axis.y.tick.values[j.axis.y.tick.values.length-1]),x&&x.length&&(q=x.find(function(e){return e.graphName==j.name}))&&q.yAxisSettings&&("Fixed"==q.yAxisSettings?(delete j.axis.y.tick.values,j.axis.y.min=q.yAxisMin,j.axis.y.max=q.yAxisMax):"Floating"==q.yAxisSettings&&(delete j.axis.y.tick.values,delete j.axis.y.max,delete j.axis.y.min),j.yAxisSettings=q.yAxisSettings,j.yAxisFixedValues={max:q.yAxisMax,min:q.yAxisMin}),j.axis.y.label="Hz",j.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},j.axis.x.tick.format=N,j.axis.x.tick.values=P,j.graphEquipment=this.fetchEquipmentFromPoints(j.name,j.sensedKeys),y.push(j)}else for(F=function(e){var t,a="ATS Frequency",n=JSON.parse(JSON.stringify(p.a));if(n.name=a,n.axis.y.label="Hz",2,n.sensedKeys=["Normal_Frequency","Emergency_Frequency"],t=[L,O.Normal_Frequency,O.Emergency_Frequency],w.find(function(e){return e.name==a})&&(n.axis.y.tick.values=w.find(function(e){return e.name==a}).value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1]),x&&x.length){var i=x.find(function(e){return e.graphName==a});i&&i.yAxisSettings&&("Fixed"==i.yAxisSettings?(delete n.axis.y.tick.values,n.axis.y.min=i.yAxisMin,n.axis.y.max=i.yAxisMax):"Floating"==i.yAxisSettings&&(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min),n.yAxisSettings=i.yAxisSettings,n.yAxisFixedValues={max:i.yAxisMax,min:i.yAxisMin})}n.axis.y.tick.format=function(e){return parseFloat(e).toFixed(2)},n.axis.x.tick.format=N,n.axis.x.tick.values=P,n.graphData.x="x",n.graphData.columns=t,n.graphEquipment=M.fetchEquipmentFromPoints(a,n.sensedKeys),y.push(n)},M=this,K=0;K<1;K++)F(K);this.props.loadNextInsight(),Object(l.h)(D,this.callLiveUpdate),this.setState({grid:f,graphData:y,lastUpdatedAt:v,loading:!1},function(){h(!!g||_.length>0),m&&C.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,o=t.lastUpdatedAt,l=t.enableYAxis,u=this.props,m=u.instance,p=u.buildingName,h=u.device,g=u.insightRelEquipment,d=u.showAlarmPoints,f=u.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=o||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,u="";return d&&t.alarmStatus&&("active"==t.alarmStatus?u="alarm-graph":"ack"==t.alarmStatus?u="alarm-ack-graph":"clear"==t.alarmStatus&&(u="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+u,id:"divGraphs"},n.createElement("br",null),(d||l)&&n.createElement("div",{className:"alarm-limit-select"},d&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(c.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),l&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/ATS/"+Object(c.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(c.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(c.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",g.map(function(e,t){return e.rdfsLabel+(t<g.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(c.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(c.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",o)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2972:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(715),o=a(804),l=a(11),u=a(835),c=a(797),m=a(122),p=a(736),h=a(124),g=a(760),d=(a.n(g),a(834)),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(l.g)(e)&&Object(h.g)(Object(l.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,s,o,u,h,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(m.a)(!0),r&&!e?[3,2]:(o=[],i&&i.length&&i.forEach(function(e){o.push({sensedValue:Object(l.g)(e.sensedValue),maximumExtremeValue:Object(l.g)(e.maximumExtremeValue),maximumNormalValue:Object(l.g)(e.maximumNormalValue),minimumExtremeValue:Object(l.g)(e.minimumExtremeValue),minimumNormalValue:Object(l.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(l.g)(e.ifMaximumExtremeValue)||"true"!=Object(l.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(l.g)(e.ifMaximumNormalValue)||"true"!=Object(l.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(l.g)(e.ifMinimumExtremeValue)||"true"!=Object(l.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(l.g)(e.ifMinimumNormalValue)||"true"!=Object(l.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(l.g)(s.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(h=t[0].graphData.columns,g=new Date(h[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:o,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===o||void 0===o?void 0:o.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,s=n.alarmSensedPoints,o=this.props,u=o.showAlarmPoints,c=o.device,m=new Date,p=Object(l.g)(c.moncontype),h=d.c.filter(function(e){return p.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(m=new Date(e["@timestamp"]));var g=this.props.liveGraphRange;if(i&&i.length&&m){for(var f=0;f<i.length;f++){var v=i[f],x=v.graphData.columns.map(function(e){return e[0]});if(v.graphData.columns&&v.graphData.columns.length){if(v.graphData.columns[0].push(m),e&&Object.keys(e).length)for(var y=Object.keys(e),b=function(a){var n=y[a];if(v.sensedKeys&&v.sensedKeys.length&&v.sensedKeys.find(function(e){return e==n})){var i=null===(t=h.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=x.findIndex(function(e){return e==i});v.graphData.columns[r].push(e[n]),v.graphData.columns[r].splice(1,1)}}},A=0;A<y.length;A++)b(A);(m.getTime()-v.graphData.columns[0][2].getTime())/6e4>g&&v.graphData.columns[0].splice(1,1),v.axis.x.tick.values[2]&&v.axis.x.tick.values[1].getTime()&&v.axis.x.tick.values[2].getTime()-v.axis.x.tick.values[1].getTime()<m.getTime()-v.axis.x.tick.values[v.axis.x.tick.values.length-1]&&(v.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),m.setSeconds(0),g>10&&m.setMinutes(m.getMinutes()-m.getMinutes()%5),v.axis.x.tick.values.push(m),r.x.lines.push({value:m,class:"grid4"}))}}var E=null===m||void 0===m?void 0:m.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:E},function(){if(u){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&s.length>0&&s.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),o=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,o,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,s,o=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(l.g)(i.moncontype),(s=d.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){o.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,s,u,c,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,u=i.device,c=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",c?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(l.g)(u.moncondevice),g=Object(l.g)(u.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(o.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(l.g)(i.moncondevice),[4,Object(o.a)(t,r)];case 1:return s=u.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(l.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(l.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(l.g)(r.relatedEquipment)})||i.push({value:Object(l.g)(r.relatedEquipment),label:Object(l.g)(r.relatedEquipmentLabel),space:Object(l.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,c,m,p,g,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.showAlarmPoints,r=e.graphsList,u=e.devicePoints,c=e.isEquipment,m=e.equipment,p=e.isGraphLoaded,g=e.showAllGraphs,f=this.state,v=f.grid,x=f.graphData,y=f.lastUpdatedAt,A=f.graphYAxisSettings,E=[],c&&(E=u.filter(function(e){return Object(l.g)(e.relatedEquipment)==m.ontology})),t&&t.moncondevice?(D=Object(l.g)(t.moncontype),w=Object(l.g)(t.topic),S=d.b.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=d.c.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),O=[],!c||c&&E.length?[4,Object(s.m)(w,a,n,!1)]:[3,2]):[3,3];case 1:O=b.sent(),b.label=2;case 2:if(L={GenVAB_Volts:[_.find(function(e){return"GenVAB_Volts"==e.sensedKey}).des],GenVBC_Volts:[_.find(function(e){return"GenVBC_Volts"==e.sensedKey}).des],GenVCA_Volts:[_.find(function(e){return"GenVCA_Volts"==e.sensedKey}).des],GenVAN_Volts:[_.find(function(e){return"GenVAN_Volts"==e.sensedKey}).des],GenVBN_Volts:[_.find(function(e){return"GenVBN_Volts"==e.sensedKey}).des],GenVCN_Volts:[_.find(function(e){return"GenVCN_Volts"==e.sensedKey}).des],BusVoltage_Volts:[_.find(function(e){return"BusVoltage_Volts"==e.sensedKey}).des],GenIA_Amps:[_.find(function(e){return"GenIA_Amps"==e.sensedKey}).des],GenIB_Amps:[_.find(function(e){return"GenIB_Amps"==e.sensedKey}).des],GenIC_Amps:[_.find(function(e){return"GenIC_Amps"==e.sensedKey}).des],GenKVA_A_KiloVA:[_.find(function(e){return"GenKVA_A_KiloVA"==e.sensedKey}).des],GenKVA__B_KiloVA:[_.find(function(e){return"GenKVA__B_KiloVA"==e.sensedKey}).des],GenKVA_C_KiloVA:[_.find(function(e){return"GenKVA_C_KiloVA"==e.sensedKey}).des],GenKVA_Total_KiloVA:[_.find(function(e){return"GenKVA_Total_KiloVA"==e.sensedKey}).des],Gen_A_kW:[_.find(function(e){return"Gen_A_kW"==e.sensedKey}).des],Gen_B_kW:[_.find(function(e){return"Gen_B_kW"==e.sensedKey}).des],Gen_C_kW:[_.find(function(e){return"Gen_C_kW"==e.sensedKey}).des],Gen_Total_kW:[_.find(function(e){return"Gen_Total_kW"==e.sensedKey}).des],GenPFLagging:[_.find(function(e){return"GenPFLagging"==e.sensedKey}).des],ActiveSpeedSource:[_.find(function(e){return"ActiveSpeedSource"==e.sensedKey}).des],EngineSpeed_rpm:[_.find(function(e){return"EngineSpeed_rpm"==e.sensedKey}).des],EngineLoad_pct:[_.find(function(e){return"EngineLoad_pct"==e.sensedKey}).des],CoolantTemp_F:[_.find(function(e){return"CoolantTemp_F"==e.sensedKey}).des],OilPressure_psi:[_.find(function(e){return"OilPressure_psi"==e.sensedKey}).des],BatteryVoltage_DeciVolt:[_.find(function(e){return"BatteryVoltage_DeciVolt"==e.sensedKey}).des],FuelLevel:[_.find(function(e){return"FuelLevel"==e.sensedKey}).des],ECUCoolantLevel:[_.find(function(e){return"ECUCoolantLevel"==e.sensedKey}).des],CoolDownTimeRemaining_mins:[_.find(function(e){return"CoolDownTimeRemaining_mins"==e.sensedKey}).des],UnexpectedShutdown:[_.find(function(e){return"UnexpectedShutdown"==e.sensedKey}).des],GlobalAlarm:[_.find(function(e){return"GlobalAlarm"==e.sensedKey}).des],AutoRestartFailure:[_.find(function(e){return"AutoRestartFailure"==e.sensedKey}).des],FuelLeakDetect:[_.find(function(e){return"FuelLeakDetect"==e.sensedKey}).des],BatteryChargerFailure:[_.find(function(e){return"BatteryChargerFailure"==e.sensedKey}).des],TransferFail:[_.find(function(e){return"TransferFail"==e.sensedKey}).des],LowCoolantLevel:[_.find(function(e){return"LowCoolantLevel"==e.sensedKey}).des],ECUShutdown:[_.find(function(e){return"ECUShutdown"==e.sensedKey}).des],EmergencyShutdown:[_.find(function(e){return"EmergencyShutdown"==e.sensedKey}).des],Overcrank:[_.find(function(e){return"Overcrank"==e.sensedKey}).des],LossofECUComms:[_.find(function(e){return"LossofECUComms"==e.sensedKey}).des],GlobalSenderFail:[_.find(function(e){return"GlobalSenderFail"==e.sensedKey}).des],LowFuelLevel:[_.find(function(e){return"LowFuelLevel"==e.sensedKey}).des],LowOilPressure:[_.find(function(e){return"LowOilPressure"==e.sensedKey}).des],HighCoolantTemp:[_.find(function(e){return"HighCoolantTemp"==e.sensedKey}).des]},P=["x"],L.GenVAB_Volts.push(null),L.GenVBC_Volts.push(null),L.GenVCA_Volts.push(null),L.GenVAN_Volts.push(null),L.GenVBN_Volts.push(null),L.GenVCN_Volts.push(null),L.BusVoltage_Volts.push(null),L.GenIA_Amps.push(null),L.GenIB_Amps.push(null),L.GenIC_Amps.push(null),L.GenKVA_A_KiloVA.push(null),L.GenKVA__B_KiloVA.push(null),L.GenKVA_C_KiloVA.push(null),L.GenKVA_Total_KiloVA.push(null),L.Gen_A_kW.push(null),L.Gen_B_kW.push(null),L.Gen_C_kW.push(null),L.Gen_Total_kW.push(null),L.GenPFLagging.push(null),L.ActiveSpeedSource.push(null),L.EngineSpeed_rpm.push(null),L.EngineLoad_pct.push(null),L.CoolantTemp_F.push(null),L.OilPressure_psi.push(null),L.BatteryVoltage_DeciVolt.push(null),L.FuelLevel.push(null),L.ECUCoolantLevel.push(null),L.CoolDownTimeRemaining_mins.push(null),L.UnexpectedShutdown.push(null),L.GlobalAlarm.push(null),L.AutoRestartFailure.push(null),L.FuelLeakDetect.push(null),L.BatteryChargerFailure.push(null),L.TransferFail.push(null),L.LowCoolantLevel.push(null),L.ECUShutdown.push(null),L.EmergencyShutdown.push(null),L.Overcrank.push(null),L.LossofECUComms.push(null),L.GlobalSenderFail.push(null),L.LowFuelLevel.push(null),L.LowOilPressure.push(null),L.HighCoolantTemp.push(null),P.push(new Date(a)),O.length>0&&O.forEach(function(e){e&&(L.GenVAB_Volts.push(e.GenVAB_Volts||0),L.GenVBC_Volts.push(e.GenVBC_Volts||0),L.GenVCA_Volts.push(e.GenVCA_Volts||0),L.GenVAN_Volts.push(e.GenVAN_Volts||0),L.GenVBN_Volts.push(e.GenVBN_Volts||0),L.GenVCN_Volts.push(e.GenVCN_Volts||0),L.BusVoltage_Volts.push(e.BusVoltage_Volts||0),L.GenIA_Amps.push(e.GenIA_Amps||0),L.GenIB_Amps.push(e.GenIB_Amps||0),L.GenIC_Amps.push(e.GenIC_Amps||0),L.GenKVA_A_KiloVA.push(e.GenKVA_A_KiloVA||0),L.GenKVA__B_KiloVA.push(e.GenKVA__B_KiloVA||0),L.GenKVA_C_KiloVA.push(e.GenKVA_C_KiloVA||0),L.GenKVA_Total_KiloVA.push(e.GenKVA_Total_KiloVA||0),L.Gen_A_kW.push(e.Gen_A_kW||0),L.Gen_B_kW.push(e.Gen_B_kW||0),L.Gen_C_kW.push(e.Gen_C_kW||0),L.Gen_Total_kW.push(e.Gen_Total_kW||0),L.GenPFLagging.push(e.GenPFLagging||0),L.ActiveSpeedSource.push(e.ActiveSpeedSource||0),L.EngineSpeed_rpm.push(e.EngineSpeed_rpm||0),L.EngineLoad_pct.push(e.EngineLoad_pct||0),L.CoolantTemp_F.push(e.CoolantTemp_F||0),L.OilPressure_psi.push(e.OilPressure_psi||0),L.BatteryVoltage_DeciVolt.push(e.BatteryVoltage_DeciVolt||0),L.FuelLevel.push(e.FuelLevel||0),L.ECUCoolantLevel.push(e.ECUCoolantLevel||0),L.CoolDownTimeRemaining_mins.push(e.CoolDownTimeRemaining_mins||0),L.UnexpectedShutdown.push(e.UnexpectedShutdown||0),L.GlobalAlarm.push(e.GlobalAlarm||0),L.AutoRestartFailure.push(e.AutoRestartFailure||0),L.FuelLeakDetect.push(e.FuelLeakDetect||0),L.BatteryChargerFailure.push(e.BatteryChargerFailure||0),L.TransferFail.push(e.TransferFail||0),L.LowCoolantLevel.push(e.LowCoolantLevel||0),L.ECUShutdown.push(e.ECUShutdown||0),L.EmergencyShutdown.push(e.EmergencyShutdown||0),L.Overcrank.push(e.Overcrank||0),L.LossofECUComms.push(e.LossofECUComms||0),L.GlobalSenderFail.push(e.GlobalSenderFail||0),L.LowFuelLevel.push(e.LowFuelLevel||0),L.LowOilPressure.push(e.LowOilPressure||0),L.HighCoolantTemp.push(e.HighCoolantTemp||0),P.push(new Date(e.timestamp)))}),y=O.length>0?null===(C=P[P.length-1])||void 0===C?void 0:C.toLocaleString():"No Data",L.GenVAB_Volts.push(null),L.GenVBC_Volts.push(null),L.GenVCA_Volts.push(null),L.GenVAN_Volts.push(null),L.GenVBN_Volts.push(null),L.GenVCN_Volts.push(null),L.BusVoltage_Volts.push(null),L.GenIA_Amps.push(null),L.GenIB_Amps.push(null),L.GenIC_Amps.push(null),L.GenKVA_A_KiloVA.push(null),L.GenKVA__B_KiloVA.push(null),L.GenKVA_C_KiloVA.push(null),L.GenKVA_Total_KiloVA.push(null),L.Gen_A_kW.push(null),L.Gen_B_kW.push(null),L.Gen_C_kW.push(null),L.Gen_Total_kW.push(null),L.GenPFLagging.push(null),L.ActiveSpeedSource.push(null),L.EngineSpeed_rpm.push(null),L.EngineLoad_pct.push(null),L.CoolantTemp_F.push(null),L.OilPressure_psi.push(null),L.BatteryVoltage_DeciVolt.push(null),L.FuelLevel.push(null),L.ECUCoolantLevel.push(null),L.CoolDownTimeRemaining_mins.push(null),L.UnexpectedShutdown.push(null),L.GlobalAlarm.push(null),L.AutoRestartFailure.push(null),L.FuelLeakDetect.push(null),L.BatteryChargerFailure.push(null),L.TransferFail.push(null),L.LowCoolantLevel.push(null),L.ECUShutdown.push(null),L.EmergencyShutdown.push(null),L.Overcrank.push(null),L.LossofECUComms.push(null),L.GlobalSenderFail.push(null),L.LowFuelLevel.push(null),L.LowOilPressure.push(null),L.HighCoolantTemp.push(null),P.push(new Date(n)),P.length>1){if(N=Object(o.c)(5,a,n),V="",N.length>1?(j=((new Date).getTime()-N[0].getTime())/1e3,V=(j/=3600)>24?"%m-%d %H:%M":j<.3?"%H:%M:%S":"%H:%M"):V="%H:%M:%S",v.x.lines=[],N.forEach(function(e){v.x.lines.push({value:e,class:"grid4"})}),c){for((k=JSON.parse(JSON.stringify(d.a))).name="Generator",k.graphData.columns=[P],k.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},k.axis.x.tick.format=V,k.axis.x.tick.values=N,k.graphData.x="x",G=0;G<E.length;G++)R=E[G],q=Object(l.g)(R.sensedValue),k.sensedKeys.push(q),k.graphData.columns.push(L[""+q]);S.find(function(e){return e.name==k.name})&&(k.axis.y.tick.values=S.find(function(e){return e.name==k.name}).value,k.axis.y.min=k.axis.y.tick.values[0],k.axis.y.max=k.axis.y.tick.values[k.axis.y.tick.values.length-1]),A&&A.length&&(F=A.find(function(e){return e.graphName==k.name}))&&F.yAxisSettings&&("Fixed"==F.yAxisSettings?(delete k.axis.y.tick.values,k.axis.y.min=F.yAxisMin,k.axis.y.max=F.yAxisMax):"Floating"==F.yAxisSettings&&(delete k.axis.y.tick.values,delete k.axis.y.max,delete k.axis.y.min),k.yAxisSettings=F.yAxisSettings,k.yAxisFixedValues={max:F.yAxisMax,min:F.yAxisMin}),k.graphEquipment=this.fetchEquipmentFromPoints(k.name,k.sensedKeys),x.push(k)}else for(M=function(e){var t=r[e],a=JSON.parse(JSON.stringify(d.a)),n=0,i=[];if(a.name=t,"Voltages"==t?(a.axis.y.label="Volts",a.sensedKeys=["GenVAB_Volts","GenVBC_Volts","GenVCA_Volts","GenVAN_Volts","GenVBN_Volts","GenVCN_Volts","BusVoltage_Volts"],i=[P,L.GenVAB_Volts,L.GenVBC_Volts,L.GenVCA_Volts,L.GenVAN_Volts,L.GenVBN_Volts,L.GenVCN_Volts,L.BusVoltage_Volts]):"Currents"==t?(a.axis.y.label="Amps",n=1,a.sensedKeys=["GenIA_Amps","GenIB_Amps","GenIC_Amps"],i=[P,L.GenIA_Amps,L.GenIB_Amps,L.GenIC_Amps]):"Powers"==t?(a.axis.y.label="Watts",n=1,a.sensedKeys=["GenKVA_A_KiloVA","GenKVA__B_KiloVA","GenKVA_C_KiloVA","GenKVA_Total_KiloVA","Gen_A_kW","Gen_B_kW","Gen_C_kW","Gen_Total_kW"],i=[P,L.GenKVA_A_KiloVA,L.GenKVA__B_KiloVA,L.GenKVA_C_KiloVA,L.GenKVA_Total_KiloVA,L.Gen_A_kW,L.Gen_B_kW,L.Gen_C_kW,L.Gen_Total_kW]):"Power Factor"==t?(a.axis.y.label="",a.sensedKeys=["GenPFLagging"],i=[P,L.GenPFLagging]):"Other Parameters"==t?(a.axis.y.label="",a.sensedKeys=["ActiveSpeedSource","EngineSpeed_rpm","EngineLoad_pct","CoolantTemp_F","OilPressure_psi","BatteryVoltage_DeciVolt","FuelLevel","ECUCoolantLevel","CoolDownTimeRemaining_mins"],i=[P,L.ActiveSpeedSource,L.EngineSpeed_rpm,L.EngineLoad_pct,L.CoolantTemp_F,L.OilPressure_psi,L.BatteryVoltage_DeciVolt,L.FuelLevel,L.ECUCoolantLevel,L.CoolDownTimeRemaining_mins]):"Binary Parameters"==t&&(a.axis.y.label="",a.sensedKeys=["UnexpectedShutdown","GlobalAlarm","AutoRestartFailure","FuelLeakDetect","BatteryChargerFailure","TransferFail","LowCoolantLevel","ECUShutdown","EmergencyShutdown","Overcrank","LossofECUComms","GlobalSenderFail","LowFuelLevel","LowOilPressure","HighCoolantTemp"],i=[P,L.UnexpectedShutdown,L.GlobalAlarm,L.AutoRestartFailure,L.FuelLeakDetect,L.BatteryChargerFailure,L.TransferFail,L.LowCoolantLevel,L.ECUShutdown,L.EmergencyShutdown,L.Overcrank,L.LossofECUComms,L.GlobalSenderFail,L.LowFuelLevel,L.LowOilPressure,L.HighCoolantTemp]),S.find(function(e){return e.name==t})&&(a.axis.y.tick.values=S.find(function(e){return e.name==t}).value,a.axis.y.min=a.axis.y.tick.values[0],a.axis.y.max=a.axis.y.tick.values[a.axis.y.tick.values.length-1]),A&&A.length){var s=A.find(function(e){return e.graphName==t});s&&s.yAxisSettings&&("Fixed"==s.yAxisSettings?(delete a.axis.y.tick.values,a.axis.y.min=s.yAxisMin,a.axis.y.max=s.yAxisMax):"Floating"==s.yAxisSettings&&(delete a.axis.y.tick.values,delete a.axis.y.max,delete a.axis.y.min),a.yAxisSettings=s.yAxisSettings,a.yAxisFixedValues={max:s.yAxisMax,min:s.yAxisMin})}a.axis.y.tick.format=function(e){return parseFloat(e).toFixed(n)},a.axis.x.tick.format=V,a.axis.x.tick.values=N,a.graphData.x="x",a.graphData.columns=i,a.graphEquipment=K.fetchEquipmentFromPoints(t,a.sensedKeys),x.push(a)},K=this,G=0;G<r.length;G++)M(G);this.props.loadNextInsight(),Object(h.h)(w,this.callLiveUpdate),this.setState({grid:v,graphData:x,lastUpdatedAt:y,loading:!1},function(){p(!!g||O.length>0),i&&Y.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,o=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.device,g=c.showAlarmPoints,d=c.insightRelEquipment,f=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=o||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,f="";return g&&t.alarmStatus&&("active"==t.alarmStatus?f="alarm-graph":"ack"==t.alarmStatus?f="alarm-ack-graph":"clear"==t.alarmStatus&&(f="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+f,id:"divGraphs"},n.createElement("br",null),(g||u)&&n.createElement("div",{className:"alarm-limit-select"},g&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(l.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/Generator/"+Object(l.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(l.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(l.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(l.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(l.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",o)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:g&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2973:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(715),o=a(804),l=a(11),u=a(835),c=a(797),m=a(122),p=a(736),h=a(124),g=a(760),d=(a.n(g),a(834)),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(l.g)(e)&&Object(h.g)(Object(l.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,s,o=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(l.g)(i.moncontype),(s=d.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){o.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,s,u,c,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,u=i.device,c=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",c?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(l.g)(u.moncondevice),g=Object(l.g)(u.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(o.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(l.g)(i.moncondevice),[4,Object(o.a)(t,r)];case 1:return s=u.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(l.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(l.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(l.g)(r.relatedEquipment)})||i.push({value:Object(l.g)(r.relatedEquipment),label:Object(l.g)(r.relatedEquipmentLabel),space:Object(l.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,s,o,u,h,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(m.a)(!0),r&&!e?[3,2]:(o=[],i&&i.length&&i.forEach(function(e){o.push({sensedValue:Object(l.g)(e.sensedValue),maximumExtremeValue:Object(l.g)(e.maximumExtremeValue),maximumNormalValue:Object(l.g)(e.maximumNormalValue),minimumExtremeValue:Object(l.g)(e.minimumExtremeValue),minimumNormalValue:Object(l.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(l.g)(e.ifMaximumExtremeValue)||"true"!=Object(l.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(l.g)(e.ifMaximumNormalValue)||"true"!=Object(l.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(l.g)(e.ifMinimumExtremeValue)||"true"!=Object(l.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(l.g)(e.ifMinimumNormalValue)||"true"!=Object(l.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(l.g)(s.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(h=t[0].graphData.columns,g=new Date(h[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:o,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===o||void 0===o?void 0:o.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,s=n.alarmSensedPoints,o=this.props,u=o.showAlarmPoints,c=o.device,m=Object(l.g)(c.moncontype),p=d.c.filter(function(e){return m.toLowerCase().indexOf(e.type.toLowerCase())>-1}),h=new Date;e["@timestamp"]&&(h=new Date(e["@timestamp"]));var g=this.props.liveGraphRange;if(i&&i.length&&h){for(var f=0;f<i.length;f++){var v=i[f],x=v.graphData.columns.map(function(e){return e[0]});if(v.graphData.columns&&v.graphData.columns.length){if(v.graphData.columns[0].push(h),e&&Object.keys(e).length)for(var y=Object.keys(e),b=function(a){var n=y[a];if(v.sensedKeys&&v.sensedKeys.length&&v.sensedKeys.find(function(e){return e==n})){var i=null===(t=p.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=x.findIndex(function(e){return e==i});v.graphData.columns[r].push(e[n]),v.graphData.columns[r].splice(1,1)}}},A=0;A<y.length;A++)b(A);(h.getTime()-v.graphData.columns[0][2].getTime())/6e4>g&&v.graphData.columns[0].splice(1,1),v.axis.x.tick.values[2]&&v.axis.x.tick.values[1].getTime()&&v.axis.x.tick.values[2].getTime()-v.axis.x.tick.values[1].getTime()<h.getTime()-v.axis.x.tick.values[v.axis.x.tick.values.length-1]&&(v.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),h.setSeconds(0),g>10&&h.setMinutes(h.getMinutes()-h.getMinutes()%5),v.axis.x.tick.values.push(h),r.x.lines.push({value:h,class:"grid4"}))}}var E=null===h||void 0===h?void 0:h.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:E},function(){if(u){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&s.length>0&&s.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),o=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,o,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,c,m,p,g,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.showAlarmPoints,r=e.graphsList,u=e.devicePoints,c=e.isEquipment,m=e.equipment,p=e.isGraphLoaded,g=e.showAllGraphs,f=this.state,v=f.grid,x=f.lastUpdatedAt,y=f.graphYAxisSettings,A=[],E=[],c&&(E=u.filter(function(e){return Object(l.g)(e.relatedEquipment)==m.ontology})),t&&t.moncondevice?(D=Object(l.g)(t.moncontype),w=Object(l.g)(t.topic),S=d.b.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=d.c.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),O=[],!c||c&&E.length?[4,Object(s.k)(w,a,n,!1)]:[3,2]):[3,3];case 1:O=b.sent(),b.label=2;case 2:if(L={register1:[_.find(function(e){return"register1"==e.sensedKey}).des],t3frontRefrigerator1:[_.find(function(e){return"t3frontRefrigerator1"==e.sensedKey}).des],t4backRefrigerator1:[_.find(function(e){return"t4backRefrigerator1"==e.sensedKey}).des],t5evapfanRefrigerator1:[_.find(function(e){return"t5evapfanRefrigerator1"==e.sensedKey}).des],t6comprinRefrigerator1:[_.find(function(e){return"t6comprinRefrigerator1"==e.sensedKey}).des],t7comproutRefrigerator1:[_.find(function(e){return"t7comproutRefrigerator1"==e.sensedKey}).des],t8probeRefrigerator1:[_.find(function(e){return"t8probeRefrigerator1"==e.sensedKey}).des],t3frontRefrigerator2:[_.find(function(e){return"t3frontRefrigerator2"==e.sensedKey}).des],t4backRefrigerator2:[_.find(function(e){return"t4backRefrigerator2"==e.sensedKey}).des],t5evapfanRefrigerator2:[_.find(function(e){return"t5evapfanRefrigerator2"==e.sensedKey}).des],t6comprinRefrigerator2:[_.find(function(e){return"t6comprinRefrigerator2"==e.sensedKey}).des],t7comproutRefrigerator2:[_.find(function(e){return"t7comproutRefrigerator2"==e.sensedKey}).des],t8probeRefrigerator2:[_.find(function(e){return"t8probeRefrigerator2"==e.sensedKey}).des],t3frontRefrigerator3:[_.find(function(e){return"t3frontRefrigerator3"==e.sensedKey}).des],t4backRefrigerator3:[_.find(function(e){return"t4backRefrigerator3"==e.sensedKey}).des],t5evapfanRefrigerator3:[_.find(function(e){return"t5evapfanRefrigerator3"==e.sensedKey}).des],t6comprinRefrigerator3:[_.find(function(e){return"t6comprinRefrigerator3"==e.sensedKey}).des],t7comproutRefrigerator3:[_.find(function(e){return"t7comproutRefrigerator3"==e.sensedKey}).des],t8probeRefrigerator3:[_.find(function(e){return"t8probeRefrigerator3"==e.sensedKey}).des],t3frontRefrigerator4:[_.find(function(e){return"t3frontRefrigerator4"==e.sensedKey}).des],t4backRefrigerator4:[_.find(function(e){return"t4backRefrigerator4"==e.sensedKey}).des],t5evapfanRefrigerator4:[_.find(function(e){return"t5evapfanRefrigerator4"==e.sensedKey}).des],t6comprinRefrigerator4:[_.find(function(e){return"t6comprinRefrigerator4"==e.sensedKey}).des],t7comproutRefrigerator4:[_.find(function(e){return"t7comproutRefrigerator4"==e.sensedKey}).des],t8probeRefrigerator4:[_.find(function(e){return"t8probeRefrigerator4"==e.sensedKey}).des]},P=["x"],L.register1.push(null),L.t3frontRefrigerator1.push(null),L.t4backRefrigerator1.push(null),L.t5evapfanRefrigerator1.push(null),L.t6comprinRefrigerator1.push(null),L.t7comproutRefrigerator1.push(null),L.t8probeRefrigerator1.push(null),L.t3frontRefrigerator2.push(null),L.t4backRefrigerator2.push(null),L.t5evapfanRefrigerator2.push(null),L.t6comprinRefrigerator2.push(null),L.t7comproutRefrigerator2.push(null),L.t8probeRefrigerator2.push(null),L.t3frontRefrigerator3.push(null),L.t4backRefrigerator3.push(null),L.t5evapfanRefrigerator3.push(null),L.t6comprinRefrigerator3.push(null),L.t7comproutRefrigerator3.push(null),L.t8probeRefrigerator3.push(null),L.t3frontRefrigerator4.push(null),L.t4backRefrigerator4.push(null),L.t5evapfanRefrigerator4.push(null),L.t6comprinRefrigerator4.push(null),L.t7comproutRefrigerator4.push(null),L.t8probeRefrigerator4.push(null),P.push(new Date(a)),O.length>0&&O.forEach(function(e){e&&(L.register1.push(""+e.register1||"0"),L.t3frontRefrigerator1.push(""+e.t3frontRefrigerator1||"0"),L.t4backRefrigerator1.push(""+e.t4backRefrigerator1||"0"),L.t5evapfanRefrigerator1.push(""+e.t5evapfanRefrigerator1||"0"),L.t6comprinRefrigerator1.push(""+e.t6comprinRefrigerator1||"0"),L.t7comproutRefrigerator1.push(""+e.t7comproutRefrigerator1||"0"),L.t8probeRefrigerator1.push(""+e.t8probeRefrigerator1||"0"),L.t3frontRefrigerator2.push(""+e.t3frontRefrigerator2||"0"),L.t4backRefrigerator2.push(""+e.t4backRefrigerator2||"0"),L.t5evapfanRefrigerator2.push(""+e.t5evapfanRefrigerator2||"0"),L.t6comprinRefrigerator2.push(""+e.t6comprinRefrigerator2||"0"),L.t7comproutRefrigerator2.push(""+e.t7comproutRefrigerator2||"0"),L.t8probeRefrigerator2.push(""+e.t8probeRefrigerator2||"0"),L.t3frontRefrigerator3.push(""+e.t3frontRefrigerator3||"0"),L.t4backRefrigerator3.push(""+e.t4backRefrigerator3||"0"),L.t5evapfanRefrigerator3.push(""+e.t5evapfanRefrigerator3||"0"),L.t6comprinRefrigerator3.push(""+e.t6comprinRefrigerator3||"0"),L.t7comproutRefrigerator3.push(""+e.t7comproutRefrigerator3||"0"),L.t8probeRefrigerator3.push(""+e.t8probeRefrigerator3||"0"),L.t3frontRefrigerator4.push(""+e.t3frontRefrigerator4||"0"),L.t4backRefrigerator4.push(""+e.t4backRefrigerator4||"0"),L.t5evapfanRefrigerator4.push(""+e.t5evapfanRefrigerator4||"0"),L.t6comprinRefrigerator4.push(""+e.t6comprinRefrigerator4||"0"),L.t7comproutRefrigerator4.push(""+e.t7comproutRefrigerator4||"0"),L.t8probeRefrigerator4.push(""+e.t8probeRefrigerator4||"0"),P.push(new Date(e.timestamp)))}),x=O.length>0?null===(C=P[P.length-1])||void 0===C?void 0:C.toLocaleString():"No Data",L.register1.push(null),L.t3frontRefrigerator1.push(null),L.t4backRefrigerator1.push(null),L.t5evapfanRefrigerator1.push(null),L.t6comprinRefrigerator1.push(null),L.t7comproutRefrigerator1.push(null),L.t8probeRefrigerator1.push(null),L.t3frontRefrigerator2.push(null),L.t4backRefrigerator2.push(null),L.t5evapfanRefrigerator2.push(null),L.t6comprinRefrigerator2.push(null),L.t7comproutRefrigerator2.push(null),L.t8probeRefrigerator2.push(null),L.t3frontRefrigerator3.push(null),L.t4backRefrigerator3.push(null),L.t5evapfanRefrigerator3.push(null),L.t6comprinRefrigerator3.push(null),L.t7comproutRefrigerator3.push(null),L.t8probeRefrigerator3.push(null),L.t3frontRefrigerator4.push(null),L.t4backRefrigerator4.push(null),L.t5evapfanRefrigerator4.push(null),L.t6comprinRefrigerator4.push(null),L.t7comproutRefrigerator4.push(null),L.t8probeRefrigerator4.push(null),P.push(new Date(n)),P.length>1){if(N=Object(o.c)(5,a,n),V="",N.length>1?(j=((new Date).getTime()-N[0].getTime())/1e3,V=(j/=3600)>24?"%m-%d %H:%M":j<.3?"%H:%M:%S":"%H:%M"):V="%H:%M:%S",v.x.lines=[],N.forEach(function(e){v.x.lines.push({value:e,class:"grid4"})}),c){for((k=JSON.parse(JSON.stringify(d.a))).name="Temperatures",k.graphData.columns=[P],k.graphData.x="x",G=0;G<E.length;G++)R=E[G],q=Object(l.g)(R.sensedValue),k.sensedKeys.push(q),k.graphData.columns.push(L[""+q]);S.find(function(e){return e.name==k.name})&&(k.axis.y.tick.values=S.find(function(e){return e.name==k.name}).value,k.axis.y.min=k.axis.y.tick.values[0],k.axis.y.max=k.axis.y.tick.values[k.axis.y.tick.values.length-1]),y&&y.length&&(F=y.find(function(e){return e.graphName==k.name}))&&F.yAxisSettings&&("Fixed"==F.yAxisSettings?(delete k.axis.y.tick.values,k.axis.y.min=F.yAxisMin,k.axis.y.max=F.yAxisMax):"Floating"==F.yAxisSettings&&(delete k.axis.y.tick.values,delete k.axis.y.max,delete k.axis.y.min),k.yAxisSettings=F.yAxisSettings,k.yAxisFixedValues={max:F.yAxisMax,min:F.yAxisMin}),k.axis.y.label="\xb0F",k.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},k.axis.x.tick.format=V,k.axis.x.tick.values=N,k.graphEquipment=this.fetchEquipmentFromPoints(k.name,k.sensedKeys),A.push(k)}else for(M=function(e){var t=r[e],a=JSON.parse(JSON.stringify(d.a)),n=[];if(a.name=t,"Refrigerator 1"==t?(a.sensedKeys=["register1","t3frontRefrigerator1","t4backRefrigerator1","t5evapfanRefrigerator1","t6comprinRefrigerator1","t7comproutRefrigerator1","t8probeRefrigerator1"],n=[P,L.register1,L.t3frontRefrigerator1,L.t4backRefrigerator1,L.t5evapfanRefrigerator1,L.t6comprinRefrigerator1,L.t7comproutRefrigerator1,L.t8probeRefrigerator1]):"Refrigerator 2"==t?(a.sensedKeys=["register1","t3frontRefrigerator2","t4backRefrigerator2","t5evapfanRefrigerator2","t6comprinRefrigerator2","t7comproutRefrigerator2","t8probeRefrigerator2"],n=[P,L.register1,L.t3frontRefrigerator2,L.t4backRefrigerator2,L.t5evapfanRefrigerator2,L.t6comprinRefrigerator2,L.t7comproutRefrigerator2,L.t8probeRefrigerator2]):"Refrigerator 3"==t?(a.sensedKeys=["register1","t3frontRefrigerator3","t4backRefrigerator3","t5evapfanRefrigerator3","t6comprinRefrigerator3","t7comproutRefrigerator3","t8probeRefrigerator3"],n=[P,L.register1,L.t3frontRefrigerator3,L.t4backRefrigerator3,L.t5evapfanRefrigerator3,L.t6comprinRefrigerator3,L.t7comproutRefrigerator3,L.t8probeRefrigerator3]):"Refrigerator 2"==t&&(a.sensedKeys=["register1","t3frontRefrigerator4","t4backRefrigerator4","t5evapfanRefrigerator4","t6comprinRefrigerator4","t7comproutRefrigerator4","t8probeRefrigerator4"],n=[P,L.register1,L.t3frontRefrigerator4,L.t4backRefrigerator4,L.t5evapfanRefrigerator4,L.t6comprinRefrigerator4,L.t7comproutRefrigerator4,L.t8probeRefrigerator4]),S.find(function(e){return e.name==t})&&(a.axis.y.tick.values=S.find(function(e){return e.name==t}).value,a.axis.y.min=a.axis.y.tick.values[0],a.axis.y.max=a.axis.y.tick.values[a.axis.y.tick.values.length-1]),y&&y.length){var i=y.find(function(e){return e.graphName==t});i&&i.yAxisSettings&&("Fixed"==i.yAxisSettings?(delete a.axis.y.tick.values,a.axis.y.min=i.yAxisMin,a.axis.y.max=i.yAxisMax):"Floating"==i.yAxisSettings&&(delete a.axis.y.tick.values,delete a.axis.y.max,delete a.axis.y.min),a.yAxisSettings=i.yAxisSettings,a.yAxisFixedValues={max:i.yAxisMax,min:i.yAxisMin})}a.axis.y.label="\xb0F",a.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},a.axis.x.tick.format=V,a.axis.x.tick.values=N,a.graphData.x="x",a.graphData.columns=n,a.graphEquipment=K.fetchEquipmentFromPoints(t,a.sensedKeys),A.push(a)},K=this,G=0;G<r.length;G++)M(G);this.props.loadNextInsight(),Object(h.h)(w,this.callLiveUpdate),this.setState({grid:v,graphData:A,lastUpdatedAt:x,loading:!1},function(){p(!!g||O.length>0),i&&Y.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,o=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.device,g=c.showAlarmPoints,d=c.insightRelEquipment,f=c.isEquipment,v=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=o||v?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,v="";return g&&t.alarmStatus&&("active"==t.alarmStatus?v="alarm-graph":"ack"==t.alarmStatus?v="alarm-ack-graph":"clear"==t.alarmStatus&&(v="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+v,id:"divGraphs"},n.createElement("br",null),(g||u)&&n.createElement("div",{className:"alarm-limit-select"},g&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(l.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/CBW406/"+Object(l.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},f?t.name:t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(l.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(l.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(l.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(l.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",o)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:g&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2974:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(715),o=a(804),l=a(11),u=a(835),c=a(797),m=a(122),p=a(736),h=a(124),g=a(760),d=(a.n(g),a(834)),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(l.g)(e)&&Object(h.g)(Object(l.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,s,o,u,h,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(m.a)(!0),r&&!e?[3,2]:(o=[],i&&i.length&&i.forEach(function(e){o.push({sensedValue:Object(l.g)(e.sensedValue),maximumExtremeValue:Object(l.g)(e.maximumExtremeValue),maximumNormalValue:Object(l.g)(e.maximumNormalValue),minimumExtremeValue:Object(l.g)(e.minimumExtremeValue),minimumNormalValue:Object(l.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(l.g)(e.ifMaximumExtremeValue)||"true"!=Object(l.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(l.g)(e.ifMaximumNormalValue)||"true"!=Object(l.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(l.g)(e.ifMinimumExtremeValue)||"true"!=Object(l.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(l.g)(e.ifMinimumNormalValue)||"true"!=Object(l.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(l.g)(s.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(h=t[0].graphData.columns,g=new Date(h[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:o,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===o||void 0===o?void 0:o.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,s=n.alarmSensedPoints,o=this.props,u=o.showAlarmPoints,c=o.device,m=new Date,p=Object(l.g)(c.moncontype),h=d.c.filter(function(e){return p.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(m=new Date(e["@timestamp"]));var g=this.props.liveGraphRange;if(i&&i.length&&m){for(var f=0;f<i.length;f++){var v=i[f],x=v.graphData.columns.map(function(e){return e[0]});if(v.graphData.columns&&v.graphData.columns.length){if(v.graphData.columns[0].push(m),e&&Object.keys(e).length)for(var y=Object.keys(e),b=function(a){var n=y[a];if(v.sensedKeys&&v.sensedKeys.length&&v.sensedKeys.find(function(e){return e==n})){var i=null===(t=h.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=x.findIndex(function(e){return e==i});v.graphData.columns[r].push(e[n]),v.graphData.columns[r].splice(1,1)}}},A=0;A<y.length;A++)b(A);(m.getTime()-v.graphData.columns[0][2].getTime())/6e4>g&&v.graphData.columns[0].splice(1,1),v.axis.x.tick.values[2]&&v.axis.x.tick.values[1].getTime()&&v.axis.x.tick.values[2].getTime()-v.axis.x.tick.values[1].getTime()<m.getTime()-v.axis.x.tick.values[v.axis.x.tick.values.length-1]&&(v.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),m.setSeconds(0),g>10&&m.setMinutes(m.getMinutes()-m.getMinutes()%5),v.axis.x.tick.values.push(m),r.x.lines.push({value:m,class:"grid4"}))}}var E=null===m||void 0===m?void 0:m.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:E},function(){if(u){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&s.length>0&&s.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),o=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,o,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,s,o=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(l.g)(i.moncontype),(s=d.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){o.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,s,u,c,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,u=i.device,c=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",c?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(l.g)(u.moncondevice),g=Object(l.g)(u.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(o.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(l.g)(i.moncondevice),[4,Object(o.a)(t,r)];case 1:return s=u.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(l.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(l.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(l.g)(r.relatedEquipment)})||i.push({value:Object(l.g)(r.relatedEquipment),label:Object(l.g)(r.relatedEquipmentLabel),space:Object(l.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,c,m,p,g,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y,T,H,B,U,I,W=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.showAlarmPoints,r=e.graphsList,u=e.devicePoints,c=e.isEquipment,m=e.equipment,p=e.isGraphLoaded,g=e.showAllGraphs,f=this.state,v=f.grid,x=f.graphData,y=f.lastUpdatedAt,A=f.graphYAxisSettings,E=[],c&&(E=u.filter(function(e){return Object(l.g)(e.relatedEquipment)==m.ontology})),t&&t.moncondevice?(D=Object(l.g)(t.moncontype),w=Object(l.g)(t.topic),S=d.b.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=d.c.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),O=[],!c||c&&E.length?[4,Object(s.l)(w,a,n,!1)]:[3,2]):[3,3];case 1:O=b.sent(),b.label=2;case 2:if(L={a13comprcurrRefrigerator1:[_.find(function(e){return"a13comprcurrRefrigerator1"==e.sensedKey}).des],a14efmcurrRefrigerator1:[_.find(function(e){return"a14efmcurrRefrigerator1"==e.sensedKey}).des],a15prRefrigerator1:[_.find(function(e){return"a15prRefrigerator1"==e.sensedKey}).des],a16doorRefrigerator1:[_.find(function(e){return"a16doorRefrigerator1"==e.sensedKey}).des],a13comprcurrRefrigerator2:[_.find(function(e){return"a13comprcurrRefrigerator2"==e.sensedKey}).des],a14efmcurrRefrigerator2:[_.find(function(e){return"a14efmcurrRefrigerator2"==e.sensedKey}).des],a15prRefrigerator2:[_.find(function(e){return"a15prRefrigerator2"==e.sensedKey}).des],a16doorRefrigerator2:[_.find(function(e){return"a16doorRefrigerator2"==e.sensedKey}).des],register1:[_.find(function(e){return"register1"==e.sensedKey}).des],serialNumber:[_.find(function(e){return"serialNumber"==e.sensedKey}).des],minRecRefresh:[_.find(function(e){return"minRecRefresh"==e.sensedKey}).des],a13comprcurrRefrigerator3:[_.find(function(e){return"a13comprcurrRefrigerator3"==e.sensedKey}).des],a14efmcurrRefrigerator3:[_.find(function(e){return"a14efmcurrRefrigerator3"==e.sensedKey}).des],a15prRefrigerator3:[_.find(function(e){return"a15prRefrigerator3"==e.sensedKey}).des],a16doorRefrigerator3:[_.find(function(e){return"a16doorRefrigerator3"==e.sensedKey}).des],a13comprcurrRefrigerator4:[_.find(function(e){return"a13comprcurrRefrigerator4"==e.sensedKey}).des],a14efmcurrRefrigerator4:[_.find(function(e){return"a14efmcurrRefrigerator4"==e.sensedKey}).des],a15prRefrigerator4:[_.find(function(e){return"a15prRefrigerator4"==e.sensedKey}).des],a16doorRefrigerator4:[_.find(function(e){return"a16doorRefrigerator4"==e.sensedKey}).des],amalgamatedWattsRefrigerator1:["Amalgamated Watts"],amalgamatedWattsRefrigerator2:["Amalgamated Watts"],amalgamatedWattsRefrigerator3:["Amalgamated Watts"],amalgamatedWattsRefrigerator4:["Amalgamated Watts"]},P=["x"],L.a13comprcurrRefrigerator1.push(null),L.a14efmcurrRefrigerator1.push(null),L.a15prRefrigerator1.push(null),L.a16doorRefrigerator1.push(null),L.a13comprcurrRefrigerator2.push(null),L.a14efmcurrRefrigerator2.push(null),L.a15prRefrigerator2.push(null),L.a16doorRefrigerator2.push(null),L.a13comprcurrRefrigerator3.push(null),L.a14efmcurrRefrigerator3.push(null),L.a15prRefrigerator3.push(null),L.a16doorRefrigerator3.push(null),L.a13comprcurrRefrigerator4.push(null),L.a14efmcurrRefrigerator4.push(null),L.a15prRefrigerator4.push(null),L.a16doorRefrigerator4.push(null),L.register1.push(null),L.serialNumber.push(null),L.minRecRefresh.push(null),L.amalgamatedWattsRefrigerator1.push(null),L.amalgamatedWattsRefrigerator2.push(null),L.amalgamatedWattsRefrigerator3.push(null),L.amalgamatedWattsRefrigerator4.push(null),P.push(new Date(a)),N=!1,V=!1,j=!1,k=!1,O.length>0&&O.forEach(function(e){e&&(L.a13comprcurrRefrigerator1.push(""+e.a13comprcurrRefrigerator1||null),L.a14efmcurrRefrigerator1.push(""+e.a14efmcurrRefrigerator1||null),L.a15prRefrigerator1.push(""+e.a15prRefrigerator1||null),L.a16doorRefrigerator1.push(""+e.a16doorRefrigerator1||null),L.a13comprcurrRefrigerator2.push(""+e.a13comprcurrRefrigerator2||null),L.a14efmcurrRefrigerator2.push(""+e.a14efmcurrRefrigerator2||null),L.a15prRefrigerator2.push(""+e.a15prRefrigerator2||null),L.a16doorRefrigerator2.push(""+e.a16doorRefrigerator2||null),L.a13comprcurrRefrigerator3.push(""+e.a13comprcurrRefrigerator3||null),L.a14efmcurrRefrigerator3.push(""+e.a14efmcurrRefrigerator3||null),L.a15prRefrigerator3.push(""+e.a15prRefrigerator3||null),L.a16doorRefrigerator3.push(""+e.a16doorRefrigerator3||null),L.a13comprcurrRefrigerator4.push(""+e.a13comprcurrRefrigerator4||null),L.a14efmcurrRefrigerator4.push(""+e.a14efmcurrRefrigerator4||null),L.a15prRefrigerator4.push(""+e.a15prRefrigerator4||null),L.a16doorRefrigerator4.push(""+e.a16doorRefrigerator4||null),L.register1.push(""+e.register1||null),L.serialNumber.push(""+e.serialNumber||null),L.minRecRefresh.push(""+e.minRecRefresh||null),L.amalgamatedWattsRefrigerator1.push(""+360*e.a13comprcurrRefrigerator1||"0"),L.amalgamatedWattsRefrigerator2.push(""+360*e.a13comprcurrRefrigerator2||"0"),L.amalgamatedWattsRefrigerator3.push(""+360*e.a13comprcurrRefrigerator3||"0"),L.amalgamatedWattsRefrigerator4.push(""+360*e.a13comprcurrRefrigerator4||"0"),P.push(new Date(e.timestamp)),N=e.a14efmcurrRefrigerator1<-5,V=e.a14efmcurrRefrigerator2<-5,j=e.a14efmcurrRefrigerator3<-5,k=e.a14efmcurrRefrigerator4<-5)}),y=O.length>0?null===(I=P[P.length-1])||void 0===I?void 0:I.toLocaleString():"No Data",L.a13comprcurrRefrigerator1.push(null),L.a14efmcurrRefrigerator1.push(null),L.a15prRefrigerator1.push(null),L.a16doorRefrigerator1.push(null),L.a13comprcurrRefrigerator2.push(null),L.a14efmcurrRefrigerator2.push(null),L.a15prRefrigerator2.push(null),L.a16doorRefrigerator2.push(null),L.a13comprcurrRefrigerator3.push(null),L.a14efmcurrRefrigerator3.push(null),L.a15prRefrigerator3.push(null),L.a16doorRefrigerator3.push(null),L.a13comprcurrRefrigerator4.push(null),L.a14efmcurrRefrigerator4.push(null),L.a15prRefrigerator4.push(null),L.a16doorRefrigerator4.push(null),L.register1.push(null),L.serialNumber.push(null),L.minRecRefresh.push(null),L.amalgamatedWattsRefrigerator1.push(null),L.amalgamatedWattsRefrigerator2.push(null),L.amalgamatedWattsRefrigerator3.push(null),L.amalgamatedWattsRefrigerator4.push(null),P.push(new Date(n)),P.length>1){if(R=Object(o.c)(5,a,n),q="",R.length>1?(F=((new Date).getTime()-R[0].getTime())/1e3,q=(F/=3600)>24?"%m-%d %H:%M":F<.3?"%H:%M:%S":"%H:%M"):q="%H:%M:%S",v.x.lines=[],R.forEach(function(e){v.x.lines.push({value:e,class:"grid4"})}),c){for((M=JSON.parse(JSON.stringify(d.a))).name="Analog Values",M.graphData.columns=[P],M.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},M.axis.x.tick.format=q,M.axis.x.tick.values=R,M.graphData.x="x",K="",U=0;U<E.length;U++)G=E[U],C=Object(l.g)(G.sensedValue),M.sensedKeys.push(C),M.graphData.columns.push(L[""+C]),K=C.substr(C.length-1);M.graphEquipment=this.fetchEquipmentFromPoints(M.name,M.sensedKeys),Y="1"==K?N:"2"==K?N:"3"==K?j:"4"==K&&k,S.find(function(e){return e.name==M.name})&&(M.axis.y.tick.values=Y?S.find(function(e){return e.name==M.name}).value2:S.find(function(e){return e.name==M.name}).value,M.axis.y.min=M.axis.y.tick.values[0],M.axis.y.max=M.axis.y.tick.values[M.axis.y.tick.values.length-1]),A&&A.length&&(T=A.find(function(e){return e.graphName==M.name}))&&T.yAxisSettings&&("Fixed"==T.yAxisSettings?(delete M.axis.y.tick.values,M.axis.y.min=T.yAxisMin,M.axis.y.max=T.yAxisMax):"Floating"==T.yAxisSettings&&(delete M.axis.y.tick.values,delete M.axis.y.max,delete M.axis.y.min),M.yAxisSettings=T.yAxisSettings,M.yAxisFixedValues={max:T.yAxisMax,min:T.yAxisMin}),M.axis.y.label="Amps,PSI",x.push(M)}else for(H=function(e){var t=r[e],a=JSON.parse(JSON.stringify(d.a)),n=[];if(a.name=t,"Refrigerator 1"==t?(a.sensedKeys=["a13comprcurrRefrigerator1","a14efmcurrRefrigerator1","a15prRefrigerator1","a16doorRefrigerator1"],n=[P,L.a13comprcurrRefrigerator1,L.a14efmcurrRefrigerator1,L.a15prRefrigerator1,L.a16doorRefrigerator1]):"Refrigerator 2"==t?(a.sensedKeys=["a13comprcurrRefrigerator2","a14efmcurrRefrigerator2","a15prRefrigerator2","a16doorRefrigerator2"],n=[P,L.a13comprcurrRefrigerator2,L.a14efmcurrRefrigerator2,L.a15prRefrigerator2,L.a16doorRefrigerator2]):"Refrigerator 3"==t?(a.sensedKeys=["a13comprcurrRefrigerator3","a14efmcurrRefrigerator3","a15prRefrigerator3","a16doorRefrigerator3"],n=[P,L.a13comprcurrRefrigerator3,L.a14efmcurrRefrigerator3,L.a15prRefrigerator3,L.a16doorRefrigerator3]):"Refrigerator 4"==t&&(a.sensedKeys=["a13comprcurrRefrigerator4","a14efmcurrRefrigerator4","a15prRefrigerator4","a16doorRefrigerator4"],n=[P,L.a13comprcurrRefrigerator4,L.a14efmcurrRefrigerator4,L.a15prRefrigerator4,L.a16doorRefrigerator4]),S.find(function(e){return e.name==t})){var i=!1;"Refrigerator 1"==t?i=N:"Refrigerator 2"==t?i=V:"Refrigerator 3"==t?i=j:"Refrigerator 4"==t&&(i=k),a.axis.y.tick.values=i?S.find(function(e){return e.name==t}).value2:S.find(function(e){return e.name==t}).value,a.axis.y.min=a.axis.y.tick.values[0],a.axis.y.max=a.axis.y.tick.values[a.axis.y.tick.values.length-1]}if(A&&A.length){var s=A.find(function(e){return e.graphName==t});s&&s.yAxisSettings&&("Fixed"==s.yAxisSettings?(delete a.axis.y.tick.values,a.axis.y.min=s.yAxisMin,a.axis.y.max=s.yAxisMax):"Floating"==s.yAxisSettings&&(delete a.axis.y.tick.values,delete a.axis.y.max,delete a.axis.y.min),a.yAxisSettings=s.yAxisSettings,a.yAxisFixedValues={max:s.yAxisMax,min:s.yAxisMin})}a.axis.y.label="Amps,PSI",a.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},a.axis.x.tick.format=q,a.axis.x.tick.values=R,a.graphData.x="x",a.graphData.columns=n,a.graphEquipment=B.fetchEquipmentFromPoints(t,a.sensedKeys),x.push(a)},B=this,U=0;U<r.length;U++)H(U);this.props.loadNextInsight(),Object(h.h)(w,this.callLiveUpdate),this.setState({grid:v,graphData:x,lastUpdatedAt:y,loading:!1},function(){p(!!g||O.length>0),i&&W.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,o=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.showAlarmPoints,g=c.device,d=c.insightRelEquipment,f=c.isEquipment,v=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=o||v?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,v="";return h&&t.alarmStatus&&("active"==t.alarmStatus?v="alarm-graph":"ack"==t.alarmStatus?v="alarm-ack-graph":"clear"==t.alarmStatus&&(v="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+v,id:"divGraphs"},n.createElement("br",null),(h||u)&&n.createElement("div",{className:"alarm-limit-select"},h&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(l.g)(g.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/CompressorControl/"+Object(l.g)(g.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},f?t.name:t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(l.g)(g.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(l.g)(g.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(l.g)(g.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(l.g)(g.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",o)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:h&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2975:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(707),o=a(11),l=a(804),u=a(835),c=a(797),m=a(122),p=a(736),h=a(124),g=a(760),d=(a.n(g),a(834)),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(o.g)(e)&&Object(h.g)(Object(o.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,s,l,u,h,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(m.a)(!0),r&&!e?[3,2]:(l=[],i&&i.length&&i.forEach(function(e){l.push({sensedValue:Object(o.g)(e.sensedValue),maximumExtremeValue:Object(o.g)(e.maximumExtremeValue),maximumNormalValue:Object(o.g)(e.maximumNormalValue),minimumExtremeValue:Object(o.g)(e.minimumExtremeValue),minimumNormalValue:Object(o.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(o.g)(e.ifMaximumExtremeValue)||"true"!=Object(o.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(o.g)(e.ifMaximumNormalValue)||"true"!=Object(o.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(o.g)(e.ifMinimumExtremeValue)||"true"!=Object(o.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(o.g)(e.ifMinimumNormalValue)||"true"!=Object(o.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(o.g)(s.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(h=t[0].graphData.columns,g=new Date(h[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:l,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===l||void 0===l?void 0:l.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,l=n.alarmSensedPoints,u=this.props,c=u.showAlarmPoints,m=u.device,p=new Date,h=Object(o.g)(m.moncontype),g=d.c.filter(function(e){return h.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(p=new Date(e["@timestamp"]));var f=this.props.liveGraphRange,v=Object(s.a)(parseInt(null===e||void 0===e?void 0:e.v4relay_state));3==v.length?v="0"+v:2==v.length?v="00"+v:1==v.length&&(v="000"+v);var x=v[3],y=v[2],b=v[1],A=v[0];if(i&&i.length&&p){for(var E=0;E<i.length;E++){var D=i[E],w=D.graphData.columns.map(function(e){return e[0]});if(D.graphData.columns&&D.graphData.columns.length){if(D.graphData.columns[0].push(p),e&&Object.keys(e).length)for(var S=Object.keys(e),_=function(a){var n=S[a];if(D.sensedKeys&&D.sensedKeys.length&&D.sensedKeys.find(function(e){return e==n}))if("v4relay_state"==n){var i=w.findIndex(function(e){return"Relay 1 State"==e}),r=w.findIndex(function(e){return"Relay 2 State"==e}),s=w.findIndex(function(e){return"Relay 3 State"==e}),o=w.findIndex(function(e){return"Relay 4 State"==e});D.graphData.columns[i].splice(1,1),D.graphData.columns[i].push(x||"0"),D.graphData.columns[r].splice(1,1),D.graphData.columns[r].push(y||"0"),D.graphData.columns[s].splice(1,1),D.graphData.columns[s].push(b||"0"),D.graphData.columns[o].splice(1,1),D.graphData.columns[o].push(A||"0")}else{var l=null===(t=g.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(l){var u=w.findIndex(function(e){return e==l});D.graphData.columns[u].splice(1,1),D.graphData.columns[u].push(e[n])}}},O=0;O<S.length;O++)_(O);(p.getTime()-D.graphData.columns[0][2].getTime())/6e4>f&&D.graphData.columns[0].splice(1,1),D.axis.x.tick.values[2]&&D.axis.x.tick.values[1].getTime()&&D.axis.x.tick.values[2].getTime()-D.axis.x.tick.values[1].getTime()<p.getTime()-D.axis.x.tick.values[D.axis.x.tick.values.length-1]&&(D.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),p.setSeconds(0),f>10&&p.setMinutes(p.getMinutes()-p.getMinutes()%5),D.axis.x.tick.values.push(p),r.x.lines.push({value:p,class:"grid4"}))}}var L=null===p||void 0===p?void 0:p.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:L},function(){if(c){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&l.length>0&&l.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),s=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,s,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,s,l=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(o.g)(i.moncontype),(s=d.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){l.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,s,u,c,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,u=i.device,c=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",c?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(o.g)(u.moncondevice),g=Object(o.g)(u.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(l.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(o.g)(i.moncondevice),[4,Object(l.a)(t,r)];case 1:return s=u.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(o.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(o.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(o.g)(r.relatedEquipment)})||i.push({value:Object(o.g)(r.relatedEquipment),label:Object(o.g)(r.relatedEquipmentLabel),space:Object(o.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,c,m,p,g,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y,T,H,B,U,I=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.showAlarmPoints,r=e.devicePoints,u=e.isEquipment,c=e.equipment,m=e.isGraphLoaded,p=e.showAllGraphs,g=this.state,f=g.grid,v=g.graphData,x=g.lastUpdatedAt,y=g.graphYAxisSettings,A=[],u&&(A=r.filter(function(e){return Object(o.g)(e.relatedEquipment)==c.ontology})),t&&t.moncondevice?(E=Object(o.g)(t.moncontype),D=Object(o.g)(t.topic),w=d.b.filter(function(e){return E.toLowerCase().indexOf(e.type.toLowerCase())>-1}),S=d.c.filter(function(e){return E.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=[],!u||u&&A.length?[4,Object(s.h)(D,a,n,!1)]:[3,2]):[3,3];case 1:_=b.sent(),b.label=2;case 2:if(O={mAmps_relay1:[S.find(function(e){return"mAmps_relay1"==e.sensedKey}).des],mAmps_relay2:[S.find(function(e){return"mAmps_relay2"==e.sensedKey}).des],mAmps_relay3:[S.find(function(e){return"mAmps_relay3"==e.sensedKey}).des],mAmps_relay4:[S.find(function(e){return"mAmps_relay4"==e.sensedKey}).des],nominal_src_volts:[S.find(function(e){return"nominal_src_volts"==e.sensedKey}).des],power_Wt_relay1:[S.find(function(e){return"power_Wt_relay1"==e.sensedKey}).des],power_Wt_relay2:[S.find(function(e){return"power_Wt_relay2"==e.sensedKey}).des],power_Wt_relay3:[S.find(function(e){return"power_Wt_relay3"==e.sensedKey}).des],Relay1_State:[S.find(function(e){return"Relay1_State"==e.sensedKey}).des],Relay2_State:[S.find(function(e){return"Relay2_State"==e.sensedKey}).des],Relay3_State:[S.find(function(e){return"Relay3_State"==e.sensedKey}).des],Relay4_State:[S.find(function(e){return"Relay4_State"==e.sensedKey}).des]},L=["x"],O.mAmps_relay1.push(null),O.mAmps_relay2.push(null),O.mAmps_relay3.push(null),O.mAmps_relay4.push(null),O.nominal_src_volts.push(null),O.power_Wt_relay1.push(null),O.power_Wt_relay2.push(null),O.power_Wt_relay3.push(null),O.Relay1_State.push(null),O.Relay2_State.push(null),O.Relay3_State.push(null),O.Relay4_State.push(null),L.push(new Date(a)),_.length>0)for(B=0;B<_.length;B++)(null===(P=_[B])||void 0===P?void 0:P.mAmps_relay1)&&(O.mAmps_relay1.push(P.mAmps_relay1||"0"),O.mAmps_relay2.push(P.mAmps_relay2||"0"),O.mAmps_relay3.push(P.mAmps_relay3||"0"),O.mAmps_relay4.push(P.mAmps_relay4||"0"),O.nominal_src_volts.push(P.nominal_src_volts||"0"),O.power_Wt_relay1.push(P.power_Wt_relay1||"0"),O.power_Wt_relay2.push(P.power_Wt_relay2||"0"),O.power_Wt_relay3.push(P.power_Wt_relay3||"0"),N=Object(s.a)(parseInt(P.v4relay_state)),L.push(new Date(P.timestamp)),3==N.length?N="0"+N:2==N.length?N="00"+N:1==N.length&&(N="000"+N),V=N[3],j=N[2],k=N[1],R=N[0],O.Relay1_State.push(V||"0"),O.Relay2_State.push(j||"0"),O.Relay3_State.push(k||"0"),O.Relay4_State.push(R||"0"));if(x=_.length>0?null===(U=L[L.length-1])||void 0===U?void 0:U.toLocaleString():"No Data",O.mAmps_relay1.push(null),O.mAmps_relay2.push(null),O.mAmps_relay3.push(null),O.mAmps_relay4.push(null),O.nominal_src_volts.push(null),O.power_Wt_relay1.push(null),O.power_Wt_relay2.push(null),O.power_Wt_relay3.push(null),O.Relay1_State.push(null),O.Relay2_State.push(null),O.Relay3_State.push(null),O.Relay4_State.push(null),L.push(new Date(n)),L.length>1){if(q=Object(l.c)(5,a,n),F="",q.length>1?(M=((new Date).getTime()-q[0].getTime())/1e3,F=(M/=3600)>24?"%m-%d %H:%M":M<.3?"%H:%M:%S":"%H:%M"):F="%H:%M:%S",f.x.lines=[],q.forEach(function(e){f.x.lines.push({value:e,class:"grid4"})}),u){for((K=JSON.parse(JSON.stringify(d.a))).name="Relay V4",K.graphData.columns=[L],K.axis.x.tick.format=F,K.axis.x.tick.values=q,K.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},K.graphData.x="x",B=0;B<A.length;B++)G=A[B],C=Object(o.g)(G.sensedValue),K.sensedKeys.push(C),"v4relay_state"==C?(K.graphData.columns.push(O.Relay1_State),K.graphData.columns.push(O.Relay2_State),K.graphData.columns.push(O.Relay3_State),K.graphData.columns.push(O.Relay4_State)):K.graphData.columns.push(O[""+C]);w.find(function(e){return e.name==K.name})&&(K.axis.y.tick.values=w.find(function(e){return e.name==K.name}).value,K.axis.y.min=K.axis.y.tick.values[0],K.axis.y.max=K.axis.y.tick.values[K.axis.y.tick.values.length-1]),y&&y.length&&(Y=y.find(function(e){return e.graphName==K.name}))&&Y.yAxisSettings&&("Fixed"==Y.yAxisSettings?(delete K.axis.y.tick.values,K.axis.y.min=Y.yAxisMin,K.axis.y.max=Y.yAxisMax):"Floating"==Y.yAxisSettings&&(delete K.axis.y.tick.values,delete K.axis.y.max,delete K.axis.y.min),K.yAxisSettings=Y.yAxisSettings,K.yAxisFixedValues={max:Y.yAxisMax,min:Y.yAxisMin}),K.graphEquipment=this.fetchEquipmentFromPoints(K.name,K.sensedKeys),v.push(K)}else for(T=function(e){var t,a="Relay V4",n=JSON.parse(JSON.stringify(d.a));if(n.name=a,n.axis.y.label="Amp, W, On/Off, Volts",n.sensedKeys=["mAmps_relay1","mAmps_relay2","mAmps_relay3","mAmps_relay4","power_Wt_relay1","power_Wt_relay2","power_Wt_relay3","v4relay_state","nominal_src_volts"],t=[L,O.mAmps_relay1,O.mAmps_relay2,O.mAmps_relay3,O.mAmps_relay4,O.power_Wt_relay1,O.power_Wt_relay2,O.power_Wt_relay3,O.Relay1_State,O.Relay2_State,O.Relay3_State,O.Relay4_State,O.nominal_src_volts],w.find(function(e){return e.name==a})&&(n.axis.y.tick.values=w.find(function(e){return e.name==a}).value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1]),y&&y.length){var i=y.find(function(e){return e.graphName==a});i&&i.yAxisSettings&&("Fixed"==i.yAxisSettings?(delete n.axis.y.tick.values,n.axis.y.min=i.yAxisMin,n.axis.y.max=i.yAxisMax):"Floating"==i.yAxisSettings&&(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min),n.yAxisSettings=i.yAxisSettings,n.yAxisFixedValues={max:i.yAxisMax,min:i.yAxisMin})}n.axis.y.tick.format=function(e){return parseFloat(e).toFixed(0)},n.axis.x.tick.format=F,n.axis.x.tick.values=q,n.graphData.x="x",n.graphData.columns=t,n.graphEquipment=H.fetchEquipmentFromPoints(a,n.sensedKeys),v.push(n)},H=this,B=0;B<1;B++)T(B);this.props.loadNextInsight(),Object(h.h)(D,this.callLiveUpdate),this.setState({grid:f,graphData:v,lastUpdatedAt:x,loading:!1},function(){m(!!p||_.length>0),i&&I.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,l=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.device,g=c.insightRelEquipment,d=c.showAlarmPoints,f=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=l||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,f="";return d&&t.alarmStatus&&("active"==t.alarmStatus?f="alarm-graph":"ack"==t.alarmStatus?f="alarm-ack-graph":"clear"==t.alarmStatus&&(f="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+f,id:"divGraphs"},n.createElement("br",null),(d||u)&&n.createElement("div",{className:"alarm-limit-select"},d&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(o.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/RelayControl/"+Object(o.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(o.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(o.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",g.map(function(e,t){return e.rdfsLabel+(t<g.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(o.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(o.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",l)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:d&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2976:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(772)),r=a.n(i),s=a(715),o=a(804),l=a(11),u=a(835),c=a(797),m=a(122),p=a(736),h=a(124),g=a(760),d=(a.n(g),a(834)),f=a(20),v=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),x=this&&this.__assign||function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},y=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},A=function(e){function t(t){var a=e.call(this,t)||this;return a.state={graphData:[],grid:{x:{lines:[{}]},y:{show:!0}},loading:!0,lastUpdatedAt:"No Data",deviceAlarms:[],alarmSensedPoints:[],enableYAxis:a.props.enableYAxis,graphYAxisSettings:[]},a._fetchData=a._fetchData.bind(a),a.callLiveUpdate=a.callLiveUpdate.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return window.addEventListener("ShowAlarms",function(){return e.changeAlarmStatus()}),window.addEventListener("reLoadGraph",function(){var t=e.state,a=t.graphData;!t.loading&&a&&a.length>0&&e.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return e.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),[4,this.fetchGraphYAxisSettings()];case 1:return t.sent(),this._fetchData(),[2]}})})},t.prototype.componentWillUnmount=function(){return y(this,void 0,void 0,function(){var e,t=this;return b(this,function(a){return e=this.props.device.topic,window.removeEventListener("ShowAlarms",function(e){return t.changeAlarmStatus()}),window.removeEventListener("reLoadGraph",function(){var e=t.state,a=e.graphData;!e.loading&&a&&a.length>0&&t.setState({graphData:a.map(function(e){return e.loading=!0,e})},function(){return t.setState({graphData:a.map(function(e){return e.loading=!1,e})})})}),Object(l.g)(e)&&Object(h.g)(Object(l.g)(e)),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({enableYAxis:e.enableYAxis})},t.prototype.changeAlarmStatus=function(e){return y(this,void 0,void 0,function(){var t,a,n,i,r,s,o,u,h,g,d,f,v,x=this;return b(this,function(y){switch(y.label){case 0:return t=this.state.graphData,a=this.props,n=a.buildingName,i=a.devicePoints,r=a.showAlarmPoints,s=a.device,Object(m.a)(!0),r&&!e?[3,2]:(o=[],i&&i.length&&i.forEach(function(e){o.push({sensedValue:Object(l.g)(e.sensedValue),maximumExtremeValue:Object(l.g)(e.maximumExtremeValue),maximumNormalValue:Object(l.g)(e.maximumNormalValue),minimumExtremeValue:Object(l.g)(e.minimumExtremeValue),minimumNormalValue:Object(l.g)(e.minimumNormalValue),generateMaximumExtremeValue:!(!Object(l.g)(e.ifMaximumExtremeValue)||"true"!=Object(l.g)(e.ifMaximumExtremeValue)),generateMaximumNormalValue:!(!Object(l.g)(e.ifMaximumNormalValue)||"true"!=Object(l.g)(e.ifMaximumNormalValue)),generateMinimumExtremeValue:!(!Object(l.g)(e.ifMinimumExtremeValue)||"true"!=Object(l.g)(e.ifMinimumExtremeValue)),generateMinimumNormalValue:!(!Object(l.g)(e.ifMinimumNormalValue)||"true"!=Object(l.g)(e.ifMinimumNormalValue))})}),[4,Object(c.e)(p.a.OperationalAlarm,n,!1,0,50,null,null,[Object(l.g)(s.moncondevice)],null)]);case 1:return u=y.sent(),t&&t.length&&t[0]&&t[0].graphData&&t[0].graphData.columns.length>1&&(h=t[0].graphData.columns,g=new Date(h[0][1]),u=u.filter(function(e){return new Date(e.timeofalarm)>g})),this.setState({alarmSensedPoints:o,deviceAlarms:u},function(){var e=t[0].graphData.columns;if((null===o||void 0===o?void 0:o.length)>0&&e.length>1){for(var a=[],n=0;n<t.length;n++){var i=t[n],r=i.selectedAlarmPoint.sensedValue.length>1?i.selectedAlarmPoint.sensedValue:i.sensedKeys&&i.sensedKeys.length>0?i.sensedKeys[i.sensedKeys.length-1]:"";a.push(x.selectAlarmPoint(i,r,!1))}x.setState({graphData:a})}}),[3,3];case 2:for(d=[],f=0;f<t.length;f++)v=t[f],d.push(this.selectAlarmPoint(v,"",!1));this.setState({graphData:d}),y.label=3;case 3:return Object(m.a)(!1),[2]}})})},t.prototype.selectAlarmPoint=function(e,t,a){var n=this;return e&&e.graphData&&e.graphData.columns&&e.graphData.columns.length&&this.setState({loading:!0},function(){var i,r,s=n.state,o=s.alarmSensedPoints,l=s.deviceAlarms,c=s.graphData,m=o.find(function(e){return e.sensedValue===t}),p=e.sensedKeys&&e.sensedKeys.length&&l.length>0&&l.find(function(t){return e.sensedKeys.includes(t.sensedValueKey)});if(e.graphDataAlarmPoint={x:"x",columns:[],regions:{},colors:{}},m){for(var h=!0,g=0;g<e.sensedKeys.length;g++){var d=e.sensedKeys[g];if(t==d){h=!1;for(var f=["Low-Low"],v=["Low"],y=["High"],b=["High-High"],A=0;A<e.graphData.columns[0].length-1;A++)f.push(m.minimumExtremeValue),v.push(m.minimumNormalValue),y.push(m.maximumNormalValue),b.push(m.maximumExtremeValue);e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],f,v,e.graphData.columns[g+1],y,b],regions:{"Low-Low":[{style:"dashed"}],Low:[{style:"dashed"}],High:[{style:"dashed"}],"High-High":[{style:"dashed"}]},colors:(i={"Low-Low":"red",Low:"grey"},i[e.graphData.columns[g+1][0]]="#e3e3e3",i.High="grey",i["High-High"]="red",i)},e.graphDataAlarmPoint.columns&&e.graphDataAlarmPoint.columns.length&&e.graphDataAlarmPoint.regions&&e.graphDataAlarmPoint.colors&&(!m.generateMaximumExtremeValue&&e.graphDataAlarmPoint.columns[5]&&(e.graphDataAlarmPoint.columns.splice(5,1),delete e.graphDataAlarmPoint.regions["High-High"],delete e.graphDataAlarmPoint.colors["High-High"]),!m.generateMaximumNormalValue&&e.graphDataAlarmPoint.columns[4]&&(e.graphDataAlarmPoint.columns.splice(4,1),delete e.graphDataAlarmPoint.regions.High,delete e.graphDataAlarmPoint.colors.High),!m.generateMinimumExtremeValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions["Low-Low"],delete e.graphDataAlarmPoint.colors["Low-Low"]),!m.generateMinimumNormalValue&&e.graphDataAlarmPoint.columns[1]&&(e.graphDataAlarmPoint.columns.splice(1,1),delete e.graphDataAlarmPoint.regions.Low,delete e.graphDataAlarmPoint.colors.Low))}}h&&(e.graphDataAlarmPoint=e.graphData),e.selectedAlarmPoint=m,e.alarmStatus=p?!p.archived&&p.acknowledge?p.clearable?"clear":"ack":"active":"",c.forEach(function(t){t.name==e.name&&(t=x({},e))}),a?n.setState({graphData:c,loading:!1}):n.setState({loading:!1})}else{e.selectedAlarmPoint=u.a,e.selectedAlarmPoint.sensedValue=t;for(g=0;g<e.sensedKeys.length;g++){d=e.sensedKeys[g];t==d&&(e.graphDataAlarmPoint={x:"x",columns:[e.graphData.columns[0],e.graphData.columns[g+1]],colors:(r={},r[e.graphData.columns[g+1][0]]="#e3e3e3",r)})}if(a){var E=n.state.graphData;E.forEach(function(t){t.name==e.name&&(t=x({},e))}),n.setState({graphData:E,loading:!1})}else n.setState({loading:!1})}}),e},t.prototype.callLiveUpdate=function(e){var t,a=this,n=this.state,i=n.graphData,r=n.grid,s=n.alarmSensedPoints,o=this.props,u=o.showAlarmPoints,c=o.device,m=new Date,p=Object(l.g)(c.moncontype),h=d.c.filter(function(e){return p.toLowerCase().indexOf(e.type.toLowerCase())>-1});e["@timestamp"]&&(m=new Date(e["@timestamp"]));var g=this.props.liveGraphRange;if(i&&i.length&&m){for(var f=0;f<i.length;f++){var v=i[f],x=v.graphData.columns.map(function(e){return e[0]});if(v.graphData.columns&&v.graphData.columns.length){if(v.graphData.columns[0].push(m),e&&Object.keys(e).length)for(var y=Object.keys(e),b=function(a){var n=y[a];if(v.sensedKeys&&v.sensedKeys.length&&v.sensedKeys.find(function(e){return e==n})){var i=null===(t=h.find(function(e){return e.sensedKey==n}))||void 0===t?void 0:t.des;if(i){var r=x.findIndex(function(e){return e==i});"EnergySumNR"==n||"EnergyPosSumNR"==n?v.graphData.columns[r].push(parseFloat(e[""+n])/1e3):v.graphData.columns[r].push(e[n]),v.graphData.columns[r].splice(1,1)}}},A=0;A<y.length;A++)b(A);(m.getTime()-v.graphData.columns[0][2].getTime())/6e4>g&&v.graphData.columns[0].splice(1,1),v.axis.x.tick.values[2]&&v.axis.x.tick.values[1].getTime()&&v.axis.x.tick.values[2].getTime()-v.axis.x.tick.values[1].getTime()<m.getTime()-v.axis.x.tick.values[v.axis.x.tick.values.length-1]&&(v.axis.x.tick.values.splice(0,1),r.x.lines.splice(0,1),m.setSeconds(0),g>10&&m.setMinutes(m.getMinutes()-m.getMinutes()%5),v.axis.x.tick.values.push(m),r.x.lines.push({value:m,class:"grid4"}))}}var E=null===m||void 0===m?void 0:m.toLocaleString();this.setState({grid:r,graphData:i,lastUpdatedAt:E},function(){if(u){for(var e=[],t=function(t){var n=i[t],r=n.sensedKeys&&n.sensedKeys.length&&s.length>0&&s.filter(function(e){return n.sensedKeys.includes(e.sensedValue)}),o=n.selectedAlarmPoint.sensedValue.length>1?n.selectedAlarmPoint.sensedValue:(null===r||void 0===r?void 0:r.length)>0?r[r.length-1].sensedValue:"";e.push(a.selectAlarmPoint(n,o,!1))},n=0;n<i.length;n++)t(n);a.setState({graphData:e})}})}},t.prototype.changeYAxisSettings=function(e,t){return y(this,void 0,void 0,function(){var a,n,i,r,s,o=this;return b(this,function(u){switch(u.label){case 0:return a=this.state.graphData,(n=a.find(function(t){return t.name==e})).yAxisSettings=t,"Floating"==t?(delete n.axis.y.tick.values,delete n.axis.y.max,delete n.axis.y.min):"Fixed"==t?(delete n.axis.y.tick.values,n.axis.y.max=n.yAxisFixedValues.max,n.axis.y.min=n.yAxisFixedValues.min):(i=this.props.device,r=Object(l.g)(i.moncontype),(s=d.b.find(function(t){return r.toLowerCase().indexOf(t.type.toLowerCase())>-1&&t.name==e}))&&s.value&&(n.axis.y.tick.values=s.value,n.axis.y.min=n.axis.y.tick.values[0],n.axis.y.max=n.axis.y.tick.values[n.axis.y.tick.values.length-1])),[4,this.updateYAxisSettingsDB(e,t,n.axis.y.min,n.axis.y.max)];case 1:return u.sent(),this.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){o.setState({graphData:a.map(function(t){return t.name==e&&(t.loading=!1),t})})}),[2]}})})},t.prototype.changeYaxisMinMax=function(e,t,a,n){var i=this,r=this.state.graphData,s=r.find(function(t){return t.name==e});a?(s.yAxisFixedValues.min=t,s.axis.y.min=t):(s.yAxisFixedValues.max=t,s.axis.y.max=t),n?this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!0),t})},function(){return y(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return delete s.axis.y.tick.values,[4,this.updateYAxisSettingsDB(e,"Fixed",s.axis.y.min,s.axis.y.max)];case 1:return t.sent(),this.setState({graphData:r.map(function(t){return t.name==e&&(t.loading=!1),t})}),[2]}})})}):this.setState({graphData:r})},t.prototype.updateYAxisSettingsDB=function(e,t,a,n){return y(this,void 0,void 0,function(){var i,r,s,u,c,m,p,h,g,d,v,x,y,A=this;return b(this,function(b){switch(b.label){case 0:return i=this.props,r=i.instance,s=i.buildingName,u=i.device,c=i.isEquipment,m=i.equipment,p=this.state.graphYAxisSettings,h="",g="",d="",c?(d="equipment",h=m.ontology,g=m.rdfsLabel):(d="device",h=Object(l.g)(u.moncondevice),g=Object(l.g)(u.rdfsLabel)),v=p.find(function(t){return t.graphName==e}),x=Object(f.E)(12),v&&v.ontology&&(x=v.ontology),y={instance:r,building:s,ontology:x,assetOntology:h,ontologyLabel:g,ontologyAssetType:d,graphName:e,yAxisMax:n,yAxisMin:a,yAxisSettings:t},[4,Object(o.b)(y).then(function(){A.fetchGraphYAxisSettings()})];case 1:return b.sent(),[2]}})})},t.prototype.fetchGraphYAxisSettings=function(){return y(this,void 0,void 0,function(){var e,t,a,n,i,r,s;return b(this,function(u){switch(u.label){case 0:return e=this.props,t=e.buildingName,a=e.isEquipment,n=e.equipment,i=e.device,r=a?n.ontology:Object(l.g)(i.moncondevice),[4,Object(o.a)(t,r)];case 1:return s=u.sent(),this.setState({graphYAxisSettings:s}),[2]}})})},t.prototype.fetchEquipmentFromPoints=function(e,t){var a=this.props.devicePoints,n=Object(),i=[];if(a&&a.length>0)for(var r=function(e){var n=t[e],r=a.find(function(e){return Object(l.g)(e.sensedValue).toLowerCase()==n.toLowerCase()});!r||!Object(l.g)(r.point)||i&&i.length&&i.find(function(e){return e.value==Object(l.g)(r.relatedEquipment)})||i.push({value:Object(l.g)(r.relatedEquipment),label:Object(l.g)(r.relatedEquipmentLabel),space:Object(l.g)(r.relatedEquipmentSpaceLabel)})},s=0;s<t.length;s++)r(s);return n.graph=e,n.pointEquip=i,n},t.prototype._fetchData=function(){var e=this;this.setState({loading:!0},function(){return y(e,void 0,void 0,function(){var e,t,a,n,i,r,u,c,m,p,g,f,v,x,y,A,E,D,w,S,_,O,L,P,N,V,j,k,R,q,F,M,K,G,C,Y,T=this;return b(this,function(b){switch(b.label){case 0:return e=this.props,t=e.device,a=e.from,n=e.to,i=e.showAlarmPoints,r=e.graphsList,u=e.devicePoints,c=e.isEquipment,m=e.equipment,p=e.isGraphLoaded,g=e.showAllGraphs,f=this.state,v=f.grid,x=f.graphData,y=f.lastUpdatedAt,A=f.graphYAxisSettings,E=[],c&&(E=u.filter(function(e){return Object(l.g)(e.relatedEquipment)==m.ontology})),t&&t.moncondevice?(D=Object(l.g)(t.moncontype),w=Object(l.g)(t.topic),S=d.b.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),_=d.c.filter(function(e){return D.toLowerCase().indexOf(e.type.toLowerCase())>-1}),(O=w?w.split(","):[]).length&&O[0]?(L=[],!c||c&&E.length?[4,Object(s.n)(O[0],a,n)]:[3,2]):[3,3]):[3,3];case 1:L=b.sent(),b.label=2;case 2:if(P={EnergySum:[_.find(function(e){return"EnergySum"==e.sensedKey}).des],EnergyPosSum:[_.find(function(e){return"EnergyPosSum"==e.sensedKey}).des],EnergySumNR:[_.find(function(e){return"EnergySumNR"==e.sensedKey}).des],EnergyPosSumNR:[_.find(function(e){return"EnergyPosSumNR"==e.sensedKey}).des],PowerSum:[_.find(function(e){return"PowerSum"==e.sensedKey}).des],PowerA:[_.find(function(e){return"PowerA"==e.sensedKey}).des],PowerB:[_.find(function(e){return"PowerB"==e.sensedKey}).des],PowerC:[_.find(function(e){return"PowerC"==e.sensedKey}).des],VoltA:[_.find(function(e){return"VoltA"==e.sensedKey}).des],VoltB:[_.find(function(e){return"VoltB"==e.sensedKey}).des],VoltC:[_.find(function(e){return"VoltC"==e.sensedKey}).des],VoltAvgLL:[_.find(function(e){return"VoltAvgLL"==e.sensedKey}).des],VoltAB:[_.find(function(e){return"VoltAB"==e.sensedKey}).des],VoltAC:[_.find(function(e){return"VoltAC"==e.sensedKey}).des],VoltBC:[_.find(function(e){return"VoltBC"==e.sensedKey}).des],Freq:[_.find(function(e){return"Freq"==e.sensedKey}).des]},N=["x"],P.EnergySum.push(null),P.EnergyPosSum.push(null),P.EnergySumNR.push(null),P.EnergyPosSumNR.push(null),P.PowerSum.push(null),P.PowerA.push(null),P.PowerB.push(null),P.PowerC.push(null),P.VoltA.push(null),P.VoltB.push(null),P.VoltC.push(null),P.VoltAvgLL.push(null),P.VoltAB.push(null),P.VoltAC.push(null),P.VoltBC.push(null),P.Freq.push(null),N.push(new Date(a)),L.length>0&&L.forEach(function(e){e&&(P.EnergySum.push(e.EnergySum||"0"),P.EnergyPosSum.push(e.EnergyPosSum||"0"),P.EnergySumNR.push(""+ +e.EnergySumNR/1e3||"0"),P.EnergyPosSumNR.push(""+ +e.EnergyPosSumNR/1e3||"0"),P.PowerSum.push(e.PowerSum||"0"),P.PowerA.push(e.PowerA||"0"),P.PowerB.push(e.PowerB||"0"),P.PowerC.push(e.PowerC||"0"),P.VoltA.push(e.VoltA||"0"),P.VoltB.push(e.VoltB||"0"),P.VoltC.push(e.VoltC||"0"),P.VoltAvgLL.push(e.VoltAvgLL||"0"),P.VoltAB.push(e.VoltAB||"0"),P.VoltAC.push(e.VoltAC||"0"),P.VoltBC.push(e.VoltBC||"0"),P.Freq.push(e.Freq||"0"),N.push(new Date(e.timestamp)))}),y=L.length>0?null===(Y=N[N.length-1])||void 0===Y?void 0:Y.toLocaleString():"No Data",P.EnergySum.push(null),P.EnergyPosSum.push(null),P.EnergySumNR.push(null),P.EnergyPosSumNR.push(null),P.PowerSum.push(null),P.PowerA.push(null),P.PowerB.push(null),P.PowerC.push(null),P.VoltA.push(null),P.VoltB.push(null),P.VoltC.push(null),P.VoltAvgLL.push(null),P.VoltAB.push(null),P.VoltAC.push(null),P.VoltBC.push(null),P.Freq.push(null),N.push(new Date(n)),N.length>1){if(V=Object(o.c)(5,a,n),j="",V.length>1?(k=((new Date).getTime()-V[0].getTime())/1e3,j=(k/=3600)>24?"%m-%d %H:%M":k<.3?"%H:%M:%S":"%H:%M"):j="%H:%M:%S",v.x.lines=[],V.forEach(function(e){v.x.lines.push({value:e,class:"grid4"})}),c){for((R=JSON.parse(JSON.stringify(d.a))).name="Wattnode",R.graphData.columns=[N],R.axis.y.tick.format=function(e){return parseFloat(e).toFixed(1)},R.axis.x.tick.format=j,R.axis.x.tick.values=V,R.graphData.x="x",C=0;C<E.length;C++)q=E[C],F=Object(l.g)(q.sensedValue),R.sensedKeys.push(F),R.graphData.columns.push(P[""+F]);S.find(function(e){return e.name==R.name})&&(R.axis.y.tick.values=S.find(function(e){return e.name==R.name}).value,R.axis.y.min=R.axis.y.tick.values[0],R.axis.y.max=R.axis.y.tick.values[R.axis.y.tick.values.length-1]),A&&A.length&&(M=A.find(function(e){return e.graphName==R.name}))&&M.yAxisSettings&&("Fixed"==M.yAxisSettings?(delete R.axis.y.tick.values,R.axis.y.min=M.yAxisMin,R.axis.y.max=M.yAxisMax):"Floating"==M.yAxisSettings&&(delete R.axis.y.tick.values,delete R.axis.y.max,delete R.axis.y.min),R.yAxisSettings=M.yAxisSettings,R.yAxisFixedValues={max:M.yAxisMax,min:M.yAxisMin}),R.graphEquipment=this.fetchEquipmentFromPoints(R.name,R.sensedKeys),x.push(R)}else for(K=function(e){var t=r[e],a=JSON.parse(JSON.stringify(d.a)),n=1,i=[];if(a.name=t,"Power"==t?(a.axis.y.label="Watts",a.sensedKeys=["PowerA","PowerB","PowerC","PowerSum"],i=[N,P.PowerA,P.PowerB,P.PowerC,P.PowerSum]):"Phase Voltage"==t?(n=0,a.axis.y.label="Volts",a.sensedKeys=["VoltAB","VoltBC","VoltAC"],i=[N,P.VoltAB,P.VoltBC,P.VoltAC]):"Voltage"==t?(n=0,a.axis.y.label="Volts",a.sensedKeys=["VoltA","VoltB","VoltC"],i=[N,P.VoltA,P.VoltB,P.VoltC]):"Frequency"==t?(a.axis.y.label="Hz",a.sensedKeys=["Freq"],i=[N,P.Freq]):"Energy Sum Resettable"==t?(a.axis.y.label="MWh",a.sensedKeys=["EnergySumNR"],i=[N,P.EnergySumNR]):"Positive Energy Sum Non-resettable"==t&&(a.axis.y.label="MWh",a.sensedKeys=["EnergyPosSumNR"],i=[N,P.EnergyPosSumNR]),S.find(function(e){return e.name==t})&&(a.axis.y.tick.values=S.find(function(e){return e.name==t}).value,a.axis.y.min=a.axis.y.tick.values[0],a.axis.y.max=a.axis.y.tick.values[a.axis.y.tick.values.length-1]),A&&A.length){var s=A.find(function(e){return e.graphName==t});s&&s.yAxisSettings&&("Fixed"==s.yAxisSettings?(delete a.axis.y.tick.values,a.axis.y.min=s.yAxisMin,a.axis.y.max=s.yAxisMax):"Floating"==s.yAxisSettings&&(delete a.axis.y.tick.values,delete a.axis.y.max,delete a.axis.y.min),a.yAxisSettings=s.yAxisSettings,a.yAxisFixedValues={max:s.yAxisMax,min:s.yAxisMin})}a.axis.y.tick.format=function(e){return parseFloat(e).toFixed(n)},a.axis.x.tick.format=j,a.axis.x.tick.values=V,a.graphData.x="x",a.graphData.columns=i,a.graphEquipment=G.fetchEquipmentFromPoints(t,a.sensedKeys),x.push(a)},G=this,C=0;C<r.length;C++)K(C);this.props.loadNextInsight(),Object(h.h)(O,this.callLiveUpdate),this.setState({grid:v,graphData:x,lastUpdatedAt:y,loading:!1},function(){p(!!g||L.length>0),i&&T.changeAlarmStatus(!0)})}b.label=3;case 3:return[2]}})})})},t.prototype.render=function(){var e=this,t=this.state,a=t.loading,i=t.graphData,s=t.grid,o=t.lastUpdatedAt,u=t.enableYAxis,c=this.props,m=c.instance,p=c.buildingName,h=c.device,g=c.showAlarmPoints,d=c.insightRelEquipment,f=c.showAllGraphs;return a?n.createElement("div",null,n.createElement("div",{className:"col-md-12 padding-5 margin-5"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})))):"No Data"!=o||f?n.createElement(n.Fragment,null,i&&i.length&&i.map(function(t){var a,i,c,f="";return g&&t.alarmStatus&&("active"==t.alarmStatus?f="alarm-graph":"ack"==t.alarmStatus?f="alarm-ack-graph":"clear"==t.alarmStatus&&(f="alarm-clear-ack-graph")),(null===(a=t.graphData.columns)||void 0===a?void 0:a.length)||(null===(i=t.graphDataAlarmPoint.columns)||void 0===i?void 0:i.length)?n.createElement("div",{className:"row col-md-12 m-0 device-graphs "+f,id:"divGraphs"},n.createElement("br",null),(g||u)&&n.createElement("div",{className:"alarm-limit-select"},g&&n.createElement(n.Fragment,null,"Limits For: "," ",t.sensedKeys&&t.sensedKeys.length?n.createElement("select",{className:"alarm-points-list",value:t.selectedAlarmPoint.sensedValue,onChange:function(a){e.selectAlarmPoint(t,a.target.value,!0)}},t.sensedKeys.map(function(e,t){return n.createElement("option",{key:t,value:e},e)})):n.createElement(n.Fragment,null,"No Alarm points created"),t.alarmStatus&&n.createElement("a",{href:"#"+m+"/"+p+"/Alarms/OperationalAlarms/Device/"+Object(l.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},n.createElement("i",{className:"fa fa-info-circle select alarm-icon","aria-hidden":"true"}))),u&&n.createElement("div",{className:"pull-right"},"Y axis: "," ",n.createElement("select",{className:"alarm-points-list",value:t.yAxisSettings,onChange:function(a){e.changeYAxisSettings(t.name,a.target.value)}},n.createElement("option",{key:1,value:"Fixed"}," Fixed "),n.createElement("option",{key:2,value:"Floating"}," Floating "),n.createElement("option",{key:2,value:"Default"}," Default ")),"Fixed"==t.yAxisSettings&&n.createElement(n.Fragment,null,n.createElement("span",{className:"ml-5"},"Min:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.min,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!0,!0)}}),n.createElement("span",{className:"ml-2"},"Max:")," ",n.createElement("input",{type:"number",className:"y-axis-input",value:t.yAxisFixedValues.max,onChange:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!1)},onBlur:function(a){e.changeYaxisMinMax(t.name,+a.target.value,!1,!0)}})))),n.createElement("h5",{className:" no-padding no-margin-color-textalign tooltipDashboard graphHeading "},n.createElement("a",{className:"col-md-5 sentence-break",href:"#"+m+"/"+p+"/Insights/Equipment/Graphs/WattNodeControl/"+Object(l.g)(h.moncondevice),target:"_blank",rel:"noreferrer noopener"},t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned"),n.createElement("span",{className:"col-md-3 sentence-break"},t.name),n.createElement("div",{className:"tooltiptextDashboard"},n.createElement("span",null,"Equipment: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.label}).join(","):"No equipment assigned to data point"," "),n.createElement("br",null),n.createElement("span",null,"Space: ",t.graphEquipment&&t.graphEquipment.pointEquip.length?t.graphEquipment.pointEquip.map(function(e){return e.space}).join(","):"No space for equipment"," "),n.createElement("br",null),n.createElement("span",null,"Floor: ",Object(l.g)(h.floorRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Zone: ",Object(l.g)(h.zoneRdfsLabel)," "),n.createElement("br",null),n.createElement("span",null,"Device Rel. Equip.: ",d.map(function(e,t){return e.rdfsLabel+(t<d.length-1?", ":" ")})," "),n.createElement("br",null),n.createElement("span",null,"Device: ",Object(l.g)(h.rdfsLabel)||"No device assigned"," "),n.createElement("br",null),n.createElement("span",null,"Device Space: ",Object(l.g)(h.spaceRdfsLabel)," ")),n.createElement("span",{className:"sentence-break lastUpdated"},"Last: ",o)),t.loading?n.createElement("div",{className:"row col-md-12 m-0 device-graphs",id:"divGraphs"},n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"}))):n.createElement(r.a,{data:g&&(null===(c=t.graphDataAlarmPoint.columns)||void 0===c?void 0:c.length)>1?t.graphDataAlarmPoint:t.graphData,size:{height:300},axis:t.axis,grid:s,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})):n.createElement(n.Fragment,null)})):n.createElement(n.Fragment,null)},t}(n.Component);t.a=A},2977:function(e,t,a){"use strict";var n=a(2),i=(a.n(n),a(744)),r=a(1014),s=a(772),o=a.n(s),l=a(760),u=(a.n(l),a(715)),c=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),m=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(i,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var a,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{a=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},h=function(e){function t(t){var a=e.call(this,t)||this;return a.state={asisData:[],seasonList:[],graphData1:{x:"Date",columns:[],type:"bar"},grid1:{x:{lines:[{}]},y:{show:!0}},axis1:{x:{type:"timeseries",tick:{count:30,format:"%m-%d"}},y:{label:"kWh",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},graphData2:{x:"Date",columns:[],type:"bar"},grid2:{x:{lines:[{}]},y:{show:!0}},axis2:{x:{type:"timeseries",tick:{count:30,format:"%m-%d"}},y:{label:"kWh",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}},y2:{show:!0,label:"$",tick:{fit:!0,count:6,format:function(e){return parseFloat(e).toFixed(2)}}}},loading:!0,selectedSeason:""},a._fetchData=a._fetchData.bind(a),a}return c(t,e),t.prototype.componentDidMount=function(){return m(this,void 0,void 0,function(){return p(this,function(e){return this._fetchData(),[2]})})},t.prototype.fetchVeifyDetail=function(e){return m(this,void 0,void 0,function(){return p(this,function(e){return[2]})})},t.prototype._fetchData=function(){return m(this,void 0,void 0,function(){var e,t,a=this;return p(this,function(n){switch(n.label){case 0:return e=this.props.buildingName,t=this.props.projectName,[4,Object(i.o)(e,"",t).then(function(e){return m(a,void 0,void 0,function(){var t,a,n,s,o,l,u,c,m,h,g,d,f,v,x=this;return p(this,function(p){switch(p.label){case 0:return e&&e[0]&&e[0].ontology?(t=[],0,0,0,0,a=[],n=e[0],[4,Object(i.l)(n.ontology)]):[3,7];case 1:if(!((s=p.sent())&&s.length>0))return[3,7];for((t=s.sort(function(e,t){return e.seasonSequence>t.seasonSequence?1:t.seasonSequence>e.seasonSequence?-1:0})).map(function(e){var t=e.analysisName+": "+(e.seasonType&&"both"==e.seasonType.toLocaleLowerCase().trim()?e.seasonType+": "+("cooling"==e.selectedAnalysis?"Cooling":"Heating"):e.seasonType);a.push({label:t,value:e.ontology})}),o=0;o<t.length;o++)l=t[o],l.totalConsumedEnergyASIS,l.totalConsumedEnergyECM,l.totalConsumedEnergyCostASIS,l.totalConsumedEnergyCostECM;return 0==n.measureAnalysis.length?n.measureAnalysis=[{staticSeasonName:"Summer",selectedSeasonName:a[0].label,selectedSeasonOntology:a[0].value},{staticSeasonName:"Fall",selectedSeasonName:a[0].label,selectedSeasonOntology:a[0].value},{staticSeasonName:"Winter",selectedSeasonName:a[0].label,selectedSeasonOntology:a[0].value},{staticSeasonName:"Spring",selectedSeasonName:a[0].label,selectedSeasonOntology:a[0].value}]:n.measureAnalysis.length,u=[],c=[],t&&t.length>0?(m=[],h=[],(g=t.sort(function(e,t){return new Date(e.asisStartDate)>new Date(t.asisStartDate)?1:new Date(t.asisStartDate)>new Date(e.asisStartDate)?-1:0}))&&g.length>0?(d=g[0],[4,Object(i.k)(d.importDataASISOntology).then(function(e){u=e?e[0].fileData:[]})]):[3,6]):[3,7];case 2:return p.sent(),[4,Object(i.k)(d.importDataECMOntology).then(function(e){c=e?e[0].fileData:[]})];case 3:return p.sent(),[4,Object(r.c)(u,new Date(d.asisStartDate),new Date(d.asisEndDate),d.noaaStation.value,parseFloat(d.basepointCD),parseFloat(d.basepointHD),d.isMeasureFile)];case 4:return f=p.sent(),[4,Object(r.c)(c,new Date(d.ecmStartDate),new Date(d.ecmEndDate),d.noaaStation.value,parseFloat(d.basepointCD),parseFloat(d.basepointHD),d.isMeasureFile)];case 5:v=p.sent(),m.push.apply(m,f),h.push.apply(h,v),p.label=6;case 6:this.setState({seasonList:t,asisData:u},function(){x.energyConsumptionGraph()}),p.label=7;case 7:return[2]}})})}).catch(function(e){console.log(e)})];case 1:return n.sent(),[2]}})})},t.prototype.energyConsumptionGraph=function(){return m(this,void 0,void 0,function(){var e,t,a,n,i,r,s,o,l,c,m,h,g,d,f,v,x,y,b,A,E,D,w,S;return p(this,function(p){switch(p.label){case 0:e=this.state.asisData,t=this.state,a=t.graphData1,n=t.axis1,i=t.grid1,r=t.graphData2,s=t.axis2,o=t.grid2,l=new Date,c=new Date,l.setMonth(l.getMonth()-1),l.setHours(0,0,0,0),m=["ECM Energy Consumption (Metered)"],h=["Date"],g=["Asis Consumption (Projected)"],d=["Energy Saving"],f=["Energy Savings $ at 10.42 cents per unit"],v=["Tons CO2 emission reduction at 0.000709 tons per unit"],x=new Date(l),p.label=1;case 1:return x<=c?((y=new Date(x)).setHours(23,59,59,0),[4,Object(u.n)("michaels/5_125/wn_basicreg1",x,y,!1)]):[3,4];case 2:b=p.sent(),A=b[0],E=b[b.length-1],A&&E?m.push(""+(E.EnergyPosSum-A.EnergyPosSum)):m.push("0"),h.push(new Date(x)),p.label=3;case 3:return x.setDate(x.getDate()+1),[3,1];case 4:for(D=function(t){var a=new Date(h[t]),n=0;e.filter(function(e){if(+e.Date.split("/")[1]==a.getDate())return e}).forEach(function(e){n+=+e.ValueSum}),g.push(n),i.x.lines.push({value:a,class:"grid4"}),o.x.lines.push({value:a,class:"grid4"})},w=1;w<h.length-1;w++)D(w);for(w=1;w<g.length-1;w++)+g[w]&&+m[w]?(S=+g[w]-+m[w],d.push(S),f.push(.01042*S),v.push(709e-6*S)):(d.push(0),f.push(0));return a={x:"Date",columns:[h,m,g],type:"bar"},r={x:"Date",columns:[h,d,f],groups:[["Energy Saving"]],axes:{"Energy Savings $ at 10.42 cents per unit":"y"},type:"bar",types:{"Energy Savings $ at 10.42 cents per unit":"line"}},n.y.label="KwH",s.y.tick.values=[-2e3,-1e3,0,1e3,2e3],s.y.tick.max=2e3,s.y.tick.min=-2e3,s.y2.tick.values=[-40,-20,0,20,40],s.y2.tick.max=40,s.y2.tick.min=-40,this.setState({loading:!1,graphData1:a,axis1:n,grid1:i,graphData2:r,grid2:o}),[2]}})})},t.prototype.render=function(){var e=this.state,t=e.loading,a=e.graphData1,i=e.grid1,r=e.axis1,s=e.graphData2,l=e.axis2,u=e.grid2;return n.createElement(n.Fragment,null,n.createElement("div",{className:"row col-md-12 device-graphs mt-22 ",id:"divGraphs"},t?n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})):n.createElement(o.a,{data:a,size:{height:500},axis:r,grid:i,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})),n.createElement("div",{className:"row col-md-12 device-graphs mt-22 ",id:"divGraphs"},t?n.createElement("div",{className:"graph-box-loader"},n.createElement("div",{className:"loader center-object"})):n.createElement(o.a,{data:s,size:{height:500},axis:l,grid:u,legend:{position:"bottom"},point:{focus:{expand:{r:3}},r:0}})))},t}(n.Component);t.a=h}});