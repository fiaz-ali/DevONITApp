webpackJsonp([95],{1470:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,c=n(3),i=(n.n(c),n(568)),o=n(26),l=n(87),r=n(872),s=n(17),d=n(18),m=n(575),u=n(45),f=n(845),p=n(14),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),b=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(c,i){function o(e){try{r(a.next(e))}catch(e){i(e)}}function l(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){e.done?c(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,l)}r((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,c,i,o={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(c=2&i[0]?a.return:i[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,i[1])).done)return c;switch(a=0,c&&(i=[2&i[0],c.value]),i[0]){case 0:case 1:c=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(c=(c=o.trys).length>0&&c[c.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!c||i[1]>c[0]&&i[1]<c[3])){o.label=i[1];break}if(6===i[0]&&o.label<c[1]){o.label=c[1],c=i;break}if(c&&o.label<c[2]){o.label=c[2],o.ops.push(i);break}c[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=c=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isEdit:!1,documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},Documents:[],DocumentTypes:f.a,itemToDelete:Object(),files:[]},a=n,n.handleTypeFilters=n.handleTypeFilters.bind(n),n.handleDocumentForm=n.handleDocumentForm.bind(n),n.saveDocument=n.saveDocument.bind(n),n.fetchDocuments=n.fetchDocuments.bind(n),n.onDeleteDocument=n.onDeleteDocument.bind(n),n.deleteDocument=n.deleteDocument.bind(n),n}return h(t,e),t.prototype.componentDidMount=function(){return b(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this.fetchDocuments()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.fetchDocuments=function(){return b(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,Object(r.b)(this.props.buildingName).then(function(e){a.setState({Documents:e})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.handleTypeFilters=function(e){var t=e.target.checked,n=this.state.DocumentTypes;n[n.findIndex(function(t){return t.Type===e.target.value})].visible=t,this.setState({DocumentTypes:n});var a=[],c=f.b;if(c){for(var i=0;i<c.length;i++)for(var o=0;o<n.length;o++)n[o].Type==c[i].Type&&1==n[o].visible&&a.push(c[i]);this.setState({Documents:a})}},t.prototype.saveDocument=function(){return b(this,void 0,void 0,function(){var e,t,n,c,i,s,d,m,f,h=this;return v(this,function(y){switch(y.label){case 0:return e=this.state,t=e.documentObject,n=e.isEdit,c=e.itemToDelete,t&&t.infoEntity?(Object(l.a)(!0),1!=n?[3,2]:[4,Object(r.e)(this.props.buildingName,t,this.state.isEdit,c)]):[3,5];case 1:return y.sent(),[3,4];case 2:return i=JSON.parse(p.a.getItem("user")),t.enteredBy=i.contact,[4,Object(r.e)(this.props.buildingName,t,this.state.isEdit)];case 3:y.sent(),y.label=4;case 4:if(s=new u.b,(d=Object(o.d)())&&d.length)for(m=0;m<d.length;m++)(f=d[m])||(f=d[m].file),f&&s.UploadFile(u.a.COMMUNITYDOCS,t.s3FileName[m],f,function(e,t){e?console.log(e):console.log(t)});this.setState({documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""},files:[],isEdit:!1},function(){return b(h,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,a.fetchDocuments()];case 1:return e.sent(),[2]}})})}),Object(l.a)(!1),y.label=5;case 5:return[2]}})})},t.prototype.onDeleteDocument=function(e){return b(this,void 0,void 0,function(){return v(this,function(t){return this.setState({itemToDelete:e}),[2]})})},t.prototype.deleteDocument=function(){return b(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=this.state.itemToDelete).documentName.value?[4,Object(d.e)(e.documentName.value,o.b.DOCS)]:[3,3];case 1:return t.sent(),[4,this.fetchDocuments()];case 2:t.sent(),Object(r.c)(e.rdfsLabel.value).then(function(t){t&&0==t.length&&(new u.b).DeleteFile(u.a.COMMUNITYDOCS,e.rdfsLabel.value)}),t.label=3;case 3:return[2]}})})},t.prototype.onEditDocument=function(e){return b(this,void 0,void 0,function(){var t;return v(this,function(n){return(t=this.state.documentObject).infoEntity=[],t.documentType=e.documentType&&e.documentType.value,t.rdfsLabel=e.rdfsLabel&&e.rdfsLabel.value,t.documentName=e.documentName&&e.documentName.value,t.enteredBy=e.enteredBy&&e.enteredBy.value,t.enteredByName=e.enteredByName&&e.enteredByName.value,this.setState({documentObject:t,isEdit:!0,itemToDelete:e}),document.getElementById("btnDocumentForm").click(),[2]})})},t.prototype.handleDocumentForm=function(e,t){this.setState({documentObject:e,files:t})},t.prototype.render=function(){var e=this,t=this.state,n=t.Documents,a=t.DocumentTypes,l=t.documentObject,r=(this.props,Object(o.c)()),d=l.rdfsLabel&&(l.s3FileName&&r||l.linkToDocument)&&!0;return c.createElement("div",{className:"content"},c.createElement("div",{className:"container-fluid"},c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement(i.a,{id:"filterDocumentsModal",heading:"Filter Documents",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},a&&a.length>0&&a.map(function(t,n){return!0===t.visible?c.createElement("div",{key:t+"-"+n},c.createElement("input",{checked:!0,type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",c.createElement("label",null,t.Type)):c.createElement("div",null,c.createElement("input",{type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",c.createElement("label",null,t.Type))})),c.createElement("div",{className:"row"},c.createElement("div",{className:"col-md-12"},c.createElement("button",{type:"button",className:"btn btn-dark pull-right","data-toggle":"modal","data-target":"#documentFormDialog",onClick:function(){e.setState({isEdit:!1,files:[],documentObject:{infoEntity:[],enteredBy:"",documentType:"",date:"",documentName:"",rdfsLabel:"",enteredByName:"",s3FileName:[],linkToDocument:""}})}},c.createElement("i",{className:"fa fa-plus"})," Add "))),c.createElement("br",null),c.createElement("div",{className:"card padding-10"},c.createElement("div",{className:""},c.createElement("h4",{className:"title"},"Community Documents")),c.createElement("div",{className:"content"},c.createElement("div",{className:"dataCard"},c.createElement("div",{className:"row hidden-xs no-padding"},c.createElement("div",{className:"col-md-10 col-sm-12  no-padding dataCard"},c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header-left"},"Name"),c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small grid-header"},"Link"),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small grid-header"},"Date"),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small grid-header"},"Entered By")),c.createElement("div",{className:"col-md-1 col-sm-12 headingText"})),n&&n.length>0&&n.map(function(t,n){var a=Object(s.g)(t.linkToDocument);return a=a?a.indexOf("ttp")>0?a:"http://"+a:"",c.createElement("div",{key:t.documentName+"-"+n,className:"row no-padding"},""!=Object(s.g)(t.rdfsLabel)&&c.createElement("div",{className:"no-padding"},c.createElement("div",{className:"col-md-10 col-sm-12  no-padding"},c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.rdfsLabel)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Name"),c.createElement("a",{href:u.c+"/"+u.a.COMMUNITYDOCS+"/"+encodeURIComponent(Object(s.g)(t.s3FileName?t.s3FileName:t.rdfsLabel)),target:"_blank"},Object(s.g)(t.rdfsLabel))),c.createElement("div",{className:"col-md-3 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.linkToDocument)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Link"),c.createElement("a",{href:a,target:"_blank"},a)),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.date)?new Date(Object(s.g)(t.date)).YYMMDDHHMM():""},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Date"),Object(s.g)(t.date)?new Date(Object(s.g)(t.date)).YYMMDDHHMM():""),c.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(s.g)(t.enteredByName)},c.createElement("span",{className:"hidden visible-xs-inline headingText"},"Entered By"),Object(s.g)(t.enteredByName))),c.createElement("div",{className:"col-md-2 col-sm-12 col-xs-12",style:{paddingTop:"3px"}},c.createElement("button",{className:"btn-sm btn-danger active pull-right","data-toggle":"modal","data-target":"#ConfirmDeleteDialog",onClick:function(n){e.onDeleteDocument(t)}},c.createElement("i",{className:"fa fa-trash"})," Delete "))))}),c.createElement("button",{type:"button",id:"btnDocumentForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#documentFormDialog"}," ."),c.createElement(i.a,{id:"documentFormDialog",onSaveButtonClick:function(){e.saveDocument()},saveButtonText:"Save",disableSaveButton:!d}),c.createElement(m.a,{instance:this.props.instance,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this item?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteDocument()}}))))))))},t}(c.Component);t.default=y}});