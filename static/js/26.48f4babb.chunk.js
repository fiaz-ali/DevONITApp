webpackJsonp([26],{2728:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),l=(n.n(a),n(698)),o=n(771),c=n(13),i=n(750),s=n(11),r=n(20),m=n(711),u=n(736),d=n(8),p=n(2729),h=n(2730),f=n(58),b=n(706),g=n.n(b),y=n(57),E=n(21),v=n(704),N=n(718),D=n(719),O=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),T=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,i)}s((a=a.apply(e,t||[])).next())})},w=this&&this.__generator||function(e,t){var n,a,l,o,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(l=(l=c.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){c.label=o[1];break}if(6===o[0]&&c.label<l[1]){c.label=l[1],l=o;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(o);break}l[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},j=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),l=0;for(t=0;t<n;t++)for(var o=arguments[t],c=0,i=o.length;c<i;c++,l++)a[l]=o[c];return a},C=function(e){function t(t){var n=e.call(this,t)||this,a=new Date(new Date(Date.now()).setHours(new Date(Date.now()).getHours()-6)),l=new Date(Date.now());return n.state={isEdit:!1,documentObject:{docOntology:"",entityOntology:[{label:Object(r.z)(n.props.entityName),value:n.props.entityName}],entityType:"",documentType:"",documentSubtype:"",rdfsLabel:"",s3FileName:"",entryTimeStamp:"",enteredBy:"",enteredByName:"",linkToDocument:"",building:"",buildingName:""},OMDocuments:[],DocumentTypes:u.c,itemToDelete:Object(),from:a,to:l,files:[],MediaDocuments:[],ContractDocuments:[],LifeDocuments:[],ProjectDocuments:[],VerifyDocuments:[],WoPoDocuments:[],TaskDocuments:[],InspectionDocuments:[],OtherDocuments:[],_people:[],selectedDurationButton:"All Time",showLogs:!1},n.handleTypeFilters=n.handleTypeFilters.bind(n),n.handleDocumentForm=n.handleDocumentForm.bind(n),n._saveDocument=n._saveDocument.bind(n),n.saveDoc=n.saveDoc.bind(n),n.fetchData=n.fetchData.bind(n),n.handleDurationButton=n.handleDurationButton.bind(n),n.handleFromTimeChange=n.handleFromTimeChange.bind(n),n.handleToTimeChange=n.handleToTimeChange.bind(n),n}return O(t,e),t.prototype.componentDidMount=function(){return T(this,void 0,void 0,function(){return w(this,function(e){return this.props.buildingName&&this.props.infoEntity&&this.props.entityName&&this.fetchData(),[2]})})},t.prototype.fetchData=function(){return T(this,void 0,void 0,function(){var e,t,n,a,l,o,c,r,m,u,d,p,h,b,g,y,E,N;return w(this,function(D){switch(D.label){case 0:return e=this.props,t=e.buildingName,n=e.entityName,a=e.infoEntity,l=[],"Equip"!=a?[3,3]:[4,Object(v.s)(t,n)];case 1:return o=D.sent(),c=[],o.forEach(function(e){c.push(Object(s.g)(e.name))}),[4,Object(i.d)(t,[],j([n],c))];case 2:return l=D.sent(),[3,5];case 3:return[4,Object(i.d)(t,[],[n])];case 4:l=D.sent(),D.label=5;case 5:return l=l.sort(function(e,t){return new Date(Object(s.g)(e.entryTimeStamp))>new Date(Object(s.g)(e.entryTimeStamp))?1:-1}),r=l&&l.length&&l.filter(function(e){return"O&M"==Object(s.g)(e.documentType)}),m=l&&l.length&&l.filter(function(e){return"Media"==Object(s.g)(e.documentType)&&"Equip"==a?"Component"==Object(s.g)(e.entityType)||"Equipment"==Object(s.g)(e.entityType)||"Equip"==Object(s.g)(e.entityType):"Space"==a?"Space"==Object(s.g)(e.entityType):"Zone"==a&&"Zone"==Object(s.g)(e.entityType)}),u=l&&l.length&&l.filter(function(e){return"TaskDoc"==Object(s.g)(e.documentType)&&("Task"==Object(s.g)(e.entityType)||"Component"==Object(s.g)(e.entityType)||"Equipment"==Object(s.g)(e.entityType)||"Equip"==Object(s.g)(e.entityType)||"Space"==Object(s.g)(e.entityType)||"WorkerTaskAttachment"==Object(s.g)(e.entityType)||"Zone"==Object(s.g)(e.entityType)||"ObjectAttachment"==Object(s.g)(e.entityType))}),d=l&&l.length&&l.filter(function(e){return"ContractDoc"==Object(s.g)(e.documentType)}),p=l&&l.length&&l.filter(function(e){return"LifeDoc"==Object(s.g)(e.documentType)}),h=l&&l.length&&l.filter(function(e){return"ProjectDoc"==Object(s.g)(e.documentType)}),b=l&&l.length&&l.filter(function(e){return"VerifyDoc"==Object(s.g)(e.documentType)}),g=l&&l.length&&l.filter(function(e){return"WoPoDoc"==Object(s.g)(e.documentType)}),y=l&&l.length&&l.filter(function(e){return"OtherDoc"==Object(s.g)(e.documentType)}),E=l&&l.length&&l.filter(function(e){return"InspectionDoc"==Object(s.g)(e.documentType)}),[4,Object(f.A)(this.props.buildingName)];case 6:return N=D.sent(),this.setState({OMDocuments:r&&r.length>0?r:[],MediaDocuments:m&&m.length>0?m:[],_people:N,ContractDocuments:d,OtherDocuments:y,LifeDocuments:p,ProjectDocuments:h,VerifyDocuments:b,WoPoDocuments:g,TaskDocuments:u,InspectionDocuments:E}),[2]}})})},t.prototype.handleTypeFilters=function(e){var t=e.target.checked,n=this.state.DocumentTypes;n[n&&n.length>0&&n.findIndex(function(t){return t.Type===e.target.value})].visible=t,this.setState({DocumentTypes:n});var a=[],l=u.d;if(l&&l.length)for(var o=0;o<l.length;o++)for(var c=0;c<(n&&n.length>0&&n.length);c++)n[c].Type==l[o].Type&&1==n[c].visible&&a.push(l[o]);this.setState({OMDocuments:a})},t.prototype.saveDoc=function(e){return T(this,void 0,void 0,function(){var t;return w(this,function(n){switch(n.label){case 0:return t=e&&e.entityOntology&&e.entityOntology.length?e:this.state.documentObject,[4,Object(i.f)(t).then(function(){})];case 1:return n.sent(),[2]}})})},t.prototype._saveDocument=function(){return T(this,void 0,void 0,function(){var e,t,n,a,l,o,i,s=this;return w(this,function(r){switch(r.label){case 0:return e=this.state.documentObject,t=this.props.infoEntity,n=JSON.parse(d.a.getItem("user")),e.enteredBy=n.contact,e.documentType=e.documentSubtype&&-1==e.documentSubtype.indexOf("O&M")?e.documentSubtype:"O&M",e.entityType=t,e.entityOntology&&e.entityOntology.length?(a=new y.b,(l=Object(c.d)())&&l.length?(o=l[0],i=o,[4,a.UploadFile(y.a.DOCUMENT(),e.s3FileName,i,function(t,n){t?Object(E.a)("Attachment failed to upload"):(s.saveDoc(e).then(function(){s.setState({files:[],documentObject:Object()},function(){return T(s,void 0,void 0,function(){return w(this,function(e){return this.fetchData(),[2]})})})}),Object(E.b)("Attachment Uploaded Successfully"))})]):[3,2]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,4];case 3:Object(E.a)("To Upload Attachments, You need to save Form first "),r.label=4;case 4:return[2]}})})},t.prototype.onDeleteDocument=function(e){return T(this,void 0,void 0,function(){return w(this,function(t){return this.setState({itemToDelete:e}),[2]})})},t.prototype.handleDocumentForm=function(e,t){this.setState({documentObject:e,files:t})},t.prototype.handleFromTimeChange=function(e){this.setState({from:e},function(){})},t.prototype.handleToTimeChange=function(e){this.setState({to:e},function(){})},t.prototype.handleDurationButton=function(e){var t=0;switch(e){case"All Time":t=72;break;case"This Year":t=24;break;case"This Month":case"This Week":case"Today":case"Custom":t=6}var n=new Date(new Date(Date.now()).setHours(new Date(Date.now()).getHours()-t)),a=new Date;this.setState({selectedDurationButton:e,from:n,to:a},function(){})},t.prototype.render=function(){var e=this,t=this.state,n=t.DocumentTypes,c=t.documentObject,i=t.OMDocuments,s=t.MediaDocuments,u=t.LifeDocuments,f=t.WoPoDocuments,b=t.OtherDocuments,y=t.VerifyDocuments,E=t.ProjectDocuments,v=t.ContractDocuments,O=t.TaskDocuments,T=t.InspectionDocuments,w=t.selectedDurationButton,j=t.to,C=t.from,S=t.showLogs,x=this.props,k=x.buildingName,F=x.infoEntity,L=x.entityName,_=x.instance,M=JSON.parse(d.a.getItem("user")),B=Object(m.b)(M,"info-equip","write"),I=c&&c.entityOntology&&c.documentSubtype&&c.rdfsLabel&&c.s3FileName&&!0;return S?a.createElement(N.a,{instance:_,buildingName:k,fromEntityList:!0,ontology:L,module:D.a.Assets,entityName:"AssetDocument",onLogClose:function(){return e.setState({showLogs:!1})}}):a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement(l.a,{id:"filterDocumentsModal",heading:"Filter Documents",saveButtonText:"Done",onSaveButtonClick:function(){},disableSaveButton:!1},n&&n.map(function(t,n){return!0===t.visible?a.createElement("div",{key:n},a.createElement("input",{checked:!0,type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",a.createElement("label",null,t.Type)):a.createElement("div",{key:n},a.createElement("input",{type:"checkbox",value:t.Type,onChange:e.handleTypeFilters})," ",a.createElement("label",null,t.Type))})),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement(o.a,{instance:this.props.instance,buildingName:k,tabName:F,itemName:L,showDevicesButton:"Point"==F,showComponentButton:"Equip"==F,showAuditTypes:"Equip"==F||"Space"==F,showBIMButtons:"Equip"==F||"Space"==F}),M&&"1"==M.role&&a.createElement("button",{className:"btn btn-md btn-primary btn-fill pull-right",style:{marginLeft:5},title:"Logs",onClick:function(){e.setState({showLogs:!0})}}," ",a.createElement("img",{src:"assets/img/Logs.png",style:{width:25,height:18}})),B&&a.createElement("button",{type:"button",className:"btn btn-dark pull-right","data-toggle":"modal","data-target":"#documentFormDialog",onClick:function(){e.setState({isEdit:!1,files:[],documentObject:{docOntology:"",entityOntology:[{value:e.props.entityName,label:Object(r.z)(e.props.entityName)}],entityType:"",enteredBy:"",documentType:"",documentSubtype:"",entryTimeStamp:"",rdfsLabel:"",enteredByName:"",s3FileName:"",linkToDocument:"",building:k}})}},a.createElement("i",{className:"fa fa-plus"})," Add "))),a.createElement("br",null),a.createElement("div",{className:"card padding-10"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"header"},a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-2"},a.createElement("h4",{className:"title"},"Documents")),a.createElement("div",{className:"col-md-10"},a.createElement("div",{className:"btn-group",role:"group"},a.createElement("button",{type:"button",className:"btn btn-success "+("All Time"==w?"btn-fill":""),onClick:function(){e.handleDurationButton("All Time")}},"All Time"),a.createElement("button",{type:"button",className:"btn btn-success "+("This Year"==w?"btn-fill":""),onClick:function(){e.handleDurationButton("This Year")}},"This Year"),a.createElement("button",{type:"button",className:"btn btn-success "+("This Month"==w?"btn-fill":""),onClick:function(){e.handleDurationButton("This Month")}},"This Month"),a.createElement("button",{type:"button",className:"btn btn-success "+("This Week"==w?"btn-fill":""),onClick:function(){e.handleDurationButton("This Week")}},"This Week"),a.createElement("button",{type:"button",className:"btn btn-success "+("Today"==w?"btn-fill":""),onClick:function(){e.handleDurationButton("Today")}},"Today"),a.createElement("button",{type:"button",className:"btn btn-success "+("Custom"==w?"btn-fill":""),onClick:function(){e.handleDurationButton("Custom")}},"Custom")),"Custom"==w&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-2 padding-5"},a.createElement("label",null,"From:")),a.createElement("div",{className:"col-md-3"},a.createElement(g.a,{id:"startTime",className:"form-control",selected:C,onChange:function(t){return e.handleFromTimeChange(t)},timeFormat:"HH:mm",timeIntervals:15,showTimeSelect:!0,dateFormat:"yyyy/MM/d h:mm aa",timeCaption:"time"})),a.createElement("div",{className:"col-md-2 padding-5"},a.createElement("label",null,"To:")),a.createElement("div",{className:"col-md-3"},a.createElement(g.a,{id:"startTime",className:"form-control",selected:j,onChange:function(t){return e.handleToTimeChange(t)},timeFormat:"HH:mm",timeIntervals:15,showTimeSelect:!0,dateFormat:"yyyy/MM/d h:mm aa",timeCaption:"time"}))))),a.createElement("br",null)),a.createElement("button",{type:"button",id:"btnDocumentForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#documentFormDialog"}," ."),a.createElement(l.a,{id:"documentFormDialog",onSaveButtonClick:function(){e._saveDocument()},saveButtonText:"Save",disableSaveButton:!I},a.createElement(p.a,{instance:this.props.instance,infoEntity:this.props.infoEntity,buildingName:this.props.buildingName,documentObject:c,handleDocument:this.handleDocumentForm,files:this.state.files})),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapseom",href:"#collapseom"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"O&M ")))),a.createElement("div",{id:"collapseom",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:i,refreshDocs:this.fetchData,listTypeName:"OnM"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapsemedia",href:"#collapsemedia"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Media ")))),a.createElement("div",{id:"collapsemedia",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:s,refreshDocs:this.fetchData,listTypeName:"Media"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapseother",href:"#collapseother"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Other")))),a.createElement("div",{id:"collapseother",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:b,refreshDocs:this.fetchData,listTypeName:"Other"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapsecontractfile",href:"#collapsecontractfile"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Contract File")))),a.createElement("div",{id:"collapsecontractfile",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:v,refreshDocs:this.fetchData,listTypeName:"ContractFile"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapseprojectlifefile",href:"#collapseprojectlifefile"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Project Life File")))),a.createElement("div",{id:"collapseprojectlifefile",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:E,refreshDocs:this.fetchData,listTypeName:"ProjectLifeFile"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapsewopo",href:"#collapsewopo"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"WO/PO File")))),a.createElement("div",{id:"collapsewopo",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:f,refreshDocs:this.fetchData,listTypeName:"WoPoFile"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapseverify",href:"#collapseverify"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Verify File")))),a.createElement("div",{id:"collapseverify",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:y,refreshDocs:this.fetchData,listTypeName:"VerifyFile"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapselife",href:"#collapselife"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Life File")))),a.createElement("div",{id:"collapselife",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:u,refreshDocs:this.fetchData,listTypeName:"LifeFile"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapsetaskchecklist",href:"#collapsetaskchecklist"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Task File")))),a.createElement("div",{id:"collapsetaskchecklist",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:O,refreshDocs:this.fetchData,listTypeName:"TaskFile"})))),a.createElement("div",{className:"panel panel-default row"},a.createElement("div",{className:"panel-heading"},a.createElement("a",{style:{color:"black"},"data-toggle":"collapse",id:"btn-collapseinspection",href:"#collapseinspection"},a.createElement("h4",{className:"panel-title",onClick:function(){}},a.createElement("label",null,"Inspection")))),a.createElement("div",{id:"collapseinspection",className:"padding-10 panel-collapse collapse "},a.createElement("div",{className:"padding-10"},a.createElement(h.a,{instance:_,buildingName:k,Documents:T,refreshDocs:this.fetchData,listTypeName:"Inspection"}))))))))))},t}(a.Component);t.default=C},2729:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(13)),o=n(122),c=n(702),i=n(704),s=n(721),r=n(764),m=n(709),u=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),d=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,i)}s((a=a.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var n,a,l,o,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(l=(l=c.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){c.label=o[1];break}if(6===o[0]&&c.label<l[1]){c.label=l[1],l=o;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(o);break}l[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={documentObject:n.props.documentObject,_infoEntityItems:[],DropDownList:[],documentTypes:l.a,files:[]},n.handleFormChange=n.handleFormChange.bind(n),n.handleMultiInfoEntityChange=n.handleMultiInfoEntityChange.bind(n),n._fetchItems=n._fetchItems.bind(n),n.handlefileAttached=n.handlefileAttached.bind(n),n.handleTitleChange=n.handleTitleChange.bind(n),n}return u(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e=this;return p(this,function(t){return this.props.infoEntity&&this.setState({files:this.props.files},function(){e._fetchItems()}),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({documentObject:e.documentObject,files:e.files})},t.prototype._fetchItems=function(){return d(this,void 0,void 0,function(){var e,t,n;return p(this,function(a){switch(a.label){case 0:if(Object(o.a)(!0),!(e=this.props.infoEntity))return[2];switch(t=[],e){case"Equip":return[3,1];case"Space":return[3,3];case"Zone":return[3,5];case"Point":return[3,7]}return[3,8];case 1:return[4,Object(i.l)(this.props.buildingName)];case 2:return t=a.sent(),[3,8];case 3:return[4,Object(m.b)(this.props.buildingName)];case 4:return t=a.sent(),[3,8];case 5:return[4,Object(s.e)(this.props.buildingName)];case 6:return t=a.sent(),[3,8];case 7:return[3,8];case 8:return n=t.map(function(e){return{value:e.ontology.value,label:e.rdfsLabel.value}}),this.setState({_infoEntityItems:t,DropDownList:n}),Object(o.a)(!1),[2]}})})},t.prototype.handleMultiInfoEntityChange=function(e){var t=this.state.documentObject;t.entityOntology=e,this.setState({documentObject:t})},t.prototype.handleFormChange=function(e){var t=this,n=this.state,a=n.documentObject,l=n.files,o=e.target.name;a[""+o]=e.target.value,this.setState({documentObject:a},function(){t.props.handleDocument(a,l)})},t.prototype.handleTitleChange=function(e){var t=this.state,n=t.documentObject,a=t.files;n.rdfsLabel=e,this.setState({documentObject:n},function(){n.rdfsLabel?document.getElementById("rdfsLabel").style.boxShadow="0px 0px 15px gainsboro":document.getElementById("rdfsLabel").style.boxShadow="0px 0px 15px red"}),this.props.handleDocument(n,a)},t.prototype.handleDueDateChange=function(e){},t.prototype.handlefileAttached=function(e){var t=this,n=this.state.documentObject;if(e.length>0){var a=this.state.files;a||(a=[]);var o=e[0].name.split(".").pop(),c=(new Date).YYMMDDHHMMSS2()+"-"+n.rdfsLabel+"."+o.toLowerCase();c=c.replace(new RegExp(" ","g"),"-"),n.s3FileName=c,Object(l.g)(e),this.setState({files:e,documentObject:n},function(){return d(t,void 0,void 0,function(){return p(this,function(t){return this.props.handleDocument(n,e),[2]})})})}},t.prototype.render=function(){var e=this,t=this.state,n=t.documentObject,l=t.documentTypes,o=t.DropDownList;return a.createElement("div",{className:"content"},!this.props.isCommunityDoc&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"infoEntity"},this.props.infoEntity,":")),a.createElement("div",{className:"col-md-9"},a.createElement(c.a,{id:"infoEntity",name:"infoEntity",closeMenuOnSelect:!1,isMulti:!1,isDisabled:!0,value:n.entityOntology,onChange:this.handleMultiInfoEntityChange,placeholder:"Select "+this.props.infoEntity,options:o})))),this.props.isCommunityDoc&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"name"},"Document Name:")),a.createElement("div",{className:"col-md-9"},a.createElement("input",{id:"name",name:"rdfsLabel",className:"form-control",value:n.rdfsLabel,onChange:function(t){return e.handleFormChange(t)}})))),!this.props.isCommunityDoc&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"rdfsLabel"},"Attachment Label:")),a.createElement("div",{className:"col-md-9"},a.createElement("input",{id:"rdfsLabel",name:"rdfsLabel",className:"form-control",value:n.rdfsLabel,onChange:function(t){e.handleTitleChange(t.target.value)}})))),a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},"\xa0"),a.createElement("div",{className:"col-md-9",onClick:function(){n.rdfsLabel?document.getElementById("rdfsLabel").style.boxShadow="0px 0px 15px gainsboro":document.getElementById("rdfsLabel").style.boxShadow="0px 0px 15px red"}},a.createElement(r.a,{disable:!n.rdfsLabel,handleAttachedFile:this.handlefileAttached,files:this.state.files,single:!0})))),!this.props.isCommunityDoc&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("div",{className:"col-md-3"},a.createElement("label",{htmlFor:"documentSubtype"},"Document Type:")),a.createElement("div",{className:"col-md-9"},a.createElement("select",{className:"form-control",id:"documentSubtype",name:"documentSubtype",onChange:function(t){return e.handleFormChange(t)},value:n.documentSubtype},a.createElement("option",{value:"-1"},"Select Document Type"),l.map(function(e,t){return e.value===n.documentSubtype?a.createElement("option",{key:t,selected:!0,value:e.value},e.label):a.createElement("option",{key:t,value:e.value},e.label)}))))))},t}(a.Component);t.a=h},2730:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(11)),o=n(57),c=n(940),i=n(1126),s=(n.n(i),n(122)),r=n(750),m=n(698),u=n(844),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function c(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,i)}s((a=a.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var n,a,l,o,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(l=(l=c.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){c.label=o[1];break}if(6===o[0]&&c.label<l[1]){c.label=l[1],l=o;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(o);break}l[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},f=function(e){function t(t){var n=e.call(this,t)||this;return n.onPageChanged=function(e){var t=n.props.Documents,a=e.currentPage,l=e.totalPages,o=e.pageLimit,c=(a-1)*o,i=t.slice(c,c+o);n.setState({currentPage:a,currentModelData:i,totalPages:l})},n.state={isOpen:!1,imageurl:"",photoIndex:0,deleteImage:Object(),currentModelData:n.props.Documents?n.props.Documents:[],currentPage:1,totalPages:0,pageLimit:10,docType:""},n.onPageChanged=n.onPageChanged.bind(n),n.deleteFile=n.deleteFile.bind(n),n}return d(t,e),t.prototype.deleteFile=function(e){return p(this,void 0,void 0,function(){var t=this;return h(this,function(n){switch(n.label){case 0:return Object(s.a)(!0),[4,Object(r.a)(Object(l.g)(e.docOntology)).then(function(){(new o.b).DeleteFile(o.a.DOCUMENT(),Object(l.g)(e.s3FileName)),t.props.refreshDocs(),Object(s.a)(!1)})];case 1:return n.sent(),this.setState({deleteImage:Object()}),[2]}})})},t.prototype.urlToBlob=function(e){return fetch(e).then(function(e){return e.blob()})},t.prototype.render=function(){var e=this,t=this.props,n=t.Documents,i=t.listTypeName,s=this.state,r=s.isOpen,d=s.photoIndex,p=s.deleteImage,h=s.currentModelData,f=s.pageLimit,b=s.docType,g=new o.b;return a.createElement("div",{className:"content",id:i},a.createElement("div",{className:"dataCard"},n&&h&&n.length>0?a.createElement(a.Fragment,null,a.createElement("div",{className:"row hidden-xs"},a.createElement("div",{className:"col-sm-12"},a.createElement("div",{className:"col-md-1 small grid-header-left"},"Image "),a.createElement("div",{className:"col-md-2 small grid-header"},"Label "),a.createElement("div",{className:"col-md-3 small grid-header"},"File Name "),a.createElement("div",{className:"col-md-1 small grid-header"},"Extension "),a.createElement("div",{className:"col-md-2 small grid-header"},"Date "),a.createElement("div",{className:"col-md-1 small grid-header"},"Added By "),a.createElement("div",{className:"col-md-2 small grid-header"},"Action"))),h.map(function(t,n){var c=Object(l.g)(t.s3FileName).split(".").pop(),s=Object(l.g)(t.s3FileName),r=g.GetSignedURL(o.a.DOCUMENT(),s),m="",u=s.toLowerCase().indexOf(".mp4")>0||s.toLowerCase().indexOf(".mov")>0,d=s.toLowerCase().indexOf(".pdf")>0,p=s.toLowerCase().indexOf(".png")>0||s.toLowerCase().indexOf(".jpeg")>0||s.toLowerCase().indexOf(".jpg")>0||s.toLowerCase().indexOf(".tiff")>0;s?(u&&(m="assets/img/video-file-icon.png"),d&&(m="assets/img/pdf-file-icon.png"),p&&(m=r),(s.toLowerCase().indexOf(".xls")>0||s.toLowerCase().indexOf(".csv")>0)&&(m="assets/img/excel-file-icon.png"),(s.toLowerCase().indexOf(".docx")>0||s.toLowerCase().indexOf(".txt")>0)&&(m="assets/img/doc-file-icon.png"),""==m&&(m="assets/img/office-file-icon.png")):m=r;var h=u?"video":d?"pdf":"image";return a.createElement("div",{key:t.docOntology+"-"+n},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-sm-12"},a.createElement("div",{className:"col-sm-1 small trim-data",title:Object(l.g)(t.rdfsLabel)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},h),a.createElement("img",{src:m,style:{width:"100%",cursor:"pointer",border:"1px solid lightgray",borderRadius:"3px",padding:"2px"},onClick:function(){e.setState({isOpen:!0,photoIndex:n,docType:h},function(){"video"==h&&document.getElementById("btnvideoFile"+n).click()})}})),a.createElement("div",{className:"col-sm-2 small trim-data",title:Object(l.g)(t.rdfsLabel)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Label"),Object(l.g)(t.rdfsLabel),a.createElement("br",null),""!=Object(l.g)(t.documentSubtype)&&a.createElement("span",{className:"small"},a.createElement("b",null,"Type:"),""!=Object(l.g)(t.documentSubtype)?Object(l.g)(t.documentSubtype):"")),a.createElement("div",{className:"col-sm-3 small trim-data",title:Object(l.g)(t.s3FileName)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"File Name"),Object(l.g)(t.s3FileName)),a.createElement("div",{className:"col-sm-1 trim-data",title:c.toLowerCase()},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Extension"),c.toLowerCase()),a.createElement("div",{className:"col-sm-2 trim-data",title:Object(l.g)(t.entryTimeStamp)?new Date(Object(l.g)(t.entryTimeStamp)).toLocaleString():""},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Date"),""!=Object(l.g)(t.entryTimeStamp)?new Date(Object(l.g)(t.entryTimeStamp)).toLocaleString():""),a.createElement("div",{className:"col-sm-1 trim-data",title:Object(l.g)(t.enteredByName)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Entered By"),""!=Object(l.g)(t.enteredByName)?Object(l.g)(t.enteredByName):Object(l.g)(t.enteredBy)),a.createElement("div",{className:"col-sm-2 small trim-data",title:"Action"},a.createElement("a",{className:"btn no-text-decor",href:g.GetSignedURL(o.a.DOCUMENT(),Object(l.g)(t.s3FileName)),style:{width:32,padding:5}},a.createElement("i",{className:"fa fa-download icn-download"})),"\xa0\xa0",a.createElement("button",{className:"btn btn-danger no-text-decor",style:{cursor:"pointer",width:30,padding:5},onClick:function(){var n=e.state.deleteImage;n=t,e.setState({deleteImage:n},function(){document.getElementById("deleteImageDialogueConfirm_"+i).click()})}},a.createElement("i",{className:"fa fa-trash icn-delete"}))))))}),a.createElement("div",{className:"col-md-12 my-4 center"},a.createElement(u.a,{totalRecords:n.length,pageLimit:f,pageNeighbours:1,onPageChanged:this.onPageChanged}))):a.createElement("div",{className:"set-font-family-poppins"},"\xa0\xa0 No documents"),r&&"image"==b&&a.createElement("div",null,a.createElement(c.a,{mainSrc:g.GetSignedURL(o.a.DOCUMENT(),h&&Object(l.g)(h[d].s3FileName)),imageTitle:h&&Object(l.g)(h[d].s3FileName),onCloseRequest:function(){e.setState({isOpen:!1,photoIndex:0})},onMovePrevRequest:function(){},onMoveNextRequest:function(){}})),r&&a.createElement(a.Fragment,null,a.createElement("button",{id:"btnvideoFile"+d,style:{display:"none"},"data-toggle":"modal","data-target":"#videoFile"+d},"."),a.createElement(m.a,{id:"videoFile"+d,showCancelButton:!0,showSaveButton:!1,heading:h&&Object(l.g)(h[d].s3FileName)},a.createElement("video",{src:g.GetSignedURL(o.a.DOCUMENT(),h&&Object(l.g)(h[d].s3FileName)),controls:!0,width:"100%"},"Sorry, your browser doesn't support embedded videos."))),a.createElement("button",{id:"deleteImageDialogueConfirm_"+i,style:{display:"none"},"data-toggle":"modal","data-target":"#deleteImageDialogue_"+i},"."),a.createElement(m.a,{id:"deleteImageDialogue_"+i,showCancelButton:!0,showSaveButton:!0,heading:"Delete Image",onCancelButtonClick:function(){e.setState({deleteImage:Object()})},onSaveButtonClick:function(){e.deleteFile(p)},saveButtonText:"Ok"},a.createElement("h5",null,"Are you sure want to delete the file? "))))},t}(a.Component);t.a=f}});