webpackJsonp([9],{1214:function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(793)),r=n(22),i=n(1008),l=n(688),c=n(673),s=n.n(c),u=n(1128),m=n.n(u),p=n(970),d=(n.n(p),n(117)),h=n(696),f=n(672),b=n(23),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={graphTab:"graph1",graphTitle:"",graphData:Object(),graphDataForSecondSide:Object(),axis:Object(),axisForSecondSide:Object(),grid:Object(),from:new Date(new Date(Date.now()).setHours(new Date(Date.now()).getHours()-1)),to:new Date(Date.now()),yAxislabel:"",yAxislabelForSecondSide:"",totalGraphs:1},n}return g(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,Promise,function(){var e,t,n,a=this;return y(this,function(o){return e=Object(),t=e={x:{type:"timeseries",tick:{fit:!0,format:"%m-%d %H:%M:%S"},culling:{max:5}},y:{tick:{format:function(e){return e.toFixed(2)}}}},n={x:{show:!0},y:{show:!0}},this.setState({axis:t,grid:n,axisForSecondSide:e},function(){a.loadGraph()}),[2]})})},t.prototype.loadGraph=function(){return v(this,void 0,void 0,function(){var e,t,n,a,o,r;return y(this,function(i){switch(i.label){case 0:return e=this.props.graphType,t=this.state,n=t.graphTab,a=t.from,o=t.to,r=1,Object(d.a)(!0),a&&o?"PTAC"!=e?[3,2]:(r=3,[4,this.getPTACGraph(n)]):[3,7];case 1:return i.sent(),[3,6];case 2:return-1==e.indexOf("Refrigerator")?[3,4]:(r=4,[4,this.getRefrigeratorGraphs(n)]);case 3:return i.sent(),[3,6];case 4:return"RTU"!=e?[3,6]:(r=3,[4,this.getRTUGraph(n)]);case 5:i.sent(),i.label=6;case 6:return this.setState({totalGraphs:r}),[3,8];case 7:Object(b.a)("Please select both dates to display the graph"),i.label=8;case 8:return Object(d.a)(!1),[2]}})})},t.prototype.onChangeGraphTab=function(e){var t=this;this.setState({graphTab:"",graphData:{x:"x",columns:[]},graphDataForSecondSide:{x:"x",columns:[]}},function(){t.setState({graphTab:e},function(){t.loadGraph()})})},t.prototype.getRTUGraph=function(e){return v(this,void 0,void 0,function(){var t,n,a,o,i,c,s,u,m,p,d,f,b,g,v,C,E,T,S,O,N,D,w,x,j,R,M,_,A,I,k,P,F,q,L,B,z,G,U,H,Q,W,V,J,K,X,Z,Y,$,ee,te,ne,ae,oe,re;return y(this,function(y){switch(y.label){case 0:return t=this.props.devices,n=this.state,a=n.from,o=n.to,i=this.state.axis,c="",s="",u={x:"x",columns:[],axes:{}},i={x:{type:"timeseries",tick:{fit:!0,format:"%m-%d %H:%M:%S",count:7},culling:{max:5}},y:{tick:{format:function(e){return e.toFixed(2)}}},y2:{culling:{max:5},position:"outer-middle",default:[0,3],tick:{format:function(e){return e.toFixed(2)}},show:!0}},"graph1"!=e?[3,3]:(c="\xb0F",s="Ceiling Sensor Data",t&&t.length>0&&(m=t.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("ceiling")}))&&m.topic?[4,Object(l.c)(m.topic,a,o,!1)]:[3,2]);case 1:if(p=y.sent(),console.log("data: ",p),d=[],f=[],b=[],g=[],v=[],C=[],E=[],T=[],S=[],O=[],ne=[],p&&p.length>0)for(ae=0;ae<p.length;ae++)N=p[ae],D=N.temp_celsius?Object(r.a)(N.temp_celsius):0,w=N.equiCO2_ppm?N.equiCO2_ppm:0,x=N.relhumidity_pct?N.relhumidity_pct:0,j=N.num_BTdev?N.num_BTdev:0,R=N.altitude_m?N.altitude_m:0,M=N.pressure_hPa?N.pressure_hPa:0,_=N.tvoc_ppm?N.tvoc_ppm:0,A=N.illuminance_lux?N.illuminance_lux:0,I=N.gasResistance_kOhm?N.gasResistance_kOhm:0,k=N.wifiTemp1_celsius?Object(r.a)(N.wifiTemp1_celsius):0,d.push(""+D),f.push(""+w),b.push(""+x),g.push("",+j),v.push(""+R),C.push(""+M),E.push(""+_),T.push(""+A),S.push(""+I),O.push(""+k),ne.push(new Date(N.timestamp));d.unshift("Room Temperature (\xb0F)"),f.unshift("Carbon Dioxide (ppm)"),b.unshift("Humidity (%)"),g.unshift("Bluetooth Devices"),v.unshift("Altitude (m)"),C.unshift("Pressure (hPa)"),E.unshift("TVOC (ppm)"),T.unshift("Illuminance (Lumens)"),S.unshift("Gas Resistance (kOhm)"),O.unshift("WiFi Temperature (\xb0F)"),ne.unshift("x"),u.columns=[d,f,b,g,v,T,S,C,E,ne],i.y2.show=!1,y.label=2;case 2:return[3,8];case 3:return"graph2"!=e?[3,6]:(c="\xb0F",s="Thermostat Data",t&&t.length>0&&(P=t.find(function(e){return"Thermostat"===e.monitoringControlDeviceType})?t.find(function(e){return"Thermostat"===e.monitoringControlDeviceType}):t.find(function(e){return"VenstarThermostat"===e.monitoringControlDeviceType}))&&P.topic?[4,Object(l.G)(P.topic,a,o,!1)]:[3,5]);case 4:if(F=y.sent(),q=[],L=[],B=[],ne=[],z=[],G=[],U=[],H=[],F&&F.length>0)for(ae=0;ae<F.length;ae++)Q=F[ae],W=Q.cooltemp?Q.cooltemp:0,V=Q.heattemp?Q.heattemp:0,J=Q.spacetemp?Q.spacetemp:0,K=Q.mode?Q.mode:0,X=Q.state?Q.state:0,Z=Q.fan?Q.fan:0,Y=Q.fanstate?Q.fanstate:0,q.push(""+W),L.push(""+V),B.push(""+J),z.push(""+K),G.push(""+X),U.push(""+Z),H.push(""+Y),ne.push(new Date(Q.timestamp));q.unshift("Cool setpoint (\xb0F)"),L.unshift("Heat setpoint (\xb0F)"),B.unshift("Space Temp (\xb0F)"),z.unshift("Mode 1: Heat 2: Cool"),G.unshift("State 1: Heat 2: Cool"),U.unshift("Fan 0: Auto 1: On"),H.unshift("Fan State 1: On"),ne.unshift("x"),u.columns=[q,L,B,U,H,z,G,ne],u.axes={Mode:"y2",State:"y2",Fan:"y2","Fan State":"y2"},i.y2.show=!0,y.label=5;case 5:return[3,8];case 6:return"graph3"!=e?[3,8]:($=t.find(function(e){return"CBW418"===e.monitoringControlDeviceType}))&&$.topic?[4,Object(h.h)($.topic,a,o,!1)]:[3,8];case 7:if(ee=y.sent(),te=[],ne=[],ee&&ee.length>0)for(ae=0;ae<ee.length;ae++)oe=ee[ae],re=oe.a13comprcurrRefrigerator1?360*oe.a13comprcurrRefrigerator1:0,te.push(""+re),ne.push(new Date(oe.timestamp));te.unshift("RTU Current (kW)"),ne.unshift("x"),u.columns=[te,ne],i.y2.show=!1,y.label=8;case 8:return i&&i.y&&i.y.label&&(i.y.label=c),this.setState({graphData:u,yAxislabel:c,graphTitle:s,axis:i}),[2]}})})},t.prototype.getPTACGraph=function(e){return v(this,void 0,void 0,function(){var t,n,a,c,s,u,m,p,d,h,f,b,g,v,C,E,T,S,O,N,D,w,x;return y(this,function(y){switch(y.label){case 0:return t=this.props,n=t.buildingName,a=t.solution,c=t.equipment,s=t.devices,u=this.state,m=u.from,p=u.to,d=this.state.axis,h="",f="",b={x:"x",columns:[]},"graph1"!=e?[3,2]:(g=[],N=[],h="\xb0F",f="Set Point Temperature Over Time",[4,Object(i.d)(n,a,c,m,p)]);case 1:if((T=y.sent())&&T.length>0)for(w=0;w<T.length;w++)(x=T[w]).mode==o.c.Cool?g.push(""+x.coolTemp):x.mode==o.c.Heat?g.push(""+x.heatTemp):x.mode==o.c.Off&&g.push("0"),N.push(new Date(x.timestamp));return g.unshift("Set Point Temperature"),N.unshift("x"),b.columns=[g,N],[3,8];case 2:return"graph2"!=e?[3,5]:(h="\xb0F",f="Room Temperature Over Time",s&&s.length>0&&(C=s.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("ceiling")}))&&C.topic?[4,Object(l.c)(C.topic,m,p,!1)]:[3,4]);case 3:if(E=y.sent(),g=[],N=[],E&&E.length>0)for(w=0;w<E.length;w++)D=E[w],v=D.temp_celsius?Object(r.a)(D.temp_celsius):0,g.push(""+v),N.push(new Date(D.timestamp));g.unshift("Room Temperature"),N.unshift("x"),b.columns=[g,N],y.label=4;case 4:return[3,8];case 5:return"graph3"!=e?[3,8]:(h="Room Occupancy",f="Motion Sensor & PTAC Occupancy Over Time",s&&s.length>0&&(C=s.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("ceiling")}))&&C.topic?[4,Object(l.c)(C.topic,m,p,!1)]:[3,8]);case 6:return E=y.sent(),[4,Object(i.d)(n,a,c,m,p)];case 7:if(T=y.sent(),S=[],O=[],N=[],E&&E.length>0)for(w=0;w<E.length;w++)D=E[w],S.push(D&&D.motion_sensed?"1":"0"),N.push(new Date(D.timestamp));if(T&&T.length>0)for(w=0;w<T.length;w++)x=T[w],O.push(x.isRoomOccupied?"UNOCCUPIED"==x.isRoomOccupied?"0":"OCCUPIED"==x.isRoomOccupied?"1":"0.5":"0"),N.push(new Date(x.timestamp));S.unshift("Ceiling Sensor"),O.unshift("PTAC Occupancy Sensor"),N.unshift("x"),b.columns=[S,O,N],y.label=8;case 8:return d&&d.y&&d.y.label&&(d.y.label=h),this.setState({graphData:b,yAxislabel:h,graphTitle:f,axis:d}),[2]}})})},t.prototype.getRefrigeratorGraphs=function(e){return v(this,void 0,void 0,function(){var t,n,a,o,i,c,s,u,m,p,d,b,g,v,C,E,T,S,O,N,D,w,x,j,R,M,_,A,I,k,P,F,q,L,B,z,G,U,H,Q,W,V,J,K,X,Z;return y(this,function(Y){switch(Y.label){case 0:return t=this.props,n=t.devices,a=t.graphType,o=t.solution,i=this.state,c=i.from,s=i.to,u=this.state,m=u.axis,p=u.axisForSecondSide,d="",b="",g="",v={x:"x",columns:[]},C={x:"x",columns:[]},E=n.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("406")}),T=n.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("418")}),S=[],O=[],N=[],D=[],"graph1"!=e?[3,7]:(S=[],O=[],E&&E.topic?[4,Object(h.g)(E.topic,c,s)]:[3,3]);case 1:return N=Y.sent(),[4,Object(f.i)([E.monitoringControlDeviceType])];case 2:S=Y.sent(),Y.label=3;case 3:return T&&T.topic?[4,Object(h.h)(T.topic,c,s)]:[3,6];case 4:return D=Y.sent(),[4,Object(f.i)([T.monitoringControlDeviceType])];case 5:O=Y.sent(),Y.label=6;case 6:if(d="Temperature \xb0F",b="Value",g="Temperature Setting To Pi",V=[],J=[],I=[],k=[],R=[],M=[],N&&N.length>0)for(X=0;X<N.length;X++)(Z=N[X])["t3front"+a]&&V.push(Z["t3front"+a]),Z["t4back"+a]&&J.push(Z["t4back"+a]),Z["t8probe"+a]&&I.push(Z["t8probe"+a]),R.push(new Date(Z.timestamp));if(D&&D.length>0)for(X=0;X<D.length;X++)(Z=D[X])["a13comprcurr"+a]&&k.push(Z["a13comprcurr"+a]),M.push(new Date(Z.timestamp));return V.unshift("T3 Ref Front ("+S.find(function(e){return"t3frontRefrigerator1"==e.sensedValue}).unit+")"),J.unshift("T4 Ref Back ("+S.find(function(e){return"t4backRefrigerator1"==e.sensedValue}).unit+")"),I.unshift("T8 Ref Wax Probe ("+S.find(function(e){return"t8probeRefrigerator1"==e.sensedValue}).unit+")"),k.unshift("A13 Compressor ("+O.find(function(e){return"a13comprcurrRefrigerator1"==e.sensedValue}).unit+")"),R.unshift("x"),M.unshift("x"),v.columns=[V,J,I,R],C.columns=[k,M],[3,25];case 7:return"graph2"!=e?[3,14]:E&&E.topic?[4,Object(h.g)(E.topic,c,s)]:[3,10];case 8:return N=Y.sent(),[4,Object(f.i)([E.monitoringControlDeviceType])];case 9:S=Y.sent(),Y.label=10;case 10:return T&&T.topic?[4,Object(h.h)(T.topic,c,s)]:[3,13];case 11:return D=Y.sent(),[4,Object(f.i)([T.monitoringControlDeviceType])];case 12:O=Y.sent(),Y.label=13;case 13:if(d="Temperature \xb0F",b="Values",g="CBW406 & CBW418 Information",V=[],J=[],I=[],k=[],P=[],F=[],w=[],x=[],j=[],R=[],M=[],N&&N.length>0)for(X=0;X<N.length;X++)(Z=N[X])["t3front"+a]&&V.push(Z["t3front"+a]),Z["t4back"+a]&&J.push(Z["t4back"+a]),Z["t5evapfan"+a]&&I.push(Z["t5evapfan"+a]),Z["t6comprin"+a]&&k.push(Z["t6comprin"+a]),Z["t7comprout"+a]&&P.push(Z["t7comprout"+a]),Z["t8probe"+a]&&F.push(Z["t8probe"+a]),R.push(new Date(Z.timestamp));if(D&&D.length>0)for(X=0;X<D.length;X++)(Z=D[X])["a13comprcurr"+a]&&w.push(Z["a13comprcurr"+a]),Z["a15pr"+a]&&x.push(Z["a15pr"+a]),j.push(parseFloat((120*Math.sqrt(3)*Z.a13comprcurrRefrigerator1).toFixed(2))),M.push(new Date(Z.timestamp));return V.unshift("T3 Ref Front ("+S.find(function(e){return"t3frontRefrigerator1"==e.sensedValue}).unit+")"),J.unshift("T4 Ref Back ("+S.find(function(e){return"t4backRefrigerator1"==e.sensedValue}).unit+")"),I.unshift("T5 Ref Evap Fan ("+S.find(function(e){return"t5evapfanRefrigerator1"==e.sensedValue}).unit+")"),k.unshift("T6 Compressor In ("+S.find(function(e){return"t6comprinRefrigerator1"==e.sensedValue}).unit+")"),P.unshift("T7 Compressor Out ("+S.find(function(e){return"t7comproutRefrigerator1"==e.sensedValue}).unit+")"),F.unshift("T8 Ref Wax Probe ("+S.find(function(e){return"t8probeRefrigerator1"==e.sensedValue}).unit+")"),w.unshift("A13 Compressor ("+O.find(function(e){return"a13comprcurrRefrigerator1"==e.sensedValue}).unit+")"),x.unshift("A15 Pressure Sensor ("+O.find(function(e){return"a15prRefrigerator1"==e.sensedValue}).unit+")"),j.unshift("Amalgamated Watts (watts)"),R.unshift("x"),M.unshift("x"),v.columns=[V,J,I,k,P,F,R],C.columns=[w,x,j,M],[3,25];case 14:return"graph3"!=e?[3,21]:[4,Object(h.v)("",o)];case 15:if(_=Y.sent(),A=[],d="On/Off State",b="Totalized Watt-Hour",g="Relay Pi Information",V=[],J=[],I=[],k=[],P=[],F=[],K=[],!(_&&_.length>0))return[3,20];q=function(e){var t,a,o,r;return y(this,function(i){switch(i.label){case 0:return t=_[e],a=n.find(function(e){return e.deviceName==t.device}),o=Object(),t.deviceMonconType.toLocaleLowerCase().indexOf("i1")>-1?[4,Object(l.f)(a.topic,c,s)]:[3,2];case 1:return o=i.sent(),[3,4];case 2:return t.deviceMonconType.toLocaleLowerCase().indexOf("v4")>-1?[4,Object(l.g)(a.topic,c,s)]:[3,4];case 3:o=i.sent(),i.label=4;case 4:return r={deviceMapModel:t,i1RelayMQTTData:t.deviceMonconType.toLocaleLowerCase().indexOf("i1")>-1?o:null,v4RelayMQTTData:t.deviceMonconType.toLocaleLowerCase().indexOf("v4")>-1?o:null},A.push(r),[2]}})},X=0,Y.label=16;case 16:return X<_.length?[5,q(X)]:[3,19];case 17:Y.sent(),Y.label=18;case 18:return X++,[3,16];case 19:if(L=A.find(function(e){return"Compressor"==e.deviceMapModel.mappingHardware}),B=A.find(function(e){return"EvapFans"==e.deviceMapModel.mappingHardware}),z=A.find(function(e){return"DefrostHeater"==e.deviceMapModel.mappingHardware}),L)if(L.deviceMapModel.deviceMonconType.toLowerCase().indexOf("i1")>-1&&L.i1RelayMQTTData&&L.i1RelayMQTTData.length>0)for(X=0;X<L.i1RelayMQTTData.length;X++)G=L.i1RelayMQTTData[X],V.push(G.i1relay_state&&"1"==G.i1relay_state?1:0),J.push(G.import_active_energy_Wh?parseFloat(G.import_active_energy_Wh):0),K.push(new Date(G.timestamp));else if(L.deviceMapModel.deviceMonconType.toLowerCase().indexOf("v4")>-1&&L.v4RelayMQTTData&&L.v4RelayMQTTData.length>0)for(X=0;X<L.v4RelayMQTTData.length;X++)U=L.v4RelayMQTTData[X],H=Object(r.b)(parseInt(U.v4relay_state),!0),Q=H.split(","),W=parseInt(L.deviceMapModel.devicePointNumber)||1,V.push(Q&&Q.length>0&&L.deviceMapModel.devicePointNumber&&Q[W]&&"1"==Q[W]?1:0),J.push(parseFloat(U["power_Wt_relay"+W])||0),K.push(new Date(U.timestamp));if(B)if(B.deviceMapModel.deviceMonconType.toLowerCase().indexOf("i1")>-1&&B.i1RelayMQTTData&&B.i1RelayMQTTData.length>0)for(X=0;X<B.i1RelayMQTTData.length;X++)G=B.i1RelayMQTTData[X],I.push(G.i1relay_state&&"1"==G.i1relay_state?1:0),k.push(G.import_active_energy_Wh?parseFloat(G.import_active_energy_Wh):0),K.push(new Date(G.timestamp));else if(B.deviceMapModel.deviceMonconType.toLowerCase().indexOf("v4")>-1&&B.v4RelayMQTTData&&B.v4RelayMQTTData.length>0)for(X=0;X<B.v4RelayMQTTData.length;X++)U=B.v4RelayMQTTData[X],H=Object(r.b)(parseInt(U.v4relay_state),!0),Q=H.split(","),W=parseInt(B.deviceMapModel.devicePointNumber)||1,I.push(Q&&Q.length>0&&B.deviceMapModel.devicePointNumber&&Q[W]&&"1"==Q[W]?1:0),k.push(parseFloat(U["power_Wt_relay"+W])||0),K.push(new Date(U.timestamp));if(z)if(z.deviceMapModel.deviceMonconType.toLowerCase().indexOf("i1")>-1&&z.i1RelayMQTTData&&z.i1RelayMQTTData.length>0)for(X=0;X<z.i1RelayMQTTData.length;X++)G=z.i1RelayMQTTData[X],P.push(G.i1relay_state&&"1"==G.i1relay_state?1:0),F.push(G.import_active_energy_Wh?parseFloat(G.import_active_energy_Wh):0),K.push(new Date(G.timestamp));else if(z.deviceMapModel.deviceMonconType.toLowerCase().indexOf("v4")>-1&&z.v4RelayMQTTData&&z.v4RelayMQTTData.length>0)for(X=0;X<z.v4RelayMQTTData.length;X++)U=z.v4RelayMQTTData[X],H=Object(r.b)(parseInt(U.v4relay_state),!0),Q=H.split(","),W=parseInt(z.deviceMapModel.devicePointNumber)||1,P.push(Q&&Q.length>0&&z.deviceMapModel.devicePointNumber&&Q[W]&&"1"==Q[W]?1:0),F.push(parseFloat(U["power_Wt_relay"+W])||0),K.push(new Date(U.timestamp));Y.label=20;case 20:return V.unshift("Compressor Relay State"),J.unshift("Compressor Totalized Watt-Hour"),I.unshift("Evap. Fan Relay State"),k.unshift("Evap. Fan Totalized Watt-Hour"),P.unshift("Defrost Relay State"),F.unshift("Defrost Totalized Watt-Hour"),K.unshift("x"),v.columns=[V,I,P,K],C.columns=[J,k,F,K],[3,25];case 21:return"graph4"!=e?[3,25]:(d="Subcooling",b="Temperature \xb0F",g="Evap Fan and Compressor Out Information",V=[],J=[],K=[],E&&E.topic?[4,Object(h.g)(E.topic,c,s)]:[3,24]);case 22:return N=Y.sent(),[4,Object(f.i)([E.monitoringControlDeviceType])];case 23:S=Y.sent(),Y.label=24;case 24:if(N&&N.length>0)for(X=0;X<N.length;X++)(Z=N[X])["t5evapfan"+a]&&V.push(Z["t5evapfan"+a]),Z["t7comprout"+a]&&J.push(Z["t7comprout"+a]),K.push(new Date(Z.timestamp));V.unshift("T5 Evap Fan ("+S.find(function(e){return"t5evapfanRefrigerator1"==e.sensedValue}).unit+")"),J.unshift("T7 Compressor Out ("+S.find(function(e){return"t7comproutRefrigerator1"==e.sensedValue}).unit+")"),K.unshift("x"),v.columns=[],C.columns=[V,J,K],Y.label=25;case 25:return m&&m.y&&m.y.label&&(m.y.label=d),p&&p.y&&p.y.label&&(p.y.label=b),this.setState({graphData:v,graphDataForSecondSide:C,yAxislabel:d,yAxislabelForSecondSide:b,graphTitle:g,axis:m,axisForSecondSide:p}),[2]}})})},t.prototype.handleTimeChange=function(e,t){t?this.setState({from:e,graphData:{x:"x",columns:[]},graphDataForSecondSide:{x:"x",columns:[]}}):this.setState({to:e,graphData:{x:"x",columns:[]},graphDataForSecondSide:{x:"x",columns:[]}})},t.prototype.render=function(){for(var e=this,t=(this.props,this.state),n=t.graphTab,o=t.totalGraphs,r=t.graphData,i=t.axis,l=t.grid,c=t.from,u=t.to,p=t.axisForSecondSide,d=t.graphDataForSecondSide,h=[],f=1;f<=o;f++)h.push("graph"+f);return a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"btn-group"},h&&h.map(function(t,o){return a.createElement("button",{className:"btn "+(n==t?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.onChangeGraphTab(t)}},a.createElement("span",{className:"vertical-align"},"Graph ",o+1))}))),a.createElement("div",{className:"row mt-5"},a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-3 col-sm-3"},a.createElement("div",{className:"col-md-2 padding-5"},a.createElement("label",null,"From: \xa0")),a.createElement("div",{className:"col-md-10 no-padding"},a.createElement(s.a,{id:"startTime",className:"form-control",selected:c,onChange:function(t){return e.handleTimeChange(t,!0)},timeFormat:"HH:mm",timeIntervals:15,showTimeSelect:!0,dateFormat:"yyyy/MM/d h:mm aa",timeCaption:"time"}))),a.createElement("div",{className:"col-md-3 col-sm-3"},a.createElement("div",{className:"col-md-2 padding-5"},a.createElement("label",null,"To: \xa0")),a.createElement("div",{className:"col-md-10 no-padding"},a.createElement(s.a,{id:"startTime",className:"form-control",selected:u,onChange:function(t){return e.handleTimeChange(t,!1)},timeFormat:"HH:mm",timeIntervals:15,showTimeSelect:!0,dateFormat:"yyyy/MM/d h:mm aa",timeCaption:"time"})))),a.createElement("div",{className:"col-md-6 col-sm-6"},a.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){return e.loadGraph()}},a.createElement("i",{className:"fa fa-bar-chart","aria-hidden":"true"}),"Load Graph"))),a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12 padding-5 margin-5"},a.createElement("div",{className:"row margin-top-25px pdfDiv",id:"DeviceStatusGraph"},n&&r&&r.columns&&r.columns.length>0&&i&&l&&a.createElement(m.a,{data:r,axis:i,unloadBeforeLoad:!0,grid:l,bar:{width:15},style:{height:"550px"},padding:{top:20,right:210,bottom:10,left:50},legend:{show:!0,position:"inset",stroke:"",padding:15,inset:{fill:"transparent",anchor:"top-right",x:-200}}}),n&&d&&d.columns&&d.columns.length>0&&p&&l&&a.createElement(a.Fragment,null,a.createElement("br",null),a.createElement("br",null),a.createElement(m.a,{data:d,height:1e3,axis:p,unloadBeforeLoad:!0,grid:l,bar:{width:15},style:{height:"450px"},padding:{top:20,right:40,bottom:10,left:50}})))))))},t}(a.Component);t.a=C},2700:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),o=n.n(a),r=n(1007),i=n(2701),l=n(117),c=n(22),s=n(696),u=n(2703),m=n(900),p=n(2706),d=n(1388),h=n(10),f=n(123),b=n(2708),g=n(1389),v=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),y=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},C=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={solution:Object(),generatorDevice:Object(),currentEquipment:"",currentEquipmentIndex:0,currentTab:"ControllerGUI",showControllers:[],selectedAssetType:"",selectedAssetLabel:"",selectedComponnet:Object(),selectedDevice:Object(),selectedEquipment:Object(),selectedPoint:Object(),devicesList:[],allRelatedFloors:[],currentFloorTabIndex:0,currentFloorOntology:"",floorOntologies:[],selectedDeviceMappingModel:[],manageControlScreenModel:Object(),ifIsControllerView:!0},n.getSolutionInDetail=n.getSolutionInDetail.bind(n),n.getUnique=n.getUnique.bind(n),n.saveDeviceMappings=n.saveDeviceMappings.bind(n),n}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return e=this.props.solution,Object(c.I)(!1),[4,Promise.all([this.getSolutionInDetail(e)])];case 1:return t.sent(),[2]}})})},t.prototype.getSolutionInDetail=function(e){return y(this,void 0,void 0,function(){var t,n,a,o,r,i,c,u,m,p=this;return C(this,function(d){switch(d.label){case 0:return Object(l.a)(!0),t=this.props.buildingName,n=Object(),[4,Object(s.y)(t,e)];case 1:return a=d.sent(),n=a&&a.length>0&&a[0]?a[0]:Object(),o=JSON.parse(h.a.getItem("user")),[4,Object(f.b)(o.contact)];case 2:if(d.sent(),!n||!n.equipmentTemplatesOntology)return[3,4];if(r=n.equipmentTemplatesOntology.split(","),i=[],c=[],n){if(n.equipmentByTemplate&&n.equipmentByTemplate.length>0&&n.equipmentByTemplate[0])for(u=0;u<n.equipmentByTemplate.length;u++)m=n.equipmentByTemplate[u],i.push({label:m.equipment.rdfsLabel,value:r[u]});n.devices&&n.devices.map(function(e){return c.push(!1)})}return this.setState({solution:n,currentEquipmentIndex:0,currentEquipment:e,showControllers:c},function(){var e="";n.controllerGUI?e="ControllerGUI":n.oneLineGUI?e="SymbolicGUI":n.floorPlanGUI&&(e="SymbolicGUI"),p.setState({currentTab:e})}),this.fetchEquipmentTemplateFromSolution(0),[4,this.fetchControllerScreenSettings(n)];case 3:d.sent(),d.label=4;case 4:return Object(l.a)(!1),[2]}})})},t.prototype.fetchEquipmentTemplateFromSolution=function(e){var t=this;Object(l.a)(!0);var n=this.state.solution;if(n&&n.equipmentByTemplate&&n.equipmentByTemplate.length>0){var a=[],o=Object(),r=n.equipmentByTemplate[e];n&&(n.equipmentByTemplate&&n.equipmentByTemplate.length>0&&(o=n.equipmentByTemplate[e||0].equipment),n.devices&&(a=n.devices)),"Generator"==r.equipment.subclassType&&(o=r.equipment);var i,c=[];o&&o.floor&&c.push(o.floor),a&&a.length>0&&a.map(function(e){return y(t,void 0,void 0,function(){return C(this,function(t){return c.push(e.floor),[2]})})}),i=c[0]||"",this.setState({selectedEquipment:o,devicesList:a,floorOntologies:c,currentFloorOntology:i})}Object(l.a)(!1)},t.prototype.fetchControllerScreenSettings=function(e){return y(this,void 0,void 0,function(){var t,n;return C(this,function(a){switch(a.label){case 0:return Object(l.a)(!0),[4,Object(s.x)(e.ontology)];case 1:return t=a.sent(),n=Object(),n=t&&t.length>0&&t[0]._id?t[0]:Object(s.B)(e),this.setState({manageControlScreenModel:n}),Object(l.a)(!1),[2]}})})},t.prototype.setCollapseIcon=function(e){var t=e.currentTarget.children[0].className;e.currentTarget.children[0].className="fa fa-plus"==t?"fa fa-minus":"fa fa-plus"},t.prototype.getDeviceControllerData=function(e,t,n){var a=this.state.showControllers;a[t]=!n,this.setState({showControllers:a})},t.prototype.saveDeviceMappings=function(e){return y(this,void 0,void 0,function(){var t,n,a=this;return C(this,function(o){switch(o.label){case 0:return t=this.state.devicesList,[4,Object(s.n)(this.props.buildingName,e)];case 1:return o.sent(),n=t,this.setState({devicesList:[]},function(){a.setState({devicesList:n})}),[2]}})})},t.prototype.getUnique=function(){return y(this,void 0,void 0,function(){var e,t,n,a,o,r;return C(this,function(i){switch(i.label){case 0:for(e=this.state.floorOntologies,t=[],n=Object(),a=[],o=0;o<e.length;o++)-1===t.indexOf(e[o])&&t.push(e[o]);if(!(t&&t.length>0))return[3,5];o=0,i.label=1;case 1:return o<t.length?[4,Object(c.z)(t[o])]:[3,4];case 2:r=i.sent(),n={ontology:t[o],name:r},a.push(n),i.label=3;case 3:return o++,[3,1];case 4:this.setState({allRelatedFloors:a,currentFloorOntology:a[0].ontology}),i.label=5;case 5:return[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,a=t.instance,l=this.state,s=l.solution,f=l.currentTab,v=l.selectedEquipment,E=l.devicesList,T=l.allRelatedFloors,S=l.currentFloorTabIndex,O=l.currentFloorOntology,N=l.manageControlScreenModel,D=l.ifIsControllerView,w=v&&v.subclassType&&v.subclassType?v.subclassType:"",x=JSON.parse(h.a.getItem("user")),j=!(!x||"1"!=x.role&&"2"!=x.role);return o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"container-fluid"},o.a.createElement("div",{className:"card",style:{padding:"1vw"}},o.a.createElement("div",{className:"row m-0"},o.a.createElement("div",{className:"col-md-12 p-0"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12 padding-5 margin-5"},o.a.createElement("div",{className:"btn-group"},s.controllerGUI?o.a.createElement("button",{className:"btn "+("ControllerGUI"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"ControllerGUI"}),e.fetchControllerScreenSettings(s)}},o.a.createElement("span",{className:"vertical-align"},"Controller View")):"",s.oneLineGUI?o.a.createElement("button",{className:"btn "+("SymbolicGUI"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"SymbolicGUI"})}},o.a.createElement("span",{className:"vertical-align"},"One-Line View")):"",s.floorPlanGUI?o.a.createElement("button",{className:"btn "+("FloorPlanGUI"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){return y(e,void 0,void 0,function(){var e,t;return C(this,function(n){switch(n.label){case 0:return e=this.setState,t=[{currentTab:"FloorPlanGUI"}],[4,this.getUnique];case 1:return e.apply(this,t.concat([n.sent()])),[2]}})})}},o.a.createElement("span",{className:"vertical-align"},"Floor Plan View")):"",o.a.createElement("button",{className:"btn "+("SolutionDiagram"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"SolutionDiagram"})}},o.a.createElement("span",{className:"vertical-align"},"Diagram")),j&&o.a.createElement("button",{className:"btn "+("ManageControlScreen"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"ManageControlScreen"})}},o.a.createElement("span",{className:"vertical-align"},"Manage Control Screen"))))),"FloorPlanGUI"==f&&o.a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},o.a.createElement("div",{className:"row m-0"},o.a.createElement("div",{className:"col-md-12 padding-5 margin-5"},o.a.createElement("button",{type:"button",title:"Show full view",className:"btn btn-dark btn-fill pull-right",style:{marginRight:10},onClick:function(){window.open("http://"+Object(c.q)()+"/#"+a+"/"+n+"/"+e.props.solution+"/BimSpace/FullScreen","_blank")}},"Show full view"," "),o.a.createElement("div",{className:"btn-group"},T.map(function(t,n){return o.a.createElement("button",{className:"btn "+(S==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){return e.setState({currentFloorTabIndex:n,currentFloorOntology:""},function(){e.setState({currentFloorOntology:t.ontology})})}},o.a.createElement("span",{className:"vertical-align"},t.name))})))),O&&o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement(m.a,{instance:a,buildingName:n,floorOntology:O,isView:!0,isMapper:!1})))),"ControllerGUI"==f&&o.a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},s&&s.equipmentByTemplate&&s.equipmentByTemplate.map(function(t,r){var l=N&&N.manageControlScreenDetails&&N.manageControlScreenDetails.length>0&&N.manageControlScreenDetails.find(function(e){return e?e.equipment:""==t.equipment.equipmentName})?N.manageControlScreenDetails.find(function(e){return e?e.equipment:""==t.equipment.equipmentName}):Object();if("Refrigerator"==t.equipment.subclassType)return o.a.createElement("div",{className:"row m-0 padding-10"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"panel-heading",style:{backgroundColor:"#174b54",color:"white",borderRadius:"5px"}},o.a.createElement("h4",{className:"panel-title"},o.a.createElement("div",null,o.a.createElement("span",{style:{marginLeft:"15px"}},t.equipment.rdfsLabel),o.a.createElement("a",{className:"icn-collapse pull-right color-white","data-toggle":"collapse",id:"btn-collapse-ref"+(r+1),href:"#collapse-ref"+(r+1),onClick:function(t){e.setCollapseIcon(t)}},o.a.createElement("i",{className:"fa fa-minus"}))))),o.a.createElement("div",{id:"collapse-ref"+(r+1),className:"panel-collapse collapse in"},o.a.createElement("div",{className:"panel-body"},o.a.createElement("div",{style:{height:"auto"}},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},E&&E.length>0&&o.a.createElement(i.a,{instance:a,buildingName:n,devices:E,solutionOntology:s.ontology,equipmentOntology:t.equipment.equipmentName,equipmentLRdfsLabel:t.equipment.rdfsLabel,compressorBox:r+1,controlScreenSettings:l})))))))));if("PTAC"==t.equipment.subclassType){var c=N&&N.manageControlScreenDetails&&N.manageControlScreenDetails.length>0&&N.manageControlScreenDetails.find(function(e){return e.equipment==t.equipment.equipmentName})?N.manageControlScreenDetails.find(function(e){return e.equipment==t.equipment.equipmentName}):Object();return o.a.createElement("div",{className:"row m-0 padding-10"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"panel-heading",style:{backgroundColor:"#174b54",color:"white",borderRadius:"5px"}},o.a.createElement("h4",{className:"panel-title"},o.a.createElement("div",null,o.a.createElement("span",{style:{marginLeft:"15px"}},t.equipment.rdfsLabel),o.a.createElement("a",{className:"icn-collapse pull-right color-white","data-toggle":"collapse",id:"btn-collapse-ref"+(r+1),href:"#collapse-ref"+(r+1),onClick:function(t){e.setCollapseIcon(t)}},o.a.createElement("i",{className:"fa fa-minus"}))))),o.a.createElement("div",{id:"collapse-ref"+(r+1),className:"panel-collapse collapse in"},o.a.createElement("div",{className:"panel-body"},o.a.createElement("div",{style:{height:"auto"}},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},E&&E.length>0&&o.a.createElement(p.a,{controllerScreenSettings:c,instance:a,buildingName:n,solutionOntology:s.ontology,devices:E,equipmentOntology:t.equipment.equipmentName,equipmentRdfsLabel:t.equipment.rdfsLabel,isDataCapture:t.equipment.isDataCapture})))))))))}return"RTU"==t.equipment.subclassType?o.a.createElement("div",{className:"row m-0 padding-10"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"panel-heading",style:{backgroundColor:"#174b54",color:"white",borderRadius:"5px"}},o.a.createElement("h4",{className:"panel-title"},o.a.createElement("div",null,o.a.createElement("span",{style:{marginLeft:"15px"}},t.equipment.rdfsLabel),o.a.createElement("a",{className:"icn-collapse pull-right color-white","data-toggle":"collapse",id:"btn-collapse-ref"+(r+1),href:"#collapse-ref"+(r+1),onClick:function(t){e.setCollapseIcon(t)}},o.a.createElement("i",{className:"fa fa-minus"}))))),o.a.createElement("div",{id:"collapse-ref"+(r+1),className:"panel-collapse collapse in"},o.a.createElement("div",{className:"panel-body"},o.a.createElement("div",{style:{height:"auto"}},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},E&&E.length>0&&o.a.createElement(b.a,{controllerScreenSettings:l,buildingName:n,instance:a,Devices:E,solutionOntology:s.ontology,equipmentOntology:t.equipment.equipmentName,equipmentRdfsLabel:t.equipment.rdfsLabel}))))))))):void 0})),"SymbolicGUI"==f&&o.a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},"Generator"==w&&o.a.createElement(u.a,{building:n,instance:a,devices:s.devices,ontology:v&&v.equipmentName?v.equipmentName:"",solutionOntology:s.ontology})))),"SolutionDiagram"==f&&o.a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"5px",minHeight:"700px"}},o.a.createElement(r.a,{buildingName:n,instance:a,SolutionName:"",solution:s,isFullScreenHeight:!1,isRefreshButtonShow:!1})),"ManageControlScreen"==f&&o.a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"5px",minHeight:"700px"}},o.a.createElement(d.a,{buildingName:n,instance:a,solution:s,isView:!1})),o.a.createElement("br",null),o.a.createElement("div",{className:"row m-0"},o.a.createElement("div",{className:"col-md-12 p-0"},o.a.createElement("div",{className:"panel-heading",style:{backgroundColor:"#174b54",color:"white",borderRadius:"5px"}},o.a.createElement("h4",{className:"panel-title"},o.a.createElement("div",null,o.a.createElement("span",{style:{marginLeft:"15px"}},"Devices"),o.a.createElement("a",{className:"icn-collapse pull-right color-white","data-toggle":"collapse",id:"btn-collapse1",href:"#collapse1",onClick:function(t){e.setCollapseIcon(t)}},o.a.createElement("i",{className:"fa fa-minus"}))))),o.a.createElement("div",{id:"collapse1",className:"panel-collapse collapse in"},o.a.createElement(g.a,{instance:a,buildingName:n,devicesList:E,solution:s,ifIsControllerView:D,isFromSolution:!0,saveMappings:this.saveDeviceMappings})))))))))},t}(o.a.Component);t.default=E},2701:function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(736)),r=n(23),i=n(117),l=n(793),c=n(694),s=n(22),u=n(696),m=n(10),p=n(688),d=n(899),h=n(2702),f=n(901),b=n(1214),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},y=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isDefrost:!1,currentTabs:"InnerControllerGUI",cbw406Model:Object(),cbw418Model:Object(),compressorADPDB:Object(),spaceTemp:0,compressorController:Object(),modelChanged:!1,intervalId:Object(),modelChangedState:"",device418:Object(),device406:Object(),compressorMapDevice:Object(),evapFanMapDevice:Object(),defrostMapDevice:Object(),deviceMappingModels:[],deviceMappingMQTTModel:[],compressorRelayDemandingRunningStatus:0,evapRelayDemandingRunningStatus:0,defrostRelayDemandingRunningStatus:0,compressorRelayRunningStatus:0,evapRelayRunningStatus:0,defrostRelayRunningStatus:0,evapRelayAmps:0,connectedComputingDevice:Object(),spaceTempWeights:Object()},n.fetchCompressorControllerDetails=n.fetchCompressorControllerDetails.bind(n),n.fetchDeviceData=n.fetchDeviceData.bind(n),n.fetchCompressorMQTTData=n.fetchCompressorMQTTData.bind(n),n.fetchADPValues=n.fetchADPValues.bind(n),n.getSpaceTemp=n.getSpaceTemp.bind(n),n.setIntervalStart=n.setIntervalStart.bind(n),n.changeControl=n.changeControl.bind(n),n.changeEvaporatorFan=n.changeEvaporatorFan.bind(n),n.changeCompressorState=n.changeCompressorState.bind(n),n.changeTemperature=n.changeTemperature.bind(n),n.saveChanges=n.saveChanges.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){var e,t;return y(this,function(n){switch(n.label){case 0:return Object(i.a)(!0),[4,this.fetchDeviceData()];case 1:return e=n.sent(),t=this.props.equipmentLRdfsLabel,e.device406&&e.device406.deviceName||Object(r.a)("No CBW406 device added to "+t),e.device418&&e.device418.deviceName||Object(r.a)("No CBW418 device added to "+t),[4,Promise.all([this.fetchADPValues(),this.fetchCompressorControllerDetails(),this.fetchCompressorMQTTData(e.device406,e.device418),this.fetchDeviceMapping()])];case 2:return n.sent(),this.setIntervalStart(),Object(i.a)(!1),[2]}})})},t.prototype.componentWillUnmount=function(){var e=this.state.intervalId;e&&clearInterval(e),this.setState({intervalId:Object()})},t.prototype.resetData=function(){return v(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return Object(i.a)(!0),[4,Promise.all([this.fetchADPValues(),this.cancelClick()])];case 1:return e.sent(),Object(i.a)(!1),[2]}})})},t.prototype.cancelClick=function(){return v(this,void 0,void 0,function(){var e,t,n;return y(this,function(a){switch(a.label){case 0:return e=this.state,t=e.device406,n=e.device418,Object(i.a)(!0),[4,Promise.all([this.fetchCompressorControllerDetails(),this.fetchCompressorMQTTData(t,n),this.getRelayMQTTData()])];case 1:return a.sent(),Object(i.a)(!1),[2]}})})},t.prototype.fetchCompressorControllerDetails=function(){return v(this,void 0,void 0,function(){var e,t,n,a,o,r,i,c;return y(this,function(m){switch(m.label){case 0:return e=this.props,t=e.buildingName,n=e.solutionOntology,a=e.equipmentOntology,[4,Object(u.u)(t,"",n,a)];case 1:return o=m.sent(),[4,Object(u.q)(o)];case 2:return(r=m.sent())&&r.length>0?this.setState({compressorController:r[0]}):(i=this.state.compressorADPDB,c={ontology:Object(s.y)(12),solutionOntology:n,compressorTemperature:i&&i.LowTemp?i.LowTemp:0,defrostControl:l.a.Local,equipment:a,inhibitControl:l.a.Local,isDefrost:!1,isEvaporatorFanAuto:!0},this.setState({compressorController:c})),[2]}})})},t.prototype.fetchDeviceData=function(){return v(this,void 0,void 0,function(){var e,t,n;return y(this,function(a){return e=this.props.devices,t=Object(),n=Object(),e&&e.length>0&&(n=e.find(function(e){return"cbw418"==e.monitoringControlDeviceType.toLocaleLowerCase()}),t=e.find(function(e){return"cbw406"==e.monitoringControlDeviceType.toLocaleLowerCase()})),this.setState({device418:n,device406:t}),[2,{device406:t,device418:n}]})})},t.prototype.fetchCompressorMQTTData=function(e,t){return v(this,void 0,void 0,function(){var n,a,o=this;return y(this,function(i){switch(i.label){case 0:return n=Object(),a=Object(),e&&e.topic?[4,Object(u.g)(e.topic,new Date,new Date,!0).then(function(t){return!t||t&&t.error?(Object(r.a)("Error occurred while fetching CBW board info."),Object()):(t[t.length-1]&&localStorage.setItem(e.deviceID,JSON.stringify(t[t.length-1])),t[t.length-1])}).catch(function(e){return Object()})]:[3,2];case 1:n=i.sent(),i.label=2;case 2:return t&&t.topic?[4,Object(u.h)(t.topic,new Date,new Date,!0).then(function(e){return!e||e&&e.error?(Object(r.a)("Error occurred while fetching CBW board info."),Object()):(e[e.length-1]&&localStorage.setItem(t.deviceID,JSON.stringify(e[e.length-1])),e[e.length-1])}).catch(function(e){return Object()})]:[3,4];case 3:a=i.sent(),i.label=4;case 4:return this.setState({cbw406Model:n,cbw418Model:a,modelChanged:!1,modelChangedState:""},function(){o.getSpaceTemp()}),[2]}})})},t.prototype.fetchADPValues=function(){return v(this,void 0,void 0,function(){var e,t,n,a,o,r=this;return y(this,function(i){switch(i.label){case 0:return e=this.props,t=e.buildingName,n=e.solutionOntology,a=e.equipmentOntology,[4,Object(p.o)(t,"",a,n)];case 1:return o=i.sent(),this.setState({compressorADPDB:o},function(){r.getSpaceTemp()}),[2]}})})},t.prototype.fetchDeviceMapping=function(){return v(this,void 0,void 0,function(){var e,t,n=this;return y(this,function(a){switch(a.label){case 0:return e=this.props.solutionOntology,Object(i.a)(!0),[4,Object(u.v)("",e)];case 1:return t=a.sent(),this.setState({deviceMappingModels:t},function(){n.getRelayMQTTData()}),Object(i.a)(!1),[2]}})})},t.prototype.getRelayMQTTData=function(){return v(this,void 0,void 0,function(){var e,t,n,a,o,r,i,l,s,u,m,d,h,f,b,g,v,C,E,T,S,O,N;return y(this,function(D){switch(D.label){case 0:if(e=this.state.deviceMappingModels,t=this.props,n=t.devices,a=t.equipmentOntology,o=[],r="-1",i="-1",l="-1",s="-1",u="-1",m="-1",d="-1",h=Object(),f=Object(),b=Object(),g=Object(),!(e&&e.length>0))return[3,5];v=function(t){var r,i,l,c;return y(this,function(s){switch(s.label){case 0:return r=e[t],i=n.find(function(e){return e.deviceName==r.device}),l=Object(),r.deviceMonconType.toLocaleLowerCase().indexOf("i1")>-1&&r.equipment==a?[4,Object(p.f)(i.topic,new Date,new Date,!0)]:[3,2];case 1:return l=s.sent(),[3,4];case 2:return r.deviceMonconType.toLocaleLowerCase().indexOf("v4")>-1&&r.equipment==a?[4,Object(p.g)(i.topic,new Date,new Date,!0)]:[3,4];case 3:l=s.sent(),s.label=4;case 4:return c={deviceMapModel:r,i1RelayMQTTData:r.deviceMonconType.toLocaleLowerCase().indexOf("i1")>-1&&r.equipment==a?l:[],v4RelayMQTTData:r.deviceMonconType.toLocaleLowerCase().indexOf("v4")>-1&&r.equipment==a?l:[]},o.push(c),[2]}})},C=0,D.label=1;case 1:return C<e.length?[5,v(C)]:[3,4];case 2:D.sent(),D.label=3;case 3:return C++,[3,1];case 4:o&&o.length>0&&(h=o.find(function(e){return"Compressor"==e.deviceMapModel.mappingHardware&&e.deviceMapModel.equipment==a}),f=o.find(function(e){return"EvapFans"==e.deviceMapModel.mappingHardware&&e.deviceMapModel.equipment==a}),b=o.find(function(e){return"DefrostHeater"==e.deviceMapModel.mappingHardware&&e.deviceMapModel.equipment==a}),h&&h.deviceMapModel.deviceMonconType.toLowerCase().indexOf("i1")>-1&&h.deviceMapModel.equipment==a?(T=h.i1RelayMQTTData[h.i1RelayMQTTData.length-1])?(r=T.i1relay_demand_state?T.i1relay_demand_state:"0",s=T.i1relay_state?T.i1relay_state:"0"):s="-2":h&&h.deviceMapModel.deviceMonconType.toLowerCase().indexOf("v4")>-1&&h.deviceMapModel.equipment==a&&((T=h.v4RelayMQTTData[h.v4RelayMQTTData.length-1])?(r=T.i1relay_demand_state?T.i1relay_demand_state:"0",s=T.v4relay_state?T.v4relay_state:"0"):s="-2"),f&&f.deviceMapModel.deviceMonconType.toLowerCase().indexOf("i1")>-1&&f.deviceMapModel.equipment==a?(T=f.i1RelayMQTTData[f.i1RelayMQTTData.length-1])?(i=T.i1relay_demand_state?T.i1relay_demand_state:"0",u=T.i1relay_state?T.i1relay_state:"0",d=T.current_Amperes?T.current_Amperes:"0"):u="-2":f&&f.deviceMapModel.deviceMonconType.toLowerCase().indexOf("v4")>-1&&f.deviceMapModel.equipment==a&&((T=f.v4RelayMQTTData[f.v4RelayMQTTData.length-1])?(i=T.i1relay_demand_state?T.i1relay_demand_state:"0",u=T.v4relay_state?T.v4relay_state:"0",E=f.deviceMapModel.devicePointNumber,d=T["mAmps_relay"+E]?T["mAmps_relay"+E]:"0"):u="-2"),b&&b.deviceMapModel.deviceMonconType.toLowerCase().indexOf("i1")>-1&&b.deviceMapModel.equipment==a?(T=b.i1RelayMQTTData[b.i1RelayMQTTData.length-1])?(l=T.i1relay_demand_state?T.i1relay_demand_state:"0",m=T.i1relay_state?T.i1relay_state:"0"):m="-2":b&&b.deviceMapModel.deviceMonconType.toLowerCase().indexOf("v4")>-1&&b.deviceMapModel.equipment==a&&((T=b.v4RelayMQTTData[b.v4RelayMQTTData.length-1])?(l=T.i1relay_demand_state?T.i1relay_demand_state:"0",m=T.v4relay_state?T.v4relay_state:"0"):m="-2")),D.label=5;case 5:return h&&h.deviceMapModel&&h.deviceMapModel.device&&(S=h&&h.deviceMapModel&&h.deviceMapModel.computingDevice)?[4,Object(c.f)(S)]:[3,8];case 6:return O=D.sent(),[4,Object(c.d)(O)];case 7:(N=D.sent())&&N.length>0&&(g=N[0]),D.label=8;case 8:return this.setState({deviceMappingMQTTModel:o,compressorRelayDemandingRunningStatus:parseInt(r),evapRelayDemandingRunningStatus:parseInt(i),defrostRelayDemandingRunningStatus:parseInt(l),compressorRelayRunningStatus:parseInt(s),evapRelayRunningStatus:parseInt(u),defrostRelayRunningStatus:parseInt(m),evapRelayAmps:parseInt(d),compressorMapDevice:h,evapFanMapDevice:f,defrostMapDevice:b,connectedComputingDevice:g}),[2]}})})},t.prototype.getSpaceTemp=function(){var e=this.props.compressorBox,t=this.state,n=t.compressorADPDB,a=t.cbw406Model,o=0,r={back:0,front:0,solid:0};if(n&&n.equipment&&a&&a.device_Name){var i=a["t3frontRefrigerator"+e],l=a["t4backRefrigerator"+e],c=a["t8probeRefrigerator"+e];o=i*((r=i?l?c?{back:n.BackTempWeight,front:n.FrontTempWeight,solid:n.SolidTempWeight}:{back:50,front:50,solid:0}:c?{back:0,front:50,solid:50}:{back:0,front:100,solid:0}:l?c?{back:50,front:0,solid:50}:{back:100,front:0,solid:0}:c?{back:0,front:0,solid:100}:{back:0,front:0,solid:0}).front/100)+l*(r.back/100)+c*(r.solid/100),Object(s.n)(new Date(a.timestamp),new Date)>=20&&n.MedianTemp&&(o=n.MedianTemp)}this.setState({spaceTemp:o,spaceTempWeights:r})},t.prototype.setIntervalStart=function(){var e=this,t=0;this.state.intervalId&&clearInterval(this.state.intervalId);var n=setInterval(function(){t++;var n=e.state,a=n.modelChanged,o=n.device406,r=n.device418;!a&&t>=5&&(t=0,"InnerControllerGUI"==e.state.currentTabs&&(e.fetchCompressorControllerDetails(),e.fetchCompressorMQTTData(o,r),e.getRelayMQTTData()))},1e3);this.setState({intervalId:n})},t.prototype.changeTemperature=function(e,t){var n=this.state,a=n.compressorController,o=n.compressorADPDB;a&&o&&(t||(t=e?o.LowTemp:o.HighTemp),e?(a.compressorTemperature=t-.1,a.compressorTemperature<o.LowTemp&&(a.compressorTemperature=o.LowTemp)):(a.compressorTemperature=t+.1,a.compressorTemperature>o.HighTemp&&(a.compressorTemperature=o.HighTemp)),this.setState({compressorController:a,modelChanged:!0,modelChangedState:"setpointtemperature"}))},t.prototype.changeEvaporatorFan=function(e){var t=this.state.compressorController;t.isEvaporatorFanAuto=e,this.setState({compressorController:t,modelChanged:!0,modelChangedState:"evapfan"})},t.prototype.changeControl=function(e,t){return v(this,void 0,void 0,function(){var n,a,o;return y(this,function(r){switch(r.label){case 0:return n=this.props.equipmentOntology,a=this.state.compressorController,e?a.defrostControl=t:a.inhibitControl=t,(o=Object()).equipmentOntology=n,o.isScheduleOn=t==l.a.Schedule,Object(i.a)(!0),[4,Object(p._0)(o)];case 1:return r.sent(),Object(i.a)(!1),this.setState({compressorController:a,modelChanged:!0,modelChangedState:"controlstate"}),[2]}})})},t.prototype.changeCompressorState=function(e){var t=this.state.compressorController;t.isDefrost=e,this.setState({compressorController:t,modelChanged:!0,modelChangedState:"controlstatedefroststate"})},t.prototype.saveChanges=function(){return v(this,void 0,void 0,function(){var e,t,n,a,o,s,m,d,h,f,b,g,v,C,E,T,S,O,N,D,w,x,j,R,M,_,A,I,k,P,F,q,L,B,z;return y(this,function(y){switch(y.label){case 0:return e=this.props,t=e.buildingName,n=e.solutionOntology,a=e.equipmentOntology,o=e.devices,s=e.compressorBox,m=e.controlScreenSettings,d=e.equipmentLRdfsLabel,h=this.state,f=h.modelChanged,b=h.compressorController,g=h.compressorADPDB,v=h.modelChangedState,C=h.deviceMappingModels,E=h.spaceTempWeights,Object(i.a)(!0,"Saving Refrigerator State"),[4,Object(u.u)(t,"",n,"")];case 1:return T=y.sent(),[4,Object(u.q)(T)];case 2:for(S=y.sent(),O=!1,N=0;N<S.length;N++)(D=S[N]).equipment&&(D.equipment==a&&(D=b),D.inhibitControl!=l.a.Schedule&&D.defrostControl!=l.a.Schedule||O||(O=!0));return f?(w=Object(),x="1",j="i1",R=!0,M="","setpointtemperature"==v||"controlstate"==v?C.find(function(e){return"Compressor"==e.mappingHardware&&e.equipment==a})?(_=C.find(function(e){return"Compressor"==e.mappingHardware}),o.find(function(e){return e.deviceName==_.device})?(w=o.find(function(e){return e.deviceName==_.device}),x=_.devicePointNumber,k=_.deviceMonconType.toLocaleLowerCase(),j=k.indexOf("i1")>-1?"i1":k.indexOf("v4")>-1?"v4":k.indexOf("signal")>-1?"wsh":"",M="compressor"):(Object(r.a)("No Device is not mapped to Compressor for "+d+"."),R=!1)):(Object(r.a)("No Device is not mapped to Compressor for "+d+"."),R=!1):"evapfan"==v?C.find(function(e){return"EvapFans"==e.mappingHardware&&e.equipment==a})?(A=C.find(function(e){return"EvapFans"==e.mappingHardware}),o.find(function(e){return e.deviceName==A.device})?(w=o.find(function(e){return e.deviceName==A.device}),x=A.devicePointNumber,k=A.deviceMonconType.toLocaleLowerCase(),j=k.indexOf("i1")>-1?"i1":k.indexOf("v4")>-1?"v4":k.indexOf("signal")>-1?"wsh":"",M="evaporator"):(Object(r.a)("No Device is not mapped to Evaporator Fans for "+d+"."),R=!1)):(Object(r.a)(" No Device is not mapped to Evaporator Fans for "+d+"."),R=!1):"controlstatedefroststate"==v&&(C.find(function(e){return"DefrostHeater"==e.mappingHardware&&e.equipment==a})?(I=C.find(function(e){return"DefrostHeater"==e.mappingHardware}),o.find(function(e){return e.deviceName==I.device})?(w=o.find(function(e){return e.deviceName==I.device}),x=I.devicePointNumber,k=I.deviceMonconType.toLocaleLowerCase(),j=k.indexOf("i1")>-1?"i1":k.indexOf("v4")>-1?"v4":k.indexOf("signal")>-1?"wsh":"",M="defroster"):(Object(r.a)("No Device is not mapped to Defrost Heater for "+d+"."),R=!1)):(Object(r.a)(" No Device is not mapped to Defrost Heater for "+d+"."),R=!1)),R?[4,Object(p._1)(w.deviceName,O)]:[3,11]):[3,12];case 3:return y.sent(),P="",m&&m.defrostAttached&&m.defrostAttached.indexOf("inhi")>-1?b.defrostControl==l.a.Manual?P=b.isDefrost?"defrost":"inhibit":b.defrostControl==l.a.Schedule?P="defrost":b.defrostControl==l.a.Optimize&&(P="optimize"):m&&m.defrostAttached&&m.defrostAttached.indexOf("act")>-1&&(b.defrostControl==l.a.Manual?P=b.isDefrost?"inactive":"active":b.defrostControl==l.a.Schedule?P="inactive":b.defrostControl==l.a.Optimize&&(P="optimize")),F=Object(),w.computingDevice?[4,Object(c.f)(w.computingDevice)]:[3,6];case 4:return q=y.sent(),[4,Object(c.d)(q)];case 5:(L=y.sent())&&L.length>0&&(F=L[0]),y.label=6;case 6:return B={TS1:b.compressorTemperature.toFixed(2),controller_pi:F.controllerIpAddress,mac_id:F.macID,device:"refcon-request",dbdmin:""+g.DeadBandMinutes,dbdtemp:""+g.DeadBandTemp,defrost:P,nominal_temp:""+(g.MedianTemp?g.MedianTemp:0),device_name:w.deviceName,evapfan:b.isEvaporatorFanAuto?"Auto":"On",back:""+E.back,front:""+E.front,probe:""+E.solid,relaynum:x,rlb_ver:j,rlb_add:w.boardAddress,mapped:M,evp_dead_band:""+(g.ThresholdTemp?g.ThresholdTemp:1),psc_timer:""+(g.MinTimeBeforeRestart?g.MinTimeBeforeRestart:3),Refrigerator:"Refrigerator"+s,refrigerator_mode:b.inhibitControl&&b.inhibitControl==l.a.Local?"local":"remote",defrost_mode:b.defrostControl&&b.defrostControl==l.a.Local?"local":"remote",timestamp:""+(new Date).getTime(),timestamp_request:""+(new Date).getTime()},Object(i.a)(!0,"Sending signal to local processor"),[4,Object(u.j)(B,t)];case 7:return(z=y.sent())&&0==z.responseCode?(Object(i.a)(!0,"Saving Refrigerator State"),[4,Object(u.m)(b,t)]):[3,9];case 8:return y.sent(),[3,11];case 9:return[4,this.fetchCompressorControllerDetails()];case 10:y.sent(),y.label=11;case 11:this.setState({modelChanged:!1}),y.label=12;case 12:return Object(i.a)(!1),[2]}})})},t.prototype.bootDevice=function(){return v(this,void 0,void 0,function(){var e,t,n,a,o=this;return y(this,function(l){switch(l.label){case 0:return e=this.props.buildingName,t=this.state.connectedComputingDevice,!(n=JSON.parse(m.a.getItem("user")))||!n.role||"1"!=n.role&&"2"!=n.role?[3,2]:(Object(i.a)(!0,"Booting Device"),a="refrigeration",[4,Object(p.I)(t,e,a).then(function(e){return v(o,void 0,void 0,function(){return y(this,function(t){return 0==e.responseCode?Object(r.b)(e.responseMessage):Object(r.a)(e.responseMessage),[2]})})}).catch(function(e){Object(r.a)("Some error orccured. ")})]);case 1:l.sent(),Object(i.a)(!1),l.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.currentTabs,r=t.spaceTemp,i=t.compressorController,c=t.compressorADPDB,s=t.modelChanged,u=t.modelChangedState,p=t.device418,g=t.cbw418Model,v=t.compressorRelayDemandingRunningStatus,y=t.compressorRelayRunningStatus,C=t.defrostRelayDemandingRunningStatus,E=t.defrostRelayRunningStatus,T=t.evapRelayDemandingRunningStatus,S=t.evapRelayRunningStatus,O=t.evapRelayAmps,N=t.compressorMapDevice,D=t.defrostMapDevice,w=this.props,x=w.instance,j=w.buildingName,R=w.compressorBox,M=w.solutionOntology,_=w.equipmentOntology,A=w.devices,I=w.controlScreenSettings,k=!1,P=!1,F=!1;i&&c&&(P=i.compressorTemperature<=c.LowTemp,k=i.compressorTemperature>=c.HighTemp),F=!(!i||i.inhibitControl!=l.a.Local&&i.inhibitControl!=l.a.Schedule&&i.inhibitControl!=l.a.Optimize);var q=i&&i.compressorTemperature?parseFloat(i.compressorTemperature.toFixed(1)):0,L=i&&i.isDefrost?"Defrost":"Inhibit",B=I&&I.defrostAttached&&"no"!=I.defrostAttached,z=g&&g["a13comprcurrRefrigerator"+R]?20*g["a13comprcurrRefrigerator"+R]/5:0,G=!(c&&c.ThresholdCompressorAmps>z),U=!(c&&c.ThresholdAmps>O),H=JSON.parse(m.a.getItem("user")),Q=H&&("1"==H.role||"2"==H.role),W=!(!I||!I.showRefrigeratorStatusToAllUsers)||Q,V=N&&N.deviceMapModel&&N.deviceMapModel.device?N.deviceMapModel.device:"",J=D&&D.deviceMapModel&&D.deviceMapModel.device?D.deviceMapModel.device:"";return a.createElement(a.Fragment,null,a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12 padding-5 margin-5"},a.createElement("div",{className:"btn-group"},a.createElement("button",{className:"btn "+("InnerControllerGUI"==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"InnerControllerGUI"}),e.resetData()}},a.createElement("span",{className:"vertical-align"},"Controller")),a.createElement("button",{className:"btn "+("BoxSchedule"==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",disabled:!V,title:V?"":"No device mapped to compressor",onClick:function(){e.setState({currentTabs:"BoxSchedule"}),e.resetData()}},a.createElement("span",{className:"vertical-align"},"Box Schedule")),B&&a.createElement("button",{className:"btn "+("DefrostSchedule"==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",disabled:!J,title:J?"":"No device mapped to defrost",onClick:function(){e.setState({currentTabs:"DefrostSchedule"}),e.resetData()}},a.createElement("span",{className:"vertical-align"},"Defrost Schedule")),a.createElement("button",{className:"btn "+("Graphs"==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"Graphs"}),e.resetData()}},a.createElement("span",{className:"vertical-align"},"Graphs")),Q&&a.createElement("button",{className:"btn "+("InnerControllerADP"==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"InnerControllerADP"}),e.resetData()}},a.createElement("span",{className:"vertical-align"},"ADP"))),Q&&a.createElement("button",{className:"btn btn-success active pull-right","data-toggle":"modal","data-target":"#bootDevice_"+_},a.createElement("span",{className:"vertical-align"},"Boot PI Board")))),"InnerControllerGUI"==n&&a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"card",id:"InsightsList"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12 tempCounter roomTemp pull-right"},a.createElement("div",null,"Space Temp"),a.createElement("div",{className:"counter"},r.toFixed(1),"\xb0F")),a.createElement("div",{className:"col-md-6 col-xs-12"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12 tempCounter"},a.createElement("div",null,"Cool To"),a.createElement("div",{className:"counter"},q,"\xb0F")),a.createElement("div",{className:"col-md-6 col-xs-12 InsightControls"},a.createElement("div",{className:"btn-group-vertical"},a.createElement("button",{type:"button",className:"btn tempButton heatTo",onClick:function(){return e.changeTemperature(!1,i.compressorTemperature)},disabled:k||F||s&&"setpointtemperature"!=u},a.createElement("div",null,a.createElement("i",{className:"fa fa-angle-up"})),a.createElement("div",null,"Warmer")),a.createElement("button",{type:"button",className:"btn tempButton coolTo",onClick:function(){return e.changeTemperature(!0,i.compressorTemperature)},disabled:P||F||s&&"setpointtemperature"!=u},a.createElement("div",null,"Cooler"),a.createElement("div",null,a.createElement("i",{className:"fa fa-angle-down"})))))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},a.createElement("div",{className:"InsightHeading"},a.createElement("i",{className:"fa fa-first-order"}),"Evaporator Fan"),a.createElement("div",{className:"btn-group"},a.createElement("button",{disabled:F||s&&"evapfan"!=u,type:"button",className:i&&i.isEvaporatorFanAuto?"btn btn-fill":"btn",onClick:function(){e.changeEvaporatorFan(!0)}},"Auto"),a.createElement("button",{disabled:F||s&&"evapfan"!=u,type:"button",className:i&&i.isEvaporatorFanAuto?"btn":"btn btn-fill",onClick:function(){e.changeEvaporatorFan(!1)}},"On"))),a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow pull-right"},a.createElement("br",null),a.createElement("div",{className:"btn-group"},a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.inhibitControl==l.a.Local?"btn-fill":""),onClick:function(){e.changeControl(!1,l.a.Local)}},"Local"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(!i||"Remote"!=i.inhibitControl&&i.inhibitControl!=l.a.Schedule&&i.inhibitControl!=l.a.Manual&&i.inhibitControl!=l.a.Optimize?"":"btn-fill")},"Remote"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),onClick:function(){e.changeControl(!1,l.a.Manual)},className:"btn btn-success "+(i&&i.inhibitControl==l.a.Manual?"btn-fill":"")},"Manual"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.inhibitControl==l.a.Schedule?"btn-fill":""),onClick:function(){e.changeControl(!1,l.a.Schedule)}},"Schedule"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.inhibitControl==l.a.Optimize?"btn-fill":""),onClick:function(){e.changeControl(!1,l.a.Optimize)}},"Optimize")))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},a.createElement("div",{className:"ml-4"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-7 pr-0"},a.createElement("div",{className:"pull-left",style:{fontSize:"15px"}},a.createElement("strong",null,"Compressor Status:")," ",I.showCompressorDemandingStatus?-1==v?"":1==v?"(Local Cont. Run)":"(Local Cont. Stop)":"",a.createElement("div",{className:"btn btn-sm btn-round btn-control-screen "+(G?"btn-danger":"btn-success")+" btn-fill ml-2"},a.createElement("i",{className:"fa fa-lightbulb-o"})))),a.createElement("div",{className:"col-md-5"},a.createElement("div",{className:"feedBack-status mb-3"},y>-1&&a.createElement(a.Fragment,null,a.createElement("b",null,"Compr. Relay Status:"),a.createElement("div",{className:"btn btn-sm btn-round btn-control-screen "+(y?"btn-danger":"btn-success")+" btn-fill ml-2"},a.createElement("img",{src:"assets/img/"+(y?"close-circuit.png":"open-circuit.png")}))),-1==y&&a.createElement("b",null,"Compr. Relay Not Mapped"),-2==y&&a.createElement("b",null,"No Data for Compr. Relay")))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-7 pr-0"},a.createElement("div",{className:"pull-left",style:{fontSize:"15px"}},a.createElement("strong",null,"Evap. Fan Status:")," ",I.showEvapFanDemandingStatus?-1==T?"":1==T?"(Local Cont. Run)":"(Local Cont. Stop)":"",O>-1&&a.createElement("div",{className:"btn btn-sm btn-round btn-control-screen "+(U?"btn-danger":"btn-success")+" btn-fill ml-2"},a.createElement("i",{className:"fa fa-lightbulb-o"})))),a.createElement("div",{className:"col-md-5"},a.createElement("div",{className:"feedBack-status mb-3"},S>-1&&a.createElement(a.Fragment,null,a.createElement("b",null,"Evap Fan Relay Status:"),a.createElement("div",{className:"btn btn-sm btn-round btn-control-screen "+(S?"btn-danger":"btn-success")+" btn-fill ml-2"},a.createElement("img",{src:"assets/img/"+(S?"close-circuit.png":"open-circuit.png")}))),-1==S&&a.createElement("b",null,"Evap Fan Relay Not Mapped"),-2==S&&a.createElement("b",null,"No Data for Evap Fan Relay")))),B&&a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-7 pr-0"},a.createElement("div",{className:"pull-left",style:{fontSize:"15px"}},a.createElement("strong",null,"Defrost Status:")," ",I.showDefrostDemandingStatus?-1==C?"":1==C?"(Local Cont. Run)":"(Local Cont. Stop)":"")),a.createElement("div",{className:"col-md-5"},a.createElement("div",{className:"feedBack-status mb-3"},E>-1&&a.createElement(a.Fragment,null,a.createElement("b",null,"Defrost Relay Status:"),a.createElement("div",{className:"btn btn-sm btn-round btn-control-screen "+(E?"btn-danger":"btn-success")+" btn-fill ml-2"},a.createElement("img",{src:"assets/img/"+(E?"close-circuit.png":"open-circuit.png")}))),-1==E&&a.createElement("b",null,"Defrost Relay Not Mapped"),-2==E&&a.createElement("b",null,"No Data for Defrost Relay")))))),B&&a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow pull-right"},a.createElement("h5",{className:"title"},a.createElement("strong",null,"DEFROST")),a.createElement("div",{className:"btn-group"},a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.defrostControl==l.a.Local?"btn-fill":""),onClick:function(){e.changeControl(!0,l.a.Local)}},"Local"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(!i||"Remote"!=i.defrostControl&&i.defrostControl!=l.a.Schedule&&i.defrostControl!=l.a.Manual&&i.defrostControl!=l.a.Optimize?"":"btn-fill")},"Remote"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.defrostControl==l.a.Manual?"btn-fill":""),onClick:function(){e.changeControl(!0,l.a.Manual)}},"Manual"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.defrostControl==l.a.Schedule?"btn-fill":""),onClick:function(){e.changeControl(!0,l.a.Schedule)}},"Schedule"),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:"btn btn-success "+(i&&i.defrostControl==l.a.Optimize?"btn-fill":""),onClick:function(){e.changeControl(!0,l.a.Optimize)}},"Optimize")),i&&i.defrostControl==l.a.Manual?a.createElement("div",{style:{marginTop:10}},a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:i&&i.isDefrost?"btn":"btn btn-fill",style:{marginRight:"15px"},onClick:function(){e.changeCompressorState(!1)}},I&&I.defrostAttached.indexOf("inhi")>-1?"Inhibited":"Active"," "),a.createElement("button",{type:"button",disabled:s&&-1==u.indexOf("controlstate"),className:i&&i.isDefrost?"btn btn-fill":"btn",style:{marginRight:"15px"},onClick:function(){e.changeCompressorState(!0)}},I&&I.defrostAttached.indexOf("inhi")>-1?"Allow Defrost":"Inactive")):"")),a.createElement("div",{className:s?"InsightApplyChanges":"hidden"},a.createElement("h4",null,"Do you want to apply these changes?"),a.createElement("div",null,a.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){e.cancelClick()}},"Cancel"),"\xa0",a.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:this.saveChanges},"Apply Changes"))),a.createElement(o.a,{id:"bootDevice_"+_,heading:"Boot Device",cancelButtonText:"Cancel",showCreateButton:!0,createButtonText:"Boot",showRestoreButton:!0,showCancelButton:!0,onSaveButtonClick:function(){return e.bootDevice()}},a.createElement("h4",null,"Are you sure you want to boot device?")))))),"BoxSchedule"==n&&V&&a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},a.createElement(f.default,{isSolution:!0,instance:x,buildingName:j,InsightName:V,ControlName:"CompressorControl",type:"Equipment",isDefrost:!1,hideTabs:!0,equipmentOntology:_,solutionOntology:M,solutionEquipmentType:"Refrigerator",compressorTemperatureOrDefrostState:q.toString()})),"DefrostSchedule"==n&&J&&B&&a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},a.createElement(f.default,{isSolution:!0,instance:x,buildingName:j,InsightName:J,ControlName:"CompressorControl",type:"Equipment",isDefrost:!0,hideTabs:!0,equipmentOntology:_,compressorTemperatureOrDefrostState:L})),"InnerControllerADP"==n&&Q&&a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},a.createElement(d.default,{instance:x,buildingName:j,InsightName:_,ControlName:"CompressorControl",type:"Equipment",hideTabs:!0,solutionOntology:M})),"Graphs"==n&&a.createElement("div",null,a.createElement(b.a,{instance:x,buildingName:j,devices:A,equipment:_,graphType:"Refrigerator"+R,solution:M})),g&&g.device_Name&&W&&a.createElement(h.a,{buildingName:j,deviceName:p.deviceName,device:p,refrigeratorNo:R,cbwModel:g,controlScreenSettings:I}))},t}(a.Component);t.a=C},2702:function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(23)),r=n(672),i=n(696),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),c=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={device:n.props.device?n.props.device:Object(),cbwModel:n.props.cbwModel,intervalID:Object()},n.fetchDeviceData=n.fetchDeviceData.bind(n),n.fetchCompressorMQTTData=n.fetchCompressorMQTTData.bind(n),n.calculator=n.calculator.bind(n),n.setIntervalStart=n.setIntervalStart.bind(n),n}return l(t,e),t.prototype.componentDidMount=function(){return c(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return[4,this.fetchDeviceData()];case 1:return e=t.sent(),this.props.cbwModel&&this.props.cbwModel.device_Name?[4,this.fetchCompressorMQTTData(e)]:[3,3];case 2:t.sent(),this.setIntervalStart(),t.label=3;case 3:return this.setState({device:e}),[2]}})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){e.cbwModel&&e.cbwModel.device_Name&&this.setState({cbwModel:e.cbwModel})},t.prototype.componentWillUnmount=function(){var e=this.state.intervalID;e&&clearInterval(e),this.setState({intervalID:null})},t.prototype.fetchDeviceData=function(){return c(this,void 0,void 0,function(){var e,t,n,a;return s(this,function(o){switch(o.label){case 0:return e=this.props,t=e.deviceName,n=e.device,a=e.buildingName,n&&n.deviceName||!t?[3,2]:[4,Object(r.x)(t,a)];case 1:return[2,o.sent()];case 2:return[2,n]}})})},t.prototype.setIntervalStart=function(){var e=this,t=0,n=setInterval(function(){++t>=5&&(t=0,e.fetchCompressorMQTTData(e.state.device))},1e3);this.setState({intervalID:n})},t.prototype.fetchCompressorMQTTData=function(e){return c(this,void 0,void 0,function(){var t;return s(this,function(n){switch(n.label){case 0:return[4,Object(i.h)(e.topic,new Date,new Date,!0).then(function(t){return!t||t&&t.error?(Object(o.a)("Error occurred while fetching CBW board info."),Object()):(t[t.length-1]&&localStorage.setItem(e.deviceID,JSON.stringify(t[t.length-1])),t[t.length-1])}).catch(function(e){return Object()})];case 1:return t=n.sent(),this.setState({cbwModel:t}),[2]}})})},t.prototype.calculator=function(e,t){return"Compressor and FreezerDefrost"==e?t:"PressureSensor"==e?14.5*t*50/5:void 0},t.prototype.render=function(){var e=this.state.cbwModel,t=this.props,n=t.refrigeratorNo,o=t.controlScreenSettings,r=o&&o.showFreezerDefrostValue&&o.defrostAttached&&"no"!=o.defrostAttached;return a.createElement("div",null,e&&o&&o.showRefrigeratorStatus&&a.createElement("div",{className:""},a.createElement("div",{className:"card"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"header"},a.createElement("h4",{className:"title"},a.createElement("strong",null,"REFRIGERATOR STATUS:"))),a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 col-xs-12 "},o.showCompressorValue&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-3 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,"Compressor")," ")),a.createElement("div",{className:"col-md-2 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,this.calculator("Compressor and FreezerDefrost",e["a13comprcurrRefrigerator"+n]?e["a13comprcurrRefrigerator"+n]:0)," amps ")," "))),r&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-2 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,"EFM")," ")),a.createElement("div",{className:"col-md-3 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,this.calculator("Compressor and FreezerDefrost",e["a14efmcurrRefrigerator"+n]?e["a14efmcurrRefrigerator"+n]:0)," amps ")," ")))),a.createElement("div",{className:"col-md-12 col-xs-12 "},o.showPressureSensorValue&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-3 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,"Outlet Pressure Sensor")," ")),a.createElement("div",{className:"col-md-2 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,this.calculator("PressureSensor",e["a15prRefrigerator"+n]?e["a15prRefrigerator"+n]:0).toFixed(2)," psig ")," "))),o.showDoorContactValue&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-2 col-xs-6"},a.createElement("p",{style:{fontSize:20}}," ",a.createElement("strong",null,"Door Contact ")," ")),a.createElement("div",{className:"col-md-3 col-xs-6"},e["a16doorRefrigerator"+n]&&e["a16doorRefrigerator"+n]>2?a.createElement("p",{style:{fontSize:20,color:"#337840"}}," ",a.createElement("strong",null,"  The door is closed ")," "):a.createElement("p",{style:{fontSize:20,color:"red"}}," ",a.createElement("strong",null,"  The door is open ")," ")))),a.createElement("div",{className:"col-md-12 col-xs-12 "},a.createElement("div",{className:"col-md-2 col-xs-6"},a.createElement("p",{style:{fontSize:15}}," ",a.createElement("strong",null,"Last data synced at: "))),a.createElement("div",{className:"col-md-10 col-xs-6"},a.createElement("p",{style:{fontSize:15}},"  ",new Date(e.timestamp).toLocaleString())))))))),a.createElement("p",null," "))},t}(a.Component);t.a=u},2703:function(e,t,n){"use strict";var a=n(2),o=n.n(a),r=n(664),i=n(736),l=n(23),c=n(117),s=n(2704),u=n(793),m=n(11),p=n(1127),d=n(694),h=n(22),f=n(2705),b=n(696),g=n(10),v=n(688),y=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),C=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},E=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},T=function(e){function t(t){var n=e.call(this,t)||this;return n.state={devices:n.props.devices,atsDevice:Object(),relayDevice:Object(),atsMQTTData:Object(),utilityDevice:Object(),alarmsStatus:s.a.Stop,alarms:[],utilityMQTTData:Object(),intervalId:Object(),SignalRelay:Object(),modelChanged:!1,actionApplied:"",generatorControl:Object(),signalRelayComputingDevice:Object()},n}return y(t,e),t.prototype.componentDidMount=function(){return C(this,void 0,void 0,function(){var e;return E(this,function(t){switch(t.label){case 0:return e=this.props.devices,this.fetchATSDevice(e),this.fetchWattnodeDevice(e),Object(c.a)(!0),[4,this.fetchRelayDevice(e)];case 1:return t.sent(),[4,this.fetchGeneratorInfo()];case 2:return t.sent(),[4,this.fetchGeneratorAlarms()];case 3:return t.sent(),Object(c.a)(!1),this.setIntervalStart(),[2]}})})},t.prototype.componentWillUnmount=function(){var e=this.state.intervalId;e&&clearInterval(e)},t.prototype.setIntervalStart=function(){var e=this,t=this.state.intervalId;t&&clearInterval(t);var n=0;t=setInterval(function(){return C(e,void 0,void 0,function(){var e;return E(this,function(t){switch(t.label){case 0:return n++,!this.state.modelChanged&&n>=5?(n=0,e=this.props.devices,[4,this.fetchRelayDevice(e)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},1e3),this.setState({intervalId:t})},t.prototype.handleRelayControlType=function(e){var t=this.state.SignalRelay;if(t.controlType=e,e==u.a.Local)for(var n=0;n<8;n++)t.statusNotes[n]="Locally";this.setState({modelChanged:!0,SignalRelay:t,actionApplied:"ControlType"})},t.prototype.handleOptimzeSettingsStatus=function(e){var t=this.state.generatorControl;t.optimizeMode=e;this.setState({modelChanged:!0,generatorControl:t,actionApplied:"OptimizeSettings"})},t.prototype.fetchGeneratorInfo=function(){return C(this,void 0,void 0,function(){var e,t,n,a,o,r,i;return E(this,function(l){switch(l.label){case 0:return e=this.props,t=e.building,n=e.ontology,a=e.solutionOntology,[4,Object(f.a)(t,"",a,n)];case 1:return o=l.sent(),[4,Object(f.c)(o)];case 2:return r=l.sent(),i=Object(),i=r&&r.length>0&&r[0]?r[0]:{Volt1:"0",Volt2:"230",Volt3:"0",optimizeMode:s.b.Normal,atsStatus:s.a.Stop,initiateEngineStatus:s.a.Stop,controlType:u.a.Local,engineStatus:s.a.Stop,runEngineStatus:s.a.Stop,equipment:n,ontology:Object(h.y)(12),solutionOntology:a,building:t},this.setState({generatorControl:i}),[2]}})})},t.prototype.fetchATSDevice=function(e){return C(this,void 0,void 0,function(){var t,n=this;return E(this,function(a){return t=Object(),e&&e.length>0&&(t=e.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("ats")})),this.setState({atsDevice:t},function(){return C(n,void 0,void 0,function(){return E(this,function(e){switch(e.label){case 0:return[4,this.fetchATSMQTTData()];case 1:return e.sent(),[2]}})})}),[2]})})},t.prototype.fetchRelayDevice=function(e){return C(this,void 0,void 0,function(){var t,n,a,o,r,i,l,c,s,p;return E(this,function(h){switch(h.label){case 0:return t=Object(),n=Object(),a=[],o=[],r=Object(),e&&e.length>0?(t=e.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("relay")}))&&t.deviceName?(i=this.props.building,t.computingDevice?[4,Object(d.f)(t.computingDevice)]:[3,3]):[3,5]:[3,5];case 1:return l=h.sent(),[4,Object(d.d)(l)];case 2:(s=h.sent())&&s.length>0&&s[0]&&(r=s[0]),h.label=3;case 3:return[4,Object(v.y)(i,t.deviceName)];case 4:if((c=h.sent())&&c.length>0&&c[0]&&(s=c[0]))return n.device=Object(m.g)(s.device),n.controlType=Object(m.g)(s.controlType),n.relayStatus=Object(m.g)(s.relayStatus).split(","),n.statusNotes=Object(m.g)(s.statusNotes).split(","),this.setState({SignalRelay:n,relayDevice:t,signalRelayComputingDevice:r}),[2];h.label=5;case 5:for(p=0;p<8;p++)a.push(""),o.push("Local");return n={controlType:u.a.Local,device:t.deviceName,relayStatus:a,statusNotes:o},this.setState({SignalRelay:n,relayDevice:t,signalRelayComputingDevice:r}),[2]}})})},t.prototype.fetchWattnodeDevice=function(e){return C(this,void 0,void 0,function(){var t,n=this;return E(this,function(a){return t=Object(),e&&e.length>0&&(t=e.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("watt")})),this.setState({utilityDevice:t},function(){return C(n,void 0,void 0,function(){return E(this,function(e){switch(e.label){case 0:return[4,this.fetchUtilityMQTTData()];case 1:return e.sent(),[2]}})})}),[2]})})},t.prototype.fetchATSMQTTData=function(){return C(this,void 0,void 0,function(){var e,t,n,a,o,r;return E(this,function(i){switch(i.label){case 0:return e=this.state,t=e.atsDevice,n=e.generatorControl,t.topic?(a=t.topic.split(","),[4,Object(b.f)(a[0],new Date,new Date,!0)]):[3,2];case 1:(o=i.sent())&&o.length>0&&(r=o[0],n.atsStatus="1"==r.Main_onNormal&&"0"==r.Main_onEmergency?s.a.Stop:s.a.Start,this.setState({atsMQTTData:r,generatorControl:n})),i.label=2;case 2:return[2]}})})},t.prototype.fetchUtilityMQTTData=function(){return C(this,void 0,void 0,function(){var e,t,n,a;return E(this,function(o){switch(o.label){case 0:return(e=this.state.utilityDevice).topic?(t=e.topic.split(","),[4,Object(b.i)(t[0],new Date,new Date,!0)]):[3,2];case 1:(n=o.sent())&&n.length>0&&(a=n[0],this.setState({utilityMQTTData:a})),o.label=2;case 2:return[2]}})})},t.prototype.fetchGeneratorAlarms=function(){return C(this,void 0,void 0,function(){var e,t,n,a,o;return E(this,function(r){switch(r.label){case 0:return e=this.props,t=e.building,n=e.devices,a=n.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("relay")}),o=[],a&&a.deviceName?[4,Object(p.e)(t,!1,!1,Object(),"","","","",a.deviceName)]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return this.setState({alarms:o,alarmsStatus:o.length>0?s.a.Start:s.a.Stop}),[2]}})})},t.prototype.handleEngineStart=function(e){return void 0===e&&(e="6"),C(this,void 0,void 0,function(){var t;return E(this,function(n){switch(n.label){case 0:return(t=this.state.generatorControl).runEngineStatus!=s.a.Pending&&t.runEngineStatus!=s.a.Stop?[3,4]:(t.runEngineStatus=s.a.Pending,[4,this.handleRelayOnOff(e,!0)]);case 1:return n.sent()?(t.runEngineStatus=s.a.Start,t.engineStatus=s.a.Start,[4,this.saveGeneratorInfo(t)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[3,7];case 4:return t.runEngineStatus!=s.a.Start?[3,7]:(t.runEngineStatus=s.a.Pending,[4,this.handleRelayOnOff(e,!1)]);case 5:return n.sent()?(t.runEngineStatus=s.a.Stop,t.engineStatus=s.a.Pending,[4,this.saveGeneratorInfo(t)]):[3,7];case 6:n.sent(),n.label=7;case 7:return[2]}})})},t.prototype.handleCancelInitiateEngine=function(e,t){return void 0===e&&(e="5"),void 0===t&&(t="2"),C(this,void 0,void 0,function(){var t;return E(this,function(n){switch(n.label){case 0:return(t=this.state.generatorControl).initiateEngineStatus==s.a.Stop?[3,3]:[4,this.handleRelayOnOff(e,!1)];case 1:return n.sent()?(t.initiateEngineStatus=s.a.Stop,t.engineStatus=s.a.Stop,t.Volt1="0",[4,this.saveGeneratorInfo(t)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.handleInitiateEngine=function(e,t,n){return void 0===e&&(e="5"),void 0===t&&(t="2"),void 0===n&&(n="6"),C(this,void 0,void 0,function(){var t;return E(this,function(a){switch(a.label){case 0:return(t=this.state.generatorControl).initiateEngineStatus!=s.a.Pending&&t.initiateEngineStatus!=s.a.Stop?[3,4]:(t.initiateEngineStatus=s.a.Pending,t.engineStatus=s.a.Pending,[4,this.handleRelayOnOff(e,!0)]);case 1:return a.sent()?(t.initiateEngineStatus=s.a.Start,t.Volt1="208",[4,this.saveGeneratorInfo(t)]):[3,3];case 2:a.sent(),a.label=3;case 3:return[3,9];case 4:return t.initiateEngineStatus!=s.a.Start?[3,9]:t.runEngineStatus!=s.a.Start?[3,7]:(t.runEngineStatus=s.a.Pending,[4,this.handleRelayOnOff(n,!1)]);case 5:return a.sent()?(t.runEngineStatus=s.a.Stop,t.engineStatus=s.a.Pending,[4,this.saveGeneratorInfo(t)]):[3,7];case 6:a.sent(),a.label=7;case 7:return[4,this.handleCancelInitiateEngine()];case 8:a.sent(),a.label=9;case 9:return[2]}})})},t.prototype.handleManualAtsControl=function(e,t){return void 0===e&&(e="1"),void 0===t&&(t="2"),C(this,void 0,void 0,function(){var n,a=this;return E(this,function(o){switch(o.label){case 0:return(n=this.state.generatorControl).atsStatus!=s.a.Pending&&n.atsStatus!=s.a.Stop?[3,1]:(n.atsStatus=s.a.Pending,this.setState({generatorControl:n},function(){return C(a,void 0,void 0,function(){return E(this,function(a){switch(a.label){case 0:return[4,this.handleRelayOnOff(e,!0)];case 1:return a.sent()?[4,this.handleRelayOnOff(t,!0)]:[3,4];case 2:return a.sent()?(n.atsStatus=s.a.Start,n.engineStatus=s.a.Start,n.Volt2="208",[4,this.saveGeneratorInfo(n)]):[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}})})}),[3,3]);case 1:return n.atsStatus!=s.a.Start?[3,3]:(n.atsStatus=s.a.Stop,[4,this.saveGeneratorInfo(n)]);case 2:o.sent(),o.label=3;case 3:return[2]}})})},t.prototype.handleAtsControlToUtility=function(e,t){return void 0===e&&(e="1"),void 0===t&&(t="2"),C(this,void 0,void 0,function(){var n;return E(this,function(a){switch(a.label){case 0:return(n=this.state.generatorControl).atsStatus!=s.a.Pending&&n.atsStatus!=s.a.Start?[3,4]:(n.atsStatus=s.a.Pending,n.engineStatus=s.a.Pending,[4,this.handleRelayOnOff(e,!1)]);case 1:return a.sent()?[4,this.handleRelayOnOff(t,!1)]:[3,4];case 2:return a.sent()?(n.atsStatus=s.a.Stop,n.engineStatus=s.a.Stop,n.Volt2="0",[4,this.saveGeneratorInfo(n)]):[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}})})},t.prototype.generateAlarm=function(e,t,n,a){return C(this,void 0,void 0,function(){var n,o,r,i,l,c,s,u;return E(this,function(m){return n=this.props,o=n.ontology,r=n.instance,i=n.building,l=this.state,c=l.relayDevice,s=l.alarms,c&&((u=Object()).device=c.deviceName,u.deviceName=c.rdfsLabel,u.floor=c.floor,u.space=c.location,u.title=t,u.description="Device: "+c.rdfsLabel+" with Controller IP: "+c.wirelessConfig.controllerIPAddress+". Request failed: Relay "+e+" is not responding.",u.timeofalarm=(new Date).toString(),u.status="alerting",u.equipment=o,u.instance=r,u.buildingName=i,u.archived=!1,u.acknowledge=!1,u.deviceOntology=c.deviceName,u.sensedValue=a,u.sensedValueKey="relay_state_"+e,u.ruleId=2,u.ruleName=t,u.ruleUrl="",s.push(u),this.setState({alarms:s})),[2]})})},t.prototype.handleRelayOnOff=function(e,t){return C(this,void 0,void 0,function(){var n,a,o,r,i,s,u,m;return E(this,function(p){switch(p.label){case 0:return n=this.props.building,a=this.state,o=a.relayDevice,r=a.SignalRelay,i=a.signalRelayComputingDevice,o?(Object(c.a)(!0,"Sending signal to local microprocessor"),i?i.macID?(s={controller_pi:i.controllerIpAddress,device:"waveshare-request",device_name:o.deviceName,mac_id:i.macID,relay_state:t?"on":"off",relaynum:e,rlb_add:o.boardAddress,timestamp:""+(new Date).getTime(),timestamp_request:""+(new Date).getTime()},[4,Object(v.S)(n,s,o)]):[3,5]:[3,7]):[3,9];case 1:return(u=p.sent())&&u.res?0!=u.res.responseCode?[3,3]:(m=parseInt(e)-1,r.relayStatus[m]=t?"1":"0",r.statusNotes[m]="Manual",[4,this.saveSignalRelayInfo(r)]):[3,4];case 2:return p.sent(),[2,!0];case 3:Object(l.a)(u.res.responseMessage),p.label=4;case 4:return[3,6];case 5:Object(l.a)("No Mac ID is added to the connected computing device of "+o.rdfsLabel),p.label=6;case 6:return[3,8];case 7:Object(l.a)("No computing device connected to "+o.rdfsLabel),p.label=8;case 8:Object(c.a)(!1),p.label=9;case 9:return[2,!1]}})})},t.prototype.saveSignalRelayInfo=function(e){return C(this,void 0,void 0,function(){var t;return E(this,function(n){switch(n.label){case 0:return t=this.props.building,Object(c.a)(!0,"Saving Relay Status"),[4,Object(v.Z)(t,e)];case 1:return n.sent(),this.setState({SignalRelay:e}),Object(c.a)(!1),[2]}})})},t.prototype.saveGeneratorInfo=function(e){return C(this,void 0,void 0,function(){var t;return E(this,function(n){switch(n.label){case 0:return t=this.state.SignalRelay,Object(c.a)(!0,"Saving Generator Status"),e.controlType=t.controlType,[4,Object(f.b)(this.props.building,e)];case 1:return n.sent(),this.setState({generatorControl:e}),Object(c.a)(!1),[2]}})})},t.prototype.openAlarms=function(){var e=this.props,t=e.instance,n=e.building,a=this.state.alarms;localStorage.setItem("alarmList",JSON.stringify("")),a&&a.length>0?(localStorage.setItem("alarmList",JSON.stringify(a)),window.open("http://"+Object(h.q)()+"/#"+t+"/"+n+"/Health/Alarms/OperationalAlarms/AlarmList","_blank")):alert("No Alarms for Generator")},t.prototype.applyChanges=function(){return C(this,void 0,void 0,function(){var e,t,n,a,o;return E(this,function(r){switch(r.label){case 0:return e=this.state,t=e.modelChanged,n=e.actionApplied,a=e.SignalRelay,o=e.generatorControl,t?"Cancel"!=n?[3,2]:[4,this.handleCancelInitiateEngine()]:[3,15];case 1:return r.sent(),[3,14];case 2:return"Initiate Engine"!=n?[3,4]:[4,this.handleInitiateEngine()];case 3:return r.sent(),[3,14];case 4:return"Run Engine"!=n&&"Starting Engine"!=n&&"Stop Engine"!=n?[3,6]:[4,this.handleEngineStart()];case 5:return r.sent(),[3,14];case 6:return"Start Manual ATS Transfer"!=n?[3,8]:[4,this.handleManualAtsControl()];case 7:return r.sent(),[3,14];case 8:return"Stop Manual ATS Transfer"!=n?[3,10]:[4,this.handleAtsControlToUtility()];case 9:return r.sent(),[3,14];case 10:return"ControlType"!=n?[3,13]:[4,this.saveSignalRelayInfo(a)];case 11:return r.sent(),[4,this.saveGeneratorInfo(o)];case 12:return r.sent(),[3,14];case 13:r.label=14;case 14:this.setState({modelChanged:!1,actionApplied:""}),r.label=15;case 15:return[2]}})})},t.prototype.cancelClick=function(){return C(this,void 0,void 0,function(){var e;return E(this,function(t){switch(t.label){case 0:return e=this.state.devices,Object(c.a)(!0),[4,this.fetchRelayDevice(e)];case 1:return t.sent(),[4,this.fetchGeneratorInfo()];case 2:return t.sent(),this.setState({modelChanged:!1,actionApplied:""}),Object(c.a)(!1),[2]}})})},t.prototype.bootDevice=function(){return C(this,void 0,void 0,function(){var e,t,n,a,o=this;return E(this,function(r){switch(r.label){case 0:return e=this.props.building,t=this.state.signalRelayComputingDevice,!(n=JSON.parse(g.a.getItem("user")))||!n.role||"1"!=n.role&&"2"!=n.role?[3,2]:(Object(c.a)(!0,"Booting Device"),a="generation",[4,Object(v.I)(t,e,a).then(function(e){return C(o,void 0,void 0,function(){return E(this,function(t){return 0==e.responseCode?Object(l.b)(e.responseMessage):Object(l.a)(e.responseMessage),[2]})})}).catch(function(e){Object(l.a)("Some error orccured. ")})]);case 1:r.sent(),Object(c.a)(!1),r.label=2;case 2:return[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.atsMQTTData,a=t.alarmsStatus,l=t.alarms,c=t.utilityMQTTData,m=t.modelChanged,p=t.actionApplied,d=t.SignalRelay,f=t.generatorControl,b=f.Volt1,v=f.Volt3,y=f.atsStatus,C=f.engineStatus,E=f.initiateEngineStatus,T=f.optimizeMode,S=f.runEngineStatus,O=this.props.ontology,N="#d2202a",D="#337840";C==s.a.Start?D=N:C==s.a.Pending&&(D="#FF9500");var w="#337840";E==s.a.Start?w=N:E==s.a.Pending&&(w="#FF9500");var x="#337840";S==s.a.Start?x=N:S==s.a.Pending&&(x="#FF9500");var j="#337840";y==s.a.Start?j=N:y==s.a.Pending&&(j="#FF9500");var R="#007bff";a==s.a.Start?R=N:a==s.a.Pending&&(R="#FF9500");var M=0;c.PowerSum&&parseFloat(c.PowerSum)&&(M=parseFloat(c.PowerSum)/1e3);var _=d&&d.controlType==u.a.Manual,A=T==s.b.Optimze,I="";"Cancel"==p&&(I="Do you want to apply these changes? (Turn off the Initiate Engine Stop)"),"ControlType"==p?I="Do you want to apply these changes? (Turn the Generator mode : "+d.controlType+")":"Initiate Engine"==p?I="Do you want to apply these changes? (Initiate Engine of Generator)":"Run Engine"==p||"Starting Engine"==p||"Stop Engine"==p?I="Do you want to apply these changes? ("+p+" of Generator)":"Start Manual ATS Transfer"==p?I="Are you sure you want to transfer load to the Generator?":"Stop Manual ATS Transfer"==p?I="Are you sure you wish to transfer to the utility power?":"OptimizeSettings"==p&&(I="Do you want to apply these changes? (Generator settings : "+T+")");var k=JSON.parse(g.a.getItem("user"));return o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},k&&k.role&&("1"==k.role||"2"==k.role)&&o.a.createElement("button",{className:"btn btn-success active pull-right custom-outline-btn m-3",title:"Boot PI Board","data-toggle":"modal","data-target":"#bootDevice_"+O}," ",o.a.createElement("i",{className:"fa fa-refresh"})," Boot PI Board")),o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"content",style:{padding:"15px 0 10px 15px !important"}},o.a.createElement("div",{style:{width:"100%",overflowX:"scroll"}},o.a.createElement("div",{className:"content",style:{width:"1200px",padding:"15px 0 10px 15px !important"}},o.a.createElement("div",{style:{width:"60px",float:"left",marginTop:"75px"}},o.a.createElement("h5",{className:"title",style:{fontWeight:"bold",display:"inline-block"}}," Utility ")),o.a.createElement("div",{style:{width:"130px",marginTop:"-8px",float:"left",marginLeft:"35px"}},o.a.createElement("h5",{className:"title",style:{fontSize:"18px",fontWeight:"bold"}}," ",c.VoltAvgLL," V "),o.a.createElement("h5",{className:"title",style:{fontSize:"18px",fontWeight:"bold"}}," ",M," kW"),o.a.createElement("h5",{className:"title",style:{fontSize:"18px",fontWeight:"bold"}}," ",n&&n.Normal_Frequency?n.Normal_Frequency:"0"," Hz ")),o.a.createElement("div",{style:{width:"315px",float:"left",textAlign:"right",marginTop:"-8px",marginLeft:"20px"}},o.a.createElement("h5",{className:"title",style:{fontSize:"18px",fontWeight:"bold"}}," ",b," V"),o.a.createElement("h5",{className:"title",style:{fontSize:"18px",fontWeight:"bold"}}," ",v," A"),o.a.createElement("h5",{className:"title",style:{fontSize:"18px",fontWeight:"bold"}}," ",n&&n.Emergency_Frequency?n.Emergency_Frequency:"0"," Hz ")),o.a.createElement("div",{style:{width:"950px",float:"left"}},o.a.createElement("div",{style:{width:"30px",float:"left",height:"15px",backgroundColor:"black",marginTop:"12px",borderRadius:"2px"}}),o.a.createElement("div",{style:{width:"50px",float:"left",height:"40px",backgroundColor:n&&"1"==n.Normal_SourceAvble?"red":"green",borderRadius:"5px"}}),o.a.createElement("div",{style:{width:"80px",float:"left",height:"15px",backgroundColor:"black",marginTop:"12px",borderRadius:"2px"}}),o.a.createElement("div",{style:{width:"28px",float:"left",height:"30px",backgroundColor:"black",marginTop:"5px",borderRadius:"22px",marginLeft:"-2px"}}),o.a.createElement("div",{style:{width:"120px",float:"left",height:"15px",backgroundColor:"black",marginTop:"55px",borderRadius:"2px",marginLeft:"-28px",visibility:y==s.a.Start||y==s.a.Pending?"hidden":"visible",transform:"rotate(42deg)"}}),o.a.createElement("div",{style:{width:"30px",float:"left",height:"30px",backgroundColor:"black",marginTop:"88px",borderRadius:"22px",marginLeft:"-30px"}}),o.a.createElement("div",{style:{width:"15px",float:"left",height:"200px",backgroundColor:"black",marginTop:"110px",borderRadius:"4px",marginLeft:"-23px"}}),o.a.createElement("div",{style:{width:"120px",float:"left",height:"15px",backgroundColor:"black",marginTop:"50px",borderRadius:"2px",marginLeft:"-25px",visibility:y==s.a.Stop||y==s.a.Pending?"hidden":"visible",transform:"rotate(-42deg)"}}),o.a.createElement("div",{style:{width:"30px",float:"left",height:"30px",backgroundColor:"black",marginTop:"5px",borderRadius:"22px",marginLeft:"-34px"}}),o.a.createElement("div",{style:{width:"100px",float:"left",height:"15px",backgroundColor:"black",marginTop:"12px",borderRadius:"2px",marginLeft:"-8px"}}),o.a.createElement("div",{style:{width:"50px",float:"left",height:"40px",backgroundColor:n&&"1"==n.Emergency_SourceAvble?"red":"green",borderRadius:"5px"}}),o.a.createElement("div",{style:{width:"100px",float:"left",height:"15px",backgroundColor:"black",marginTop:"12px",borderRadius:"2px"}}),o.a.createElement("div",{style:{width:"55px",float:"left",height:"54px",backgroundColor:n&&"0"==n.Emergency_Frequency?"green":"red",marginTop:"-8px",borderRadius:"32px",marginLeft:"-2px"}}),o.a.createElement("div",{style:{width:"100px",float:"left",height:"15px",backgroundColor:"black",marginTop:"12px",borderRadius:"2px",marginLeft:"-2px"}}),o.a.createElement("div",{style:{width:"80px",float:"left",height:"40px",backgroundColor:""+D,borderRadius:"5px"}})),o.a.createElement("div",{style:{width:"1200px"}},o.a.createElement("div",{style:{width:"50px",float:"left",height:"40px",backgroundColor:"red",marginTop:"1px",borderRadius:"5px",marginLeft:"300px"}})),o.a.createElement("div",{style:{width:"1200px"}},o.a.createElement("div",{style:{width:"80px",float:"left",height:"40px",borderRadius:"5px",marginTop:"41px",marginLeft:"-46px",fontSize:"18px",fontWeight:"bold"}},"Load")),o.a.createElement("div",{style:{width:"175px",float:"left",textAlign:"right",marginLeft:"175px",marginTop:"-260px"}},o.a.createElement("h5",{className:"title",style:{fontWeight:"bold"}}," Generator ")),o.a.createElement("div",{style:{width:"250px",float:"left",textAlign:"center",marginLeft:"355px",marginTop:"-261px"}},o.a.createElement("h5",{className:"title",style:{fontWeight:"bold"}}," Engine "),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("button",{className:"btn "+(E==s.a.Pending?"btn-primary":"btn-secondary")+" btn-fill",disabled:m||E!=s.a.Pending,onClick:function(){e.setState({modelChanged:!0,actionApplied:"Cancel"})}},"Cancel"),o.a.createElement("button",{className:"btn btn-fill pull-right",style:{backgroundColor:w},disabled:m||!_,onClick:function(){e.setState({modelChanged:!0,actionApplied:"Initiate Engine"})}},"Initiate Engine ",""+(E==s.a.Stop?s.a.Start:E==s.a.Pending?"Starting":"Stop"))),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("button",{className:"btn btn-primary btn-fill",style:{visibility:"hidden"}},"Cancel"),o.a.createElement("button",{className:"btn btn-fill pull-right",style:{backgroundColor:x},disabled:m||!(_&&E==s.a.Start),onClick:function(){e.setState({modelChanged:!0,actionApplied:(S==s.a.Stop?"Run":S==s.a.Pending?"Starting":"Stop")+" Engine"})}},S==s.a.Stop?"Run":S==s.a.Pending?"Starting":"Stop"," Engine"))),o.a.createElement("div",{style:{width:"250px",float:"right",textAlign:"center",marginTop:"-29%"}},o.a.createElement("div",{style:{width:"0",height:"0",borderStyle:"solid",borderWidth:"0 50px 75px 50px",borderColor:"transparent transparent "+R+" transparent",margin:"0 auto",cursor:"pointer"},onClick:function(){e.openAlarms()}}),o.a.createElement("div",{style:{width:"150px",float:"left",textAlign:"right"}},o.a.createElement("h5",{className:"title",style:{fontWeight:"bold"}}," Alarm "))),o.a.createElement("div",{style:{width:"1200px"}},o.a.createElement("button",{className:"btn btn-fill",disabled:m||!(_&&S==s.a.Start),style:{float:"left",marginTop:"-195px",marginLeft:"-50px",backgroundColor:j},onClick:function(){y==s.a.Pending||y==s.a.Stop?e.setState({modelChanged:!0,actionApplied:"Start Manual ATS Transfer"}):y==s.a.Start&&e.setState({modelChanged:!0,actionApplied:"Stop Manual ATS Transfer"})}},"Manual ATS Transfer")),o.a.createElement("div",{className:"btn-group",style:{width:"270px",float:"right",marginTop:"83px",marginRight:"-78px"}},o.a.createElement("button",{type:"button",className:"btn btn-success "+(_?"":"btn-fill"),disabled:m,onClick:function(){e.handleRelayControlType(u.a.Local)}},"Local"),o.a.createElement("button",{type:"button",className:"btn btn-success "+(_?"btn-fill":""),disabled:m,onClick:function(){e.handleRelayControlType(u.a.Manual)}},"Remote")),o.a.createElement("div",{className:"btn-group",style:{width:"870px"}},o.a.createElement("h6",null,"\xa0\xa0\xa0\xa0 Optimize Settings"),o.a.createElement("button",{type:"button",className:"btn "+(A?"":"btn-fill"),disabled:m,onClick:function(){e.handleOptimzeSettingsStatus(s.b.Normal)}},"Normal"),o.a.createElement("button",{type:"button",className:"btn "+(A?"btn-fill":""),disabled:m,onClick:function(){e.handleOptimzeSettingsStatus(s.b.Optimze)}},"Optimize")))),o.a.createElement("div",{className:m?"InsightApplyChanges":"hidden"},I&&o.a.createElement("h4",null,I),o.a.createElement("div",null,o.a.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){e.cancelClick()}},"Cancel"),"\xa0",o.a.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){e.applyChanges()}},"Apply Changes"))),o.a.createElement(i.a,{id:"bootDevice_"+O,heading:"Boot Device",cancelButtonText:"Cancel",showCreateButton:!0,createButtonText:"Boot",showRestoreButton:!0,showCancelButton:!0,onSaveButtonClick:function(){return e.bootDevice()}},o.a.createElement("h4",null,"Are you sure you want to boot device?"))))),o.a.createElement("button",{type:"button",id:"btnShowAlarms",className:"btn btn-primary btn-fill","data-toggle":"modal","data-target":"#ShowAlarms",style:{display:"none"}},"."),o.a.createElement(r.a,{id:"ShowAlarms",showSaveButton:!1,showCancelButton:!0,isEditForm:!0,heading:"Alarms List"},o.a.createElement("div",{className:"row padding-10"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"padding-10",style:{border:"2px solid gainsboro"}},o.a.createElement("div",{className:"row no-padding"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"col-md-2 headingText"},"Title"),o.a.createElement("div",{className:"col-md-2 headingText"},"Description"),o.a.createElement("div",{className:"col-md-1 headingText"},"Relay"),o.a.createElement("div",{className:"col-md-2 headingText"},"Timestamp"),o.a.createElement("div",{className:"col-md-1 headingText"},"Device name"),o.a.createElement("div",{className:"col-md-2 headingText"},"Floor"),o.a.createElement("div",{className:"col-md-2 headingText"},"Space")))),o.a.createElement("div",{style:{paddingBottom:"1%",border:"1px solid lightgray"}},l&&l.length>0&&l.map(function(e,t){return o.a.createElement("div",{key:t,style:{margin:"2px"}},o.a.createElement("div",{className:"",style:{marginBottom:"1px"},key:t},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"col-md-2"},e.title),o.a.createElement("div",{className:"col-md-2"},e.description),o.a.createElement("div",{className:"col-md-1"},"Relay no. ",e.status),o.a.createElement("div",{className:"col-md-2"},e.timeofalarm),o.a.createElement("div",{className:"col-md-1"},e.deviceName),o.a.createElement("div",{className:"col-md-2"},Object(h.t)(e.floor)),o.a.createElement("div",{className:"col-md-2"},Object(h.t)(e.space))))))}))))))},t}(o.a.Component);t.a=T},2704:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var a={Start:"Start",Pending:"Pending",Stop:"Stop"},o={Normal:"Normal",Optimze:"Optimze"}},2705:function(e,t,n){"use strict";t.b=function(e,t){return l(this,void 0,void 0,function(){var n=this;return c(this,function(r){switch(r.label){case 0:return[4,Object(i.f)({buildingName:e,model:t},i.a.ESOLUTION.SaveGeneratorInfo,o.b.ESolution).then(function(e){return l(n,void 0,void 0,function(){return c(this,function(t){return e.message?Object(a.b)(e.message):e.error&&Object(a.a)(e.error),[2]})})}).catch(function(e){Object(a.a)("Error occured while updating Generator info.")})];case 1:return[2,r.sent()]}})})},t.a=function(e,t,n,a){return l(this,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:return[4,Object(i.e)({buildingName:e,ontology:t,solution:n,equipment:a},i.a.ESOLUTION.FetchGeneratorInfo,o.b.ESolution,!0)];case 1:return[2,r.sent()]}})})},t.c=function(e){return l(this,void 0,void 0,function(){var t,n,a,o;return c(this,function(i){for(t=[],n=0;n<e.length;n++)a=e[n],o={ontology:Object(r.g)(a.ontology),solutionOntology:Object(r.g)(a.solutionOntology),controlType:Object(r.g)(a.controlType),equipment:Object(r.g)(a.equipment),Volt1:Object(r.g)(a.Volt1),Volt2:Object(r.g)(a.Volt2),Volt3:Object(r.g)(a.Volt3),atsStatus:Object(r.g)(a.atsStatus),engineStatus:Object(r.g)(a.engineStatus),initiateEngineStatus:Object(r.g)(a.initiateEngineStatus),runEngineStatus:Object(r.g)(a.runEngineStatus),optimizeMode:Object(r.g)(a.optimizeMode),building:Object(r.g)(a.building)},t.push(o);return[2,t]})})};var a=n(23),o=n(19),r=n(11),i=n(12),l=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}}},2706:function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(736)),r=n(23),i=n(117),l=n(1398),c=n(793),s=n(855),u=n(694),m=n(670),p=n(22),d=n(1008),h=n(10),f=n(688),b=n(899),g=n(2707),v=n(901),y=n(1214),C=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),E=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},T=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},S=function(e){function t(t){var n=e.call(this,t)||this;return n.state={ptacADP:Object(),ScheduleIsOnModel:Object(),currentTabs:"CurrentValues",modelChanged:!1,ptacController:Object(),ceilingSensorDevice:Object(),relayDevice:Object(),ceilingSensorMQTT:Object(),i1RelayMQTT:Object(),openRelayControlDialog:!1,callInterval:!0,intervalId:Object(),roomTemperature:"",ptacComputingDevice:Object(),dataCapture:!1},n.changeTemperature=n.changeTemperature.bind(n),n.fetchDevices=n.fetchDevices.bind(n),n.fetchDevicesMQTTData=n.fetchDevicesMQTTData.bind(n),n.fetchPTACInfo=n.fetchPTACInfo.bind(n),n.changeTemperature=n.changeTemperature.bind(n),n.changeMode=n.changeMode.bind(n),n.changeControlType=n.changeControlType.bind(n),n.changeFanSettings=n.changeFanSettings.bind(n),n.applyRule=n.applyRule.bind(n),n.saveChanges=n.saveChanges.bind(n),n.onCloseRelayControlDialog=n.onCloseRelayControlDialog.bind(n),n.setOptimizeStatus=n.setOptimizeStatus.bind(n),n.handleDataCapture=n.handleDataCapture.bind(n),n}return C(t,e),t.prototype.componentDidMount=function(){return E(this,void 0,void 0,function(){var e;return T(this,function(t){switch(t.label){case 0:return(e=this.props.isDataCapture)&&this.setState({dataCapture:e}),this.fetchDevices(),[4,this.fetchPTACInfo()];case 1:return t.sent(),[4,this.fetchPTACADP()];case 2:return t.sent(),this.fetchDevicesMQTTData(),this.setIntervalStart(),[2]}})})},t.prototype.componentWillUnmount=function(){var e=this.state.intervalId;e&&(clearInterval(e),this.setState({callInterval:!1}))},t.prototype.fetchPTACADP=function(){return E(this,void 0,void 0,function(){var e,t,n,a,o,r;return T(this,function(i){switch(i.label){case 0:return e=this.props,t=e.equipmentOntology,n=e.buildingName,a=e.solutionOntology,o=Object(),[4,Object(d.c)(n,"",t,a)];case 1:return r=i.sent(),o=r&&r.equipment?r:{ontology:Object(p.y)(12),building:n,equipment:t,DeadBandMinutes:1,DeadBandTemp:1,MotinoDetectionE1:1,MotinoDetectionE2:1,solutionOntology:a,ADPSettings:s.a,NoOfMotionTriggers:100,OccupancyDeadband:1},this.setState({ptacADP:o}),[2]}})})},t.prototype.fetchDevices=function(){return E(this,void 0,void 0,function(){var e,t,n,a,o,i,l=this;return T(this,function(c){switch(c.label){case 0:return(e=this.props.devices)&&e.length>0?(t=Object(),n=Object(),a=Object(),t=e.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("ceiling")}),(n=e.find(function(e){return-1!=e.monitoringControlDeviceType.toLowerCase().indexOf("i1")}))&&n.deviceName?[3,1]:(Object(r.a)("No controlling device (i1 relay) found in solution to control PTAC"),[2])):[3,5];case 1:return n.computingDevice?[4,Object(u.f)(n.computingDevice)]:[3,4];case 2:return o=c.sent(),[4,Object(u.d)(o)];case 3:(i=c.sent())&&i.length>0&&(a=i[0]),c.label=4;case 4:this.setState({ceilingSensorDevice:t,relayDevice:n,ptacComputingDevice:a},function(){l.fetchDevicesMQTTData()}),c.label=5;case 5:return[2]}})})},t.prototype.setIntervalStart=function(){var e=this,t=this.state.intervalId;t&&clearInterval(t);var n=0;t=setInterval(function(){return E(e,void 0,void 0,function(){var e,t,a,o;return T(this,function(r){return e=this.state,t=e.callInterval,a=e.modelChanged,o=e.currentTabs,n++,!a&&t&&n>=5&&"CurrentValues"==o&&(this.fetchPTACInfo(),this.fetchDevicesMQTTData(),n=0),[2]})})},1e3),this.setState({intervalId:t})},t.prototype.onCloseRelayControlDialog=function(e){this.setState({openRelayControlDialog:e})},t.prototype.fetchDevicesMQTTData=function(){return E(this,void 0,void 0,function(){var e,t,n,a,o,i;return T(this,function(c){switch(c.label){case 0:return e=this.state,t=e.ceilingSensorDevice,n=e.relayDevice,a=Object(),t&&t.topic?[4,Object(f.n)(t).then(function(e){var n=e[0];return!n||n&&n.error?(Object(r.a)("Error occurred while fetching ceiling sensor board info."),Object()):(localStorage.setItem(t.deviceID,JSON.stringify(e)),n)}).catch(function(e){return Object()})]:[3,2];case 1:a=c.sent(),c.label=2;case 2:return o=Object(),n&&n.topic?[4,Object(f.f)(n.topic,new Date,new Date,!0).then(function(e){return!e||e&&e.error?(Object(r.a)("Error occurred while fetching relay board info."),Object()):(e[e.length-1]&&localStorage.setItem(n.deviceID,JSON.stringify(e[e.length-1])),e[e.length-1])}).catch(function(e){return Object()})]:[3,4];case 3:o=c.sent(),c.label=4;case 4:return i=a&&a.temp_celsius?Object(l.a)(a.temp_celsius,t.firmwareVersion):"0",this.setState({ceilingSensorMQTT:a,i1RelayMQTT:o,roomTemperature:i}),[2]}})})},t.prototype.fetchPTACInfo=function(){return E(this,void 0,void 0,function(){var e,t,n,a,o,r,i;return T(this,function(l){switch(l.label){case 0:return e=this.props,t=e.buildingName,n=e.equipmentOntology,a=e.solutionOntology,[4,Object(d.a)(t,null,null,n)];case 1:return o=l.sent(),r=Object(),o&&o.length>0?[4,Object(d.f)(o)]:[3,3];case 2:return i=l.sent(),r=i[0],[3,4];case 3:r={controlType:c.a.Local,coolTemp:0,equipment:n,fanStatus:"",heatTemp:0,isAutoOff:!0,isOptimizedActive:!1,isRelayOn:!1,isRoomOccupied:"UNOCCUPIED",isShutdownActive:!1,mode:c.c.Off,ontology:Object(p.y)(12),optimizeStatus:"0",solutionOntology:a},l.label=4;case 4:return this.setState({ptacController:r}),[2]}})})},t.prototype.changeTemperature=function(e,t,n){var a=this.state.ptacController;t==c.c.Cool?(a.coolTemp=e?a.coolTemp-.1:a.coolTemp+.1,a.coolTemp=parseFloat(a.coolTemp.toFixed(1))):t==c.c.Heat&&(a.heatTemp=e?a.heatTemp-.1:a.heatTemp+.1,a.heatTemp=parseFloat(a.heatTemp.toFixed(1))),this.setState({ptacController:a,modelChanged:!0})},t.prototype.changeMode=function(e){var t=this.state,n=t.ptacController,a=t.ptacADP;if(n.mode=e,n.mode==c.c.Off)n.isAutoOff=!1,n.isRelayOn=!1;else if(n.isAutoOff=!0,n.isRelayOn=!0,e==c.c.Cool)n.coolTemp>=0&&n.coolTemp<=1&&a&&a.ADPSettings&&a.ADPSettings.length>0&&(o=a.ADPSettings.find(function(e){return"COOLING"==e.season&&"UNOCCUPIED"==e.occType}))&&o.defaultTargetTemp&&(n.coolTemp=parseFloat(o.defaultTargetTemp));else if(e==c.c.Heat){var o;if(n.heatTemp>=0&&n.heatTemp<=1&&a&&a.ADPSettings&&a.ADPSettings.length>0)(o=a.ADPSettings.find(function(e){return"HEATING"==e.season&&"UNOCCUPIED"==e.occType}))&&o.defaultTargetTemp&&(n.heatTemp=parseFloat(o.defaultTargetTemp))}this.setState({ptacController:n,modelChanged:!0})},t.prototype.setOptimizeStatus=function(e){var t=this.state.ptacController;t.optimizeStatus=e,t.isOptimizedActive=!0,t.isShutdownActive=!1,this.setState({ptacController:t,modelChanged:!0})},t.prototype.changeControlType=function(e){return E(this,void 0,void 0,function(){var t,n,a;return T(this,function(o){switch(o.label){case 0:return t=this.props.equipmentOntology,(n=this.state.ptacController).controlType=e,(a=Object()).equipmentOntology=t,a.isScheduleOn=e==c.a.Schedule,Object(i.a)(!0),[4,Object(f._0)(a)];case 1:return o.sent(),n.isShutdownActive=e==c.a.Shutdown,n.isOptimizedActive=e==c.a.Optimize,this.setState({ptacController:n,modelChanged:!0,ScheduleIsOnModel:a}),Object(i.a)(!1),[2]}})})},t.prototype.changeFanSettings=function(e){var t=this.state.ptacController;t.fanStatus=e,this.setState({ptacController:t,modelChanged:!0})},t.prototype.applyRule=function(e,t,n){return e?t?e<n?0:e:e>n?0:e:0},t.prototype.saveChanges=function(e,t){return E(this,void 0,void 0,function(){var n,a,o,l,s,u,m,p,h=this;return T(this,function(b){switch(b.label){case 0:return n=this.props.buildingName,a=this.state,o=a.modelChanged,l=a.ptacController,s=a.relayDevice,u=a.ptacComputingDevice,s&&s.deviceName?u&&u.controllerIpAddress?u&&u.macID?o||t?(e&&Object(i.a)(!0),l.controlType!=c.a.Manual?[3,4]:(m={building:n,controller_pi:u.controllerIpAddress,mac_id:u.macID,device:"rlb-request",device_name:s.deviceName,relay_type:"i1",rlb_add:s.boardAddress,server_time:""+(new Date).getTime(),command:l.isAutoOff?"on":"off",request_type:"ptac",timestamp_request:""+(new Date).getTime()},[4,Object(f.O)(m)])):[3,7]:(Object(r.a)("No mac id found in connected computing device"+(u.name||"")),[2]):(Object(r.a)("No controlling ip address found in connected computing device "+(u.name||"")),[2]):(Object(r.a)("No controlling device (i1 relay) found in solution to control PTAC"),[2]);case 1:return(p=b.sent())&&0==p.responseCode?(l.isRelayOn=l.isAutoOff,[4,Object(d.b)(this.props.buildingName,l,!e)]):[3,3];case 2:b.sent(),b.label=3;case 3:return[3,6];case 4:return[4,Object(d.b)(this.props.buildingName,l,!e)];case 5:b.sent(),b.label=6;case 6:this.setState({modelChanged:!1},function(){h.fetchPTACInfo(),e&&Object(i.a)(!1)}),b.label=7;case 7:return[2]}})})},t.prototype.bootDevice=function(){return E(this,void 0,void 0,function(){var e,t,n,a,o=this;return T(this,function(l){switch(l.label){case 0:return e=this.props.buildingName,t=this.state.ptacComputingDevice,!(n=JSON.parse(h.a.getItem("user")))||!n.role||"1"!=n.role&&"2"!=n.role?[3,2]:(Object(i.a)(!0,"Booting Device"),a="ptac",[4,Object(f.I)(t,e,a).then(function(e){return E(o,void 0,void 0,function(){return T(this,function(t){return 0==e.responseCode?Object(r.b)(e.responseMessage):Object(r.a)(e.responseMessage),[2]})})}).catch(function(e){Object(r.a)("Some error orccured. ")})]);case 1:l.sent(),Object(i.a)(!1),l.label=2;case 2:return[2]}})})},t.prototype.handleDataCapture=function(e){return E(this,void 0,void 0,function(){var t,n;return T(this,function(a){switch(a.label){case 0:return t=this.props.buildingName,n=this.state.ptacController,[4,Object(m.C)(t,n.equipment,e)];case 1:return a.sent(),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,i=t.buildingName,l=t.solutionOntology,s=t.equipmentOntology,u=t.equipmentRdfsLabel,m=t.devices,p=t.controllerScreenSettings,d=this.state,f=d.currentTabs,C=d.ptacController,S=d.modelChanged,O=d.roomTemperature,N=d.i1RelayMQTT,D=d.relayDevice,w=d.openRelayControlDialog,x=d.ceilingSensorMQTT,j=d.dataCapture,R=!C||C.controlType!=c.a.Manual,M=JSON.parse(h.a.getItem("user"));return a.createElement(a.Fragment,null,a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12 padding-5 margin-5"},a.createElement("div",{className:"btn-group"},a.createElement("button",{className:"btn "+("CurrentValues"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"CurrentValues"})}},a.createElement("span",{className:"vertical-align"},"Controller")),a.createElement("button",{className:"btn "+("Schedule"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"Schedule"})}},a.createElement("span",{className:"vertical-align"},"Schedule")),a.createElement("button",{className:"btn "+("Alarms"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"Alarms"})}},a.createElement("span",{className:"vertical-align"},"Alarms")),a.createElement("button",{className:"btn "+("Graphs"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"Graphs"})}},a.createElement("span",{className:"vertical-align"},"Graphs")),a.createElement("button",{className:"btn "+("InnerControllerADP"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"InnerControllerADP"})}},a.createElement("span",{className:"vertical-align"},"ADP"))))),"CurrentValues"==f&&a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"card",id:"InsightsList"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-10"},a.createElement("div",{className:"header"},a.createElement("h4",{className:"title"},a.createElement("strong",null,"Equipment Status:")," (",N&&N.active_power_Watts?parseFloat(N.active_power_Watts)<.2?"idle":"running":"idle",")"))),a.createElement("div",{className:"col-md-2"},M&&M.role&&("1"==M.role||"2"==M.role)&&a.createElement("button",{className:"btn btn-success active pull-right custom-outline-btn m-3",title:"Boot PI Board","data-toggle":"modal","data-target":"#bootDevice_"+s}," ",a.createElement("i",{className:"fa fa-refresh"})," Boot PI Board")),a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"pull-right",style:{display:"flex"}},a.createElement("label",{style:{fontWeight:600}},"ADP Capture: "),a.createElement("div",{className:"no-padding",style:{transform:"scale(0.8)",marginTop:"-5px"}},a.createElement("label",null,a.createElement("input",{name:"isBoolean",checked:j,onChange:function(){e.setState({dataCapture:!j}),e.handleDataCapture(!j)},className:"switch1",type:"checkbox"}),a.createElement("div",null,a.createElement("div",null)))))))),a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12"},a.createElement("div",{className:"row"},C&&(C.mode==c.c.Heat||C.mode==c.c.Auto)&&a.createElement(a.Fragment,null,a.createElement("div",{className:(C.mode==c.c.Auto?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" tempCounter"},a.createElement("div",null,"Heat To"),a.createElement("div",{className:"counter"},C&&C.heatTemp?parseFloat(C.heatTemp.toFixed(1)):0,"\xb0F")),a.createElement("div",{className:(C.mode==c.c.Auto?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" InsightControls"},a.createElement("div",{className:"btn-group-vertical"},a.createElement("button",{type:"button",className:"btn tempButton heatTo",onClick:function(){return e.changeTemperature(!1,c.c.Heat,C&&C.heatTemp?C.heatTemp:0)},disabled:R},a.createElement("div",null,a.createElement("i",{className:"fa fa-angle-up"})),a.createElement("div",null,"Warmer")),a.createElement("button",{type:"button",className:"btn tempButton coolTo",onClick:function(){return e.changeTemperature(!0,c.c.Heat,C&&C.heatTemp?C.heatTemp:0)},disabled:R},a.createElement("div",null,"Cooler"),a.createElement("div",null,a.createElement("i",{className:"fa fa-angle-down"})))))),C&&(C.mode==c.c.Cool||C.mode==c.c.Auto)&&a.createElement(a.Fragment,null,a.createElement("div",{className:(C.mode==c.c.Auto?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" tempCounter"},a.createElement("div",null,"Cool To"),a.createElement("div",{className:"counter"},C&&C.coolTemp?parseFloat(C.coolTemp.toFixed(1)):0,"\xb0F")),a.createElement("div",{className:(C.mode==c.c.Auto?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" InsightControls"},a.createElement("div",{className:"btn-group-vertical"},a.createElement("button",{type:"button",className:"btn tempButton heatTo",onClick:function(){return e.changeTemperature(!1,c.c.Cool,C&&C.coolTemp?C.coolTemp:0)},disabled:R},a.createElement("div",null,a.createElement("i",{className:"fa fa-angle-up"})),a.createElement("div",null,"Warmer")),a.createElement("button",{type:"button",className:"btn tempButton coolTo",onClick:function(){return e.changeTemperature(!0,c.c.Cool,C&&C.coolTemp?C.coolTemp:0)},disabled:R},a.createElement("div",null,"Cooler"),a.createElement("div",null,a.createElement("i",{className:"fa fa-angle-down"}))))))),a.createElement("div",{className:"row"},a.createElement("br",null),a.createElement("div",{className:"RelayHeading center"},a.createElement("b",null,"Relay Status: ",C.isRelayOn?"On":"Off")))),a.createElement("div",{className:"col-md-6 col-xs-12 tempCounter roomTemp "},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12"},a.createElement("div",null,"Room Temp"),a.createElement("div",{className:"counter"},O," \xb0F")),C&&C.controlType!=c.a.Manual&&p.showRoomOccupancy&&a.createElement("div",{className:"col-md-6 col-xs-12",style:{textAlign:"start"}},a.createElement("div",null,"Room Occupancy"),a.createElement("div",{className:"counter"},C.isRoomOccupied))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},a.createElement("div",{className:"btn-group"},a.createElement("button",{type:"button",disabled:R,className:C&&C.mode===c.c.Off?"btn btn-fill":"btn",onClick:function(){return e.changeMode(c.c.Off)}},"Off"),a.createElement("button",{type:"button",className:C&&C.mode===c.c.Heat?"btn btn-fill":"btn",disabled:R,onClick:function(){return e.changeMode(c.c.Heat)}},"Heat"),a.createElement("button",{type:"button",className:C&&C.mode===c.c.Cool?"btn btn-fill":"btn",disabled:R,onClick:function(){return e.changeMode(c.c.Cool)}},"Cool"))),a.createElement("div",{className:"col-md-6 col-xs-12 pull-right"},a.createElement("div",{className:"row PTACInfo",style:{display:"grid"}},a.createElement("div",{className:"mb-5"},a.createElement("div",{className:"col-md-3 col-xs-6",style:{textAlign:"left"}},a.createElement("div",null,"Power Watts"),a.createElement("div",{style:{fontWeight:"lighter"}},N&&N.active_power_Watts&&parseFloat(N.active_power_Watts)?parseFloat(N.active_power_Watts):0," kW")),a.createElement("div",{className:"col-md-3 col-xs-6",style:{textAlign:"left"}},a.createElement("div",null,"Voltage"),a.createElement("div",{style:{fontWeight:"lighter"}},N&&N.voltage_volts?N.voltage_volts:0," V")),p.showCarbonDioxide&&a.createElement("div",{className:"col-md-3 col-xs-6",style:{textAlign:"left"}},a.createElement("div",null,"CO2"),a.createElement("div",{style:{fontWeight:"lighter"}},x.equiCO2_ppm?x.equiCO2_ppm+" ppm":"0 ppm"," ")),p.showHumidity&&a.createElement("div",{className:"col-md-3 col-xs-6",style:{textAlign:"left"}},a.createElement("div",null,"Humidity"),a.createElement("div",{style:{fontWeight:"lighter"}},x.relhumidity_pct?x.relhumidity_pct+" %":"0 %"))),a.createElement("div",{className:"mb-4"},a.createElement("div",{className:"col-md-3 col-xs-6",style:{textAlign:"left"}},a.createElement("div",null,"Frequency"),a.createElement("div",{style:{fontWeight:"lighter"}},N&&N.frequency_Hz?this.applyRule(N.frequency_Hz,!0,55):0," Hz")),a.createElement("div",{className:"col-md-3 col-xs-6",style:{textAlign:"left"}},a.createElement("div",null,"Energy Watt/Hour"),a.createElement("div",{style:{fontWeight:"lighter"}},N&&N.import_active_energy_Wh&&parseFloat(N.import_active_energy_Wh)?parseFloat(N.import_active_energy_Wh).toFixed(2):0," kWh")))))),a.createElement("div",{className:"row mt-22"},a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},a.createElement("div",null,a.createElement("button",{className:"btn btn-success center custom-outline-btn",title:"Control Settings",onClick:function(t){D?e.setState({openRelayControlDialog:!0},function(){document.getElementById("btnDialogRelayControl").click()}):Object(r.a)("No controlling device (i1 relay) found in solution to control PTAC")}}," ",a.createElement("i",{className:"fa fa-sliders"})," Control Settings",a.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Controls Settings")))),a.createElement("div",{className:"col-md-6 col-xs-12 InsightRow pull-right"},a.createElement("div",{className:"btn-group"},a.createElement("button",{type:"button",className:"btn btn-success "+(C&&C.controlType==c.a.Local?"btn-fill":""),onClick:function(){return E(e,void 0,void 0,function(){return T(this,function(e){return this.changeControlType(c.a.Local),[2]})})}},"Local"),a.createElement("button",{type:"button",className:"btn cursor-no-drop "+(!C||C.controlType!=c.a.Manual&&C.controlType!=c.a.Schedule&&C.controlType!=c.a.Optimize&&C.controlType!=c.a.Shutdown?"":"btn-success btn-fill")},"Remote"),a.createElement("button",{type:"button",onClick:function(){return E(e,void 0,void 0,function(){return T(this,function(e){return this.changeControlType(c.a.Manual),[2]})})},className:"btn btn-success "+(C&&C.controlType==c.a.Manual?"btn-fill":"")},"Manual"),a.createElement("button",{type:"button",className:"btn btn-success "+(C&&C.controlType==c.a.Schedule?"btn-fill":""),onClick:function(){return E(e,void 0,void 0,function(){return T(this,function(e){return this.changeControlType(c.a.Schedule),[2]})})}},"Schedule"),a.createElement("button",{type:"button",className:"btn btn-success "+(C&&C.controlType==c.a.Optimize?"btn-fill":""),onClick:function(){return E(e,void 0,void 0,function(){return T(this,function(e){return this.changeControlType(c.a.Optimize),[2]})})}},"Optimize"),a.createElement("button",{disabled:"Off"==C.mode,type:"button",className:"btn btn-success "+(C&&C.controlType==c.a.Shutdown?"btn-fill":""),onClick:function(){return E(e,void 0,void 0,function(){return T(this,function(e){return this.changeControlType(c.a.Shutdown),[2]})})}},"Shutdown")))),"Optimize"==C.controlType&&a.createElement("div",{className:"row p-4"},a.createElement("div",{className:"col-md-9"}),a.createElement("div",{className:"btn-group pull-right col-md-3 pl-0 mr-2"},a.createElement("button",{id:"optiStatus1",className:"btn "+("0"==C.optimizeStatus?"btn-fill":""),onClick:function(){e.setOptimizeStatus("0")},type:"button"},"0"),a.createElement("button",{id:"optiStatus1",disabled:"Cool"!=C.mode,className:"btn "+("1"==C.optimizeStatus?"btn-fill":""),onClick:function(){e.setOptimizeStatus("1")},type:"button"},"1"),a.createElement("button",{onClick:function(){e.setOptimizeStatus("2")},id:"optiStatus2",disabled:"Cool"!=C.mode,className:"btn "+("2"==C.optimizeStatus?"btn-fill":""),type:"button"},"2"),a.createElement("button",{onClick:function(){e.setOptimizeStatus("3")},id:"optiStatus3",disabled:"Heat"!=C.mode,className:"btn "+("3"==C.optimizeStatus?"btn-fill":""),type:"button"},"3"),a.createElement("button",{onClick:function(){e.setOptimizeStatus("4")},id:"optiStatus4",disabled:"Heat"!=C.mode,className:"btn "+("4"==C.optimizeStatus?"btn-fill":""),type:"button"},"4"))),a.createElement("div",{className:S?"InsightApplyChanges":"hidden",style:{margin:"55px -15px"}},a.createElement("h4",null,"Do you want to apply these changes?"),a.createElement("div",null,a.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){e.setState({modelChanged:!1})}},"Cancel"),"\xa0",a.createElement("button",{type:"button",className:"btn btn-fill btn-danger",onClick:function(){}},"Reset"),"\xa0",a.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){return e.saveChanges(!0,!1)}},"Apply Changes"))),a.createElement(o.a,{id:"bootDevice_"+s,heading:"Boot Device",cancelButtonText:"Cancel",showCreateButton:!0,createButtonText:"Boot",showRestoreButton:!0,showCancelButton:!0,onSaveButtonClick:function(){return e.bootDevice()}},a.createElement("h4",null,"Are you sure you want to boot device?")))))),w&&D&&a.createElement(a.Fragment,null,a.createElement("button",{type:"button",id:"btnDialogRelayControl",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#dialogRelayControl"}," . "),a.createElement(g.a,{id:"dialogRelayControl",ptacEqipmenteName:s,buildingName:i,onCloseControlDialog:this.onCloseRelayControlDialog,ptacEqipmentType:"PTAC",ptacEqipmenteLabel:u,ptacSolution:l})),"Schedule"==f&&a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},a.createElement(v.default,{isSolution:!0,equipmentOntology:s,instance:n,buildingName:i,InsightName:D.deviceName,solutionOntology:l,solutionEquipmentType:"PTAC",ControlName:"PTACControl",type:"Equipment",hideTabs:!0})),"Alarms"==f&&a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}}),"InnerControllerADP"==f&&a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},a.createElement(b.default,{instance:n,buildingName:i,InsightName:s,ControlName:"PTACControl",type:"Equipment",hideTabs:!0,solutionOntology:l})),"Graphs"==f&&a.createElement("div",null,a.createElement(y.a,{instance:n,buildingName:i,devices:m,equipment:s,graphType:"PTAC",solution:l})))},t}(a.Component);t.a=S},2707:function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(664)),r=n(688),i=n(11),l=n(117),c=n(1008),s=n(793),u=n(22),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={SensorList:[],devices:[],ptacControllerSettings:Object(),ptacController:Object()},n.onSaveHandle=n.onSaveHandle.bind(n),n.fetchDevices=n.fetchDevices.bind(n),n.handleTypeChange=n.handleTypeChange.bind(n),n.handleSensorChange=n.handleSensorChange.bind(n),n.fetchPTACControlSettingsData=n.fetchPTACControlSettingsData.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return Object(l.a)(!0),[4,this.fetchDevices()];case 1:return e.sent(),[4,this.fetchPTACInfo()];case 2:return e.sent(),[4,this.fetchPTACControlSettingsData()];case 3:return e.sent(),Object(l.a)(!1),[2]}})})},t.prototype.fetchPTACControlSettingsData=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r,i;return d(this,function(l){switch(l.label){case 0:return e=this.props,t=e.ptacEqipmenteName,n=e.ptacSolution,a=e.ptacEqipmentType,t?[4,Object(c.e)("","",t)]:[3,3];case 1:return o=l.sent(),[4,Object(c.g)(o)];case 2:(r=l.sent())&&r.length>0&&r[0]?this.setState({ptacControllerSettings:r[0]}):(i={ontology:Object(u.y)(12),controlType:"",equipment:t,equipmentType:a,ptactType:"",sensorDevice:"",solutionOntology:n},this.setState({ptacControllerSettings:i})),l.label=3;case 3:return[2]}})})},t.prototype.fetchPTACInfo=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r,i;return d(this,function(l){switch(l.label){case 0:return e=this.props,t=e.buildingName,n=e.ptacEqipmenteName,a=e.ptacSolution,[4,Object(c.a)(t,null,null,n)];case 1:return(o=l.sent())&&o.length>0?[4,Object(c.f)(o)]:[3,3];case 2:return r=l.sent(),i=r[0],this.setState({ptacController:i}),[3,4];case 3:i={ontology:Object(u.y)(12),controlType:s.a.Local,coolTemp:0,equipment:n,fanStatus:s.b.Auto,heatTemp:0,isRelayOn:!1,isAutoOff:!1,solutionOntology:a,mode:s.c.Off,optimizeStatus:"",isOptimizedActive:!1,isShutdownActive:!1,isRoomOccupied:"UNOCCUPIED"},this.setState({ptacController:i}),l.label=4;case 4:return[2]}})})},t.prototype.handleTypeChange=function(e){var t=this.state.ptacControllerSettings;t.ptactType=e,this.setState({ptacControllerSettings:t})},t.prototype.handleSensorChange=function(e){var t=this.state.ptacControllerSettings;t.sensorDevice=e,this.setState({ptacControllerSettings:t})},t.prototype.fetchDevices=function(){return p(this,void 0,void 0,function(){var e,t,n;return d(this,function(a){switch(a.label){case 0:return(e=this.props.buildingName)?(t=[],[4,Object(r.u)(e)]):[3,2];case 1:(n=a.sent())&&n.length>0&&(t=n.filter(function(e){return-1!=Object(i.g)(e.moncontype).toLowerCase().indexOf("ceiling")}).map(function(e){return{value:Object(i.g)(e.moncondevice),label:Object(i.g)(e.rdfsLabel)}})),this.setState({devices:n,SensorList:t}),a.label=2;case 2:return[2]}})})},t.prototype.onSaveHandle=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r;return d(this,function(i){switch(i.label){case 0:return e=this.props,t=e.buildingName,n=e.refreshControlDB,a=e.onCloseControlDialog,o=this.state,r=o.ptacControllerSettings,o.ptacController.controlType==s.a.Manual?r.controlType="10":r.sensorDevice?r.controlType="6":r.controlType="1",Object(l.a)(!0),[4,Object(c.i)(t,r)];case 1:return i.sent(),n?[4,n()]:[3,3];case 2:i.sent(),i.label=3;case 3:return a&&a(!1),Object(l.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.id,r=t.onCloseControlDialog,i=t.ptacEqipmenteLabel,l=this.state,c=l.ptacControllerSettings,s=l.SensorList,u=!c||!c.ptactType;return a.createElement(o.a,{id:n,saveButtonText:"Save",heading:i+" Control Settings",showSaveButton:!0,disableSaveButton:u,showCancelButton:!0,onSaveButtonClick:function(){e.onSaveHandle()},onCancelButtonClickActive:!0,onCancelButtonClick:function(){return p(e,void 0,void 0,function(){return d(this,function(e){return r&&r(!1),[2]})})}},a.createElement("div",{className:"card dataCard no-margin"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"ptacType"},"PTAC Type:"),a.createElement("select",{id:"ptacType",className:"form-control",value:c&&c.ptactType,onChange:function(t){return e.handleTypeChange(t.target.value)}},a.createElement("option",{value:"0"},"Select Type"),a.createElement("option",{value:"A"},"Type A"),a.createElement("option",{value:"B"},"Type B"),a.createElement("option",{value:"C"},"Type C"))),a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"sensor"},"Occupancy Sensor:"),a.createElement("select",{id:"sensor",className:"form-control",value:c&&c.sensorDevice,onChange:function(t){return e.handleSensorChange(t.target.value)}},a.createElement("option",{value:""},"Select Occupancy Sensor"),s&&s.map(function(e){return a.createElement("option",{value:e.value},e.label)})))))))},t}(a.Component);t.a=h},2708:function(e,t,n){"use strict";var a,o=n(2),r=(n.n(o),n(23)),i=n(117),l=n(855),c=n(688),s=n(22),u=n(899),m=n(1125),p=n(793),d=n(2709),h=n(901),f=n(694),b=n(1214),g=n(696),v=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),y=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},C=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},E=function(e){function t(t,n){var a=e.call(this,t)||this;return a.state={rtuADP:Object(),currentTabs:"CurrentValues",ceilingSensorsDevice:[],cbw418DeviceData:Object(),ceilingSensorsData:[],thermostatData:{activestage:0,availablemodes:0,away:0,cooltemp:0,cooltempmax:0,cooltempmin:0,dehum_setpoint:0,fan:0,fanstate:0,forceunocc:0,heattemp:0,heattempmax:0,heattempmin:0,holiday:0,hum:0,hum_setpoint:0,insightName:"",mode:0,name:"Thermostat",override:0,overridetime:0,schedule:0,schedulepart:0,setpointdelta:0,spacetemp:0,state:0,tempunits:0,thermostatControlStatus:"Local",timestamp:void 0},modelChanged:!1,rtuController:Object(),openControlSettingsDialog:!1,isTabChangedToGraph:!1,thermostatDevice:Object(),cbw418Device:Object(),rtuComputingDevice:Object(),ScheduleIsOnModel:Object()},a.fetchDevicesMQTTData=a.fetchDevicesMQTTData.bind(a),a.fetchThermostatData=a.fetchThermostatData.bind(a),a.fetchDevices=a.fetchDevices.bind(a),a.onChangeTemperature=a.onChangeTemperature.bind(a),a.onChangeGivenTemp=a.onChangeGivenTemp.bind(a),a.heatTempChange=a.heatTempChange.bind(a),a.coolTempChange=a.coolTempChange.bind(a),a.resetChanges=a.resetChanges.bind(a),a.fetchRTUADP=a.fetchRTUADP.bind(a),a.fetchRTUInfo=a.fetchRTUInfo.bind(a),a.onChangeMode=a.onChangeMode.bind(a),a.setIntervalStart=a.setIntervalStart.bind(a),a.setOptimizeStatus=a.setOptimizeStatus.bind(a),a.onCloseControlDialog=a.onCloseControlDialog.bind(a),a}return v(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this.fetchThermostatData(!0)];case 1:return e.sent(),[4,this.fetchDevices()];case 2:return e.sent(),[4,this.fetchRTUADP()];case 3:return e.sent(),[4,this.fetchRTUInfo()];case 4:return e.sent(),[4,this.setIntervalStart()];case 5:return e.sent(),[2]}})})},t.prototype.fetchDevices=function(){return y(this,void 0,void 0,function(){var e,t,n,a,o,i,l,c=this;return C(this,function(s){switch(s.label){case 0:return(e=this.props.Devices)&&e.length>0?(t=[],n=Object(),a=Object(),o=Object(),e&&e.length>0?(t=e.filter(function(e){return"CeilingSensor"==e.monitoringControlDeviceType}),n=e.find(function(e){return"Thermostat"===e.monitoringControlDeviceType})?e.find(function(e){return"Thermostat"===e.monitoringControlDeviceType}):e.find(function(e){return"VenstarThermostat"===e.monitoringControlDeviceType}),a=e.find(function(e){return"CBW418"==e.monitoringControlDeviceType}),n&&n.deviceName?[3,1]:(Object(r.a)("No controlling device (THERMOSTAT) found in solution to control RTU"),[2])):[3,4]):[3,5];case 1:return n.computingDevice?[4,Object(f.f)(n.computingDevice)]:[3,4];case 2:return i=s.sent(),[4,Object(f.d)(i)];case 3:(l=s.sent())&&l.length>0&&(o=l[0]),s.label=4;case 4:this.setState({ceilingSensorsDevice:t,thermostatDevice:n,rtuComputingDevice:o,cbw418Device:a},function(){c.fetchDevicesMQTTData()}),s.label=5;case 5:return[2]}})})},t.prototype.fetchRTUInfo=function(){return y(this,void 0,void 0,function(){var e,t,n,a,o,r,i,c,u;return C(this,function(d){switch(d.label){case 0:return e=this.props,t=e.buildingName,n=e.equipmentOntology,a=e.solutionOntology,o=this.state.thermostatData,r="",o.state==l.d.COOLING?r="Cooling":o.state==l.d.HEATING?r="Heating":o.state==l.d.Idle||void 0==o.state?r="Idle":o.state==l.d.ERROR?r="Error":o.state==l.d.LOCKOUT&&(r="Lockout"),i=Object(),[4,Object(m.a)(t,null,null,n)];case 1:return(c=d.sent())&&c.length>0?[4,Object(m.e)(c)]:[3,3];case 2:return u=d.sent(),i=u[0],[3,4];case 3:i={ontology:Object(s.y)(12),solutionOntology:a,equipment:n,heatTemp:o.heattemp?o.heattemp:0,coolTemp:o.cooltemp?o.cooltemp:0,thermostatState:r,airDamper:0,isAirDamperOpen:!1,controlType:p.a.Local,isOptimizedActive:!1,isRoomOccupied:"UNOCCUPIED",isShutdownActive:!1,mode:p.c.Off,optimizeStatus:"0"},d.label=4;case 4:return this.setState({rtuController:i}),[2]}})})},t.prototype.fetchRTUADP=function(){return y(this,void 0,void 0,function(){var e,t,n,a,o,r;return C(this,function(i){switch(i.label){case 0:return e=this.props,t=e.equipmentOntology,n=e.buildingName,a=e.solutionOntology,o=Object(),[4,Object(m.c)(n,"",t,a)];case 1:return r=i.sent(),o=r&&r.equipment?r:{ontology:Object(s.y)(12),building:n,equipment:t,solutionOntology:a,MotionDetectionE1:1,MotionDetectionE2:1,OccupancyDeadband:20,AirDamperDeadband:20,NoOfMotionTriggers:100,NoOfBTDevicesTriggers:5,OptimizeSecondStage:!1,OptimizeAirCondition:!1,ADPSettings:l.a,HumidityPercentage:50,CO2Level:100},this.setState({rtuADP:o}),[2]}})})},t.prototype.setIntervalStart=function(){var e=this;a&&clearInterval(a);var t=0;a=setInterval(function(){return y(e,void 0,void 0,function(){var e,n,a;return C(this,function(o){switch(o.label){case 0:return e=this.state,n=e.modelChanged,a=e.isTabChangedToGraph,t++,a?[3,4]:!n&&t>=20?(t=0,[4,this.fetchThermostatData(!1)]):[3,4];case 1:return o.sent(),[4,this.fetchRTUInfo()];case 2:return o.sent(),[4,this.fetchDevicesMQTTData()];case 3:o.sent(),Object(i.a)(!1),o.label=4;case 4:return[2]}})})},1e3)},t.prototype.componentWillUnmount=function(){clearInterval(a)},t.prototype.resetChanges=function(e){return y(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return[4,this.fetchThermostatData(e)];case 1:return t.sent(),[4,this.fetchRTUInfo()];case 2:return t.sent(),[2]}})})},t.prototype.fetchDevicesMQTTData=function(){return y(this,void 0,void 0,function(){var e,t,n,a,o,i;return C(this,function(l){switch(l.label){case 0:if(e=this.state,t=e.ceilingSensorsDevice,n=e.ceilingSensorsData,a=e.cbw418Device,o=e.cbw418DeviceData,n=[],!t||!t[0])return[3,5];i=0,l.label=1;case 1:return i<t.length?t[i]&&t[i].topic?[4,Object(c.n)(t[i]).then(function(e){var a=e[0];return!a||a&&a.error?(n.push(Object()),Object(r.a)("Error occurred while fetching ceiling sensor board info."),Object()):(n.push(a),localStorage.setItem(t[0].deviceID,JSON.stringify(e)),a)}).catch(function(e){return Object()})]:[3,3]:[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[3,6];case 5:Object(r.a)("No ceiling sensor connected to RTU"),l.label=6;case 6:return a&&a.topic?[4,Object(g.h)(a.topic,null,null,!0).then(function(e){var t=e[0];return!t||t&&t.error?(o=Object(),Object(r.a)("Error occurred while fetching CBW-418 board info."),Object()):(o=t,localStorage.setItem(a.deviceID,JSON.stringify(e)),t)}).catch(function(e){return Object()})]:[3,8];case 7:l.sent(),l.label=8;case 8:return this.setState({ceilingSensorsData:n,cbw418DeviceData:o}),[2]}})})},t.prototype.fetchThermostatData=function(e){return y(this,void 0,void 0,function(){var t,n,a,o;return C(this,function(l){switch(l.label){case 0:return t=this.props.Devices,(n=t.find(function(e){return"Thermostat"===e.monitoringControlDeviceType})?t.find(function(e){return"Thermostat"===e.monitoringControlDeviceType}):t.find(function(e){return"VenstarThermostat"===e.monitoringControlDeviceType}))&&n.monitoringControl?(e&&Object(i.a)(!0,"Fetching data from Thermostat"),[4,Object(c.G)(n.topic,null,null,!0).then(function(e){return!e||e&&e.error?(Object(r.a)("Error occurred while fetching thermostat info."),Object()):(e&&localStorage.setItem(n.deviceID,JSON.stringify(e)),e)}).catch(function(e){return Object()})]):[2];case 1:return a=l.sent(),e&&Object(i.a)(!1),o=a&&a.length>0&&a[0]?a[0]:{activestage:0,availablemodes:0,away:0,cooltemp:0,cooltempmax:0,cooltempmin:0,dehum_setpoint:0,fan:0,fanstate:0,forceunocc:0,heattemp:0,heattempmax:0,heattempmin:0,holiday:0,hum:0,hum_setpoint:0,insightName:n.deviceName,mode:0,name:"Thermostat",override:0,overridetime:0,schedule:0,schedulepart:0,setpointdelta:0,spacetemp:0,state:0,tempunits:0,thermostatControlStatus:"Local",timestamp:void 0},this.setState({thermostatData:o}),[2]}})})},t.prototype.onChangeGivenTemp=function(e,t){var n=this.state.rtuController;("cool"==t||n.mode==p.c.Auto&&"cool"==t)&&(n.coolTemp=parseFloat(e)),("heat"==t||n.mode==p.c.Auto&&"heat"==t)&&(n.heatTemp=parseFloat(e)),this.setState({rtuController:n,modelChanged:!0})},t.prototype.heatTempChange=function(e){var t=this.state.rtuController,n=0;"warmer"==e?(n=t.heatTemp?t.heatTemp:0,n+=1):(n=t.heatTemp?t.heatTemp:0,n-=1),t.heatTemp=n,this.setState({rtuController:t,modelChanged:!0})},t.prototype.coolTempChange=function(e){var t=this.state.rtuController,n=0;"warmer"==e?(n=t.coolTemp?t.coolTemp:0,n+=1):(n=t.coolTemp?t.coolTemp:0,n-=1),t.coolTemp=n,this.setState({rtuController:t,modelChanged:!0})},t.prototype.onChangeTemperature=function(e,t){var n=this.state.rtuController;n.mode==p.c.Heat?this.heatTempChange(e):n.mode==p.c.Cool?this.coolTempChange(e):n.mode==p.c.Auto&&("cool"==t?this.coolTempChange(e):this.heatTempChange(e))},t.prototype.onChangeMode=function(e){var t,n=this.state,a=n.rtuController,o=n.rtuADP;(a.mode=e,a.optimizeStatus="",e==p.c.Cool||e==p.c.Auto)&&(a.coolTemp>=0&&a.coolTemp<=1&&o&&o.ADPSettings&&o.ADPSettings.length>0&&(t=o.ADPSettings.find(function(e){return"COOLING"==e.season&&"UNOCCUPIED"==e.occType}))&&t.defaultTargetTemp&&(a.coolTemp=parseFloat(t.defaultTargetTemp)));e!=p.c.Heat&&e!=p.c.Auto||a.heatTemp>=0&&a.heatTemp<=1&&o&&o.ADPSettings&&o.ADPSettings.length>0&&(t=o.ADPSettings.find(function(e){return"HEATING"==e.season&&"UNOCCUPIED"==e.occType}))&&t.defaultTargetTemp&&(a.heatTemp=parseFloat(t.defaultTargetTemp));this.setState({rtuController:a,modelChanged:!0})},t.prototype.changeControlType=function(e){return y(this,void 0,void 0,function(){var t,n,a;return C(this,function(o){switch(o.label){case 0:return t=this.props.equipmentOntology,(n=this.state.rtuController).controlType=e,Object(i.a)(!0),(a=Object()).equipmentOntology=t,a.isScheduleOn=e==p.a.Schedule,[4,Object(c._0)(a)];case 1:return o.sent(),n.isShutdownActive=e==p.a.Shutdown,n.isOptimizedActive=e==p.a.Optimize,this.setState({rtuController:n,modelChanged:!0,ScheduleIsOnModel:a}),Object(i.a)(!1),[2]}})})},t.prototype.setOptimizeStatus=function(e){var t=this.state.rtuController;t.optimizeStatus=e,t.isOptimizedActive=!0,t.isShutdownActive=!1,this.setState({rtuController:t,modelChanged:!0})},t.prototype.saveChanges=function(e){return y(this,void 0,void 0,function(){var t,n,a,o,s,u,p,d,h,f,b=this;return C(this,function(g){switch(g.label){case 0:return t=this.state,n=t.modelChanged,a=t.rtuController,o=t.thermostatDevice,s=t.rtuComputingDevice,u=t.thermostatData,Object(i.a)(!0),o&&o.deviceName?s&&s.controllerIpAddress?s&&s.macID?n?(p=void 0,"Off"==a.mode?p=l.c.OFF:"Heat"==a.mode?p=l.c.HEAT:"Cool"==a.mode?p=l.c.COOL:"Auto"==a.mode&&(p=l.c.AUTO),d=o&&o.wirelessConfig&&o.wirelessConfig.ipAddress?o.wirelessConfig.ipAddress:"",h={controller_pi:s.controllerIpAddress,mac_id:s.macID,device_name:o.deviceName,mode:p,state:u.state,fan:u.fan,fanstate:u.fanstate,tempunits:u.tempunits,schedule:u.schedule,schedulepart:u.schedulepart,away:u.away,holiday:u.holiday,override:u.override,overridetime:u.overridetime,forceunocc:u.forceunocc,spacetemp:u.spacetemp,heattemp:a.heatTemp,cooltemp:a.coolTemp,cooltempmin:u.cooltempmin,cooltempmax:u.cooltempmax,heattempmin:u.heattempmin,heattempmax:u.heattempmax,setpointdelta:u.setpointdelta,hum:u.hum,hum_setpoint:u.hum_setpoint,dehum_setpoint:u.dehum_setpoint,availablemodes:u.availablemodes,name:u.name,activestage:u.activestage,thermostatControlStatus:a.controlType,airDamperRelayStatus:a.airDamper,tstat_ip:d,timestamp_request:""+(new Date).getTime()},[4,Object(c.P)(h)]):[3,5]:(Object(r.a)("No mac id found in connected computing device"+(s.name||"")),[2]):(Object(r.a)("No controlling ip address found in connected computing device "+(s.name||"")),[2]):(Object(r.a)("No controlling device found in solution to control RTU"),[2]);case 1:return(f=g.sent())&&0==f.responseCode?[4,Object(m.b)(this.props.buildingName,a,!e)]:[3,3];case 2:return g.sent(),[3,4];case 3:Object(r.a)("No response from Socket"),g.label=4;case 4:this.setState({modelChanged:!1},function(){b.fetchRTUInfo()}),g.label=5;case 5:return Object(i.a)(!1),[2]}})})},t.prototype.onCloseControlDialog=function(e){this.setState({openControlSettingsDialog:e})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,a=t.buildingName,r=t.equipmentOntology,i=t.solutionOntology,l=t.equipmentRdfsLabel,c=t.Devices,s=t.controllerScreenSettings,m=this.state,f=m.currentTabs,g=m.ceilingSensorsData,v=m.ceilingSensorsDevice,E=m.thermostatData,T=m.modelChanged,S=m.rtuController,O=m.openControlSettingsDialog,N=m.cbw418DeviceData,D=m.thermostatDevice,w=!S||S.controlType!=p.a.Manual,x=S.mode==p.c.Auto&&S.coolTemp<S.heatTemp+.5,j=c.find(function(e){return"Thermostat"==e.monitoringControlDeviceType})?c.find(function(e){return"Thermostat"==e.monitoringControlDeviceType}).deviceName:c.find(function(e){return"VenstarThermostat"==e.monitoringControlDeviceType}).deviceName;return o.createElement(o.Fragment,null,o.createElement("div",{className:"row m-0"},o.createElement("div",{className:"col-md-12 padding-5 margin-5"},o.createElement("div",{className:"btn-group"},o.createElement("button",{className:"btn "+("CurrentValues"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"CurrentValues",isTabChangedToGraph:!1})}},o.createElement("span",{className:"vertical-align"},"Controller")),o.createElement("button",{className:"btn "+("Schedule"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"Schedule",isTabChangedToGraph:!1})}},o.createElement("span",{className:"vertical-align"},"Schedule")),o.createElement("button",{className:"btn "+("Graphs"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"Graphs",isTabChangedToGraph:!0})}},o.createElement("span",{className:"vertical-align"},"Graphs")),o.createElement("button",{className:"btn "+("RTUControllerADP"==f?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTabs:"RTUControllerADP",isTabChangedToGraph:!1})}},o.createElement("span",{className:"vertical-align"},"ADP"))))),"CurrentValues"==f&&o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("div",{className:"card",id:"InsightsList"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"header py-5 mb-5"},o.createElement("h4",{className:"title"},o.createElement("strong",null,"Equipment Status:")," (",S.thermostatState,")"))),o.createElement("div",{className:"RTU"},o.createElement("div",{className:"content"},o.createElement("div",{className:"row set-display-flex align-items-center"},o.createElement("div",{className:"col-md-6 col-xs-12 pl-0"},S&&S.mode==p.c.Off&&o.createElement(o.Fragment,null),S&&(S.mode==p.c.Cool||S.mode==p.c.Auto)&&o.createElement("div",{className:"row mb-5",style:{alignItems:"end"}},o.createElement("div",{className:"set-display-flex",style:{alignItems:"center",justifyContent:"center"}},o.createElement("div",{className:"col-md-4 col-sm-12 set-display-flex",style:{justifyContent:"center"}},o.createElement("div",{className:"col-md-6"},o.createElement("p",{className:"mb-0"},"Cool To"),o.createElement("div",{className:"row set-display-flex"},o.createElement("label",{className:"custom-field two ml-3"},o.createElement("input",{type:"number",value:S.coolTemp?parseFloat(S.coolTemp.toFixed(1)):0,disabled:w,onChange:function(t){e.onChangeGivenTemp(t.target.value,"cool")}})),o.createElement("span",{style:{fontSize:"25px",alignSelf:"center",marginBottom:"14px"}},o.createElement("b",null," \xb0F"))))),o.createElement("div",{className:"col-md-4 col-sm-12"},o.createElement("div",{className:"btn-group-vertical"},o.createElement("button",{type:"button",className:"btn tempButton heatTo",disabled:w,style:{height:"57px",width:"100px"},onClick:function(){e.onChangeTemperature("warmer","cool")}},o.createElement("div",null,o.createElement("i",{className:"fa fa-angle-up"})),o.createElement("div",null,"Warmer")),o.createElement("button",{type:"button",className:"btn tempButton coolTo",style:{height:"57px",width:"100px"},disabled:w||x,onClick:function(){e.onChangeTemperature("cooler","cool")}},o.createElement("div",null,"Cooler"),o.createElement("div",null,o.createElement("i",{className:"fa fa-angle-down"}))))))),S&&(S.mode==p.c.Heat||S.mode==p.c.Auto)&&o.createElement("div",{className:"row mb-5",style:{alignItems:"end"}},o.createElement("div",{className:"set-display-flex",style:{alignItems:"center",justifyContent:"center"}},o.createElement("div",{className:"col-md-4 col-sm-12 set-display-flex",style:{justifyContent:"center"}},o.createElement("div",{className:"col-md-6"},o.createElement("p",{className:"mb-0"},"Heat To"),o.createElement("div",{className:"row set-display-flex"},o.createElement("label",{className:"custom-field two ml-3"},o.createElement("input",{type:"number",value:S.heatTemp?parseFloat(S.heatTemp.toFixed(1)):0,disabled:w,onChange:function(t){e.onChangeGivenTemp(t.target.value,"heat")}})),o.createElement("span",{style:{fontSize:"25px",alignSelf:"center",marginBottom:"14px"}},o.createElement("b",null," \xb0F"))))),o.createElement("div",{className:"col-md-4 col-sm-12"},o.createElement("div",{className:"btn-group-vertical"},o.createElement("button",{type:"button",disabled:w||x,className:"btn tempButton heatTo",style:{height:"57px",width:"100px"},onClick:function(){e.onChangeTemperature("warmer","heat")}},o.createElement("div",null,o.createElement("i",{className:"fa fa-angle-up"})),o.createElement("div",null,"Warmer")),o.createElement("button",{type:"button",disabled:w,className:"btn tempButton coolTo",style:{height:"57px",width:"100px"},onClick:function(){e.onChangeTemperature("cooler","heat")}},o.createElement("div",null,"Cooler"),o.createElement("div",null,o.createElement("i",{className:"fa fa-angle-down"}))))))),o.createElement("div",{className:"col-md-12 col-sm-12 mt-5",style:{justifyContent:"center",textAlign:"center"}},o.createElement("div",{className:"btn-group"},o.createElement("button",{type:"button",className:"btn "+(S.mode===p.c.Off?"btn-fill":""),disabled:w,onClick:function(){e.onChangeMode(p.c.Off)}},"Off"),o.createElement("button",{type:"button",className:"btn "+(S.mode===p.c.Heat?"btn-fill":""),disabled:w,onClick:function(){e.onChangeMode(p.c.Heat)}},"Heat"),o.createElement("button",{type:"button",className:"btn "+(S.mode===p.c.Cool?"btn-fill":""),disabled:w,onClick:function(){e.onChangeMode(p.c.Cool)}},"Cool"),o.createElement("button",{type:"button",className:"btn "+(S.mode===p.c.Auto?"btn-fill":""),disabled:w,onClick:function(){e.onChangeMode(p.c.Auto)}},"Auto"))),o.createElement("div",{className:"row mt-5 col-md-12 col-sm-12 mt-5 ml-2 mb-4",style:{textAlignLast:"center"}},o.createElement("h5",{className:"center"},"Air Damper Status: ",o.createElement("b",null,S.isAirDamperOpen?"Open":"Close"))),o.createElement("div",{className:"row mt-5 col-md-12 col-sm-12 mt-5 ml-2 my-5",style:{textAlignLast:"center"}},o.createElement("button",{className:"btn btn-success center custom-outline-btn center",title:"Control Settings",onClick:function(){e.setState({openControlSettingsDialog:!0},function(){document.getElementById("btnDialogControlSettings").click()})}},o.createElement("i",{className:"fa fa-sliders"})," Control Settings",o.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Controls Settings")))),o.createElement("div",{className:"col-md-6 col-xs-12 pull-right"},o.createElement("div",{className:"tempCounter my-5 pt-0"},o.createElement("div",{className:"row set-display-flex"},o.createElement("div",{className:"col-md-5 col-xs-6 pl-0",style:{textAlign:"center"}},o.createElement("h5",null,"Room Temp"),o.createElement("h3",{className:"mt-3"},o.createElement("b",null,E&&E.spacetemp?E.spacetemp:"0"," \xb0F"))),S&&S.controlType!=p.a.Manual&&s.showRoomOccupancy&&o.createElement("div",{className:"col-md-5 col-xs-6 pl-0",style:{textAlign:"center"}},o.createElement("h5",null,"Room Occupancy"),o.createElement("h3",{className:"mt-3"},o.createElement("b",null,S.isRoomOccupied))))),o.createElement("div",{className:"row mb-5 pb-4"},v&&v.length>0&&v[0]&&o.createElement(o.Fragment,null,s.showRoomOccupancy&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"CO\u2082"),o.createElement("p",null,g[0]&&g[0].equiCO2_ppm?g[0].equiCO2_ppm+" ppm":"No data found"," ")),s.showHumidity&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"Humidity"),o.createElement("p",null,g[0]&&g[0].relhumidity_pct?g[0].relhumidity_pct+" %":"No data found")),s.showBluetoothDevices&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"Bluetooth Devices"),o.createElement("p",null,g[0]&&g[0].num_BTdev?""+g[0].num_BTdev:"No data found")),s.showAltitude&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"Altitude"),o.createElement("p",null,g[0]&&g[0].altitude_m?g[0].altitude_m+" m":"No data found")),s.showPressure&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"Pressure"),o.createElement("p",null,g[0]&&g[0].pressure_hPa?g[0].pressure_hPa+" hPa":"No data found")),s.showTVOC&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"TVOC"),o.createElement("p",null,g[0]&&g[0].tvoc_ppm?g[0].tvoc_ppm+" ppm":"No data found")),s.showIlluminance&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"Illuminance"),o.createElement("p",null,g[0]&&g[0].illuminance_lux?g[0].illuminance_lux+" Lumens":"No data found")),s.showGasResistance&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"Gas Resistance"),o.createElement("p",null,g[0]&&g[0].gasResistance_kOhm?g[0].gasResistance_kOhm+" kOhm":"No data found")),s.showWifiTemp&&o.createElement("div",{className:"col-md-3 col-xs-4 pb-4",style:{textAlign:"left"}},o.createElement("p",{className:"bold mb-0",style:{fontSize:"15px"}},"WiFi Temperature"),o.createElement("p",null,g[0]&&g[0].wifiTemp1_celsius?9*g[0].wifiTemp1_celsius/5+32+" \xb0F":"No data found")))),o.createElement("div",{className:"row set-display-flex mb-5",style:{justifyContent:"center"}},o.createElement("div",{className:"btn-group"},o.createElement("button",{type:"button",className:"btn btn-success "+(S&&S.controlType==p.a.Local?"btn-fill":""),onClick:function(){e.changeControlType(p.a.Local)}},"Local"),o.createElement("button",{type:"button",className:"btn cursor-no-drop "+(!S||S.controlType!=p.a.Manual&&S.controlType!=p.a.Schedule&&S.controlType!=p.a.Optimize&&S.controlType!=p.a.Shutdown?"":"btn-success btn-fill")},"Remote"),o.createElement("button",{type:"button",className:"btn btn-success "+(S&&S.controlType==p.a.Manual?"btn-fill":""),onClick:function(){return y(e,void 0,void 0,function(){return C(this,function(e){return this.changeControlType(p.a.Manual),[2]})})}},"Manual"),o.createElement("button",{type:"button",disabled:"Off"==S.mode||!D,className:"btn btn-success "+(S&&S.controlType==p.a.Schedule?"btn-fill":""),onClick:function(){return y(e,void 0,void 0,function(){return C(this,function(e){return this.changeControlType(p.a.Schedule),[2]})})}},"Schedule"),o.createElement("button",{type:"button",disabled:"Off"==S.mode||"Auto"==S.mode||!D,className:"btn btn-success "+(S&&S.controlType==p.a.Optimize?"btn-fill":""),onClick:function(){return y(e,void 0,void 0,function(){return C(this,function(e){return this.changeControlType(p.a.Optimize),[2]})})}},"Optimize"),o.createElement("button",{type:"button",disabled:"Off"==S.mode||"Auto"==S.mode||!D,className:"btn btn-success "+(S&&S.controlType==p.a.Shutdown?"btn-fill":""),onClick:function(){return y(e,void 0,void 0,function(){return C(this,function(e){return this.changeControlType(p.a.Shutdown),[2]})})}},"Shutdown"))),"Optimize"==S.controlType&&o.createElement("div",{className:"row set-display-flex mb-5",style:{justifyContent:"center"}},o.createElement("div",{className:"btn-group"},o.createElement("button",{id:"optiStatus0",className:"btn "+("0"==S.optimizeStatus?"btn-fill":""),onClick:function(){e.setOptimizeStatus("0")},type:"button"},"0"),o.createElement("button",{id:"optiStatus1",disabled:"Cool"!=S.mode,className:"btn "+("1"==S.optimizeStatus?"btn-fill":""),onClick:function(){e.setOptimizeStatus("1")},type:"button"},"1"),o.createElement("button",{onClick:function(){e.setOptimizeStatus("2")},id:"optiStatus2",disabled:"Cool"!=S.mode,className:"btn "+("2"==S.optimizeStatus?"btn-fill":""),type:"button"},"2"),o.createElement("button",{onClick:function(){e.setOptimizeStatus("3")},id:"optiStatus3",disabled:"Heat"!=S.mode,className:"btn "+("3"==S.optimizeStatus?"btn-fill":""),type:"button"},"3"),o.createElement("button",{onClick:function(){e.setOptimizeStatus("4")},id:"optiStatus4",disabled:"Heat"!=S.mode,className:"btn "+("4"==S.optimizeStatus?"btn-fill":""),type:"button"},"4"))))),o.createElement("div",{className:"row my-5"},o.createElement("div",{className:"col-md-6 col-xs-12"}),o.createElement("div",{className:"col-md-6 col-xs-12"},o.createElement("h3",{className:"mt-0 bold"},"RTU Status: "),o.createElement("div",{className:"set-display-flex align-items-center mt-5"},o.createElement("p",{className:"mt-3 bold"},"RTU Current:"),o.createElement("p",{className:"mt-3 pl-3"},N&&N.a13comprcurrRefrigerator1?(360*N.a13comprcurrRefrigerator1).toFixed(2):0," kW")))),o.createElement("div",{className:T?"InsightApplyChanges":"hidden",style:{margin:"55px -15px 0px -15px"}},o.createElement("h4",null,"Do you want to apply these changes?"),o.createElement("div",null,o.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){e.resetChanges(!0),e.setState({modelChanged:!1})}},"Cancel"),"\xa0",o.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){e.saveChanges(!0)}},"Apply Changes")))))))),"Schedule"==f&&o.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},o.createElement(h.default,{isSolution:!0,equipmentOntology:r,instance:n,buildingName:a,InsightName:j,solutionOntology:i,solutionEquipmentType:"RTU",ControlName:"RTUControl",type:"Equipment",hideTabs:!0})),"Graphs"==f&&o.createElement("div",{className:"row"},o.createElement(b.a,{instance:n,buildingName:a,devices:c,equipment:r,graphType:"RTU",solution:i})),"RTUControllerADP"==f&&o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement(u.default,{instance:n,buildingName:a,InsightName:r,ControlName:"RTUControl",type:"Equipment",hideTabs:!0,solutionOntology:i}))),O&&o.createElement(o.Fragment,null,o.createElement("button",{type:"button",id:"btnDialogControlSettings",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#btnDialogControlSettings3"}," . "),o.createElement(d.a,{id:"btnDialogControlSettings3",rtuEqipmentName:r,buildingName:a,onCloseControlDialog:this.onCloseControlDialog,rtuEqipmentType:"RTU",rtuEqipmentLabel:l,rtuSolution:i,rtuThermoState:S.thermostatState})))},t}(o.Component);t.a=E},2709:function(e,t,n){"use strict";var a=n(2),o=(n.n(a),n(664)),r=n(688),i=n(11),l=n(117),c=n(793),s=n(22),u=n(1125),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,l)}c((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(o=2&r[0]?a.return:r[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,r[1])).done)return o;switch(a=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){i.label=r[1];break}if(6===r[0]&&i.label<o[1]){i.label=o[1],o=r;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(r);break}o[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={SensorList:[],devices:[],rtuControllerSettings:Object(),rtuController:Object()},n.onSaveHandle=n.onSaveHandle.bind(n),n.fetchDevices=n.fetchDevices.bind(n),n.handleTypeChange=n.handleTypeChange.bind(n),n.handleSensorChange=n.handleSensorChange.bind(n),n.fetchRTUControlSettingsData=n.fetchRTUControlSettingsData.bind(n),n}return m(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return Object(l.a)(!0),[4,this.fetchDevices()];case 1:return e.sent(),[4,this.fetchRTUInfo()];case 2:return e.sent(),[4,this.fetchRTUControlSettingsData()];case 3:return e.sent(),Object(l.a)(!1),[2]}})})},t.prototype.fetchRTUControlSettingsData=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r,i;return d(this,function(l){switch(l.label){case 0:return e=this.props,t=e.rtuEqipmentName,n=e.rtuSolution,a=e.rtuEqipmentType,t?[4,Object(u.d)("","",t)]:[3,3];case 1:return o=l.sent(),[4,Object(u.f)(o)];case 2:(r=l.sent())&&r.length>0&&r[0]?this.setState({rtuControllerSettings:r[0]}):(i={ontology:Object(s.y)(12),controlType:"",equipment:t,equipmentType:a,optimizationType:"",sensorDevice:"",solutionOntology:n},this.setState({rtuControllerSettings:i})),l.label=3;case 3:return[2]}})})},t.prototype.fetchRTUInfo=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r,i,l;return d(this,function(m){switch(m.label){case 0:return e=this.props,t=e.buildingName,n=e.rtuEqipmentName,a=e.rtuSolution,o=e.rtuThermoState,r=Object(),[4,Object(u.a)(t,null,null,n)];case 1:return(i=m.sent())&&i.length>0?[4,Object(u.e)(i)]:[3,3];case 2:return l=m.sent(),r=l[0],[3,4];case 3:r={ontology:Object(s.y)(12),solutionOntology:a,equipment:n,heatTemp:0,coolTemp:0,thermostatState:o,airDamper:0,isAirDamperOpen:!1,controlType:c.a.Local,isOptimizedActive:!1,isRoomOccupied:"UNOCCUPIED",isShutdownActive:!1,mode:c.c.Off,optimizeStatus:"0"},m.label=4;case 4:return this.setState({rtuController:r}),[2]}})})},t.prototype.handleTypeChange=function(e){var t=this.state.rtuControllerSettings;t.optimizationType=e,this.setState({rtuControllerSettings:t})},t.prototype.handleSensorChange=function(e){var t=this.state.rtuControllerSettings;t.sensorDevice=e,this.setState({rtuControllerSettings:t})},t.prototype.fetchDevices=function(){return p(this,void 0,void 0,function(){var e,t,n;return d(this,function(a){switch(a.label){case 0:return(e=this.props.buildingName)?(t=[],[4,Object(r.u)(e)]):[3,2];case 1:(n=a.sent())&&n.length>0&&(t=n.filter(function(e){return-1!=Object(i.g)(e.moncontype).toLowerCase().indexOf("ceiling")}).map(function(e){return{value:Object(i.g)(e.moncondevice),label:Object(i.g)(e.rdfsLabel)}})),this.setState({devices:n,SensorList:t}),a.label=2;case 2:return[2]}})})},t.prototype.onSaveHandle=function(){return p(this,void 0,void 0,function(){var e,t,n,a,o,r;return d(this,function(i){switch(i.label){case 0:return e=this.props,t=e.buildingName,n=e.refreshControlDB,a=e.onCloseControlDialog,o=this.state,r=o.rtuControllerSettings,o.rtuController.controlType==c.a.Manual?r.controlType="10":r.sensorDevice?r.controlType="6":r.controlType="1",Object(l.a)(!0),[4,Object(u.h)(t,r)];case 1:return i.sent(),n?[4,n()]:[3,3];case 2:i.sent(),i.label=3;case 3:return a&&a(!1),Object(l.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.id,r=t.onCloseControlDialog,i=t.rtuEqipmentLabel,l=this.state,c=l.rtuControllerSettings,s=l.SensorList,u=!(c&&"B"==c.optimizationType&&c.sensorDevice||"C"==c.optimizationType);return a.createElement(o.a,{id:n,saveButtonText:"Save",heading:i+" Control Settings",showSaveButton:!0,disableSaveButton:u,showCancelButton:!0,onSaveButtonClick:function(){e.onSaveHandle()},onCancelButtonClickActive:!0,onCancelButtonClick:function(){return p(e,void 0,void 0,function(){return d(this,function(e){return r&&r(!1),[2]})})}},a.createElement("div",{className:"card dataCard no-margin"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"ptacType"},"RTU Type:"),a.createElement("select",{id:"ptacType",className:"form-control",value:c&&c.optimizationType,onChange:function(t){return e.handleTypeChange(t.target.value)}},a.createElement("option",{value:"0"},"Select Type"),a.createElement("option",{value:"B"},"Type B"),a.createElement("option",{value:"C"},"Type C"))),a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"sensor"},"Occupancy Sensor:"),a.createElement("select",{id:"sensor",className:"form-control",value:c&&c.sensorDevice,onChange:function(t){return e.handleSensorChange(t.target.value)}},a.createElement("option",{value:""},"Select Occupancy Sensor"),s&&s.map(function(e){return a.createElement("option",{value:e.value},e.label)})))))))},t}(a.Component);t.a=h}});