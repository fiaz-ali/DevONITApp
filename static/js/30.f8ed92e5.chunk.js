webpackJsonp([30],{1029:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"CA_TYPES",function(){return v});var a,i=n(2),o=(n.n(i),n(747)),r=n(913),s=n(11),c=n(1077),l=n(122),u=n(706),p=n(738),m=n(740),h=n(756),d=n(20),f=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),b=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((a=a.apply(e,t||[])).next())})},g=this&&this.__generator||function(e,t){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v={CONDITION:"Condition",COMPLIANCE:"Compliance",SAFETY:"Safety",CANOTE:"CA_Note"},y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={caObj:{caAssessments:[]},equipLabels:[],conditionsLabels:[],complianceLabels:[],safetyLabels:[],isCompleted:!1,inspectionOntologies:[],SolutionList:[]},n.setupDropdownLists=n.setupDropdownLists.bind(n),n.handleCAForm=n.handleCAForm.bind(n),n.handleEquipmentAgeChange=n.handleEquipmentAgeChange.bind(n),n._saveCA=n._saveCA.bind(n),n.fetchCA=n.fetchCA.bind(n),n.fetchInspection_IsComplete=n.fetchInspection_IsComplete.bind(n),n.unComplete=n.unComplete.bind(n),n._getSolutionList=n._getSolutionList.bind(n),n}return f(t,e),t.prototype.componentWillUnmount=function(){return b(this,void 0,void 0,function(){return g(this,function(e){return clearInterval(a),[2]})})},t.prototype.componentDidMount=function(){return b(this,void 0,void 0,function(){var e,t,n,i,o=this;return g(this,function(r){switch(r.label){case 0:return e=this.props,t=e.infoEntity,n=e.entityName,[4,this.fetchInspection_IsComplete()];case 1:return i=r.sent(),this.setState({isCompleted:i}),t&&n?(Object(l.a)(!0),[4,this.fetchCA()]):[3,4];case 2:return r.sent(),[4,this.setupDropdownLists()];case 3:r.sent(),Object(l.a)(!1),r.label=4;case 4:return this._getSolutionList(),a=setInterval(function(){var e=Object(h.a)("inspectionOntology");e!=Object(h.a)("inspectionOntology_Old")&&(Object(h.b)("inspectionOntology_Old",e),o._getSolutionList())},3e5),[2]}})})},t.prototype._getSolutionList=function(){return b(this,void 0,void 0,function(){var e,t=this;return g(this,function(n){switch(n.label){case 0:return e=Object(h.a)("inspectionOntology"),[4,Object(m.u)(e).then(function(e){t.setState({SolutionList:e})})];case 1:return n.sent(),[2]}})})},t.prototype.fetchInspection_IsComplete=function(){return b(this,void 0,void 0,function(){var e,t,n,a,i,o;return g(this,function(r){switch(r.label){case 0:return e=this.props.entityName,t=Object(h.a)("inspectionOntology"),[4,Object(p.h)(e,"CA",t)];case 1:return n=r.sent(),a=this.state,i=a.isCompleted,o=a.inspectionOntologies,n?(i="true"==Object(s.g)(n.IsCompleted),o=Object(s.g)(n.inspectionOntology).split(","),this.setState({isCompleted:i,inspectionOntologies:o}),[2,i]):[2,!1]}})})},t.prototype.fetchCA=function(){return b(this,void 0,void 0,function(){var e,t,n,a,i,o=this;return g(this,function(r){switch(r.label){case 0:return e=this.props,t=e.buildingName,n=e.entityName,a=e.infoEntity,i=Object(h.a)("inspectionOntology"),[4,Object(c.b)(t,n,a,i).then(function(e){if(e){var t=o.state.caObj,n=e.filter(function(e){return Object(s.g)(e.inspection)==i});n&&n.map(function(e){var n={caName:Object(s.g)(e.caName),entryTimeStamp:Object(s.g)(e.entryTimeStamp),notes:Object(s.g)(e.notes),age:Object(s.g)(e.age),assessmentLabel:Object(s.g)(e.assessmentLabel),photo:Object(s.g)(e.photo).split(","),repairCost:Object(s.g)(e.repairCost),size:Object(s.g)(e.size),type:Object(s.g)(e.type),typeOf:Object(s.g)(e.assessmentLabel)};t.caAssessments.push(n)}),o.setState({caObj:t})}})];case 1:return r.sent(),[2]}})})},t.prototype.setupDropdownLists=function(){return b(this,void 0,void 0,function(){var e,t,n,a,i;return g(this,function(o){return e=this.state,t=e.equipLabels,n=e.conditionsLabels,a=e.complianceLabels,i=e.safetyLabels,n||(n=[]),a||(a=[]),i||(i=[]),t=["Cleanliness","Debris","Insulation/Sealing","Rust/Chipped Paint","Loose Connections","Pad/Support/Dunnage","Ventilation","General Notes"],0==n.length&&n.push.apply(n,["Access","Ceiling","Egress","Fenestration","Flooring","Foundation","Frame","Roof","Walls","Curb","Landscaping","Pad","ParkingLot","ParkingSpace","Paving","StructuralElement"]),0==a.length&&a.push.apply(a,["ADA","HIPAA","PCI"]),0==i.length&&i.push.apply(i,["AED","AlarmSystem","FireExtinguisher","Sprinkler"]),this.setState({equipLabels:t,conditionsLabels:n,complianceLabels:a,safetyLabels:i}),[2]})})},t.prototype.handleCAForm=function(e,t){var n=this.state.caObj,a=n.caAssessments.filter(function(e){return e.type!=t});a.push.apply(a,e),n.caAssessments=a,this.setState({caObj:n})},t.prototype.handleEquipmentAgeChange=function(e){var t=this.state.caObj;this.setState({caObj:t})},t.prototype._saveCA=function(e){return b(this,void 0,void 0,function(){var t,n,a,i,o,r,s,u,m,d,f;return g(this,function(b){switch(b.label){case 0:return Object(l.a)(!0),t=this.state,n=t.caObj,a=t.inspectionOntologies,i=t.SolutionList,o=this.props,r=o.buildingName,s=o.infoEntity,u=o.entityName,m=o.instance,d=Object(h.a)("inspectionOntology"),f=!0,[4,Object(c.c)(r,s,u,n,d,f,i,e)];case 1:return b.sent(),e?d?(a.push(d),[4,Object(p.c)(u,a,"CA")]):[3,3]:[3,4];case 2:b.sent(),b.label=3;case 3:switch(s){case"Equip":window.location.hash=m+"/"+r+"/Assets";break;case"Space":window.location.hash=m+"/"+r+"/Space";break;default:return[2,!1]}b.label=4;case 4:return Object(l.a)(!1),[2]}})})},t.prototype.unComplete=function(){return b(this,void 0,void 0,function(){var e,t,n,a;return g(this,function(i){switch(i.label){case 0:if(e=this.props.entityName,t=this.state.inspectionOntologies,n=Object(h.a)("inspectionOntology"),!(t&&t.length>0))return[3,2];if(!n)return[3,2];for(a=0;a<t.length;a++)t[a]==n&&t.splice(a,1);return[4,Object(p.k)(e,t,"CA")];case 1:i.sent(),i.label=2;case 2:return this.setState({isCompleted:!1}),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,a=t.instance,s=t.entityName,c=t.infoEntity,l=t.viewOnly,p=this.state,m=p.caObj,f=p.equipLabels,b=p.conditionsLabels,g=p.complianceLabels,y=p.safetyLabels,E=p.isCompleted,O=p.inspectionOntologies,C=Object(h.a)("inspectionOntology"),w=m.caAssessments.filter(function(e){return e.type==v.CANOTE}),N=m.caAssessments.filter(function(e){return e.type==v.CONDITION}),L=m.caAssessments.filter(function(e){return e.type==v.COMPLIANCE}),S=m.caAssessments.filter(function(e){return e.type==v.SAFETY}),A=O.find(function(e){return e==C}),I=!!(A&&A.length>0);return i.createElement("div",{className:"content"},i.createElement("div",{className:"container-fluid"},!l&&i.createElement(i.Fragment,null,i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12"},i.createElement(o.a,{instance:this.props.instance,buildingName:n,tabName:c,showComponentButton:"Equip"==c,itemName:s,showAuditTypes:!0,showBIMButtons:!0}))),i.createElement("br",null),i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12 form-group"},i.createElement("div",{className:"pull-right"},i.createElement(u.a,{ElementID:"ca",data:this.state.caObj,filename:"ca"}))))),i.createElement("div",{className:"card"},i.createElement("div",{className:"container-fluid padding-10",id:"ca"},i.createElement("div",{className:"col-md-12 padding-10"},i.createElement("h3",{style:{margin:10}},"Condition Assessment - ",Object(d.y)(s))),"Equip"==c&&f&&f.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-12"},i.createElement(r.a,{instance:a,buildingName:n,caOf:c,items:w,handleAdder:this.handleCAForm,type:v.CANOTE,labels:f,entityName:s,infoEntity:c,isView:l,isFromReport:l}))),"Space"==c&&i.createElement(i.Fragment,null,b&&b.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-12"},i.createElement("h4",null,v.CONDITION," Assessments"),i.createElement(r.a,{instance:a,buildingName:n,caOf:c,items:N,handleAdder:this.handleCAForm,type:v.CONDITION,labels:b,entityName:s,infoEntity:c,isView:l,isFromReport:l})),i.createElement("br",null),i.createElement("br",null)),g&&g.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-12"},i.createElement("h4",null,v.COMPLIANCE," Assessments"),i.createElement(r.a,{instance:a,buildingName:n,caOf:c,items:L,handleAdder:this.handleCAForm,type:v.COMPLIANCE,labels:g,entityName:s,infoEntity:c,isView:l,isFromReport:l})),i.createElement("br",null),i.createElement("br",null)),y&&y.length>0&&i.createElement(i.Fragment,null,i.createElement("div",{className:"col-md-12"},i.createElement("h4",null,v.SAFETY," Assessments"),i.createElement(r.a,{instance:a,buildingName:n,caOf:c,items:S,handleAdder:this.handleCAForm,type:v.SAFETY,labels:y,entityName:s,infoEntity:c,isView:l,isFromReport:l})),i.createElement("br",null),i.createElement("br",null))),!l&&i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-12 inline-block"},i.createElement("br",null),i.createElement("div",{className:"form-group"},i.createElement("button",{className:"btn btn-primary btn-fill",type:"button",onClick:function(){e._saveCA(!1)}},i.createElement("i",{className:"fa fa-save"})," Save"),(E||!E)&&i.createElement(i.Fragment,null," ",!I&&i.createElement("button",{className:"btn btn-primary btn-fill",type:"button",onClick:function(){e._saveCA(!0)}},i.createElement("i",{className:"fa fa-save"})," Save & Complete")),E&&I&&i.createElement("button",{className:"btn btn-fill btn-dark text-inspection-completed padding-10 margin-5",type:"button",onClick:function(){e.unComplete()}},i.createElement("b",null,"Remove Inspection Completion. ")))))))))},t}(i.Component);t.default=y},740:function(e,t,n){"use strict";t.g=function(e,t,n,c){return r(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,Object(a.f)({model:e,buildingData:t,equipment:n,lightingEquipment:c},a.a.LIFE.SaveProject,o.b.LIFE).then(function(){Object(i.b)("Project saved Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Project.")})];case 1:return[2,r.sent()]}})})},t.r=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(a.e)({buildingName:e,instance:t},a.a.LIFE.GetProjectList,o.b.LIFE)];case 1:return[2,n.sent()]}})})},t.m=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.f)({_id:e},a.a.LIFE.DeleteProject,o.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.h=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.f)({model:e},a.a.LIFE.SaveProjectSolution,o.b.LIFE).then(function(){Object(i.b)("Solution saved Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Solution.")})];case 1:return[2,t.sent()]}})})},t.o=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(a.e)({spreadSheetId:e,fileType:t},a.a.LIFE.ExportSheet,o.b.LIFE)];case 1:return[2,n.sent()]}})})},t.t=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return e?[4,Object(a.e)({projectId:e},a.a.LIFE.GetSolutionList,o.b.LIFE)]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}})})},t.u=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return e?[4,Object(a.e)({inspectionOntology:e},a.a.LIFE.GetSolutionListForInspection,o.b.LIFE)]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}})})},t.s=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.e)({solutionId:e},a.a.LIFE.GetSolution,o.b.LIFE)];case 1:return[2,t.sent()]}})})},t.n=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.f)({_id:e},a.a.LIFE.DeleteSolution,o.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.v=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(a.f)({manageFile:e,fileData:t},a.a.LIFE.ManageFile,o.b.LIFE).then(function(){Object(i.b)("Upload Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Upload.")})];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(a.f)({communityFile:e,fileData:t},a.a.LIFE.SaveCommunityFile,o.b.LIFE)];case 1:return[2,n.sent()]}})})},t.p=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(a.e)({buildingName:e,instance:t},a.a.LIFE.GetManageFile,o.b.LIFE)];case 1:return[2,n.sent()]}})})},t.b=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.e)({instance:e},a.a.LIFE.GetCommunityFile,o.b.LIFE)];case 1:return[2,t.sent()]}})})},t.l=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.f)({ManageFile:e},a.a.LIFE.DeleteManageFile,o.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.a=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.f)({communityFile:e},a.a.LIFE.DeleteCommunityFile,o.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.q=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.e)({projectId:e},a.a.LIFE.GetProject,o.b.LIFE)];case 1:return[2,t.sent()]}})})},t.f=function(e,t,n){return r(this,void 0,void 0,function(){return s(this,function(i){switch(i.label){case 0:return[4,Object(a.f)({email:e,buildingName:t,instance:n},a.a.LIFE.SaveEmailAndDrive,o.b.LIFE)];case 1:return[2,i.sent()]}})})},t.j=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(a.f)({email:e,instance:t},a.a.LIFE.ShareCommunityFolder,o.b.LIFE).then(function(e){e.result?Object(i.b)("Successfully Share."):Object(i.a)("The user Email is not valid.")}).catch(function(e){Object(i.a)("Something Went Wrong!")})];case 1:return[2,n.sent()]}})})},t.k=function(e,t,n){return r(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,Object(a.f)({email:e,buildingName:t,instance:n},a.a.LIFE.ShareMMTemplateFolder,o.b.LIFE).then(function(e){e.result?Object(i.b)("Successfully Share."):Object(i.a)("The user Email is not valid.")}).catch(function(e){Object(i.a)("Something Went Wrong!")})];case 1:return[2,r.sent()]}})})},t.i=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.f)({templatePurpose:e},a.a.LIFE.SaveTemplatePurpose,o.b.LIFE)];case 1:return[2,t.sent()]}})})},t.c=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(a.e)({instance:e},a.a.LIFE.GetTemplatePurpose,o.b.LIFE)];case 1:return[2,t.sent()]}})})},t.d=function(e){var t=e.getFullYear().toString().slice(2,4),n=(e.getMonth()+1).toString().padStart(2,0),a=e.getDate().toString().padStart(2,0),i=e.getHours().toString().padStart(2,0),o=e.getMinutes().toString().padStart(2,0),r=e.getSeconds().toString().padStart(2,0);return t+n+a+i+o+r};var a=n(12),i=n(21),o=n(13),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((a=a.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}},913:function(e,t,n){"use strict";var a=n(2),i=(n.n(a),n(698)),o=n(703),r=n(57),s=n(20),c=n(743),l=n(13),u=n(737),p=n(8),m=n(21),h=n(701),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((a=a.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){var n,a,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=2&o[0]?a.return:o[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,o[1])).done)return i;switch(a=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={items:[],caLabel:[],labelsDropDownList:[],files:[],onPageTextChanged:!1},n.addItem=n.addItem.bind(n),n.removeItem=n.removeItem.bind(n),n.handleItemChange=n.handleItemChange.bind(n),n.handleCALabelChange=n.handleCALabelChange.bind(n),n.handleFileAttachment=n.handleFileAttachment.bind(n),n.setImageURL_ForItems=n.setImageURL_ForItems.bind(n),n}return d(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){var e,t=this;return b(this,function(n){return e=this.state.labelsDropDownList,this.props.labels&&this.props.labels.length>0&&(e=this.props.labels.map(function(e){return{value:e,label:e}}),this.setState({labelsDropDownList:e},function(){t.setImageURL_ForItems()})),[2]})})},t.prototype.setImageURL_ForItems=function(){return f(this,void 0,void 0,function(){var e,t,n,a;return b(this,function(i){for(e=this.state.items,t=new r.b,n=0;n<e.length;n++)a="",e[n]&&e[n].photo&&e[n].photo.length&&e[n].photo[0]&&(e[n].photo[0].toLowerCase().indexOf(".mp4")>0&&(a="assets/img/video-file-icon.png"),e[n].photo[0].toLowerCase().indexOf(".mov")>0&&(a="assets/img/video-file-icon.png"),e[n].photo[0].toLowerCase().indexOf(".pdf")>0&&(a="assets/img/pdf-file-icon.png"),(e[n].photo[0].toLowerCase().indexOf(".xls")>0||e[n].photo[0].toLowerCase().indexOf(".csv")>0)&&(a="assets/img/excel-file-icon.png"),(e[n].photo[0].toLowerCase().indexOf(".docx")>0||e[n].photo[0].toLowerCase().indexOf(".txt")>0)&&(a="assets/img/doc-file-icon.png"),(e[n].photo[0].toLowerCase().indexOf(".png")>0||e[n].photo[0].toLowerCase().indexOf(".jpeg")>0||e[n].photo[0].toLowerCase().indexOf(".jpg")>0||e[n].photo[0].toLowerCase().indexOf(".tiff")>0)&&(a=t.GetSignedURL(r.a.DOCUMENT(),e[n].photo[0]))),e[n].imageurl=a;return this.setState({items:e}),[2]})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){return f(this,void 0,void 0,function(){var t,n,a=this;return b(this,function(i){return e.buildingName&&e.instance&&(t=JSON.stringify(this.state.items),n=JSON.stringify(e.items),(!this.state.onPageTextChanged&&!this.props.isFromReport&&t!=n||this.props.isFromReport&&t!=n)&&this.setState({items:e.items},function(){a.setImageURL_ForItems()})),[2]})})},t.prototype.addItem=function(){var e=this,t=this.state,n=t.items;t.caLabel.map(function(t){var a={caName:"",age:"",assessmentLabel:t.value,notes:"",photo:[],repairCost:"",size:"",type:e.props.type,entryTimeStamp:"",typeOf:t.value};n||(n=[]),n.push(a)}),this.setState({items:n,caLabel:[]}),this.props.handleAdder(n,this.props.type)},t.prototype.removeItem=function(e){var t=this.state.items;t.splice(e,1),this.setState({items:t}),this.props.handleAdder(t,this.props.type)},t.prototype.removeAttachment=function(e){var t=this.state.items;t[e].imageurl="",t[e].photo[0]="",this.setState({items:t}),this.props.handleAdder(t,this.props.type)},t.prototype.handleCALabelChange=function(e){this.setState({caLabel:e})},t.prototype.handleItemChange=function(e,t){var n=this.state.items,a=t.target.name;(n&&n[e])[""+a]=t.target.value,this.setState({items:n,onPageTextChanged:!0}),this.props.handleAdder(n,this.props.type)},t.prototype.handleFileAttachment=function(e,t){var n=this,a=this.props,i=a.buildingName,o=a.entityName,c=a.infoEntity,l=JSON.parse(p.a.getItem("user")),h=this.state.items,d=h[t];e&&e.length>0&&e[0].file&&d&&this.setState({items:h,files:e},function(){for(var a=function(a){var p,d,f=e[a],b=n.props.buildingName+"-_-"+Object(s.D)(10),g=f.name.substring(f.name.indexOf("."));p=""+b+g,d=f,h[t].photo[0]=p,n.props.handleAdder(h,n.props.type),(new r.b).UploadFile(r.a.DOCUMENT(),p,d,function(e,t){if(e)Object(m.a)("Attachment failed to upload");else{var n={building:i,docOntology:Object(s.D)(12),documentType:"InspectionDoc",documentSubtype:"InspectionDoc",enteredBy:l.contact,enteredByName:l.name,entityOntology:[{label:"",value:o}],entityType:c,rdfsLabel:f.name,s3FileName:p,entryTimeStamp:(new Date).toString(),linkToDocument:p};Object(u.f)(n).then(function(){})}})},p=0;p<e.length;p++)a(p)})},t.prototype.handlefileAttached=function(e,t){if(e.length>0){for(var n=this.state.items,a=n[t],i=0;i<e.length;i++){var o=e[i].name.split(".").pop(),c=this.props.buildingName+"_"+Object(s.D)(15)+"."+o.toLowerCase();n[0].photo[i]=c}Object(l.g)(e),this.setState({files:e,items:n},function(){}),this.props.handleAdder(n,this.props.type);var u=new r.b,p=Object(l.d)();if(p&&p.length)for(var h=0;h<p.length;h++){var d=p[h];u.UploadFile(r.a.DOCUMENT(),a.photo[h],d,function(e,t){e?Object(m.a)("Attachment failed to upload"):console.log(t)})}}},t.prototype.render=function(){var e=this,t=this.state,n=t.items,s=t.caLabel,l=t.labelsDropDownList,u=this.props,p=u.caOf,m=u.hideAddButton,d=void 0!==m&&m,f=u.isFromReport,b=new r.b;return a.createElement(a.Fragment,null,n&&n.map(function(t,n){var o="";return t.photo&&(o=b.GetSignedURL(r.a.DOCUMENT(),t.photo[0])),a.createElement("div",{key:n,className:"row"},a.createElement("br",null),a.createElement("div",{className:"form-group"},a.createElement("div",{className:"col-md-2"},a.createElement("label",{htmlFor:t.assessmentLabel},t.assessmentLabel)),"Space"==p&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-1"},a.createElement("input",{type:"text",id:t.age,className:"form-control",value:t.age,placeholder:"Age",name:"age",onChange:function(t){return e.handleItemChange(n,t)}})),a.createElement("div",{className:"col-md-1"},a.createElement("input",{type:"text",id:t.size,className:"form-control",value:t.size,placeholder:"Size",name:"size",onChange:function(t){return e.handleItemChange(n,t)}}))),a.createElement("div",{className:"Space"==p?"col-md-3":"col-md-5"},a.createElement("input",{type:"text",id:t.notes,className:"form-control",value:t.notes,placeholder:"Notes",name:"notes",onChange:function(t){return e.handleItemChange(n,t)}})),a.createElement("div",{className:"col-md-2"},a.createElement("input",{type:"text",id:t.repairCost,className:"form-control",value:t.repairCost,placeholder:"Approximate Repair Cost",name:"repairCost",onChange:function(t){return e.handleItemChange(n,t)}})),!f&&a.createElement(a.Fragment,null,a.createElement("div",{className:"col-md-1"},!(t.photo&&t.photo.length>0)&&a.createElement("button",{type:"button",className:"btn btn-dark",style:{fontWeight:"bold",fontSize:"12pt",width:t.photo&&t.photo.length>0&&t.imageurl?"204px":"60px",padding:0},"data-toggle":"modal","data-target":"#uploadImage"+e.props.type+n,title:"Upload Attachment",onClick:function(){e.setState({files:[]})}},a.createElement("i",{className:"fa fa-paperclip"})),t.photo&&t.photo.length>0&&a.createElement("img",{src:t.imageurl,style:{width:"100%"}}),a.createElement(i.a,{id:"uploadImage"+e.props.type+n,onSaveButtonClick:function(){},saveButtonText:"Close",isEditForm:!1,showCancelButton:!1,cancelButtonText:"Cancel",heading:e.props.type},a.createElement(c.a,{handleAttachedFile:function(t){t&&t[0]&&e.handleFileAttachment(t,n)},files:e.state.files&&e.state.files.length>0?e.state.files:[],single:!0}))),a.createElement("div",{className:"col-md-2 btn-group"},t.photo&&t.photo.length>0&&a.createElement(a.Fragment,null,a.createElement("button",{type:"button",className:"btn btn-dark padding-5","data-toggle":"modal","data-target":"#uploadImage"+e.props.type+n,title:"Replace Attachment",onClick:function(){e.setState({files:[]})}},a.createElement("i",{className:"fa fa-paperclip"})),o&&a.createElement("a",{className:"btn padding-5",title:"Download Attachment",href:o},a.createElement("i",{className:"fa fa-download"})),a.createElement("button",{type:"button",className:"btn btn-danger padding-5",title:"Remove Attachment",onClick:function(){return document.getElementById("removedCAAttacment"+t.caName).click()}},a.createElement("i",{className:"fa fa-trash"})),a.createElement("button",{style:{display:"none"},id:"removedCAAttacment"+t.caName,"data-toggle":"modal","data-target":"#removedDialogCAAttacment"+t.caName},"."),a.createElement(h.a,{instance:e.props.instance,id:"removedDialogCAAttacment"+t.caName,showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure you want to delete this attachment for proposed RCX ?",heading:"Alert",onConfirmButtonClick:function(){return e.removeAttachment(n)}})),a.createElement("button",{type:"button",className:"btn ml-5 padding-5",title:"Remove Item",style:{color:"#f00"},onClick:function(){return document.getElementById("removeCA"+t.caName).click()}},a.createElement("i",{className:"fa fa-remove"})),a.createElement("button",{style:{display:"none"},id:"removeCA"+t.caName,"data-toggle":"modal","data-target":"#removeCADialog"+t.caName},"."),a.createElement(h.a,{instance:e.props.instance,id:"removeCADialog"+t.caName,showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure you want to delete this proposed RCX?",heading:"Alert",onConfirmButtonClick:function(){return e.removeItem(n)}}))),f&&t.photo&&t.photo.length>0&&a.createElement("div",{className:"col-md-2"},a.createElement("img",{src:t.imageurl,className:"inspection-image-preview"}))))}),!d&&!f&&a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-11 col-xs-11"},a.createElement("button",{type:"button",className:"btn btn-dark btn-fill btn-sm","data-toggle":"modal","data-target":"#AddLabelDialog"+this.props.type,style:{fontWeight:"bold"}},a.createElement("i",{className:"fa fa-plus"}),"Add ",this.props.type)),a.createElement(i.a,{disableSaveButton:!s,id:"AddLabelDialog"+this.props.type,onSaveButtonClick:function(){e.addItem()},saveButtonText:"Ok",isEditForm:!1,showCancelButton:!0,cancelButtonText:"Cancel",heading:this.props.type},l&&l.length>0&&a.createElement("div",{className:"form-group"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-12"},a.createElement(o.a,{id:"lbl",isMulti:!0,closeMenuOnSelect:!1,onChange:this.handleCALabelChange,placeholder:this.props.type+" Assessment Labels",options:l,value:s}))))))))},t}(a.Component);t.a=g}});