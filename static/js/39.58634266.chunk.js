webpackJsonp([39],{1184:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l});var a=[{roleID:"1",value:"1-Super User"},{roleID:"2",value:"2-Operating Officer / Manager"},{roleID:"3",value:"3-Staff / Contractors"},{roleID:"4",value:"4-Customer"},{roleID:"5",value:"5-Service Manager"},{roleID:"6",value:"6-Service Worker"}],l=[{roleID:"3",value:"3-Staff / Contractors"},{roleID:"4",value:"4-Customer"},{roleID:"5",value:"5-Service Manager"},{roleID:"6",value:"6-Service Worker"}]},2507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),l=(n.n(a),n(670)),o=n(118),c=n(12),i=n(1184),r=n(1075),s=n(677),m=n(8),u=n(685),d=n(687),f=n(789),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function c(e){try{r(a.next(e))}catch(e){o(e)}}function i(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,i)}r((a=a.apply(e,t||[])).next())})},g=this&&this.__generator||function(e,t){var n,a,l,o,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(l=(l=c.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){c.label=o[1];break}if(6===o[0]&&c.label<l[1]){c.label=l[1],l=o;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(o);break}l[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_people:[],_peopleStatus:[],columns:[{name:"Name",selected:!0},{name:"Role",selected:!0},{name:"Phone",selected:!0},{name:"Email",selected:!0},{name:"Status",selected:!0},{name:"Chat",selected:!0}],sortOrder:1,ContactToDelete:Object(),contactNameForReset:"",showLogs:!1,verifyUser:!1},n.handleColumnFilters=n.handleColumnFilters.bind(n),n.sortPeople=n.sortPeople.bind(n),n.onDeleteContact=n.onDeleteContact.bind(n),n._fetchPeople=n._fetchPeople.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return h(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchPeople()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype._fetchPeople=function(){return h(this,void 0,void 0,function(){var e,t,n,a,l=this;return g(this,function(i){switch(i.label){case 0:return e=JSON.parse(m.a.getItem("user")),[4,Object(o.w)()];case 1:return t=i.sent(),n=[],n="1"==e.role?t:t.filter(function(e){return Object(c.g)(e.assignedTo).includes(l.props.buildingName)}),[4,Object(o.h)(n.map(function(e){return Object(c.g)(e.contact)}))];case 2:return a=i.sent(),this.setState({_people:n,_peopleStatus:a}),[2]}})})},t.prototype.handleColumnFilters=function(e){var t=e.target.checked,n=this.state.columns;n[n.findIndex(function(t){return t.name===e.target.value})].selected=t,this.setState({columns:n})},t.prototype.sortPeople=function(e,t){var n=this.state._people,a=this.state.sortOrder,l=n.sort(function(t,n){if(t&&n){var l="",o="";switch(e){case"Name":t.name&&n.name&&(l=t.name.value,o=n.name.value);break;case"Role":t.role&&n.role&&(l=t.role.value,o=n.role.value);break;case"Phone":t.phone&&n.phone&&(l=t.phone.value,o=n.phone.value);break;case"Email":t.email&&n.email&&(l=t.email.value,o=n.email.value);break;case"Status":t.status&&n.status&&(l=t.status.value,o=n.status.value);break;case"Chat":t.chatlink&&n.chatlink&&(l=t.chatlink.value,o=n.chatlink.value)}var c=0;return l.toLocaleLowerCase()<o.toLocaleLowerCase()?c=-1:l.toLocaleLowerCase()>o.toLocaleLowerCase()&&(c=1),c*a}});this.setState({_people:l,sortOrder:-1*a})},t.prototype.onDeleteContact=function(e){return h(this,void 0,void 0,function(){return g(this,function(t){return this.setState({ContactToDelete:e}),document.getElementById("btnConfirm").click(),[2]})})},t.prototype.deleteContact=function(){return h(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=this.state.ContactToDelete,[4,Object(o.c)(this.props.buildingName,e.contact.value)];case 1:return t.sent(),[4,this._fetchPeople()];case 2:return t.sent(),this.setState({ContactToDelete:Object()}),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,o=t.buildingName,p=this.state,h=p.columns,g=p._people,b=p.showLogs,v=p.verifyUser,N=JSON.parse(m.a.getItem("user")),E=Object(s.b)(N,"people","write");return b?a.createElement(u.a,{instance:n,buildingName:o,fromEntityList:!0,module:d.a.People,entityName:"Contact",entityList:g.map(function(e){return{label:Object(c.g)(e.name),value:Object(c.g)(e.contact)}}),onLogClose:function(){return e.setState({showLogs:!1})}}):v?a.createElement(f.a,{onConfirmation:function(t){t?e.setState({verifyUser:!1},function(){e.deleteContact()}):e.setState({verifyUser:!1})}}):a.createElement("div",{className:"content",style:{paddingTop:"0px"}},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row no-padding"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 "},N&&"1"==N.role&&a.createElement("button",{className:"btn btn-md btn-primary btn-fill pull-right",style:{marginLeft:5},title:"Logs",onClick:function(){e.setState({showLogs:!0})}}," ",a.createElement("img",{src:"assets/img/Logs.png",style:{width:25,height:18}})),E&&a.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){window.location.hash=n+"/"+o+"/People/NewContact"}},a.createElement("i",{className:"fa fa-plus"}),a.createElement("span",null,"Create New Contact")))),a.createElement("br",null),a.createElement("div",{className:"card padding-10",id:"PeopleList",style:{paddingTop:"0px"}},a.createElement("div",{className:"content",style:{paddingTop:"10px"}},a.createElement("div",{className:"dataCard"},a.createElement("div",{className:"row hidden-xs hidden-sm no-padding"},a.createElement("div",{className:"col-md-10 dataCard no-padding"},h.find(function(e){return"Name"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left",onClick:function(){return e.sortPeople("Name")}},a.createElement("i",{className:"fa fas fa-sort"}),"Name"),h.find(function(e){return"Role"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Role")}},a.createElement("i",{className:"fa fas fa-sort",style:{paddingLeft:"8px"}}),"Role"),h.find(function(e){return"Phone"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Phone")}},a.createElement("i",{className:"fa fas fa-sort"}),"Phone"),h.find(function(e){return"Email"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Email")}},a.createElement("i",{className:"fa fas fa-sort"}),"Email"),h.find(function(e){return"Status"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Status")}},a.createElement("i",{className:"fa fas fa-sort"}),"Status"),h.find(function(e){return"Chat"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header"}," \xa0 \xa0 \xa0Chat")),a.createElement("div",{className:"col-md-2 p-0"},a.createElement("div",{className:"col-md-12 col-sm-12 small grid-header"},"Action"))),a.createElement(r.a,{userName:this.state.contactNameForReset,dialogButtonName:"btnChangePassword"}),g&&g.length>0&&g.map(function(t,l){var r=e.state._peopleStatus.find(function(e){return e&&e.contactOntology==Object(c.g)(t.contact)});return a.createElement("div",{key:l,className:"row clickable no-padding"},a.createElement("div",{className:"col-md-10 no-padding"},h.find(function(e){return"Name"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(c.g)(t.name)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Name"),a.createElement("a",{href:"#"+n+"/"+o+"/People/ViewContact/"+Object(c.g)(t.contact)}," ",Object(c.g)(t.name))),h.find(function(e){return"Role"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:i.a.find(function(e){return e.roleID==Object(c.g)(t.role)})?i.a.find(function(e){return e.roleID==Object(c.g)(t.role)}).value:""},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"role"),i.a.find(function(e){return e.roleID==Object(c.g)(t.role)})?i.a.find(function(e){return e.roleID==Object(c.g)(t.role)}).value:""),h.find(function(e){return"Phone"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(c.g)(t.phone)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Phone"),Object(c.g)(t.phone)),h.find(function(e){return"Email"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(c.g)(t.email)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Email"),Object(c.g)(t.email)),h.find(function(e){return"Status"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 trim-data",title:"Not Working"==r.status?"OFF":r.status},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Status"),"Not Working"==r.status?"OFF":r.status),h.find(function(e){return"Chat"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small center trim-data padding-5",title:Object(c.g)(t.chatlink)},a.createElement("button",{className:"btn btn-xs btn-primary active padding-5",onClick:function(e){window.location.hash=n+"/"+o+"/PersonChatWindow/Contact/"+Object(c.g)(t.contact)}},a.createElement("i",{className:"fa fa-comments"}),"Go To/ Start New"))),E&&a.createElement("div",{className:"col-md-2 col-xs-12 padding-10 center"},"1"==N.role&&a.createElement("a",{className:"btn-sm btn-primary active custom-outline-btn pad-mag",style:{margin:"0"},title:"Change Password",onClick:function(n){e.setState({contactNameForReset:Object(c.g)(t.contact)},function(){document.getElementById("btnChangePassword").click()})}},a.createElement("i",{className:"fa fa-key"})),a.createElement("a",{className:"btn-sm btn-danger active custom-outline-btn pad-mag",style:{margin:"0"},title:"Delete",onClick:function(n){e.onDeleteContact(t)}},a.createElement("i",{className:"fa fa-trash"})),a.createElement("a",{className:"btn-sm btn-success active custom-outline-btn pad-mag",title:"Edit",style:{margin:"0"},onClick:function(e){window.location.hash=n+"/"+o+"/People/EditContact/"+Object(c.g)(t.contact)}},a.createElement("i",{className:"fa fa-edit"})),a.createElement("a",{className:"btn-sm btn-warning active custom-outline-btn pad-mag",title:"Time Log",style:{margin:"0"},onClick:function(e){window.location.hash=n+"/"+o+"/TimeClockAnalytics/"+Object(c.g)(t.contact)}},a.createElement("i",{className:"fas fa-chart-bar"}))))}),a.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),a.createElement(l.a,{instance:n,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Contact?",heading:"Confirm...",onConfirmButtonClick:function(){e.setState({verifyUser:!0})}}))))))))},t}(a.Component);t.default=b}});