webpackJsonp([73],{2111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),l=(n.n(a),n(690)),o=n(709),c=n(600),r=n(106),i=n(634),s=n(18),m=n(99),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),u=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function c(e){try{i(a.next(e))}catch(e){o(e)}}function r(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(c,r)}i((a=a.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var n,a,l,o,c={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!(l=(l=c.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){c.label=o[1];break}if(6===o[0]&&c.label<l[1]){c.label=l[1],l=o;break}if(l&&c.label<l[2]){c.label=l[2],c.ops.push(o);break}l[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},b=n(1022),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={actions:[],previousActions:[],testtext:"",qrcodeActionIndex:null,qrcodeShow:!1,toEmail:[],points:[],selectedPoints:[],doNowbtn:!1,isCompleted:[]},n.getObjectFormActions=n.getObjectFormActions.bind(n),n.onChangeNumericHandler=n.onChangeNumericHandler.bind(n),n.onBlur=n.onBlur.bind(n),n.afterPaste=n.afterPaste.bind(n),n.onChangeHandler=n.onChangeHandler.bind(n),n.handleScan=n.handleScan.bind(n),n.saveActions=n.saveActions.bind(n),n.onToEmail=n.onToEmail.bind(n),n.handleSaveMultiPointsActions=n.handleSaveMultiPointsActions.bind(n),n.onClickDownloadAgreementTemplate=n.onClickDownloadAgreementTemplate.bind(n),n.setIconChange=n.setIconChange.bind(n),n}return d(t,e),t.prototype.componentDidMount=function(){return u(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,Object(i.i)(this.props.buildingName,"","")];case 1:return e=t.sent(),this.setState({points:e}),this.getObjectFormActions(),[2]}})})},t.prototype.onClickDownloadAgreementTemplate=function(e){return u(this,void 0,void 0,function(){var t,n,a,l;return p(this,function(c){switch(c.label){case 0:return Object(m.a)(!0),[4,Object(o.b)(e)];case 1:return(t=c.sent())&&t.data&&(n=new Uint8Array(t.data),a=new Blob([n]),(l=document.createElement("a")).href=window.URL.createObjectURL(a),l.download="output.docx",l.click()),Object(m.a)(!1),[2]}})})},t.prototype.getObjectFormActions=function(){return u(this,void 0,void 0,function(){var e,t,n,a,l,c;return p(this,function(r){switch(r.label){case 0:return e=this.state,t=e.points,n=e.selectedPoints,a=e.isCompleted,l=[],[4,Object(o.c)(this.props.buildingName,[this.props.taskID])];case 1:return(c=r.sent())&&c.length>0&&c[0].visibleObjectFormActions&&c[0].visibleObjectFormActions.length>0?[4,Object(o.c)(this.props.buildingName,[],c[0].visibleObjectFormActions)]:[3,3];case 2:l=r.sent(),r.label=3;case 3:return c.map(function(e,a){for(var l=[],o=e.pointOntology.split(","),c=0;c<o.length;c++){var r=t.find(function(e){return Object(s.g)(e.point)===o[c]});r&&void 0!=r&&l.push({label:Object(s.g)(r.pointLabel),value:Object(s.g)(r.point)})}n.push(l)}),c&&c.length>0&&c.map(function(e){return e.isDone?a.push(!0):a.push(!1)}),this.setState({actions:c,previousActions:l,selectedPoints:n,isCompleted:a}),[2]}})})},t.prototype.onChangeHandler=function(e,t,n){var a=this.state.actions;a[n].dataEntered=e.editor.getData(),this.setState({actions:a})},t.prototype.onChangeNumericHandler=function(e,t){var n=this.state.actions;n[t].dataEntered=e.target.value,this.setState({actions:n})},t.prototype.onToEmail=function(e,t){var n=this.state.toEmail;n[t]=e.target.value,this.setState({toEmail:n})},t.prototype.onEmailData=function(e,t){var n=this.state.actions;n[t].dataEntered=e.target.value,this.setState({actions:n})},t.prototype.onBlur=function(e){},t.prototype.afterPaste=function(e){},t.prototype.handleScan=function(e){var t=this.state,n=t.qrcodeActionIndex,a=t.actions,l=a[n];e&&e.toString()==l.qrCode&&(a[n].isQrCodeVerified=!0,a[n].isDone=!0,this.saveActions(n),this.setState({actions:a,qrcodeShow:!1,qrcodeActionIndex:null}))},t.prototype.saveActions=function(e){return u(this,void 0,void 0,function(){var t,n,a,l=this;return p(this,function(c){switch(c.label){case 0:return t=this.state,n=t.actions,a=t.toEmail,!1,n.map(function(e,t){return u(l,void 0,void 0,function(){var n;return p(this,function(l){switch(l.label){case 0:return"email"!=e.directiveType?[3,2]:((n=Object()).to=a[t],n.subject="Update Email",n.text=e.dataEntered,[4,Object(r.a)(n)]);case 1:l.sent(),l.label=2;case 2:return"done"==e.directiveType&&!0,"formentry"!=e.directiveType?[3,4]:[4,Object(o.f)(e.assetOntology,e.unit,e.dataEntered)];case 3:l.sent(),l.label=4;case 4:return[2]}})})}),[4,Object(o.e)(this.props.buildingName,n[e]).then(function(){})];case 1:return c.sent(),[2]}})})},t.prototype.handleSaveMultiPointsActions=function(){return u(this,void 0,void 0,function(){var e,t=this;return p(this,function(n){switch(n.label){case 0:return e=this.state.actions,[4,Object(o.d)(this.props.buildingName,e).then(function(){window.location.hash=t.props.instance+"/"+t.props.buildingName+"/Tasks"})];case 1:return n.sent(),[2]}})})},t.prototype.setCollapseIcon=function(e){var t=e.currentTarget.children[0].className;e.currentTarget.children[0].className="fa fa-plus"==t?"fa fa-minus":"fa fa-plus"},t.prototype.setIconChange=function(e){var t=this.state,n=t.isCompleted,a=t.actions;n&&n.length>0&&(n[e]=!n[e],a[e].isDone=!a[e].isDone),this.setState({isCompleted:n,actions:a})},t.prototype.render=function(){var e=this,t=this.props.buildingName,n=this.state,o=n.actions,r=n.qrcodeShow,i=n.previousActions,s=n.isCompleted;return a.createElement(a.Fragment,null,a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid"},i&&i.length>0&&a.createElement("div",{className:"card padding-10"},a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12"},i.map(function(e,n){return a.createElement(a.Fragment,null,a.createElement("div",{key:n,className:"row hidden-xs no-padding"},a.createElement("div",{className:"col-md-12 "},a.createElement("div",{className:"col-md-3 col-sm-12 small grid-header-left"},a.createElement("label",null,"Task"),a.createElement("div",{className:"padding-5"},e.taskDescription)),a.createElement("div",{className:"col-md-3 col-sm-12 small grid-header-left"},a.createElement("label",null,"Do What? "),a.createElement("div",{className:"padding-5"},e.directive)),a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left"},a.createElement("label",null,"Floor"),a.createElement("div",{className:"padding-5"},e.floorOntology)),a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left"},a.createElement("label",null,"Space "),a.createElement("div",{className:"padding-5"},e.spaceOntology," ")),a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left"},a.createElement("label",null,"Asset "),a.createElement("div",{className:"padding-5"},e.assetOntology)))),a.createElement("div",{key:n+"a",className:"row hidden-xs no-padding"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-3"}," ",a.createElement("p",{className:"headingText"},e.directive,":")),a.createElement("div",{className:"col-md-9"},"enter"==e.directiveType&&a.createElement(a.Fragment,null,a.createElement("div",{dangerouslySetInnerHTML:{__html:e.dataEntered}}),a.createElement("button",{className:"m-2 btn btn-primary btn-fill",onClick:function(){}},"Download File")),"formentry"==e.directiveType&&a.createElement("p",null,e.dataEntered," ",e.dataEntered),"numeric"==e.directiveType&&a.createElement("p",null,e.dataEntered," ",e.unit),"email"==e.directiveType&&a.createElement("p",null,e.dataEntered),"done"==e.directiveType&&a.createElement("p",null,e.isDone?"Completed":"Not Done"),"scan"==e.directiveType&&a.createElement(a.Fragment,null,e.isQrCodeVerified?a.createElement("h4",{style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Verified"):a.createElement("h4",{style:{color:"red"}},a.createElement("i",{className:"fa fa-cross",style:{margin:8}}),"Not Verified")),"upload"==e.directiveType&&a.createElement(l.a,{showUploader:!1,showGrid:!0,buildingName:t,assetOntology:e.ontology,entityType:"ObjectAttachment"})))))})))),a.createElement("div",{className:"card"},a.createElement("div",{className:"row m-0"},a.createElement("div",{className:"col-md-12"},o.map(function(n,o){return a.createElement("div",{key:o,className:"row m-0 body-bg-p"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"col-md-1 col-sm-1 col-xs-1 provisionBackground",style:{backgroundColor:s&&s.length>0&&s[o]?"green":"#FF9500"}},a.createElement("i",{className:(s&&s.length>0&&s[o]?"fa fa-check-circle icon-cog":"fa fa-circle-o icon-cog")+" fa-3x","aria-hidden":"true",style:{margin:"auto",justifyContent:"center",display:"flex",marginTop:"5%"}})),a.createElement("div",{className:"col-md-11 col-sm-11 col-xs-11",style:{paddingLeft:"0px"}},a.createElement("div",{className:"panel-heading",style:{backgroundColor:"#174b54",color:"white",borderRadius:"0px 5px 5px 0px"}},a.createElement("h4",{className:"panel-title"},a.createElement("div",{style:{textAlign:"center"}},a.createElement("a",{href:"#openCollapse"+o,"data-toggle":"collapse"},a.createElement("span",{style:{alignItems:"center"}},n.directive))))),a.createElement("div",{className:"row container-fluid collapse",id:"openCollapse"+o},a.createElement("div",{className:"col-md-11"},"enter"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("input",{type:"text",style:{width:"fit-content"},className:"form-control  pull-right",value:n.dataEntered,onChange:function(t){e.onChangeNumericHandler(t,o)}})," ",a.createElement("span",null),a.createElement("button",{className:"m-2 btn btn-primary btn-fill pull-right",onClick:function(){var t={};t[n.unit]=n.dataEntered,e.onClickDownloadAgreementTemplate(t)}},"Download File")),"formentry"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("label",null,n.floorLabel?"Floor: "+n.floorLabel+" ":"",a.createElement("br",null),n.spaceLabel?"Space: "+n.spaceLabel+" ":"",a.createElement("br",null),n.assetLabel?"Asset: "+n.assetLabel+" ":"",a.createElement("br",null),n.componentLabel?"Component: "+n.componentLabel+" ":"",a.createElement("br",null),n.pointLabel?"Point(s): "+n.pointLabel:""),a.createElement("input",{type:"text",style:{width:"-webkit-fill-available"},className:"form-control pull-right",value:n.dataEntered,onChange:function(t){e.onChangeNumericHandler(t,o)}})," ",a.createElement("span",null)),"numeric"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("label",null,n.floorLabel?"Floor: "+n.floorLabel+" ":"",a.createElement("br",null),n.spaceLabel?"Space: "+n.spaceLabel+" ":"",a.createElement("br",null),n.assetLabel?"Asset: "+n.assetLabel+" ":"",a.createElement("br",null),n.componentLabel?"Component: "+n.componentLabel+" ":"",a.createElement("br",null),n.pointLabel?"Point(s): "+n.pointLabel:""),a.createElement("input",{disabled:!!n.isDone,type:"number",style:{width:"fit-content"},className:"form-control pull-right",value:n.dataEntered,onChange:function(t){e.onChangeNumericHandler(t,o)}})," ",a.createElement("span",null)),"done"==n.directiveType&&a.createElement(a.Fragment,null,n.isDone?a.createElement("h4",{className:"text-center",style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"):a.createElement("button",{className:"m-2 btn btn-primary btn-fill pull-right",onClick:function(){var t=e.state.actions;t[o].isDone=!0,e.setState({actions:t})}},"Done")),"wire"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("label",null,n.floorLabel?"Floor: "+n.floorLabel+" ":"",a.createElement("br",null),n.spaceLabel?"Space: "+n.spaceLabel+" ":"",a.createElement("br",null),n.assetLabel?"Asset: "+n.assetLabel+" ":"",a.createElement("br",null),n.componentLabel?"Component: "+n.componentLabel+" ":""),a.createElement("ul",null,"Points:",e.state.selectedPoints[o].map(function(e,t){return a.createElement(a.Fragment,null,a.createElement("li",{key:t},e.label))})),n.isDone?a.createElement("h4",{style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"):a.createElement("button",{className:"m-2 btn btn-primary btn-fill pull-right",onClick:function(){var t=e.state.actions;t[o].isDone=!0,e.setState({actions:t})}},"Done")),"email"==n.directiveType&&a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},!n.isDone&&a.createElement("div",null,a.createElement("div",{className:"col-md-2"},a.createElement("p",{className:"headingText"},"To:")),a.createElement("div",{className:"col-md-10"},a.createElement("input",{type:"text",className:"form-control",value:e.state.toEmail,onChange:function(t){e.onToEmail(t,o)}})," ",a.createElement("span",null))),a.createElement("div",{className:"col-md-2 mt-2"},a.createElement("p",{className:"headingText"},"Email:")),a.createElement("div",{className:"col-md-10 mt-2"},a.createElement("textarea",{disabled:n.isDone,rows:5,className:"form-control",value:n.dataEntered,onChange:function(t){e.onEmailData(t,o)}})," ",a.createElement("span",null)))),"scan"==n.directiveType&&!n.isQrCodeVerified&&a.createElement(a.Fragment,null,a.createElement("label",null,n.floorLabel?"Floor: "+n.floorLabel+" ":"",a.createElement("br",null),n.spaceLabel?"Space: "+n.spaceLabel+" ":"",a.createElement("br",null),n.assetLabel?"Asset: "+n.assetLabel+" ":"",a.createElement("br",null),n.componentLabel?"Component: "+n.componentLabel+" ":"",a.createElement("br",null),n.pointLabel?"Point(s): "+n.pointLabel:""),a.createElement("button",{onClick:function(){e.setState({qrcodeShow:!0,qrcodeActionIndex:o},function(){document.getElementById("qrDailogebtn").click()})},className:"ml-1 btn btn-secondary btn-fill pull-right"},a.createElement("i",{className:"fa fa-qrcode"}),"\xa0","Show Scanner"),a.createElement("button",{id:"qrDailogebtn",type:"button","data-toggle":"modal","data-target":"#qrDailoge",className:"hidden"},"."),a.createElement(c.a,{id:"qrDailoge",closeButtonId:"qrDailogeClose",heading:"Scan QR",showSaveButton:!1,showCancelButton:!0,onCancelButtonClick:function(){e.setState({qrcodeShow:!1,qrcodeActionIndex:null})}},r&&a.createElement("div",null,a.createElement(b,{delay:500,onError:function(e){console.log(e)},onScan:e.handleScan,style:{width:"100%"}})))),"scan"==n.directiveType&&n.isQrCodeVerified&&a.createElement(a.Fragment,null,a.createElement("h4",{className:"text-center",style:{color:"#33cc66"}},a.createElement("i",{className:"fa fa-check",style:{margin:8}}),"QR Verified")),"upload"==n.directiveType&&a.createElement(l.a,{showUploader:!n.isDone,showGrid:!0,buildingName:t,assetOntology:n.ontology,entityType:"ObjectAttachment"})),!n.isDone&&"scan"!==n.directiveType&&a.createElement("div",{className:"col-md-7 mt-4"},a.createElement("button",{disabled:!!n.isDone,className:"btn btn-primary btn-fill pull-right",onClick:function(){e.setIconChange(o),e.saveActions(o)}},"Mark Done"))))))}),a.createElement("hr",null),a.createElement("div",{className:"row m-0 body-bg-p pb-0 "},a.createElement("div",{className:"col-md-12"},a.createElement("button",{className:"m-2 btn btn-secondary btn-fill",onClick:function(){window.location.hash=e.props.instance+"/"+t+"/Tasks"}},"Back to Tasks")))))),a.createElement("button",{id:"multiPointsbtn",type:"button","data-toggle":"modal","data-target":"#multiPoints",className:"hidden"},"."),a.createElement(c.a,{id:"multiPoints",closeButtonId:"multiPointsClose",heading:"Action",saveButtonText:"Done",onSaveButtonClick:function(){return e.handleSaveMultiPointsActions()},showSaveButton:!0},a.createElement("div",null,a.createElement("p",null,"Are you sure that you have done your task?"))))))},t}(a.Component);t.default=h}});