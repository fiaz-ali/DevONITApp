webpackJsonp([95],{1710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(2),l=(n.n(a),n(119)),o=n(671),c=n(116),r=n(10),s=n(11),d=n(649),u=n(1270),m=n(652),g=n(821),b=n(31),h=n(719),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),f=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(a,l){function o(e){try{r(i.next(e))}catch(e){l(e)}}function c(e){try{r(i.throw(e))}catch(e){l(e)}}function r(e){e.done?a(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,c)}r((i=i.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,i,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function c(l){return function(c){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(a=2&l[0]?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,i=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],i=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}},E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={buildingObj:Object(),isEdit:!1,addBuildingFunction:!1,addBuildingName:"",regionList:[],buildingNameToDelete:Object(),isDelete:!1,DropdownModelObj:Object(),BuildingFunctionListType:[]},i=n,n.setBuilding=n.setBuilding.bind(n),n.saveBuilding=n.saveBuilding.bind(n),n.handleBuildingChange=n.handleBuildingChange.bind(n),n.getRegion=n.getRegion.bind(n),n.deleteBuilding=n.deleteBuilding.bind(n),n.toDeleteBuilding=n.toDeleteBuilding.bind(n),n}return p(t,e),t.prototype.saveBuilding=function(){return f(this,void 0,void 0,function(){var e,t,n,i,a;return v(this,function(l){switch(l.label){case 0:return e=this.state,t=e.buildingObj,n=e.isEdit,i=this.props.instance,t.dashboardLink&&t.dashboardLink.indexOf("&kiosk=tv&autofitpanels"),t.dashboardLink,t.wholeBuildingMeterLink&&t.wholeBuildingMeterLink.indexOf("&kiosk=tv&autofitpanels"),t.wholeBuildingMeterLink,a=JSON.parse(s.a.getItem("user")),t&&t.rdfsLabel?(Object(c.a)(!0),[4,Object(o.f)(t,a.contact,n)]):[3,2];case 1:l.sent(),Object(c.a)(!1),l.label=2;case 2:return window.location.hash=i+"/Buildings",[2]}})})},t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.instance?[4,this.setBuilding()]:[3,3];case 1:return e.sent(),[4,this.getBuildingFunction()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.setBuilding=function(){return f(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){return this.props.buildingName&&this.props.buildingName.length>0?Object(o.d)(this.props.buildingName).then(function(e){if(e&&e.length>0){var n=e[0],a=t.state.buildingObj;a.rdfsLabel=Object(r.g)(n.rdfsLabel),a.address=Object(r.g)(n.address),a.buildingCode=Object(r.g)(n.buildingCode),a.area=Object(r.g)(n.area),a.buildingFunction=Object(r.g)(n.function),a.buildingName=Object(r.g)(n.building),a.campus=Object(r.g)(n.campus),a.linkbimism=Object(r.g)(n.linkBimism),a.street=Object(r.g)(n.street),a.state=Object(r.g)(n.state),a.city=Object(r.g)(n.city),a.zipcode=Object(r.g)(n.zipcode),a.dashboardLink=Object(r.g)(n.dashboardLink),a.googleMapLink=Object(r.g)(n.googleMapLink),a.wholeBuildingMeterLink=Object(r.g)(n.wholeBuildingMeterLink),a.MVPSecurity=Object(r.g)(n.MVPSecurity),a.country=Object(r.g)(n.country),a.buildingDimensionUnit=Object(r.g)(n.buildingDimensionUnit),i.setState({buildingObj:a,isEdit:!0}),t.getRegion()}}).catch(function(e){return e}):((e=Object()).buildingName=Object(b.p)(4),i.setState({buildingObj:e})),[2]})})},t.prototype.saveBuildingFunction=function(){return f(this,void 0,void 0,function(){var e,t,n,i,a=this;return v(this,function(l){switch(l.label){case 0:return e=this.state,t=e.DropdownModelObj,n=e.isEdit,i=this.state.buildingObj.buildingFunction,t.name=i,t.type="Building Function",[4,Object(g.b)(t,n).then(function(){a.getBuildingFunction()}).catch(function(e){console.log(e)})];case 1:return l.sent(),[2]}})})},t.prototype.getBuildingFunction=function(){return f(this,void 0,void 0,function(){var e,t;return v(this,function(n){switch(n.label){case 0:return e=this.state.BuildingFunctionListType,[4,Object(g.c)()];case 1:return(t=n.sent())&&t.length>0&&(e=t.filter(function(e){return"Building Function"==Object(r.g)(e.type)}),this.setState({BuildingFunctionListType:e})),[2]}})})},t.prototype.handleBuildingChange=function(e,t){var n=this.state.buildingObj;switch(e){case"buildingName":n.rdfsLabel=t;break;case"address":n.address=t;break;case"buildingCode":n.buildingCode=t;break;case"area":n.area=t;break;case"buildingFunction":n.buildingFunction=t,"Others"==n.buildingFunction&&(n.buildingFunction="",document.getElementById("openSecondDialog").click());case"campus":n.campus=t;break;case"linkbimism":n.linkbimism=t;break;case"street":n.street=t;break;case"city":n.city=t;break;case"state":n.state=t;break;case"zipcode":n.zipcode=t;break;case"dashboardLink":n.dashboardLink=t;break;case"googleMapLink":n.googleMapLink=t;break;case"wholeBuildingMeterLink":n.wholeBuildingMeterLink=t;break;case"MVPSecurity":n.MVPSecurity=t;break;case"country":n.country=t;var i=u.a&&u.a.find(function(e){return e.countryName==t});this.setState({regionList:i.regions});break;case"buildingDimensionUnit":n.buildingDimensionUnit=t}this.setState({buildingObj:n})},t.prototype.getRegion=function(){var e=this.state,t=e.buildingObj,n=e.regionList;if(this.props.buildingName&&this.props.buildingName.length>0){var i=u.a&&u.a.find(function(e){return e.countryName==t.country});n=i&&i.regions,this.setState({regionList:n})}},t.prototype.deleteBuilding=function(e){this.setState({buildingNameToDelete:e},function(){document.getElementById("btnConfirm").click()})},t.prototype.toDeleteBuilding=function(){return f(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=this.state.buildingNameToDelete)?[4,Object(o.a)(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return document.getElementById("cancelBuildingEdit").click(),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.buildingObj,i=t.addBuildingFunction,o=t.addBuildingName,c=t.regionList,s=t.isEdit,g=t.BuildingFunctionListType,b=this.props,p=b.instance,f=b.buildingName,v=n&&n.city&&n.state&&n.country&&n.street&&n.zipcode&&n.rdfsLabel&&n.area&&n.buildingFunction&&!0;return a.createElement(l.a.Consumer,null,function(t){return a.createElement("div",{className:"content",style:{marginTop:"-15px",marginLeft:"7px",marginRight:"7px"}},a.createElement("div",{className:"card"},a.createElement("div",{className:"container-fluid padding-10"},a.createElement("h4",{className:"title"},"Building Information"),a.createElement("hr",null),a.createElement("br",null),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"buildingname"},"Building name:"))),a.createElement("div",{className:"col-md-3"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control "+(n.rdfsLabel?"":"addFieldValidate"),type:"text",id:"buildingname",value:n.rdfsLabel,onChange:function(t){e.handleBuildingChange("buildingName",t.target.value)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"area"},"Area:"))),a.createElement("div",{className:"col-md-3"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control "+(n.area?"":"addFieldValidate"),type:"number",id:"area",value:n.area,onChange:function(t){e.handleBuildingChange("area",t.target.value)}}))),a.createElement("div",{className:"col-md-2"},"Square Feet")),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"buildingFunction"},"Function:"))),a.createElement("div",{className:"col-md-3"},a.createElement("div",{className:"form-group"},a.createElement("select",{className:"form-control "+(n.buildingFunction?"":"addFieldValidate"),id:"buildingFunction",value:n.buildingFunction,onChange:function(t){e.handleBuildingChange("buildingFunction",t.target.value)}},a.createElement("option",{value:""},"Select Function"),g&&g.length>0&&g.map(function(e,t){return a.createElement("option",{key:t,value:Object(r.g)(e.ontology)},Object(r.g)(e.name))}),a.createElement("option",{value:"Others"},"Others")))),a.createElement("button",{type:"button",id:"openSecondDialog",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#secondDialog"}," ."),a.createElement(d.a,{id:"secondDialog",heading:i?"Add Building Function ":"Add Building Function",saveButtonText:o?"Update Building":"Create Building Funcion",cancelButtonText:"Cancel",disableSaveButton:!n.buildingFunction,showCancelButton:!0,showSaveButton:!0,isEditForm:!1,onSaveButtonClick:function(){e.saveBuildingFunction()}},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("label",{htmlFor:"point"},"Name:"),a.createElement("br",null),a.createElement("input",{className:"controls clearfix form-control",type:"text",name:"buildingfunction",placeholder:"Other Name",onChange:function(t){e.handleBuildingChange("buildingFunction",t.target.value)},value:n.buildingFunction}))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"buildingFunction"},"Building Code"))),a.createElement("div",{className:"col-md-3"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control",type:"text",id:"buildingCode",value:n.buildingCode,onChange:function(t){e.handleBuildingChange("buildingCode",t.target.value)}}))),a.createElement("div",{className:"col-md-1"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"buildingFunction"},"Dimension Unit"))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("select",{className:"form-control",id:"buildingDimensionUnit",name:"buildingDimensionUnit",value:n.buildingDimensionUnit,onChange:function(t){e.handleBuildingChange("buildingDimensionUnit",t.target.value)}},a.createElement("option",{value:""},"Select Dimension Unit"),a.createElement("option",{value:"Meter"},"Meter"),a.createElement("option",{value:"Feet"},"Feet"))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"streetAddress"},"Address"))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("select",{className:"form-control "+(n.country?"":"addFieldValidate"),id:"country",value:n.country,onChange:function(t){e.handleBuildingChange("country",t.target.value)}},a.createElement("option",{value:""},"Select Country"),u.a&&u.a.length>0&&u.a.map(function(e,t){return a.createElement("option",{value:e.countryName},e.countryName)})))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("select",{className:"form-control "+(n.state?"":"addFieldValidate"),id:"state",value:n.state,onChange:function(t){e.handleBuildingChange("state",t.target.value)}},a.createElement("option",{value:""},"Select State"),c&&c.length>0&&c.map(function(e){return a.createElement("option",{value:e.label},e.label)})))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control "+(n.street?"":"addFieldValidate"),type:"text",id:"streetAddress",name:"streetAddress",placeholder:"Street",value:n.street,onChange:function(t){e.handleBuildingChange("street",t.target.value)}}))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control "+(n.city?"":"addFieldValidate"),type:"text",id:"city",name:"city",placeholder:"City",value:n.city,onChange:function(t){e.handleBuildingChange("city",t.target.value)}}))),a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control "+(n.zipcode?"":"addFieldValidate"),type:"text",id:"zipcode",name:"zipcode",placeholder:"ZipCode",value:n.zipcode,onChange:function(t){e.handleBuildingChange("zipcode",t.target.value)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"linkbimism"},"Virtual BIM Link:"))),a.createElement("div",{className:"col-md-9"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control",type:"text",id:"linkbimism",value:n.linkbimism,onChange:function(t){e.handleBuildingChange("linkbimism",t.target.value)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"linkbimism"},"Dashboard Link:"))),a.createElement("div",{className:"col-md-9"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control",type:"text",id:"dashboardLink",value:n.dashboardLink,onChange:function(t){e.handleBuildingChange("dashboardLink",t.target.value)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"MVPSecurity"},"MVP Security Link:"))),a.createElement("div",{className:"col-md-9"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control",type:"text",id:"MVPSecurity",name:"MVPSecurity",value:n.MVPSecurity,onChange:function(t){e.handleBuildingChange("MVPSecurity",t.target.value)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"linkbimism"},"Whole Building Meter Link:"))),a.createElement("div",{className:"col-md-9"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control",type:"text",id:"wholeBuildingMeterLink",value:n.wholeBuildingMeterLink,onChange:function(t){e.handleBuildingChange("wholeBuildingMeterLink",t.target.value)}})))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("div",{className:"form-group"},a.createElement("label",{htmlFor:"linkbimism"},"Google Map Link:"))),a.createElement("div",{className:"col-md-9"},a.createElement("div",{className:"form-group"},a.createElement("input",{className:"form-control",type:"text",id:"googleMapLink",value:n.googleMapLink,onChange:function(t){e.handleBuildingChange("googleMapLink",t.target.value)}})))),(f||n.buildingName)&&a.createElement(h.a,{buildingName:f||n.buildingName,assetOntology:f||n.buildingName,entityType:"Building",showUploader:!0}),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 inline-block"},a.createElement("button",{disabled:!v,className:"btn btn-primary btn-fill",onClick:function(){t.onChangeBuilding(Object()),e.saveBuilding()}},a.createElement("i",{className:"fa fa-save"})," Save"),a.createElement("button",{className:"btn btn-secondary btn-fill",id:"cancelBuildingEdit",onClick:function(){return window.location.hash=p+"/Buildings"}},a.createElement("i",{className:"fa fa-window-close"})," Cancel"),s&&a.createElement("button",{className:"btn btn-danger active",onClick:function(){e.deleteBuilding(f)}},a.createElement("i",{className:"fa fa-trash"})," Delete"))))),a.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),a.createElement(m.a,{instance:p,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Building?",heading:"Confirm...",onConfirmButtonClick:function(){e.toDeleteBuilding()}}))})},t}(a.Component);t.default=E}});