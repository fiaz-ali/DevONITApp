webpackJsonp([52],{1464:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l});var a=[{roleID:"1",value:"1-Super User"},{roleID:"2",value:"2-Operating Officer / Manager"},{roleID:"3",value:"3-Staff / Contractors"},{roleID:"4",value:"4-Customer"},{roleID:"5",value:"5-Service Manager"},{roleID:"6",value:"6-Service Worker"}],l=[{roleID:"3",value:"3-Staff / Contractors"},{roleID:"4",value:"4-Customer"},{roleID:"5",value:"5-Service Manager"},{roleID:"6",value:"6-Service Worker"}]},3268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),l=(n.n(a),n(119)),o=n(653),i=n(657),r=n(10),c=n(1464),s=n(1319),m=n(667),u=n(11),d=n(668),f=n(669),p=n(875),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),g=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,r)}c((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,o,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(l=2&o[0]?a.return:o[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,o[1])).done)return l;switch(a=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){i.label=o[1];break}if(6===o[0]&&i.label<l[1]){i.label=l[1],l=o;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(o);break}l[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_people:[],columns:[{name:"Name",selected:!0},{name:"Role",selected:!0},{name:"Phone",selected:!0},{name:"Email",selected:!0},{name:"Status",selected:!0},{name:"Chat",selected:!0}],sortOrder:1,ContactToDelete:Object(),contactNameForReset:"",showLogs:!1,verifyUser:!1},n.handleColumnFilters=n.handleColumnFilters.bind(n),n.sortPeople=n.sortPeople.bind(n),n.onDeleteContact=n.onDeleteContact.bind(n),n._fetchPeople=n._fetchPeople.bind(n),n}return h(t,e),t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchPeople()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype._fetchPeople=function(){return g(this,void 0,void 0,function(){var e,t,n,a=this;return v(this,function(l){switch(l.label){case 0:return e=JSON.parse(u.a.getItem("user")),[4,Object(i.s)()];case 1:return t=l.sent(),"1"==e.role?this.setState({_people:t}):(n=t.filter(function(e){return Object(r.g)(e.assignedTo).includes(a.props.buildingName)}),this.setState({_people:n})),[2]}})})},t.prototype.handleColumnFilters=function(e){var t=e.target.checked,n=this.state.columns;n[n.findIndex(function(t){return t.name===e.target.value})].selected=t,this.setState({columns:n})},t.prototype.sortPeople=function(e,t){var n=this.state._people,a=this.state.sortOrder,l=n.sort(function(n,l){if(n&&l){var o="",i="";switch(e){case"Name":n.name&&l.name&&(o=n.name.value,i=l.name.value,a=t||1);break;case"Role":n.role&&l.role&&(o=n.role.value,i=l.role.value);break;case"Phone":n.phone&&l.phone&&(o=n.phone.value,i=l.phone.value);break;case"Email":n.email&&l.email&&(o=n.email.value,i=l.email.value);break;case"Status":n.status&&l.status&&(o=n.status.value,i=l.status.value);break;case"Chat":n.chatlink&&l.chatlink&&(o=n.chatlink.value,i=l.chatlink.value)}var r=0;return o.toLocaleLowerCase()<i.toLocaleLowerCase()?r=-1:o.toLocaleLowerCase()>i.toLocaleLowerCase()&&(r=1),r*a}});this.setState({_people:l,sortOrder:-1*a})},t.prototype.onDeleteContact=function(e){return g(this,void 0,void 0,function(){return v(this,function(t){return this.setState({ContactToDelete:e}),document.getElementById("btnConfirm").click(),[2]})})},t.prototype.deleteContact=function(){return g(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=this.state.ContactToDelete,[4,Object(i.c)(this.props.buildingName,e.contact.value)];case 1:return t.sent(),[4,this._fetchPeople()];case 2:return t.sent(),this.setState({ContactToDelete:Object()}),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,i=t.buildingName,h=this.state,g=h.columns,v=h._people,b=h.showLogs,N=h.verifyUser,E=JSON.parse(u.a.getItem("user")),C=Object(m.b)(E,"people","write");return b?a.createElement(d.a,{instance:n,buildingName:i,fromEntityList:!0,module:f.a.People,entityName:"Contact",entityList:v.map(function(e){return{label:Object(r.g)(e.name),value:Object(r.g)(e.contact)}}),onLogClose:function(){return e.setState({showLogs:!1})}}):N?a.createElement(p.a,{onConfirmation:function(t){t?e.setState({verifyUser:!1},function(){e.deleteContact()}):e.setState({verifyUser:!1})}}):a.createElement(l.a.Consumer,null,function(t){return a.createElement("div",{className:"content",style:{paddingTop:"0px"}},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row no-padding"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 "},E&&"1"==E.role&&a.createElement("button",{className:"btn btn-md btn-primary btn-fill pull-right",style:{marginLeft:5},title:"Logs",onClick:function(){e.setState({showLogs:!0})}}," ",a.createElement("img",{src:"assets/img/Logs.png",style:{width:25,height:18}})),C&&a.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){window.location.hash=n+"/"+i+"/People/NewContact"}},a.createElement("i",{className:"fa fa-plus"}),a.createElement("span",null,"Create New Contact")))),a.createElement("br",null),a.createElement("div",{className:"card padding-10",id:"PeopleList",style:{paddingTop:"0px"}},a.createElement("div",{className:"content",style:{paddingTop:"10px"}},a.createElement("div",{className:"dataCard"},a.createElement("div",{className:"row hidden-xs hidden-sm no-padding"},a.createElement("div",{className:"col-md-10 dataCard no-padding"},g.find(function(e){return"Name"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header-left",onClick:function(){return e.sortPeople("Name")}},a.createElement("i",{className:"fa fas fa-sort"}),"Name"),g.find(function(e){return"Role"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Role")}},a.createElement("i",{className:"fa fas fa-sort",style:{paddingLeft:"8px"}}),"Role"),g.find(function(e){return"Phone"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Phone")}},a.createElement("i",{className:"fa fas fa-sort"}),"Phone"),g.find(function(e){return"Email"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Email")}},a.createElement("i",{className:"fa fas fa-sort"}),"Email"),g.find(function(e){return"Status"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header",onClick:function(){return e.sortPeople("Status")}},a.createElement("i",{className:"fa fas fa-sort"}),"Status"),g.find(function(e){return"Chat"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small grid-header"}," \xa0 \xa0 \xa0Chat")),a.createElement("div",{className:"col-md-2"})),a.createElement(s.a,{userName:e.state.contactNameForReset,dialogButtonName:"btnChangePassword"}),v&&v.length>0&&v.map(function(l,o){return a.createElement("div",{key:o,className:"row clickable no-padding"},a.createElement("div",{className:"col-md-10 no-padding"},g.find(function(e){return"Name"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(r.g)(l.name)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Name"),a.createElement("a",{href:"#"+n+"/"+i+"/People/ViewContact/"+Object(r.g)(l.contact)}," ",Object(r.g)(l.name))),g.find(function(e){return"Role"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:c.a.find(function(e){return e.roleID==Object(r.g)(l.role)})?c.a.find(function(e){return e.roleID==Object(r.g)(l.role)}).value:""},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"role"),c.a.find(function(e){return e.roleID==Object(r.g)(l.role)})?c.a.find(function(e){return e.roleID==Object(r.g)(l.role)}).value:""),g.find(function(e){return"Phone"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(r.g)(l.phone)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Phone"),Object(r.g)(l.phone)),g.find(function(e){return"Email"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 col-sm-12 small trim-data",title:Object(r.g)(l.email)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Email"),Object(r.g)(l.email)),g.find(function(e){return"Status"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 padding-10 trim-data",title:"Not Working"==Object(r.g)(l.workingStatus)?"OFF":Object(r.g)(l.workingStatus)},a.createElement("span",{className:"hidden visible-xs-inline visible-sm-inline headingText"},"Status"),"Not Working"==Object(r.g)(l.workingStatus)?"OFF":Object(r.g)(l.workingStatus)),g.find(function(e){return"Chat"==e.name&&1==e.selected})&&a.createElement("div",{className:"col-md-2 col-sm-12 small center trim-data padding-5",title:Object(r.g)(l.chatlink)},a.createElement("button",{className:"btn btn-xs btn-primary active padding-5",onClick:function(e){window.location.hash=n+"/"+i+"/PersonChatWindow/Contact/"+Object(r.g)(l.contact)}},a.createElement("i",{className:"fa fa-comments"}),"Go To/ Start New"))),C&&a.createElement("div",{className:"col-md-2 col-xs-12 padding-10 center"},"1"==t.authenticatedUser.role&&a.createElement("a",{className:"btn-sm btn-primary active custom-outline-btn pad-mag",style:{margin:"0"},title:"Change Password",onClick:function(t){e.setState({contactNameForReset:l.contact.value},function(){document.getElementById("btnChangePassword").click()})}},a.createElement("i",{className:"fa fa-key"})),a.createElement("a",{className:"btn-sm btn-danger active custom-outline-btn pad-mag",style:{margin:"0"},title:"Delete",onClick:function(t){e.onDeleteContact(l)}},a.createElement("i",{className:"fa fa-trash"})),a.createElement("a",{className:"btn-sm btn-success active custom-outline-btn pad-mag",title:"Edit",style:{margin:"0"},onClick:function(e){window.location.hash=n+"/"+i+"/People/EditContact/"+l.contact.value}},a.createElement("i",{className:"fa fa-edit"})),a.createElement("a",{className:"btn-sm btn-warning active custom-outline-btn pad-mag",title:"Time Log",style:{margin:"0"},onClick:function(e){window.location.hash=n+"/"+i+"/TimeClockAnalytics/"+Object(r.g)(l.contact.value)}},a.createElement("i",{className:"fas fa-chart-bar"}))))}),a.createElement("button",{id:"btnConfirm",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialog"},"."),a.createElement(o.a,{instance:n,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Contact?",heading:"Confirm...",onConfirmButtonClick:function(){e.setState({verifyUser:!0})}}))))))))})},t}(a.Component);t.default=b}});