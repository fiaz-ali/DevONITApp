webpackJsonp([19],{3242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),l=(n.n(o),n(122)),i=n(709),r=n(11),s=n(3243),a=n(3244),u=n(754),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(l,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}a((o=o.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var n,o,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(l=2&i[0]?o.return:i[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,i[1])).done)return l;switch(o=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={currentView:"Space",linkBimism:"",locationModel:Object(),spaceInBuildingRoutes:[],spaceSteps:[]},n.getSpace=n.getSpace.bind(n),n.onSaveHandle=n.onSaveHandle.bind(n),n.onSpaceStepsChange=n.onSpaceStepsChange.bind(n),n.onInBuildingRouteChange=n.onInBuildingRouteChange.bind(n),n}return c(t,e),t.prototype.componentDidMount=function(){return d(this,void 0,void 0,function(){var e,t,n;return p(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,n=e.space,[4,this.getSpace(t,n)];case 1:return o.sent(),[2]}})})},t.prototype.onSaveHandle=function(){return d(this,void 0,void 0,function(){var e,t,n,o,i=this;return p(this,function(r){switch(r.label){case 0:return e=this.state,t=e.currentView,n=e.spaceSteps,o=e.spaceInBuildingRoutes,Object(l.a)(!0),"Space"!=t?[3,3]:n&&n.length>0?(n.map(function(e){return e.assignedSpace=i.props.space}),[4,Object(u.g)(this.props.buildingName,n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return[4,Object(u.e)(this.props.buildingName,o)];case 4:r.sent(),r.label=5;case 5:return Object(l.a)(!1),[2]}})})},t.prototype.onSpaceStepsChange=function(e){this.setState({spaceSteps:e})},t.prototype.onInBuildingRouteChange=function(e){this.setState({spaceInBuildingRoutes:e})},t.prototype.getSpace=function(e,t){return d(this,void 0,void 0,function(){var n,o,s=this;return p(this,function(a){switch(a.label){case 0:return n=Object(),o=this.state.locationModel,Object(l.a)(!0),[4,Object(i.i)(e,t).then(function(e){return d(s,void 0,void 0,function(){return p(this,function(t){return""==Object(r.g)(e[0].space)&&(e=[]),n=e[0],[2]})})}).catch(function(e){return e})];case 1:return a.sent(),n&&(o.buildingName=e,o.floor=Object(r.g)(n.floor&&n.floor),o.type=Object(r.g)(n.type),o.name=Object(r.g)(n.space),o.rdfsLabel=Object(r.g)(n.rdfsLabel),o.ceilingType=Object(r.g)(n.ceilingtype),o.ceilingHeight=Object(r.g)(n.ceilingheight),o.description=Object(r.g)(n.description),o.notes=Object(r.g)(n.notes),o.panelID=Object(r.g)(n.panelID),o.virtualBIM=Object(r.g)(n.virtualBIM),o.cadBIM=Object(r.g)(n.cadBIM),o.profileFileName=Object(r.g)(n.profileFileName).split(","),o.isDirectional="true"===Object(r.g)(n.isDirectional),this.setState({locationModel:o,linkBimism:o.virtualBIM})),Object(l.a)(!1),[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.currentView,l=t.linkBimism,i=this.props,r=i.instance,u=i.buildingName,c=i.space;return o.createElement("div",{className:"content"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-3 padding-5"},o.createElement("div",{className:"btn-group"},o.createElement("button",{className:"btn "+("Space"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"Space"})}},"Space Steps"),o.createElement("button",{className:"btn "+("InBuilding"==n?"btn-fill":"")+" btn-secondary btn-secondary-dark",onClick:function(){e.setState({currentView:"InBuilding"})}},"In Building Routes"))),o.createElement("div",{className:"col-md-9 padding-5"},o.createElement("div",{className:"pull-right"},o.createElement("div",{className:"col-md-6"},o.createElement("button",{type:"button",className:"btn btn-primary btn-fill",onClick:this.onSaveHandle}," Save ","Space"==n?"Space Steps":"In building Route")),o.createElement("div",{className:"col-md-6"},o.createElement("button",{type:"button",className:"btn btn-default btn-fill",onClick:function(){window.location.hash=r+"/"+u+"/Space"}}," Back To Spaces"))))),o.createElement("br",null),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},"Space"==n&&o.createElement("div",null,o.createElement(s.a,{buildingName:u,space:c,bimURL:l,onSaveSteps:this.onSpaceStepsChange})),"InBuilding"==n&&o.createElement("div",null,o.createElement(a.a,{buildingName:u,space:c,bimURL:l,onSaveRoutes:this.onInBuildingRouteChange}))))))},t}(o.Component);t.default=f},3243:function(e,t,n){"use strict";var o=n(2),l=(n.n(o),n(11)),i=n(754),r=n(21),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(l,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}a((o=o.apply(e,t||[])).next())})},u=this&&this.__generator||function(e,t){var n,o,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(l=2&i[0]?o.return:i[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,i[1])).done)return l;switch(o=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,selectedSteps:[],modelDetails:Object(),spaceDetails:[],currentSweep:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:!1,prevSweepIndex:0,onPropsReceivedStateChanged:!1,linkBimism:n.props.bimURL,sdk:Object(),locationModel:Object()},n.getSweeps=n.getSweeps.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.removeSweep=n.removeSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.loadSDK=n.loadSDK.bind(n),n.initFrame=n.initFrame.bind(n),n}return s(t,e),t.prototype.componentDidMount=function(){return a(this,void 0,void 0,function(){var e,t,n;return u(this,function(o){switch(o.label){case 0:return e=this.props,t=e.buildingName,n=e.space,[4,this.getSweeps(t,n)];case 1:return o.sent(),[2]}})})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.state.selectedSteps;e.bimURL&&this.setState({linkBimism:e.bimURL}),this.state.selectedSteps&&this.setState({selectedSteps:t})},t.prototype.getSweeps=function(e,t){return a(this,void 0,void 0,function(){var n,o=this;return u(this,function(r){switch(r.label){case 0:return n=[],[4,Object(i.c)(e,t).then(function(e){return a(o,void 0,void 0,function(){return u(this,function(t){return e.forEach(function(e){var t=Object();t.assignedSpace=Object(l.g)(e.assignedSpace),t.buildingName=Object(l.g)(e.buildingName),t.ontology=Object(l.g)(e.ontology),t.uuid=Object(l.g)(e.uuid),t.uuidIndex=parseInt(Object(l.g)(e.uuidIndex)),t.stepNo=parseInt(Object(l.g)(e.stepNo)),n.push(t)}),this.setState({selectedSteps:n}),[2]})})}).catch(function(e){return e})];case 1:return r.sent(),[2]}})})},t.prototype.toggleAddingSweep=function(){window.toggleStartStopAddingSweep()},t.prototype.toggleTourStartStop=function(){window.toggleTourSelectedSweep()},t.prototype.toggleTourSweepsStartStop=function(e){window.toggleTourSweepsSelectedSweep(e)},t.prototype.addCurrentSweep=function(){window.addCurrentSweep()},t.prototype.removeSweep=function(e,t){window.removeSweep(e)},t.prototype.setDialogState=function(e,t,n,o,l,i,r,s,a){null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&(this.setState({selectedSteps:n}),this.props.onSaveSteps(n)),null!=o&&this.setState({modelDetails:o}),null!=l&&this.setState({currentSweep:l}),null!=i&&this.setState({logMessage:i}),null!=s&&this.setState({prevSweepIndex:s}),null!=a&&(this.setState({sdk:a}),this.initFrame(a,this.setDialogState,this.state)),null!=r&&this.setState({sdkReady:r})},t.prototype.loadSDK=function(e,t){var o=n(870),l=o.APIKey,i=o.Version,r=document.getElementById("showcase");window.MP_SDK.connect(r,l,i).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.initFrame=function(e,t,n){var o=!1,l=n.modelDetails,i=n.currentSweep,s=n.isStarted,a=n.isTourSelected,u=n.selectedSteps,c=n.sdkReady,d=n.startSweep,p=n.hasStartSweep,f=n.isViewForm,h=n.prevSweepIndex;function m(n,o){s?(console.log("Tour Stopped"),t(null,null,null,null,null,"Tour Stopped")):(o.length>0&&o.length>n?(a=!0,e.Sweep.moveTo(o[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var l="Move to Step No : "+(n+=1);console.log(l),t(null,null,null,null,null,l),document.getElementById("chkStep_"+n).checked=!0,m(n,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(a=!1,console.log("Tour Ended"),t(null,null,null,null,null,"Tour Ended")),t(null,a))}c||e.App.state.subscribe(function(n){n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase===e.App.Phase.PLAYING&&(console.log("The app is ready to take user input now!"),c=!0,t(null,null,null,null,null,null,!0),p&&window.goToSweep(d.uuid))}),e.Model.getData().then(function(e){console.log("Model data loaded for sid:",e.sid),t(null,null,null,l=e)}),window.toggleStartStopAddingSweep=function(){t(s=!s),s&&window.addCurrentSweep()},window.toggleTourSelectedSweep=function(){if(t(null,a=!0),a){console.log("Tour Started"),t(null,null,null,null,null,"Tour Started");for(var e=u.sort(function(e,t){return e.stepNo-t.stepNo}),n=1;n<=e.length;n++){document.getElementById("chkStep_"+n).checked=!1}m(0,e)}else console.log("Tour Stopped"),t(null,a),t(null,null,null,null,null,"Tour Stopped")},window.toggleTourSweepsSelectedSweep=function(e){for(var n=0;n<e.length;n++){document.getElementById("chkStep_"+n).checked=!1}(t(null,a=!0),a)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),m(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,a),t(null,null,null,null,null,"Tour Stopped"))},window.addCurrentSweep=function(){e.Camera.getPose().then(function(e){var n=l.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,i=n);var o=l.sweeps.indexOf(n);if(!function(e){if(u.length>0){var n=u.find(function(t){return t.uuid==e});if(null!=n||""+n!="undefined"){var o="Step No : "+(n.stepNo+1)+" is already added in the current list";return console.log(o),t(null,null,null,null,null,o),!0}}return!1}(i.uuid)){u.push({uuid:i.uuid,uuidIndex:o,stepNo:u.length}),t(null,null,u);var r="Step No "+u.length+" Added";console.log(r),t(null,null,null,null,null,r)}})},window.removeSweep=function(e){var n=u.find(function(t){return t.uuid==e}),o=u.indexOf(n);if(o>-1){u.splice(o,1),t(null,null,u);var l="Step No : "+(o+1)+" Removed";console.log(l),Object(r.b)(l),t(null,null,null,null,null,l)}},window.goToSweep=function(n){var o=u.find(function(e){return e.uuid==n});e.Sweep.moveTo(n,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+(o.stepNo+1);console.log(n),t(null,null,null,null,null,n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},e.on(e.Sweep.Event.ENTER,function(){if(a)return!1;e.Camera.getPose().then(function(e){if("mode.inside"==e.mode||"mode.outside"==e.mode)if(f&&u.length>0){var n=u.find(function(t){return t.uuid==e.sweep});if(null!=n&&""+n!="undefined"){var l="Moved to sweep "+n.uuid;console.log(l),t(null,null,null,null,null,l),h=u.indexOf(n),t(null,null,null,null,null,null,null,h)}else{l="Not allowed in the current step ";if(console.log(l),t(null,null,null,null,null,l),o)return setTimeout(function(){o=!1},1500),o=!1,!1;o=!0,window.goToSweep(u[h].uuid)}}else console.log("Current Sweep is: "+JSON.stringify(e.sweep)),s&&window.addCurrentSweep()})})},t.prototype.render=function(){var e=this,t=this.props.isViewForm,n=this.state,l=n.isStarted,i=n.selectedSteps,r=n.isTourSelected,s=n.logMessage,a=n.sdkReady,u=this.state.linkBimism;u&&!u.includes("&utm_source=sdkdebug&play=1&tourcta=0")&&(u+="&utm_source=sdkdebug&play=1&tourcta=0");var c=0,d=!1,p=!1;return a?(d=r,p=l):(d=!0,p=!0),o.createElement("div",{className:"card dataCard padding-10 no-margin"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-xs-12"},o.createElement("iframe",{id:"showcase",src:u,onLoad:function(){e.loadSDK(e.setDialogState,e.state)},width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0}))),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-7 col-xs-12"},o.createElement("button",{type:"button",id:"btnStartStop",disabled:d,title:1==l?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:this.toggleAddingSweep},o.createElement("i",{className:1==l?"fa fa-stop":"fa fa-plus"})),o.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:d&&p,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:this.addCurrentSweep},o.createElement("i",{className:"fa fa-thumb-tack"})),o.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:p,title:1==l?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:this.toggleTourStartStop},o.createElement("i",{className:1==r?"fa fa-stop":"fa fa-play"})),o.createElement("br",null),o.createElement("br",null),!t&&o.createElement("span",{className:"small-font-list"},s)),o.createElement("div",{className:"col-md-5 col-xs-12"},o.createElement("table",null,o.createElement("tr",null,o.createElement("th",null,"Steps"),o.createElement("th",null)),i&&i.map(function(n,l){return c+=1,o.createElement("tr",null,o.createElement("td",{className:"link",onClick:function(){a&&window.goToSweep(n.uuid)}},"Step ",c,": ",o.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:"chkStep_"+c.toString()})),o.createElement("td",null,!t&&a&&o.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(n.uuid,l)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"}))))}))))))},t}(o.Component);t.a=c},3244:function(e,t,n){"use strict";var o=n(2),l=(n.n(o),n(3245)),i=n(754),r=n(11),s=n(122),a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(l,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function s(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}a((o=o.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,o,l,i,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(l=2&i[0]?o.return:i[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,i[1])).done)return l;switch(o=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(l=(l=r.trys).length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){r.label=i[1];break}if(6===i[0]&&r.label<l[1]){r.label=l[1],l=i;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(i);break}l[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,sdkReady:!1,locationModel:Object(),sdk:Object(),linkBimism:n.props.bimURL,currentSweep:Object(),modelDetails:Object(),selectedSteps:[],inBuildingRoutes:[],selectedRouteIndex:0,allSweeps:[]},n.getRoutes=n.getRoutes.bind(n),n.onRouteChange=n.onRouteChange.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.loadSDK=n.loadSDK.bind(n),n.initFrame=n.initFrame.bind(n),n}return a(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.bimURL&&this.setState({linkBimism:e.bimURL})},t.prototype.getRoutes=function(e){return u(this,void 0,void 0,function(){var t,n,o,l,s,a,d=this;return c(this,function(p){switch(p.label){case 0:return t=this.props,n=t.buildingName,o=t.space,l=[],s=[],a=[],[4,Object(i.a)(n,o).then(function(t){return u(d,void 0,void 0,function(){var n,i,u,d,p,f,h;return c(this,function(c){for(n=0;n<t.length;n++){for(i=t[n],(u=Object()).description=Object(r.g)(i.description),u.ontology=Object(r.g)(i.ontology),u.space=Object(r.g)(i.space),u.routeName=Object(r.g)(i.routeName),s=Object(r.g)(i.sweeps).split(","),a=Object(r.g)(i.stepNo).split(","),d=Object(),p=[],f=function(t){var n=s[t],l=Object();(d=e.find(function(e){return e.uuid==n}))&&(l.uuid=d.uuid,l.assignedSpace=o,l.stepNo=a[t],p.push(l))},h=0;h<s.length;h++)f(h);u.sweeps=p,l.push(u)}return this.setState({inBuildingRoutes:l}),this.props.onSaveRoutes(l),l.length>0&&this.initFrame(this.state.sdk,this.setDialogState,this.state),[2]})})}).catch(function(e){return e})];case 1:return p.sent(),[2]}})})},t.prototype.onRouteChange=function(e){this.setState({inBuildingRoutes:e}),this.props.onSaveRoutes(e),this.initFrame(this.state.sdk,this.setDialogState,this.state)},t.prototype.toggleTourSweepsStartStop=function(e,t){window.toggleTourRouteSweepsSelectedSweep(e,t)},t.prototype.toggleAddingSweep=function(e,t){this.setState({inBuildingRoutes:e,selectedRouteIndex:t}),window.toggleStartStopAddingSweepByIndex(t)},t.prototype.addCurrentSweep=function(e,t){this.setState({inBuildingRoutes:e,selectedRouteIndex:t}),window.addCurrentSweepByIndex(t)},t.prototype.setDialogState=function(e,t,n,o,l,i,r,a,d){return u(this,void 0,void 0,function(){return c(this,function(u){switch(u.label){case 0:return null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&this.setState({selectedSteps:n}),null==o?[3,2]:(this.setState({modelDetails:o}),0!=this.state.inBuildingRoutes.length?[3,2]:(Object(s.a)(!0),[4,this.getRoutes(o.sweeps)]));case 1:u.sent(),Object(s.a)(!1),u.label=2;case 2:return null!=l&&this.setState({currentSweep:l}),null!=r&&(this.setState({sdk:r}),this.initFrame(r,this.setDialogState,this.state)),null!=i&&this.setState({sdkReady:i}),null!=a&&this.setState({inBuildingRoutes:a}),null!=d&&this.setState({selectedRouteIndex:d}),[2]}})})},t.prototype.loadSDK=function(e){var t=n(870),o=t.APIKey,l=t.Version,i=document.getElementById("showcase");window.MP_SDK.connect(i,o,l).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.initFrame=function(e,t,n){var o=n.modelDetails,l=n.currentSweep,i=n.isStarted,r=n.isTourSelected,s=n.selectedSteps,a=n.sdkReady,u=n.inBuildingRoutes,c=n.selectedRouteIndex;function d(n,o,l){i?console.log("Tour Stopped"):(o.length>0&&o.length>n?(r=!0,e.Sweep.moveTo(o[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+o[n].uuidIndex;(console.log(t),l||0==l)&&(document.getElementById(l+"_chkStep_"+n).checked=!0);d(n+=1,o,l)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(r=!1,console.log("Tour Ended")),t(null,r))}a||e.App.state.subscribe(function(n){n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase===e.App.Phase.PLAYING&&(console.log("The app is ready to take user input now!"),a=!0,t(null,null,null,null,null,!0))}),e.Model.getData().then(function(e){console.log("Model data loaded for sid:",e.sid),t(null,null,null,o=e)}),window.toggleStartStopAddingSweepByIndex=function(e){c=e,t(i=!i,null,null,null,null,null,null,null,e),i&&window.addCurrentSweepByIndex(e)},window.toggleTourSelectedSweep=function(){(t(null,r=!0),r)?(console.log("Tour Started"),d(0,s.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,r))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,r=!0),r)?d(0,e.sort(function(e,t){return e.stepNo-t.stepNo})):t(null,r)},window.toggleTourRouteSweepsSelectedSweep=function(e,n){for(var o=0;o<e.length;o++){document.getElementById(n+"_chkStep_"+o).checked=!1}(t(null,r=!0),r)?d(0,e.sort(function(e,t){return e.stepNo-t.stepNo}),n):t(null,r)},window.addCurrentSweepByIndex=function(n){c=n,t(null,null,null,null,null,null,null,null,n),e.Camera.getPose().then(function(e){var i=o.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,l=i);var r=o.sweeps.indexOf(i);if(!function(e,t){if(u&&u.length>0){var n=u[t].sweeps;if(n.length>0){var o=n.find(function(t){return t.uuid==e});if(null!=o||""+o!="undefined"){var l="Sweep "+o.uuid+" of index "+o.uuidIndex+" is already added in the current list";return console.log(l),!0}}}return!1}(l.uuid,n)){var s=u[n].sweeps;s.push({uuid:l.uuid,uuidIndex:r,stepNo:s.length}),u[n].sweeps=s,t(null,null,null,null,null,null,null,u);var a="Sweep "+l.uuid+" of index "+r+" is added in the current list";console.log(a)}})},window.removeSweep=function(e){var n=s.find(function(t){return t.uuid==e}),o=s.indexOf(n);if(o>-1){s.splice(o,1),t(null,null,s);var l="Sweep "+n.uuid+" of index "+n.uuidIndex+" is removed from the current list";console.log(l)}},window.goToSweep=function(t){e.Sweep.moveTo(t,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+t;console.log(n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},e.on(e.Sweep.Event.ENTER,function(){if(r)return!1;e.Camera.getPose().then(function(e){if("mode.inside"==e.mode||"mode.outside"==e.mode)if(s.length>0){var t=s.find(function(t){return t.uuid==e.sweep});if(null!=t&&""+t!="undefined"){var n="Moved to sweep "+t.uuid;console.log(n)}else{n="Not allowed in the current step ";console.log(n)}}else console.log("Current Sweep is: "+JSON.stringify(e.sweep)),i&&window.addCurrentSweepByIndex(c)})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,i=t.space,r=this.state,s=r.inBuildingRoutes,a=r.sdkReady,u=r.isTourSelected,c=r.isStarted,d=this.state.linkBimism;d&&!d.includes("&utm_source=sdkdebug&play=1&tourcta=0")&&(d+="&utm_source=sdkdebug&play=1&tourcta=0");var p=!1,f=!1;return a?(p=u,f=c):(p=!0,f=!0),o.createElement("div",{className:"card dataCard padding-10 no-margin"},o.createElement("div",{className:"container-fluid"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12 col-xs-12"},o.createElement("iframe",{id:"showcase",src:d,onLoad:function(){e.loadSDK(e.setDialogState)},width:"100%",height:"400",frameBorder:"0",allowFullScreen:!0}))),o.createElement("br",null),o.createElement(l.a,{building:n,space:i,items:s,onItemChange:this.onRouteChange,onTour:this.toggleTourSweepsStartStop,onAddCurrentSweep:this.addCurrentSweep,onToggleAddingSweep:this.toggleAddingSweep,isStarted:f,isTourSelected:p,sdkReady:a})))},t}(o.Component);t.a=d},3245:function(e,t,n){"use strict";var o=n(2),l=(n.n(o),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={items:[],selectedRowIndex:0,isAddDisable:!1,sdkReady:!1,isStarted:!1,isTourSelected:!1,playChecked:!1},n.addItem=n.addItem.bind(n),n.handleRouteNameChange=n.handleRouteNameChange.bind(n),n.removeSweep=n.removeSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.removeItem=n.removeItem.bind(n),n.hideSweeps=n.hideSweeps.bind(n),n}return l(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.items&&this.setState({items:e.items}),e.destinationSweeps&&this.setState({destinationSweeps:e.destinationSweeps}),e.isStarted!=this.state.isStarted&&this.setState({isStarted:e.isStarted}),e.isTourSelected!=this.state.isTourSelected&&this.setState({isTourSelected:e.isTourSelected}),e.sdkReady!=this.state.sdkReady&&this.setState({sdkReady:e.sdkReady})},t.prototype.addItem=function(){var e=this.state.items;e.push({space:this.props.space,description:"",sweeps:[],hideRoutesView:!1}),this.setState({items:e,isAddDisable:!0}),this.props.onItemChange(e)},t.prototype.handleRouteNameChange=function(e,t){var n=this.state.items;n[t].routeName=e,this.setState({items:n}),this.props.onItemChange(n)},t.prototype.removeItem=function(e,t){t>-1&&(e.splice(t,1),this.setState({items:e}),this.props.onItemChange(e))},t.prototype.hideSweeps=function(e,t,n){e[t].hideRoutesView=!n,this.setState({items:e})},t.prototype.removeSweep=function(e,t,n){var o=e[t].sweeps.find(function(e){return e.uuid==n}),l=e[t].sweeps.indexOf(o);l>-1&&(e[t].sweeps.splice(l,1),this.setState({items:e}),this.props.onItemChange(e))},t.prototype.toggleAddingSweep=function(e,t){this.props.onToggleAddingSweep(e,t),this.setState({isAddDisable:!1})},t.prototype.addCurrentSweep=function(e,t){this.props.onAddCurrentSweep(e,t),this.setState({isAddDisable:!1})},t.prototype.toggleTourStartStop=function(e,t){var n=e[t].sweeps;this.props.onTour(n,t)},t.prototype.render=function(){var e=this,t=this.state,n=t.items,l=t.isAddDisable,i=t.sdkReady,r=t.isStarted,s=t.isTourSelected,a=!1,u=!1;return i?(a=s,u=r):(a=!0,u=!0),o.createElement(o.Fragment,null,o.createElement("div",{className:"container-fluid"},n&&n.length>0&&n.map(function(t,l){return o.createElement(o.Fragment,null,o.createElement("div",{key:l,className:"row matterport-margin-row"},o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("button",{type:"button",id:"btnStartStop",disabled:a,title:1==r?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:function(){e.toggleAddingSweep(n,l)}},o.createElement("i",{className:1==r?"fa fa-stop":"fa fa-plus"})),o.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:a&&u,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:function(){e.addCurrentSweep(n,l)}},o.createElement("i",{className:"fa fa-thumb-tack"})),o.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:u,title:1==r?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:function(){e.toggleTourStartStop(n,l)}},o.createElement("i",{className:1==s?"fa fa-stop":"fa fa-play"}))),o.createElement("div",{className:"col-md-3 col-xs-12"},o.createElement("div",{className:"row"},o.createElement("span",{className:"hidden visible-xs-inline headingText"},o.createElement("label",{htmlFor:"description"},"Route Name")),o.createElement("span",{className:"fullWidth"},o.createElement("input",{type:"text",className:"form-control",value:t.routeName,placeholder:"Route Name",name:"description",onChange:function(t){return e.handleRouteNameChange(t.target.value,l)}})))),o.createElement("div",{className:"col-md-4 col-xs-10"},o.createElement("table",null,o.createElement("tr",null,o.createElement("th",null,"Steps: ",t.hideRoutesView?t.sweeps.length+" Steps Added":""),o.createElement("th",null)),t.sweeps&&t.sweeps.map(function(r,s){return o.createElement("tr",{style:{display:t.hideRoutesView?"none":"block"}},o.createElement("td",{className:"link",onClick:function(){i&&window.goToSweep(r.uuid)}},"Step ",s+1,": ",o.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:l+"_chkStep_"+s.toString()})),o.createElement("td",null,i&&o.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(n,l,r.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"}))))}))),o.createElement("div",{className:"col-md-1 col-xs-1"},o.createElement("button",{type:"button",title:"Hide Route Sweeps",onClick:function(){e.hideSweeps(n,l,t.hideRoutesView)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-minus"}))),o.createElement("div",{className:"col-md-1 col-xs-1"},o.createElement("button",{type:"button",title:"Remove Item",onClick:function(){e.removeItem(n,l)},className:"btn btn-light matterport-dialog-btn-no-border"},o.createElement("i",{className:"fa fa-times"})))),o.createElement("hr",null))})),o.createElement("br",null),o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("button",{disabled:l,type:"button",className:"btn btn-dark btn-fill btn-sm",onClick:this.addItem},o.createElement("i",{className:"fa fa-plus"}),n.length>0?"More":"Add"))))},t}(o.Component);t.a=i}});