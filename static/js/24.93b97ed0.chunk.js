webpackJsonp([24,67,68,72],{1005:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(3),r=(n.n(l),n(698)),i=n(605),c=n(590),s=n(17),o=n(18),u=n(573),m=n(44),d=n(666),p=n(87),h=n(579),f=n(595),b=n(568),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),y=this&&this.__assign||function(){return(y=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},v=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function c(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,c)}s((a=a.apply(e,t||[])).next())})},O=this&&this.__generator||function(e,t){var n,a,l,r,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){i.label=r[1];break}if(6===r[0]&&i.label<l[1]){i.label=l[1],l=r;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(r);break}l[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}},E=0,C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={InsightInfo:Object(),Old_InsightInfo:Object(),InsightChanged:!1,Moncon:{monitoringControl:"",monitoringControlDeviceType:"",deviceName:"",floor:"",rdfsLabel:"",relatedEquipment:[],manufacturer:"",model:"",location:"",connectionType:"",notes:"",wirelessConfig:{ipAddress:"",controllerIPAddress:"",thermostatMacAddress:"",ssid:"",password:""},isSchedule:!1,deviceNumber:"",enclosure:""},space:{graphURL:"",rdfsLabel:"",spaceName:"",spaceInsights:[],detailsExpanded:!1},EquipmentList:[],currentChange:"",detailsExpanded:!1,localBTNState:!1,filteredInsight:[],buildingOptimalTStat:[],spaceOptimalTStat:[],spaces:[],spacesOptimalInfo:[],avgBuildingOptimalTStat:Object(),buildingInsightInfos:[],spaceInsightInfos:[],avgSpaceOptimalTStat:Object(),buildingOptimal:!1,spaceOptimal:!1,scheduleSelected:!1,callInterval:!0,controlStatus:"Manual"},n.changeMode=n.changeMode.bind(n),n.changeOverrideState=n.changeOverrideState.bind(n),n.changeFanSetting=n.changeFanSetting.bind(n),n.increaseTemp=n.increaseTemp.bind(n),n.decreaseTemp=n.decreaseTemp.bind(n),n._fetchData=n._fetchData.bind(n),n._fetchInsightInfo=n._fetchInsightInfo.bind(n),n.changeStateLocal=n.changeStateLocal.bind(n),n.cancelSend=n.cancelSend.bind(n),n.resetChanges=n.resetChanges.bind(n),n.applyChanges=n.applyChanges.bind(n),n.handleOptimize=n.handleOptimize.bind(n),n._fetchInsights=n._fetchInsights.bind(n),n._fetchSelectedTStatData=n._fetchSelectedTStatData.bind(n),n.handleOptimalSelection=n.handleOptimalSelection.bind(n),n.handleScheduleSelection=n.handleScheduleSelection.bind(n),n.getRelatedEquipmentLabel=n.getRelatedEquipmentLabel.bind(n),n.setIntervalStart=n.setIntervalStart.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return v(this,void 0,void 0,function(){return O(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchData()]:[3,4];case 1:return e.sent(),[4,this._fetchInsights()];case 2:return e.sent(),[4,this.fetchThermostatInfo()];case 3:e.sent(),this._fetchInsightInfo(!1),e.label=4;case 4:return this.setIntervalStart(),[2]}})})},t.prototype.setIntervalStart=function(){var e=this;a&&clearInterval(a),setInterval(function(){E++},1e3),a=setInterval(function(){var t=e.state,n=t.callInterval;!t.InsightChanged&&n&&E>=15&&(e._fetchInsightInfo(!1),Object(p.a)(!1))},15e3)},t.prototype.componentWillUnmount=function(){return v(this,void 0,void 0,function(){return O(this,function(e){return clearInterval(a),[2]})})},t.prototype.handleScheduleSelection=function(e){return v(this,void 0,void 0,function(){return O(this,function(t){switch(t.label){case 0:return[4,Object(i.O)(this.props.InsightName,e)];case 1:return t.sent(),e?Object(m.b)("Successfully Selected Schedule"):Object(m.b)("Successfully unSelected Schedule"),this.setState({scheduleSelected:e}),this._fetchData(),[2]}})})},t.prototype.handleOptimalSelection=function(e,t){var n=this.state,a=n.buildingOptimal,l=n.spaceOptimal;"spaceOptimal"==e?l=t:a=t,this.setState({spaceOptimal:l,buildingOptimal:a}),this.handleOptimize()},t.prototype.handleOptimize=function(){return v(this,void 0,void 0,function(){var e,t,n,a;return O(this,function(l){return e=this.state,t=e.avgBuildingOptimalTStat,n=e.avgSpaceOptimalTStat,a=e.spaceOptimal,e.buildingOptimal&&!a?this.setState({InsightInfo:t,InsightChanged:!0,currentChange:"Avg",controlStatus:"Optimize"}):this.setState({InsightInfo:n,InsightChanged:!0,currentChange:"Avg",controlStatus:"Optimize"}),[2]})})},t.prototype._fetchSelectedTStatData=function(){return v(this,void 0,void 0,function(){var e,t,n,a,l,r,o,u,d,p,h,f,b,g,y,v,E,C,S;return O(this,function(O){switch(O.label){case 0:e=this.state,t=e.buildingOptimalTStat,n=e.buildingInsightInfos,a=e.spaceInsightInfos,l=e.spaceOptimalTStat,r=e.buildingOptimal,o=e.spaceOptimal,p=0,O.label=1;case 1:return p<t.length?(u=t[p],(y=Object(s.g)(u.moncondevice))?[4,Object(c.j)(y,this.props.buildingName)]:[3,4]):[3,5];case 2:return v=O.sent(),[4,Object(i.q)(v).then(function(e){return!e||e&&e.error?(Object(m.a)("Error occurred while fetching thermostat info."),Object()):e}).catch(function(e){return Object()})];case 3:d=O.sent(),n.push(d),O.label=4;case 4:return p++,[3,1];case 5:p=0,O.label=6;case 6:if(!(p<l.length))return[3,12];if(h=l[p],!((f=h.spaceInsights)&&f.length>0))return[3,11];b=0,O.label=7;case 7:return b<f.length?(g=f[b],(y=Object(s.g)(g.moncondevice))?[4,Object(c.j)(y,this.props.buildingName)]:[3,10]):[3,11];case 8:return v=O.sent(),[4,Object(i.q)(v).then(function(e){return!e||e&&e.error?(Object(m.a)("Error occurred while fetching thermostat info."),Object()):e}).catch(function(e){return Object()})];case 9:E=O.sent(),a.push(E),O.label=10;case 10:return b++,[3,7];case 11:return p++,[3,6];case 12:return r=n.length>0,o=a.length>0,[4,Object(i.A)(n)];case 13:return C=O.sent(),[4,Object(i.A)(a)];case 14:return S=O.sent(),this.setState({avgBuildingOptimalTStat:C,avgSpaceOptimalTStat:S,buildingInsightInfos:n,spaceInsightInfos:a,buildingOptimal:r,spaceOptimal:o}),[2]}})})},t.prototype._fetchInsights=function(){return v(this,void 0,void 0,function(){var e,t,n,a,l,r,c,u,m,d,p,b,g,y,v;return O(this,function(E){switch(E.label){case 0:return(e=this.props.buildingName)?[4,Object(i.s)(e)]:[3,7];case 1:for(t=E.sent(),v=0;v<t.length;v++)n=t[v],Object(s.g)(n.moncondevice)&&Object(s.g)(n.rdfsLabel)&&Object(o.v)(Object(s.g)(n.moncondevice),Object(s.g)(n.rdfsLabel));for(a=this.state,l=a.spaces,r=a.spacesOptimalInfo,c=a.spaceOptimalTStat,u=a.buildingOptimalTStat,l=[],m=function(e){var n=t[e],a=Object(s.g)(n.space),r=Object(s.g)(n.spaceRdfsLabel);a&&r&&-1==l.findIndex(function(e){return e.ontology==a})&&l.push({ontology:a,rdfsLabel:r})},v=0;v<t.length;v++)m(v);r=[],c=[],u=[],d=function(e){var n,a,i,o,u,m,d;return O(this,function(p){switch(p.label){case 0:return n=l[e],[4,Object(h.e)(n.ontology)];case 1:return a=p.sent(),i=t.filter(function(e){return Object(s.g)(e.space)==n.ontology}),o={graphURL:a.graphURL?a.graphURL:"",rdfsLabel:n.rdfsLabel,spaceName:n.ontology,spaceInsights:i},r.push.apply(r,[o]),u=t.find(function(e){return Object(s.g)(e.space)==n.ontology}),m=[],u&&(m=Object(s.g)(u.spaceOptimalTStats).split(",")),d={graphURL:a.graphURL?a.graphURL:"",rdfsLabel:n.rdfsLabel,spaceName:n.ontology,spaceInsights:t.filter(function(e){return-1!=m.findIndex(function(t){return t==Object(s.g)(e.moncondevice)})})},c.push.apply(c,[d]),[2]}})},p=0,E.label=2;case 2:return p<l.length?[5,d(p)]:[3,5];case 3:E.sent(),E.label=4;case 4:return p++,[3,2];case 5:return[4,Object(f.c)(this.props.buildingName)];case 6:if((b=E.sent())&&b[0])for(g=b[0],g=(g=Object(s.g)(g.buildingOptimal)).split(","),y=function(e){var n=g[e],a=t&&t.length>0&&t[0]&&t.find(function(e){return Object(s.g)(e.moncondevice)==n});a&&u.push.apply(u,[a])},v=0;v<g.length;v++)y(v);this.setState({spaces:l,spacesOptimalInfo:r,spaceOptimalTStat:c,buildingOptimalTStat:u}),E.label=7;case 7:return[2]}})})},t.prototype._fetchData=function(){return v(this,void 0,void 0,function(){var e,t,n,a,l,r,i,o,m,d,f=this;return O(this,function(b){switch(b.label){case 0:return e=this.state.scheduleSelected,t=this.props,n=t.InsightName,a=t.buildingName,l=t.type,n?(Object(p.a)(!0),[4,Object(u.h)(this.props.buildingName)]):[3,6];case 1:return r=b.sent(),i=r&&r.length>0&&r.map(function(e){return{value:Object(s.g)(e.ontology),label:Object(s.g)(e.rdfsLabel)}}),o=Object(),m=Object(),"Optimal"!=l?[3,3]:[4,Object(h.e)(n)];case 2:return m=b.sent(),[3,5];case 3:return[4,Object(c.j)(n,a)];case 4:o=b.sent(),b.label=5;case 5:localStorage.getItem(o.deviceID)&&localStorage.getItem(o.deviceID).length>0&&(d=JSON.parse(localStorage.getItem(o.deviceID)),this.setState({InsightInfo:d,Old_InsightInfo:y({},d),InsightChanged:!1,currentChange:""})),e=o.isSchedule,this.setState({Moncon:o,space:m,EquipmentList:i,scheduleSelected:e},function(){return v(f,void 0,void 0,function(){return O(this,function(e){return[2]})})}),Object(p.a)(!1),b.label=6;case 6:return[2]}})})},t.prototype.fetchThermostatInfo=function(){return v(this,void 0,void 0,function(){var e,t,n,a,l,r,c;return O(this,function(s){switch(s.label){case 0:return Object(p.a)(!0),e=this.props,t=e.InsightName,n=e.buildingName,a=this.state,l=a.Moncon,r=a.controlStatus,this.setState({callInterval:!1}),[4,Object(i.y)(n,t).then(function(e){return!e||e&&e.error?(Object(m.a)("Error occurred while fetching thermostat info."),Object()):(e&&localStorage.setItem(l.deviceID,JSON.stringify(e)),e)}).catch(function(e){return Object()})];case 1:return c=s.sent(),this.setState({InsightInfo:c,Old_InsightInfo:y({},c),InsightChanged:!1,currentChange:"",callInterval:!0,controlStatus:c.thermostatControlStatus?c.thermostatControlStatus:r}),Object(p.a)(!1),[2]}})})},t.prototype._fetchInsightInfo=function(e){return v(this,void 0,void 0,function(){var t,n,a,l;return O(this,function(r){switch(r.label){case 0:return e&&Object(p.a)(!0),t=this.state,n=t.Moncon,a=t.controlStatus,this.setState({callInterval:!1}),[4,Object(i.q)(n).then(function(e){return!e||e&&e.error?(Object(m.a)("Error occurred while fetching thermostat info."),Object()):(e&&localStorage.setItem(n.deviceID,JSON.stringify(e)),e)}).catch(function(e){return Object()})];case 1:return(l=r.sent())?(l.thermostatControlStatus=a,l.insightName=this.props.InsightName,[4,Object(i.P)(this.props.buildingName,l)]):[3,3];case 2:r.sent(),this.setState({InsightInfo:l,Old_InsightInfo:y({},l),InsightChanged:!1,currentChange:"",callInterval:!0}),r.label=3;case 3:return e&&Object(p.a)(!1),[2]}})})},t.prototype.changeMode=function(e,t){e.mode=t,this.setState({InsightInfo:e,InsightChanged:!0,currentChange:"mode"})},t.prototype.changeOverrideState=function(e,t,n){"Local"==this.state.controlStatus&&"Remote"==n?(n="Manual",e.override=t,this.setState({InsightInfo:e,InsightChanged:!0,currentChange:"state",controlStatus:n,localBTNState:!1})):"Manual"==n&&(e.override=t,this.setState({InsightInfo:e,InsightChanged:!0,currentChange:"state",controlStatus:n,localBTNState:!1}))},t.prototype.changeFanSetting=function(e,t){e.fan=t,this.setState({InsightInfo:e,InsightChanged:!0,currentChange:"fan"})},t.prototype.increaseTemp=function(e,t){"Heat"==t?e.heattemp=(e.heattemp?e.heattemp:0)+.555556:e.cooltemp=(e.cooltemp?e.cooltemp:0)+.555556,this.setState({InsightInfo:e,InsightChanged:!0,currentChange:"temp"})},t.prototype.decreaseTemp=function(e,t){"Heat"==t?e.heattemp=e.heattemp-.555556:e.cooltemp=e.cooltemp-.555556,this.setState({InsightInfo:e,InsightChanged:!0,currentChange:"temp"})},t.prototype.cancelSend=function(){this.setState({InsightChanged:!1,currentChange:""}),this._fetchInsightInfo(!1)},t.prototype.resetChanges=function(e){return v(this,void 0,void 0,function(){var t=this;return O(this,function(n){return this.setState({InsightChanged:!1,currentChange:""},function(){return v(t,void 0,void 0,function(){return O(this,function(t){switch(t.label){case 0:return[4,this._fetchInsightInfo(e)];case 1:return t.sent(),[2]}})})}),[2]})})},t.prototype.applyChanges=function(e,t){return v(this,void 0,void 0,function(){var n=this;return O(this,function(l){return Object(p.a)(!0),this.setState({InsightChanged:!1,currentChange:""},function(){return v(n,void 0,void 0,function(){var n;return O(this,function(l){switch(l.label){case 0:return E=0,a&&clearInterval(a),"Local"!=(n=this.state.controlStatus)?[3,2]:[4,Object(i.O)(this.props.InsightName,!1)];case 1:return l.sent(),[3,10];case 2:return"Manual"!=n?[3,4]:[4,Object(i.O)(this.props.InsightName,!1)];case 3:return l.sent(),[3,10];case 4:return"Remote"!=n?[3,6]:[4,Object(i.O)(this.props.InsightName,!1)];case 5:return l.sent(),[3,10];case 6:return"Schedule"!=n?[3,8]:[4,Object(i.O)(this.props.InsightName,!0)];case 7:return l.sent(),[3,10];case 8:return"Optimize"!=n?[3,10]:[4,Object(i.O)(this.props.InsightName,!1)];case 9:l.sent(),l.label=10;case 10:return t.thermostatControlStatus=n,t.insightName=this.props.InsightName,[4,Object(i.P)(this.props.buildingName,t)];case 11:return l.sent(),Object(i.F)(e,t,this.state.Old_InsightInfo).then(function(e){e.success?Object(m.b)("Changes applied successfully. "):e.error&&Object(m.a)(e.reason)}).catch(function(e){Object(m.a)("Some error orccured. ")}),this.setIntervalStart(),Object(p.a)(!1),[2]}})})}),[2]})})},t.prototype.changeStateLocal=function(e){this.setState({localBTNState:e,controlStatus:"Local",InsightChanged:!0,currentChange:"state"})},t.prototype.getRelatedEquipmentLabel=function(e){var t=this.state.EquipmentList,n=Object();return(n=t&&t.find(function(t){return t.value==e}))&&n.label},t.prototype.render=function(){var e=this,t=this.state,n=t.InsightInfo,a=t.Moncon,i=t.space,c=t.InsightChanged,s=t.detailsExpanded,u=t.buildingOptimal,m=t.spaceOptimal,p=t.controlStatus,h=this.props,f=h.instance,g=h.buildingName,y=h.InsightName,v=h.type,O=h.hideTabs,E="Optimal"==v,C="Local"==p,S=n.mode==r.c.AUTO&&n.cooltemp<n.heattemp+.5;return l.createElement("div",{className:"content"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},!O&&l.createElement(d.a,{InsightName:y,ControlName:"InsightControl",buildingName:g,instance:f,type:v}),l.createElement("div",{className:"card",id:"InsightsList"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"header"},l.createElement("h3",{className:"title"},l.createElement("strong",null,E?i.rdfsLabel:a.rdfsLabel)," "),!E&&l.createElement("h4",{className:"title"},l.createElement("strong",null,this.props.type.toUpperCase(),":",a&&a.relatedEquipment.map(function(t,n){return l.createElement("span",{key:n},e.getRelatedEquipmentLabel(t.value),n+1==a.relatedEquipment.length?"":",")}),"STATUS:")," (",r.d[n.state],")"))),l.createElement("div",{className:"content"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6 col-xs-12 tempCounter roomTemp pull-right"},l.createElement("div",null,"Room Temp"),l.createElement("div",{className:"counter"},Object(o.a)(n.spacetemp).toFixed(2),"\xb0F")),l.createElement("div",{className:"col-md-6 col-xs-12"},l.createElement("div",{className:"row"},(n.mode==r.c.HEAT||n.mode==r.c.AUTO)&&l.createElement(l.Fragment,null,l.createElement("div",{className:(n.mode==r.c.AUTO?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" tempCounter"},l.createElement("div",null,"Heat To"),l.createElement("div",{className:"counter"},Object(o.a)(n.heattemp).toFixed(2),"\xb0F")),l.createElement("div",{className:(n.mode==r.c.AUTO?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" InsightControls"},l.createElement("div",{className:"btn-group-vertical"},l.createElement("button",{type:"button",className:"btn tempButton heatTo",disabled:C||S,onClick:function(){return e.increaseTemp(n,"Heat")}},l.createElement("div",null,l.createElement("i",{className:"fa fa-angle-up"})),l.createElement("div",null,"Warmer")),l.createElement("button",{type:"button",className:"btn tempButton coolTo",disabled:C,onClick:function(){return e.decreaseTemp(n,"Heat")}},l.createElement("div",null,"Cooler"),l.createElement("div",null,l.createElement("i",{className:"fa fa-angle-down"})))))),(n.mode==r.c.COOL||n.mode==r.c.AUTO)&&l.createElement(l.Fragment,null,l.createElement("div",{className:(n.mode==r.c.AUTO?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" tempCounter"},l.createElement("div",null,"Cool To"),l.createElement("div",{className:"counter"},Object(o.a)(n.cooltemp).toFixed(2),"\xb0F")),l.createElement("div",{className:(n.mode==r.c.AUTO?"col-md-3 col-xs-6":"col-md-6 col-xs-12")+" InsightControls"},l.createElement("div",{className:"btn-group-vertical"},l.createElement("button",{type:"button",className:"btn tempButton heatTo",disabled:C,onClick:function(){return e.increaseTemp(n,"Cool")}},l.createElement("div",null,l.createElement("i",{className:"fa fa-angle-up"})),l.createElement("div",null,"Warmer")),l.createElement("button",{type:"button",className:"btn tempButton coolTo",disabled:C||S,onClick:function(){return e.decreaseTemp(n,"Cool")}},l.createElement("div",null,"Cooler"),l.createElement("div",null,l.createElement("i",{className:"fa fa-angle-down"}))))))))),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6 col-xs-12 InsightRow pull-right"},l.createElement("div",{className:"btn-group"},!E&&l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:"btn btn-success "+("Local"==p?"btn-fill":""),onClick:function(){e.changeStateLocal(!0)}},"Local"),l.createElement("button",{type:"button",className:"btn btn-success "+("Remote"==p||"Schedule"==p||"Manual"==p||"Optimize"==p?"btn-fill":""),onClick:function(){return e.changeOverrideState(n,r.e.ON,"Remote")}},"Remote"),l.createElement("button",{type:"button",disabled:C,className:"btn btn-success "+("Manual"==p?"btn-fill":""),onClick:function(){return e.changeOverrideState(n,r.e.OFF,"Manual")}},"Manual")),l.createElement("button",{type:"button",className:"btn btn-success "+("Schedule"==p?"btn-fill":""),disabled:C,onClick:function(){e.setState({InsightChanged:!0,currentChange:"state",controlStatus:"Schedule"})}},"Schedule"),l.createElement("button",{type:"button",disabled:C,className:"btn btn-success "+("Optimize"==p?"btn-fill":""),onClick:function(){u&&m?document.getElementById("btnOptimize").click():e.handleOptimize()}},"Optimize"))),l.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",disabled:C,className:n.mode===r.c.OFF?"btn btn-fill":"btn",onClick:function(){return e.changeMode(n,r.c.OFF)}},"Off"),l.createElement("button",{type:"button",className:n.mode===r.c.HEAT?"btn btn-fill":"btn",disabled:C,onClick:function(){return e.changeMode(n,r.c.HEAT)}},"Heat"),l.createElement("button",{type:"button",className:n.mode===r.c.COOL?"btn btn-fill":"btn",disabled:C,onClick:function(){return e.changeMode(n,r.c.COOL)}},"Cool"),l.createElement("button",{type:"button",className:n.mode===r.c.AUTO?"btn btn-fill":"btn",disabled:C,onClick:function(){return e.changeMode(n,r.c.AUTO)}},"Auto")))),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},l.createElement("div",{className:"InsightHeading"},l.createElement("i",{className:"fa fa-first-order"})," Fan"),l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n.fan===r.b.AUTO?"btn btn-fill":"btn",disabled:C,onClick:function(){return e.changeFanSetting(n,r.b.AUTO)}},"Auto"),l.createElement("button",{type:"button",className:n.fan===r.b.ON?"btn btn-fill":"btn",disabled:C,onClick:function(){return e.changeFanSetting(n,r.b.ON)}},"On")))),!E&&l.createElement("div",{className:"accordion row padding-10",id:"accordionExample",style:{paddingLeft:"30px",border:"1px solid #80808066",margin:"10px",borderRadius:"7px"}},l.createElement("div",{className:"",id:"headingOne"},l.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne",style:{border:0,left:"-25px",position:"relative"},"aria-expanded":"true","aria-controls":"collapseOne",onClick:function(){e.setState({detailsExpanded:!s})}},l.createElement("i",{className:s?"fa fa-minus":"fa fa-plus","aria-hidden":"true"}))),l.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},l.createElement("div",{className:"col-md-6 col-xs-12 padding-10"},l.createElement("h5",{className:"title"},l.createElement("strong",null,"IP Address:")," ",a.wirelessConfig&&a.wirelessConfig.ipAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Controller IP Address:")," ",a.wirelessConfig.controllerIPAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Manufacturer:")," ",a.manufacturer),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Model:")," ",a.model),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Device ID:")," ",a.deviceID?a.deviceID:"")))),l.createElement("div",{className:c?"InsightApplyChanges":"hidden"},!S&&l.createElement("h4",null,"Do you want to apply these changes?"),S&&l.createElement("h4",null," Both heating and cooling could be on at the same time with these setpoints, please modify your request"),!S&&l.createElement("div",null,l.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){return e.cancelSend()}},"Cancel"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-danger",onClick:function(){return e.resetChanges(!0)}},"Reset"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){return e.applyChanges(a,n)}},"Apply Changes"))))),l.createElement("button",{id:"btnOptimize",style:{display:"none"},"data-toggle":"modal","data-target":"#showOptimizeDialog"},"."),l.createElement(b.a,{id:"showOptimizeDialog",cancelButtonId:"cancelOptimizeDialog",onSaveButtonClick:function(){e.handleOptimize()},saveButtonText:"Yes",showCancelButton:!0,showSaveButton:!1,cancelButtonText:"Cancel",heading:"Select One"},l.createElement("div",{className:"card padding-10"},l.createElement("div",{className:"row text-center col-md-offset-1"},u&&l.createElement("div",{onClick:function(){e.handleOptimalSelection("buildingOptimal",!0),e.setState({spaceOptimal:!1},function(){document.getElementById("cancelOptimizeDialog").click()})},className:"col-md-5 padding-10 margin-5 text-center btn btn-lg btn-secondary",style:{cursor:"pointer"}},l.createElement("label",{className:"text-center title"}," Building Optimal ")),m&&l.createElement("div",{onClick:function(){e.handleOptimalSelection("spaceOptimal",!0),e.setState({buildingOptimal:!1},function(){document.getElementById("cancelOptimizeDialog").click()})},className:"col-md-5 padding-10 margin-5 text-center btn btn-lg btn-secondary",style:{cursor:"pointer"}},l.createElement("label",{className:"text-center title"}," Space Optimal ")))))))))},t}(l.Component);t.default=C},1022:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(3),r=(n.n(l),n(605)),i=n(590),c=n(17),s=n(44),o=n(666),u=n(87),m=n(573),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__assign||function(){return(p=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},h=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function c(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,c)}s((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,r,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){i.label=r[1];break}if(6===r[0]&&i.label<l[1]){i.label=l[1],l=r;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(r);break}l[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}},b=0,g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={CeilingSensorBoardInfo:Object(),Old_RelayBoardInfo:Object(),RelayBoardInfo:Object(),I1RelayBoardInfo:Object(),modelChanged:!1,Moncon:{monitoringControl:"",monitoringControlDeviceType:"",deviceName:"",floor:"",rdfsLabel:"",manufacturer:"",model:"",location:"",computingDevice:"",networkDevice:"",connectionType:"",notes:"",wirelessConfig:{ipAddress:"",controllerIPAddress:"",thermostatMacAddress:"",ssid:"",password:""},isSchedule:!1,relatedEquipment:[],deviceNumber:"",enclosure:""},EquipmentList:[],currentChange:"",detailsExpanded:!1,spaces:[],relayControlStatusDesc:"",scheduleSelected:!1,relayisOn:!1,relayisOnNo:0,relayCensorStatus:Object(),relay1Status:!1,relay2Status:!1,relay3Status:!1,relay4Status:!1,I1RelayStatus:!1,relayControlStatus:"Manual",relayControlType:"",isOptimizeControl:!1,isOptimizeControlStatus:"",RelayBoardControl:Object(),relayOptimizeSettings:"",I4RelayBoardInfo:Object(),relayNoOptimize:0,devices:[],callInterval:!0},n,n.fetchDevices=n.fetchDevices.bind(n),n._fetchData=n._fetchData.bind(n),n._fetchCeilingSensorBoardInfo=n._fetchCeilingSensorBoardInfo.bind(n),n._fetchRelayCensorStatus=n._fetchRelayCensorStatus.bind(n),n._fetchV4RelayBoardInfo=n._fetchV4RelayBoardInfo.bind(n),n._fetchI1RelayBoardInfo=n._fetchI1RelayBoardInfo.bind(n),n._fetchI4RelayBoardInfo=n._fetchI4RelayBoardInfo.bind(n),n.fetchRelayControlSettings=n.fetchRelayControlSettings.bind(n),n.saveRelayStatusChanges=n.saveRelayStatusChanges.bind(n),n.setOptimizeSettings=n.setOptimizeSettings.bind(n),n.cancelSend=n.cancelSend.bind(n),n.resetChanges=n.resetChanges.bind(n),n.applyChanges=n.applyChanges.bind(n),n.handleChange=n.handleChange.bind(n),n.handleRelayOnOff=n.handleRelayOnOff.bind(n),n.handleRelayControlStatus=n.handleRelayControlStatus.bind(n),n.handleScheduleSelection=n.handleScheduleSelection.bind(n),n.setIntervalStart=n.setIntervalStart.bind(n),n.applyRule=n.applyRule.bind(n),n}return d(t,e),t.prototype.componentDidMount=function(){return h(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchData()]:[3,4];case 1:return e.sent(),[4,this.fetchDevices()];case 2:return e.sent(),[4,this.resetChanges(!0)];case 3:e.sent(),e.label=4;case 4:return this.setIntervalStart(),[2]}})})},t.prototype.setIntervalStart=function(){var e=this;a&&clearInterval(a),setInterval(function(){b++},1e3),a=setInterval(function(){var t=e.state,n=t.callInterval;!t.modelChanged&&n&&b>=15&&(e.resetChanges(!1),Object(u.a)(!1))},5e3)},t.prototype.componentWillUnmount=function(){return h(this,void 0,void 0,function(){return f(this,function(e){return clearInterval(a),[2]})})},t.prototype.fetchDevices=function(){return h(this,void 0,void 0,function(){var e,t;return f(this,function(n){switch(n.label){case 0:return(e=this.props.buildingName)?[4,Object(r.s)(e)]:[3,2];case 1:t=n.sent(),this.setState({devices:t}),n.label=2;case 2:return[2]}})})},t.prototype._fetchData=function(){return h(this,void 0,void 0,function(){var e,t,n,a,l,r,s,o,d,p,b,g,y,v=this;return f(this,function(O){switch(O.label){case 0:return e=this.state,t=e.scheduleSelected,n=e.relayControlType,a=this.props,l=a.RelayDeviceName,r=a.buildingName,l?(Object(u.a)(!0),[4,Object(m.h)(this.props.buildingName)]):[3,3];case 1:return s=O.sent(),o=s&&s.length>0&&s.map(function(e){return{value:Object(c.g)(e.ontology),label:Object(c.g)(e.rdfsLabel)}}),d=Object(),[4,Object(i.j)(l,r)];case 2:d=O.sent(),t=d.isSchedule,n=d.monitoringControlDeviceType,localStorage.getItem(d.deviceID)&&localStorage.getItem(d.deviceID).length>0&&(p=localStorage.getItem(d.deviceID))&&"undefined"!=p&&(-1!=n.indexOf("OneRelay")?(b=JSON.parse(localStorage.getItem(d.deviceID)),this.setState({I1RelayBoardInfo:b,modelChanged:!1,currentChange:""})):-1!=n.toLowerCase().indexOf("i4")?(g=JSON.parse(localStorage.getItem(d.deviceID)),this.setState({I4RelayBoardInfo:g,modelChanged:!1,currentChange:""})):(y=JSON.parse(localStorage.getItem(d.deviceID)),this.setState({RelayBoardInfo:y,modelChanged:!1,currentChange:""}))),this.setState({Moncon:d,EquipmentList:o,scheduleSelected:t,relayControlType:n},function(){return h(v,void 0,void 0,function(){return f(this,function(e){return this._fetchRelayCensorStatus(!0),-1!=n.toLowerCase().indexOf("i1")?this._fetchI1RelayBoardInfo(!0):-1!=n.toLowerCase().indexOf("i4")?this._fetchI4RelayBoardInfo(!0):this._fetchV4RelayBoardInfo(!0),this._fetchCeilingSensorBoardInfo(!0),this.fetchRelayControlSettings(),[2]})})}),Object(u.a)(!1),O.label=3;case 3:return[2]}})})},t.prototype._fetchCeilingSensorBoardInfo=function(e){return h(this,void 0,void 0,function(){var t,n,a,l=this;return f(this,function(c){return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.props.buildingName,a="",t.sensors&&t.sensors.map(function(e){return h(l,void 0,void 0,function(){var t,l;return f(this,function(c){switch(c.label){case 0:return a=e.value,t=Object(),[4,Object(i.j)(a,n)];case 1:return"CeilingSensor"!=(t=c.sent()).monitoringControlDeviceType?[3,3]:[4,Object(r.m)(t).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching ceiling sensor board info."),Object()):e}).catch(function(e){return Object()})];case 2:return l=c.sent(),this.setState({CeilingSensorBoardInfo:l,modelChanged:!1,currentChange:""}),[2];case 3:return[2]}})})}),e&&Object(u.a)(!1),[2]})})},t.prototype._fetchI1RelayBoardInfo=function(e){return h(this,void 0,void 0,function(){var t,n,a;return f(this,function(l){switch(l.label){case 0:return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.state.I1RelayStatus,[4,Object(r.f)(t.topic,new Date,new Date,!0).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching relay board info."),Object()):(e[e.length-1]&&localStorage.setItem(t.deviceID,JSON.stringify(e[e.length-1])),e[e.length-1])}).catch(function(e){return Object()})];case 1:return(a=l.sent())&&a.i1relay_state&&a.i1relay_state[0]&&(n="1"==a.i1relay_state[0]),a&&a.i1relay_state&&0==a.i1relay_state[0]&&(n=!1),this.setState({I1RelayBoardInfo:a,modelChanged:!1,currentChange:"",I1RelayStatus:n}),e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchV4RelayBoardInfo=function(e){return h(this,void 0,void 0,function(){var t,n,a,l,i,c,o,m,d;return f(this,function(h){switch(h.label){case 0:return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.state,a=n.relay1Status,l=n.relay2Status,i=n.relay3Status,c=n.relay4Status,o=Object(),[4,Object(r.g)(t.topic,new Date,new Date,!0).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching relay board info."),Object()):(e[e.length-1]&&localStorage.setItem(t.deviceID,JSON.stringify(e[e.length-1])),e[e.length-1])}).catch(function(e){return Object()})];case 1:return(o=h.sent())&&o.v4relay_state&&(m=this.ConvertDecimalToBinary(parseInt(o.v4relay_state)),d=m.split(","),a="1"==d[0],l="1"==d[1],i="1"==d[2],c="1"==d[3]),this.setState({RelayBoardInfo:o,Old_RelayBoardInfo:p({},o),modelChanged:!1,currentChange:"",relay1Status:a,relay2Status:l,relay3Status:i,relay4Status:c}),e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchI4RelayBoardInfo=function(e){return h(this,void 0,void 0,function(){var t,n,a,l,i,c,o;return f(this,function(m){switch(m.label){case 0:return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.state,a=n.relay1Status,l=n.relay2Status,i=n.relay3Status,c=n.relay4Status,o=Object(),[4,Object(r.o)(t).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching relay board info."),Object()):(e&&localStorage.setItem(t.deviceID,JSON.stringify(e)),e)}).catch(function(e){return Object()})];case 1:return o=m.sent(),a=120==o.voltage_volts_Ch1,l=120==o.voltage_volts_Ch2,i=120==o.voltage_volts_Ch3,c=120==o.voltage_volts_Ch4,this.setState({modelChanged:!1,currentChange:"",relay1Status:a,relay2Status:l,relay3Status:i,relay4Status:c,I4RelayBoardInfo:o}),e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchRelayCensorStatus=function(e){return h(this,void 0,void 0,function(){var t,n,a,l=this;return f(this,function(i){switch(i.label){case 0:return e&&Object(u.a)(!0),t=this.props,n=t.buildingName,a=t.RelayDeviceName,[4,Object(r.v)(n,a).then(function(e){var t=e[0];if(!t)return l.setState({relay1Status:!1,relay2Status:!1,relay3Status:!1,relay4Status:!1,relayOptimizeSettings:"Normal,Normal,Normal,Normal,"}),Object();var n=Object();n.relayStatus=[],n.controlStatus=Object(c.g)(t.controlStatus),n.deviceType=Object(c.g)(t.deviceType);var a=l.state,r=a.relay1Status,i=a.relay2Status,s=a.relay3Status,o=a.relay4Status,u=a.relayControlStatus,m=a.I1RelayStatus,d=a.relayOptimizeSettings,p=Object(c.g)(t.relayStatus).split(",");-1!=n.deviceType.indexOf("OneRelay")?(p&&(n.relayStatus=p),u=Object(c.g)(t.controlStatus),l.setState({I1RelayStatus:m,relayControlStatus:u})):(p&&(n.relayStatus=p),u=Object(c.g)(t.controlStatus),l.setState({relay1Status:r,relay2Status:i,relay3Status:s,relay4Status:o,relayControlStatus:u}));var h="Optimize"==n.controlStatus||"Normal"==n.controlStatus;(d=Object(c.g)(t.relayOptimizeSettings))&&",,,,"!=d&&""!=d||(d=-1==n.deviceType.indexOf("OneRelay")?"Normal,Normal,Normal,Normal,":"Normal"),l.setState({isOptimizeControl:h,isOptimizeControlStatus:h?n.controlStatus:"",relayOptimizeSettings:d})}).catch(function(e){return Object()})];case 1:return i.sent(),e&&Object(u.a)(!1),[2]}})})},t.prototype.fetchRelayControlSettings=function(){return h(this,void 0,void 0,function(){var e,t,n,a,l,i;return f(this,function(s){switch(s.label){case 0:return e=this.props.RelayDeviceName,t=this.state,n=t.relayControlType,a=t.RelayBoardControl,[4,Object(r.w)(e)];case 1:return(l=s.sent())[0]?(i=l[0],n&&-1==n.indexOf("OneRelay")?a.relays="1,2,3,4":a.relays="OneRelay",a.controlChoice=Object(c.g)(i.controlChoice),a.relayNames=Object(c.g)(i.relayNames),a.lightingTypes=Object(c.g)(i.lightingTypes),a.sensors=Object(c.g)(i.sensors),a.activeRelayStatus=Object(c.g)(i.activeRelayStatus)):n&&-1==n.indexOf("OneRelay")?(a.relays="1,2,3,4",a.controlChoice="0,0,0,0",a.relayNames="Relay 1,Relay 2,Relay 3,Relay 4",a.lightingTypes="0,0,0,0",a.sensors="0,0,0,0",a.activeRelayStatus="active,active,active,active"):(a.relays="OneRelay",a.controlChoice="0",a.relayNames="Relay",a.sensors="0",a.lightingTypes="0",a.activeRelayStatus="active"),this.setState({RelayBoardControl:a}),[2]}})})},t.prototype.ConvertDecimalToBinary=function(e){for(var t=[],n=e;n>0;)n%2==0?t.push("0"):t.push("1"),n=Math.floor(n/2);if(-1==this.state.relayControlType.indexOf("OneRelay"))for(var a=4-t.length,l=0;l<a;l++)t.push("0");return t.join(",")},t.prototype.handleRelayOnOff=function(e,t,n){var a=this.state,l=a.relay1Status,r=a.relay2Status,i=a.relay3Status,c=a.relay4Status;1==t&&(l=e),2==t&&(r=e),3==t&&(i=e),4==t&&(c=e),this.setState({modelChanged:n,relayisOnNo:t,relayisOn:e,relay1Status:l,relay2Status:r,relay3Status:i,relay4Status:c})},t.prototype.handleI1RelayOnOff=function(e){this.setState({I1RelayStatus:e,modelChanged:!0})},t.prototype.handleChange=function(e,t){var n=this.state.RelayBoardInfo;n[e]=t,this.setState({RelayBoardInfo:n,modelChanged:!0,currentChange:e})},t.prototype.handleRelayOptimizeSettings=function(e,t,n){return void 0===n&&(n=!0),h(this,void 0,void 0,function(){var a,l,r,i,c,s;return f(this,function(o){return a=this.state,l=a.relayOptimizeSettings,r=a.isOptimizeControl,i=a.modelChanged,c=a.relayNoOptimize,(s=l.split(","))[t]=e,r=!0,i=n,l=s.join(","),c=t+1,this.setState({isOptimizeControlStatus:e,relayOptimizeSettings:l,isOptimizeControl:r,modelChanged:i,relayNoOptimize:c}),[2]})})},t.prototype.handleRelayControlStatus=function(e){return h(this,void 0,void 0,function(){var t=this;return f(this,function(n){switch(n.label){case 0:return"Remote"==e&&"Local"!=this.state.relayControlStatus?[2]:("Remote"==e&&"Local"==this.state.relayControlStatus&&(e="Manual"),[4,this.saveRelayStatusChanges(e,!0).then(function(){return h(t,void 0,void 0,function(){var t,n,a;return f(this,function(l){return this.setState({relayControlStatus:e,isOptimizeControl:!1}),"Local"!=e&&"Schedule"!=e&&"Manual"!=e||(t=this.state,n=t.isOptimizeControl,a=t.modelChanged,n=!0,a=!0,this.setState({isOptimizeControlStatus:e,isOptimizeControl:n,modelChanged:a})),[2]})})})]);case 1:return n.sent(),[2]}})})},t.prototype.cancelSend=function(){var e=this.state,t=e.relay1Status,n=e.relay2Status,a=e.relay3Status,l=e.relay4Status,r=e.I1RelayStatus,i=e.relayCensorStatus,c=e.relayControlType,s=e.relayOptimizeSettings,o=e.isOptimizeControl,u=e.relayNoOptimize;if(-1!=c.indexOf("OneRelay"))r=!r,this.setState({I1RelayStatus:r,modelChanged:!1,isOptimizeControl:!1});else{if(i&&i.relayStatus&&i.relayStatus.length>0&&(t="1"==i.relayStatus[0],n="1"==i.relayStatus[1],a="1"==i.relayStatus[2],l="1"==i.relayStatus[3],this.setState({relay1Status:t,relay2Status:n,relay3Status:a,relay4Status:l})),o){var m=s.split(",");m[u]="Normal"==m[u]?"Optimize":"Normal",s=m.join(",")}this.setState({modelChanged:!1,isOptimizeControl:!1,currentChange:"",relayOptimizeSettings:s,relayNoOptimize:0})}},t.prototype.setOptimizeSettings=function(e,t){return h(this,void 0,void 0,function(){var n,a,l,i=this;return f(this,function(o){switch(o.label){case 0:return n=this.props,a=n.buildingName,l=n.RelayDeviceName,[4,Object(r.b)(a,l).then(function(n){return h(i,void 0,void 0,function(){var a,i,o,u,m,d,p,b,g,y,v,O,E,C,S,N,_,I=this;return f(this,function(j){switch(j.label){case 0:return a=Object(),n[0]?(a.device=Object(c.g)(n[0].device),a.A1=Object(c.g)(n[0].A1),a.A2=Object(c.g)(n[0].A2),a.B1=Object(c.g)(n[0].B1),a.B2=Object(c.g)(n[0].B2),a.C1=Object(c.g)(n[0].C1),a.C2=Object(c.g)(n[0].C2),a.D1=Object(c.g)(n[0].D1),a.D2=Object(c.g)(n[0].D2),a.E1=Object(c.g)(n[0].E1),a.E2=Object(c.g)(n[0].E2),a.F1=Object(c.g)(n[0].F1),a.F2=Object(c.g)(n[0].F2),a.G1=Object(c.g)(n[0].G1),a.G2=Object(c.g)(n[0].G2)):(a.device=l,a.A1="0",a.A2="0",a.B1="0",a.B2="0",a.C1="0",a.C2="0",a.D1="0",a.D2="0",a.E1="0",a.E2="0",a.F1="0",a.F2="0",a.G1="0",a.G2="0"),i=Object(),o=Object(),u=this.state,m=u.Moncon,d=u.relayNoOptimize,p=u.relayControlType,b=u.relayOptimizeSettings,g=u.RelayBoardControl,y=u.devices,v=u.relayControlStatus,O=e?e.split(","):b.split(","),i.isOptimize="Optimize"==O[(t||d)-1],i.isOptimize?(i.varA=parseInt(a.A2),i.varB=parseInt(a.B2),i.varC=parseInt(a.C2),i.varD=parseInt(a.D2),i.varE=parseInt(a.E2),i.varF=parseInt(a.F2),i.varG=parseInt(a.G2)):(i.varA=parseInt(a.A1),i.varB=parseInt(a.B1),i.varC=parseInt(a.C1),i.varD=parseInt(a.D1),i.varE=parseInt(a.E1),i.varF=parseInt(a.F1),i.varG=parseInt(a.G1)),i.deviceID=m.deviceName,i.relaynum=""+d,i.rlb_add=m.boardAddress,m.wirelessConfig.ipAddress&&(i.controllerPI=m.wirelessConfig.ipAddress,o.controllerPI=m.wirelessConfig.ipAddress),m.wirelessConfig.controllerIPAddress&&(i.controllerPI=m.wirelessConfig.controllerIPAddress,o.controllerPI=m.wirelessConfig.controllerIPAddress),-1!=p.toLowerCase().indexOf("v1")?i.rlb_ver="v1":-1!=p.toLowerCase().indexOf("v4")?i.rlb_ver="v4":-1!=p.toLowerCase().indexOf("i1")?i.rlb_ver="i1":-1!=p.toLowerCase().indexOf("i4")&&(i.rlb_ver="i4"),E=[],C=[],S=[],N=[],E=g.controlChoice&&g.controlChoice.split(","),C=g.lightingTypes&&g.lightingTypes.split(","),S=g.sensors&&g.sensors.split(","),N=g.relayNames&&g.relayNames.split(","),o.sched="Schedule"==v,o.controltype=o.sched?E[d-1]:"10",o.lighting_type=C[d-1],o.relaynum=""+d,o.rlb_ver=i.rlb_ver,o.rlb_add=m.boardAddress,o.deviceID=m.deviceName,S&&S[d-1]?(_=y.find(function(e){return Object(c.g)(e.moncondevice)==S[d-1]}),o.csb_add=_?Object(c.g)(_.boardAddress):"9999"):o.csb_add="9999",o.lighting_type&&"0"!=o.lighting_type&&o.controltype&&"0"!=o.controltype?[4,Object(r.H)(o,i)]:(Object(s.a)("Save the control settings for "+N[d-1]+" before posting settings"),[2]);case 1:return j.sent(),"A"!=C[d-1]?[3,11]:"0"!=S[d-1]?[3,11]:i.isOptimize?[4,this.handleRelayOnOff(!1,d,!1)]:[3,11];case 2:return j.sent(),[4,this.saveRelayStatusChanges(v,!1)];case 3:return j.sent(),-1==p.indexOf("OneRelay")?[3,7]:-1==p.indexOf("V1")?[3,4]:[3,6];case 4:return[4,Object(r.D)(m,!1).then(function(e){return h(I,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 5:j.sent(),j.label=6;case 6:return[3,11];case 7:return-1==p.indexOf("V4")?[3,9]:[4,Object(r.J)(m,!1,!1,d).then(function(e){return h(I,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 8:return j.sent(),[3,11];case 9:return[4,Object(r.E)(m,!1,!1,d).then(function(e){return h(I,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 10:j.sent(),j.label=11;case 11:return[2]}})})})];case 1:return o.sent(),[2]}})})},t.prototype.resetChanges=function(e){return h(this,void 0,void 0,function(){var t=this;return f(this,function(n){return this.setState({modelChanged:!1,isOptimizeControl:!1,currentChange:"",callInterval:!1},function(){return h(t,void 0,void 0,function(){var t;return f(this,function(n){switch(n.label){case 0:return t=this.state.relayControlType,[4,this._fetchRelayCensorStatus(e)];case 1:return n.sent(),-1!=t.toLowerCase().indexOf("i1")?this._fetchI1RelayBoardInfo(e):-1!=t.toLowerCase().indexOf("i4")?this._fetchI4RelayBoardInfo(e):this._fetchV4RelayBoardInfo(e),[4,this._fetchCeilingSensorBoardInfo(e)];case 2:return n.sent(),this.setState({callInterval:!0}),[2]}})})}),[2]})})},t.prototype.handleScheduleSelection=function(e){return h(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,Object(r.O)(this.props.RelayDeviceName,e)];case 1:return t.sent(),e?Object(s.b)("Successfully Selected Schedule"):Object(s.b)("Successfully unSelected Schedule"),[2]}})})},t.prototype.saveRelayStatusChanges=function(e,t){return h(this,void 0,void 0,function(){var n,a,l,i,c,o,m,d,p,h,b,g,y;return f(this,function(f){switch(f.label){case 0:return t&&Object(u.a)(!0),n=this.props,a=n.buildingName,l=n.RelayDeviceName,i=this.state,c=i.relay1Status,o=i.relay2Status,m=i.relay3Status,d=i.relay4Status,p=i.relayCensorStatus,h=i.relayControlType,b=i.I1RelayStatus,g=i.relayOptimizeSettings,y=[],-1!=h.indexOf("OneRelay")?y.push(b?"1":"0"):(y.push(c?"1":"0"),y.push(o?"1":"0"),y.push(m?"1":"0"),y.push(d?"1":"0")),p.relayStatus=y,p.controlStatus=e,p.deviceType=h,p.device=l,p.relayOptimizeSettings=g.split(","),[4,Object(r.M)(a,p).then(function(e){}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 1:return f.sent(),t&&Object(u.a)(!1),[2]}})})},t.prototype.applyChanges=function(){return h(this,void 0,void 0,function(){var e=this;return f(this,function(t){return Object(u.a)(!0),this.setState({modelChanged:!1,currentChange:""},function(){return h(e,void 0,void 0,function(){var e,t,n,l,i,c,o,m,d,p,g,y,v,O,E,C,S=this;return f(this,function(N){switch(N.label){case 0:if(b=0,a&&clearInterval(a),Object(u.a)(!0),e=this.state,t=e.Moncon,n=e.relayisOnNo,l=e.relayisOn,i=e.relayControlStatus,c=e.I1RelayStatus,o=e.relayControlType,m=e.isOptimizeControl,d=e.isOptimizeControlStatus,p=e.relayOptimizeSettings,g=e.RelayBoardControl,"Local"!=d&&"Schedule"!=d&&"Manual"!=d)return[3,6];"Schedule"==d&&this.handleScheduleSelection(!0),y=-1==o.indexOf("OneRelay")?4:1,v=p.split(","),O=g.activeRelayStatus&&g.activeRelayStatus.split(","),E=0,N.label=1;case 1:return E<y?"active"!=O[E]?[3,4]:[4,this.handleRelayOptimizeSettings(v[E],E,!1)]:[3,5];case 2:return N.sent(),p=v.join(","),C=E+1,[4,this.setOptimizeSettings(p,C)];case 3:N.sent(),N.label=4;case 4:return E++,[3,1];case 5:return"Local"==i&&"Local"==d?(Object(u.a)(!1),[2]):[3,18];case 6:return"Schedule"!=i&&"Schedule"!=d&&this.handleScheduleSelection(!1),[4,this.saveRelayStatusChanges(i,!1)];case 7:return N.sent(),m?[3,16]:-1==o.indexOf("OneRelay")?[3,11]:-1==o.indexOf("V1")?[3,8]:[3,10];case 8:return[4,Object(r.D)(t,c).then(function(e){return h(S,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 9:N.sent(),N.label=10;case 10:return[3,15];case 11:return-1==o.indexOf("V4")?[3,13]:[4,Object(r.J)(t,!1,l,n).then(function(e){return h(S,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 12:return N.sent(),[3,15];case 13:return[4,Object(r.E)(t,!1,l,n).then(function(e){return h(S,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 14:N.sent(),N.label=15;case 15:return[3,18];case 16:return[4,this.setOptimizeSettings()];case 17:N.sent(),N.label=18;case 18:return this.setState({isOptimizeControl:!1}),this.setIntervalStart(),Object(u.a)(!1),[2]}})})}),[2]})})},t.prototype.applyRule=function(e,t,n){return e?t?e<n?0:e:e>n?0:e:0},t.prototype.render=function(){var e,t,n,a,r=this,i=this.state,c=i.CeilingSensorBoardInfo,s=i.Moncon,u=i.modelChanged,m=i.currentChange,d=i.detailsExpanded,p=i.RelayBoardInfo,h=i.relayControlStatus,f=i.relayisOn,b=i.relayisOnNo,g=i.relay1Status,y=i.relay2Status,v=i.relay3Status,O=i.relay4Status,E=i.relayControlType,C=i.I1RelayBoardInfo,S=i.I1RelayStatus,N=i.isOptimizeControl,_=i.isOptimizeControlStatus,I=i.RelayBoardControl,j=i.relayOptimizeSettings,w=i.I4RelayBoardInfo,R=this.props,x=R.instance,T=R.buildingName,D=R.RelayDeviceName,L=R.type,A=R.hideTabs,B="Local"!=h;e=I.relayNames&&I.relayNames.split(","),t=I.lightingTypes&&I.lightingTypes.split(","),n=j&&j.split(","),a=I.activeRelayStatus&&I.activeRelayStatus.split(",");var z="not refreshed";return E&&(-1!=E.toLowerCase().indexOf("i1")?C&&C.timestamp&&(z=new Date(C.timestamp).toLocaleString()):-1!=E.toLowerCase().indexOf("i4")?w&&w.timestamp&&(z=new Date(w.timestamp).toLocaleString()):-1!=E.toLowerCase().indexOf("v4")&&p&&p.timestamp&&(z=new Date(p.timestamp).toLocaleString())),l.createElement("div",{className:"content"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},!A&&l.createElement(o.a,{InsightName:D,ControlName:"RelayControl",buildingName:T,instance:x,type:L}),l.createElement("div",{className:"card",id:"InsightsList"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-9"},l.createElement("div",{className:"header"},l.createElement("h3",{className:"title"},l.createElement("strong",null,s.rdfsLabel)," "),l.createElement("h4",{className:"title"},l.createElement("strong",null,this.props.type.toUpperCase(),":",s&&s.relatedEquipment.map(function(e,t){return l.createElement("span",{key:t},t+1==s.relatedEquipment.length?"":",")}))))))),l.createElement("div",{className:"content"},l.createElement("div",{className:"row"},-1!=E.indexOf("OneRelay")&&l.createElement(l.Fragment,null,l.createElement("div",{className:"col-md-8 InsightRow"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6 col-xs-12"},l.createElement("h4",{className:"padding-5 margin-5"},"Power Watts: ",l.createElement("b",null,C&&C.active_power_Watts?C.active_power_Watts:0," ")),l.createElement("h4",{className:"padding-5 margin-5"},"Amperes: ",l.createElement("b",null,C&&C.current_Amperes?C.current_Amperes:0)),l.createElement("h4",{className:"padding-5 margin-5"},"Frequency Hz: ",l.createElement("b",null,C&&C.frequency_Hz?this.applyRule(C.frequency_Hz,!0,55):0))),l.createElement("div",{className:"col-md-6 col-xs-12"},l.createElement("h4",{className:"padding-5 margin-5"},"Energy Watt/Hour: ",l.createElement("b",null,C&&C.import_active_energy_Wh?C.import_active_energy_Wh:0," ")),l.createElement("h4",{className:"padding-5 margin-5"},"Power Factor: ",l.createElement("b",null,C&&C.power_factor?C.power_factor:0)),l.createElement("h4",{className:"padding-5 margin-5"},"Voltage volts: ",l.createElement("b",null,C&&C.voltage_volts?C.voltage_volts:0))))),l.createElement("div",{className:"col-md-4 col-xs-12 InsightRow"},l.createElement("h4",{className:"padding-5 margin-5"},"Source Volts: ",l.createElement("b",null,p&&p.nominal_src_volts?p.nominal_src_volts:0," ")),l.createElement("h4",{className:"padding-5 margin-5"},"Illumiance: ",l.createElement("b",null,c&&c.illuminance_lux?c.illuminance_lux:0," Lumens")),l.createElement("h4",{className:"padding-5 margin-5"},"Motion Sensed: ",l.createElement("b",null,c&&c.illuminance_lux&&c.motion_sensed>0?"True":"False")))),-1==E.indexOf("OneRelay")&&l.createElement("div",{className:"col-md-12 InsightRow"},l.createElement("table",{className:"table table-striped"},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null),l.createElement("th",null,l.createElement("b",null,"Amperes")),l.createElement("th",null,l.createElement("b",null,"Power Watt")),-1!=E.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("th",null,l.createElement("b",null,"Frequency")),l.createElement("th",null,l.createElement("b",null,"Energy")),l.createElement("th",null,l.createElement("b",null,"Power Factor")),l.createElement("th",null,l.createElement("b",null,"Voltage"))),l.createElement("th",null,"Manual"==h?"Status":""),t&&t.length>0&&(1==t.length?"0"!=t[0]:"0"!=t[0]&&"0"!=t[1]&&"0"!=t[2]&&"0"!=t[3])&&l.createElement("th",null,"Optimize Settings"))),l.createElement("tbody",null,a&&"inactive"!=a[0]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[0])),-1!=E.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,p&&p.mAmps_relay1?this.applyRule(parseFloat(p.mAmps_relay1)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,p&&p.power_Wt_relay1?this.applyRule(parseFloat(p.power_Wt_relay1)/1e3,!0,3):0," W"))),-1!=E.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,w&&w.current_Amperes_Ch1?this.applyRule(w.current_Amperes_Ch1,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,w&&w.active_power_Watts_Ch1?this.applyRule(parseFloat(w.active_power_Watts_Ch1)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,w&&w.frequency_Hz_Ch1?w.frequency_Hz_Ch1:0," Hz")),l.createElement("td",null,l.createElement("b",null,w&&w.import_active_energy_Wh_Ch1?w.import_active_energy_Wh_Ch1:0," Wh")),l.createElement("td",null,l.createElement("b",null,w&&w.power_factor_Ch1?w.power_factor_Ch1:0)),l.createElement("td",null,l.createElement("b",null,w&&w.voltage_volts_Ch1?this.applyRule(w.voltage_volts_Ch1,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:g?"btn":"btn btn-fill",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!1,1,!0)}},"Off"),l.createElement("button",{type:"button",className:g?"btn btn-fill":"btn",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!0,1,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[0]&&"C"!=t[0]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[0]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Normal",0)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[0]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Optimize",0)}},"Optimize")))),a&&"inactive"!=a[1]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[1])),-1!=E.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,p&&p.mAmps_relay2?this.applyRule(parseFloat(p.mAmps_relay2)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,p&&p.power_Wt_relay2?this.applyRule(parseFloat(p.power_Wt_relay2)/1e3,!0,3):0," W"))),-1!=E.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,w&&w.current_Amperes_Ch2?this.applyRule(w.current_Amperes_Ch2,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,w&&w.active_power_Watts_Ch2?this.applyRule(parseFloat(w.active_power_Watts_Ch2)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,w&&w.frequency_Hz_Ch2?w.frequency_Hz_Ch2:0," Hz")),l.createElement("td",null,l.createElement("b",null,w&&w.import_active_energy_Wh_Ch2?w.import_active_energy_Wh_Ch2:0," Wh")),l.createElement("td",null,l.createElement("b",null,w&&w.power_factor_Ch2?w.power_factor_Ch2:0)),l.createElement("td",null,l.createElement("b",null,w&&w.voltage_volts_Ch2?this.applyRule(w.voltage_volts_Ch2,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:y?"btn":"btn btn-fill",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!1,2,!0)}},"Off"),l.createElement("button",{type:"button",className:y?"btn btn-fill":"btn",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!0,2,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[1]&&"C"!=t[1]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[1]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Normal",1)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[1]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Optimize",1)}},"Optimize")))),a&&"inactive"!=a[2]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[2])),-1!=E.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,p&&p.mAmps_relay3?this.applyRule(parseFloat(p.mAmps_relay3)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,p&&p.power_Wt_relay3?this.applyRule(parseFloat(p.power_Wt_relay3)/1e3,!0,3):0," W"))),-1!=E.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,w&&w.current_Amperes_Ch3?this.applyRule(w.current_Amperes_Ch3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,w&&w.active_power_Watts_Ch3?this.applyRule(parseFloat(w.active_power_Watts_Ch3)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,w&&w.frequency_Hz_Ch3?w.frequency_Hz_Ch3:0," Hz")),l.createElement("td",null,l.createElement("b",null,w&&w.import_active_energy_Wh_Ch3?w.import_active_energy_Wh_Ch3:0," Wh")),l.createElement("td",null,l.createElement("b",null,w&&w.power_factor_Ch3?w.power_factor_Ch3:0)),l.createElement("td",null,l.createElement("b",null,w&&w.voltage_volts_Ch3?this.applyRule(w.voltage_volts_Ch3,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:v?"btn":"btn btn-fill",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!1,3,!0)}},"Off"),l.createElement("button",{type:"button",className:v?"btn btn-fill":"btn",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!0,3,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[2]&&"C"!=t[2]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[2]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Normal",2)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[2]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Optimize",2)}},"Optimize")))),a&&"inactive"!=a[3]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[3])),-1!=E.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,p&&p.mAmps_relay4?this.applyRule(parseFloat(p.mAmps_relay4)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,"-"))),-1!=E.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,w&&w.current_Amperes_Ch4?this.applyRule(w.current_Amperes_Ch4,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,w&&w.active_power_Watts_Ch4?this.applyRule(parseFloat(w.active_power_Watts_Ch4)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,w&&w.frequency_Hz_Ch4?w.frequency_Hz_Ch4:0," Hz")),l.createElement("td",null,l.createElement("b",null,w&&w.import_active_energy_Wh_Ch4?w.import_active_energy_Wh_Ch4:0," Wh")),l.createElement("td",null,l.createElement("b",null,w&&w.power_factor_Ch4?w.power_factor_Ch4:0)),l.createElement("td",null,l.createElement("b",null,w&&w.voltage_volts_Ch4?this.applyRule(w.voltage_volts_Ch4,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:O?"btn":"btn btn-fill",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!1,4,!0)}},"Off"),l.createElement("button",{type:"button",className:O?"btn btn-fill":"btn",disabled:u||"Manual"!=h,onClick:function(){r.handleRelayOnOff(!0,4,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[3]&&"C"!=t[3]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[3]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Normal",3)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[3]?"btn btn-fill":"btn",disabled:N,onClick:function(){r.handleRelayOptimizeSettings("Optimize",3)}},"Optimize"))))))),l.createElement("div",{className:"col-md-8 col-xs-12 InsightRow"},-1!=E.indexOf("OneRelay")&&l.createElement(l.Fragment,null,l.createElement("div",{className:"col-md-6"},l.createElement(l.Fragment,null,l.createElement("div",{className:"RelayHeading"},"Relay Status"),l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:S?"btn":"btn btn-fill",disabled:u||"Manual"!=h,onClick:function(){r.handleI1RelayOnOff(!1)}},"Off"),l.createElement("button",{type:"button",className:S?"btn btn-fill":"btn",disabled:u||"Manual"!=h,onClick:function(){r.handleI1RelayOnOff(!0)}},"On")))),t&&"0"!=t[0]&&"C"!=t[0]&&l.createElement("div",{className:"col-md-6"},l.createElement("div",{className:"RelayHeading"},"Optimize Settings"),l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[0]?"btn btn-fill":"btn",onClick:function(){r.handleRelayOptimizeSettings("Normal",0)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[0]?"btn btn-fill":"btn",onClick:function(){r.handleRelayOptimizeSettings("Optimize",0)}},"Optimize")))),-1==E.indexOf("OneRelay")&&l.createElement(l.Fragment,null,l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"padding-5 margin-5"},"Source Volts: ",l.createElement("b",null,p&&p.nominal_src_volts?p.nominal_src_volts:0," "))),l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"padding-5 margin-5"},"Illumiance: ",l.createElement("b",null,c&&c.illuminance_lux?c.illuminance_lux:0," Lumens"))),l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"padding-5 margin-5"},"Motion Sensed: ",l.createElement("b",null,c&&c.illuminance_lux&&c.motion_sensed>0?"True":"False"))))),l.createElement("div",{className:"col-md-4 col-xs-12 InsightRow"},l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:"Local"==h?"btn btn-success btn-fill":"btn btn-success",disabled:""!=m&&"state"!=m,onClick:function(){r.handleRelayControlStatus("Local")}},"Local"),l.createElement("button",{type:"button",className:B?"btn btn-success btn-fill":"btn btn-success",disabled:""!=m&&"state"!=m,onClick:function(){r.handleRelayControlStatus("Remote")}},"Remote"),l.createElement("button",{type:"button",className:"Manual"==h?"btn btn-success btn-fill":"btn btn-success",disabled:!B,onClick:function(){r.handleRelayControlStatus("Manual")}},"Manual"),l.createElement("button",{type:"button",className:"Schedule"==h?"btn btn-success btn-fill":"btn btn-success",disabled:!B,onClick:function(){r.handleRelayControlStatus("Schedule")}},"Schedule")))),l.createElement("div",{className:"accordion row padding-10",id:"accordionExample",style:{paddingLeft:"30px",border:"1px solid #80808066",margin:"10px",borderRadius:"7px"}},l.createElement("div",{className:"",id:"headingOne"},l.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne",style:{border:0,left:"-25px",position:"relative"},"aria-expanded":"true","aria-controls":"collapseOne",onClick:function(){r.setState({detailsExpanded:!d})}},l.createElement("i",{className:d?"fa fa-minus":"fa fa-plus","aria-hidden":"true"}))),l.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},l.createElement("div",{className:"col-md-6 col-xs-12 padding-10"},l.createElement("h5",{className:"title"},l.createElement("strong",null,"IP Address:")," ",s.wirelessConfig&&s.wirelessConfig.ipAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Controller IP Address:")," ",s.wirelessConfig&&s.wirelessConfig.controllerIPAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Manufacturer:")," ",s.manufacturer),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Model:")," ",s.model),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Board Address:")," ",s.boardAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Device ID:")," ",s.deviceID?s.deviceID:""),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Last Data Synced At:")," ",z)))),l.createElement("div",{className:u?"InsightApplyChanges":"hidden"},N?l.createElement("h4",null,"Do you want to apply these changes (Optimize Settings: ",_,") ?"):l.createElement("h4",null,"Do you want to apply these changes (Relay ",-1!=E.indexOf("OneRelay")?" : "+(S?"on":"off"):b+" : "+(f?"on":"off"),")?"),l.createElement("div",null,l.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){return r.cancelSend()}},"Cancel"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-danger",onClick:function(){return r.resetChanges(!0)}},"Reset"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){return r.applyChanges()}},"Apply Changes")))))))))},t}(l.Component);t.default=g},1023:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(3),r=(n.n(l),n(605)),i=n(590),c=n(18),s=n(44),o=n(87),u=n(573),m=n(17),d=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__assign||function(){return(p=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},h=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function c(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,c)}s((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,r,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){i.label=r[1];break}if(6===r[0]&&i.label<l[1]){i.label=l[1],l=r;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(r);break}l[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}},b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={CeilingSensorBoardInfo:Object(),Old_CeilingSensorBoardInfo:Object(),modelChanged:!1,Moncon:{monitoringControl:"",monitoringControlDeviceType:"",deviceName:"",floor:"",rdfsLabel:"",manufacturer:"",model:"",location:"",computingDevice:"",connectionType:"",notes:"",wirelessConfig:{ipAddress:"",controllerIPAddress:"",thermostatMacAddress:"",ssid:"",password:""},isSchedule:!1,relatedEquipment:[],deviceNumber:"",enclosure:""},EquipmentList:[],currentChange:"",detailsExpanded:!1,localBTNState:!1,spaces:[]},a=a=n,n._fetchData=n._fetchData.bind(n),n._fetchCeilingSensorBoardInfo=n._fetchCeilingSensorBoardInfo.bind(n),n.cancelSend=n.cancelSend.bind(n),n.resetChanges=n.resetChanges.bind(n),n.applyChanges=n.applyChanges.bind(n),n.handleChange=n.handleChange.bind(n),n.getRelatedEquipmentLabel=n.getRelatedEquipmentLabel.bind(n),n}return d(t,e),t.prototype.componentDidMount=function(){return h(this,void 0,void 0,function(){var e=this;return f(this,function(t){switch(t.label){case 0:return this.props.buildingName?[4,this._fetchData()]:[3,2];case 1:t.sent(),t.label=2;case 2:return setInterval(function(){e.resetChanges(!1)},1e4),[2]}})})},t.prototype.componentWillUnmount=function(){return h(this,void 0,void 0,function(){return f(this,function(e){return clearInterval(void 0),[2]})})},t.prototype._fetchData=function(){return h(this,void 0,void 0,function(){var e,t,n,a,l,r,c,s=this;return f(this,function(d){switch(d.label){case 0:return this.state,e=this.props,t=e.CeilingSensorBoardName,n=e.buildingName,t?(Object(o.a)(!0),[4,Object(u.h)(this.props.buildingName)]):[3,3];case 1:return a=d.sent(),l=a&&a.length>0&&a.map(function(e){return{value:Object(m.g)(e.ontology),label:Object(m.g)(e.rdfsLabel)}}),r=Object(),[4,Object(i.j)(t,n)];case 2:r=d.sent(),localStorage.getItem(r.deviceID)&&localStorage.getItem(r.deviceID).length>0&&(c=JSON.parse(localStorage.getItem(r.deviceID)),this.setState({CeilingSensorBoardInfo:c,Old_CeilingSensorBoardInfo:p({},c),modelChanged:!1,currentChange:""})),this.setState({Moncon:r,EquipmentList:l},function(){return h(s,void 0,void 0,function(){return f(this,function(e){return this._fetchCeilingSensorBoardInfo(!0),[2]})})}),Object(o.a)(!1),d.label=3;case 3:return[2]}})})},t.prototype._fetchCeilingSensorBoardInfo=function(e){return h(this,void 0,void 0,function(){var t,n;return f(this,function(a){switch(a.label){case 0:return e&&Object(o.a)(!0),t=this.state.Moncon,[4,Object(r.m)(t).then(function(e){var n=e[0];return!n||n&&n.error?(Object(s.a)("Error occurred while fetching ceiling sensor board info."),Object()):(localStorage.setItem(t.deviceID,JSON.stringify(e)),n)}).catch(function(e){return Object()})];case 1:return n=a.sent(),this.setState({CeilingSensorBoardInfo:n,Old_CeilingSensorBoardInfo:p({},n),modelChanged:!1,currentChange:""}),e&&Object(o.a)(!1),[2]}})})},t.prototype.handleChange=function(e,t){var n=this.state.CeilingSensorBoardInfo;n[e]=t,this.setState({CeilingSensorBoardInfo:n,modelChanged:!0,currentChange:e})},t.prototype.cancelSend=function(){this.setState({modelChanged:!1,currentChange:""})},t.prototype.resetChanges=function(e){return h(this,void 0,void 0,function(){var t=this;return f(this,function(n){return this.setState({modelChanged:!1,currentChange:""},function(){return h(t,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this._fetchCeilingSensorBoardInfo(e)];case 1:return t.sent(),[2]}})})}),[2]})})},t.prototype.applyChanges=function(e,t){return h(this,void 0,void 0,function(){var n=this;return f(this,function(l){return Object(o.a)(!0),this.setState({modelChanged:!1,currentChange:""},function(){return h(n,void 0,void 0,function(){var n=this;return f(this,function(l){return setTimeout(function(){n.resetChanges(!0)},5e3),Object(r.C)(e,t,this.state.Old_CeilingSensorBoardInfo).then(function(e){e.success?Object(s.b)("Changes applied successfully. "):e.error&&Object(s.a)(e.reason)}).catch(function(e){Object(s.a)("Some error orccured. ")}),setTimeout(function(){a._fetchCeilingSensorBoardInfo()},5e3),Object(o.a)(!1),[2]})})}),[2]})})},t.prototype.getRelatedEquipmentLabel=function(e){var t=this.state.EquipmentList,n=Object();return(n=t&&t.find(function(t){return t.value==e}))&&n.label},t.prototype.render=function(){var e=this,t=this.state,n=t.CeilingSensorBoardInfo,a=t.Moncon,r=t.modelChanged,i=t.detailsExpanded,s="not refreshed";return n&&n.timestamp&&(s=new Date(n.timestamp).toLocaleString()),l.createElement("div",{className:"content"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},l.createElement("div",{className:"card",id:"InsightsList"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},l.createElement("div",{className:"header"},l.createElement("h3",{className:"title"},l.createElement("strong",null,a.rdfsLabel)," "),l.createElement("h4",{className:"title"},l.createElement("strong",null,this.props.type.toUpperCase(),":",a&&a.relatedEquipment.map(function(t,n){return l.createElement("span",{key:n},e.getRelatedEquipmentLabel(t.value),n+1==a.relatedEquipment.length?"":",")}))))))),l.createElement("div",{className:"content"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6 col-xs-12 tempCounter roomTemp"},l.createElement("h4",{className:"padding-5 margin-5"},"Temp: ",l.createElement("b",null,Object(c.a)(n&&n.temp_celsius?n.temp_celsius:0).toFixed(2),"\xb0F")),l.createElement("h4",{className:"padding-5 margin-5"},"CO2: ",l.createElement("b",null,n&&n.equiCO2_ppm?n.equiCO2_ppm+" ppm":"-")),l.createElement("h4",{className:"padding-5 margin-5"},"Altitude: ",l.createElement("b",null,n&&n.altitude_m?n.altitude_m+" m":"-")),l.createElement("h4",{className:"padding-5 margin-5"},"Pressure: ",l.createElement("b",null,n&&n.pressure_hPa?n.pressure_hPa+" hPa":"-")),l.createElement("h4",{className:"padding-5 margin-5"},"Illumiance: ",l.createElement("b",null,n&&n.illuminance_lux?n.illuminance_lux:0," Lumens")),l.createElement("h4",{className:"padding-5 margin-5"},"Gas Resistance: ",l.createElement("b",null,n&&n.gasResistance_kOhm?n.gasResistance_kOhm+" kOhm":"-"))),l.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"},l.createElement("h4",{className:"padding-5 margin-5"},"Humidity: ",l.createElement("b",null,n&&n.relhumidity_pct?n.relhumidity_pct+" %":"-")),l.createElement("h4",{className:"padding-5 margin-5"},"TVOC: ",l.createElement("b",null,n&&n.tvoc_ppm?n.tvoc_ppm+" ppm":"-")),l.createElement("h4",{className:"padding-5 margin-5"},"No. of BT Devices: ",l.createElement("b",null,n&&n.num_BTdev?n.num_BTdev:"-")),l.createElement("h4",{className:"padding-5 margin-5"},"Motion Sensed: ",l.createElement("b",null,n&&n.illuminance_lux&&n.motion_sensed>0?"True":"False")),l.createElement("h4",{className:"padding-5 margin-5"},"WIFI Temp: ",l.createElement("b",null,Object(c.a)(n&&n.wifiTemp1_celsius?n.wifiTemp1_celsius:0).toFixed(2),"\xb0F"))),l.createElement("div",{className:"col-md-6 col-xs-12 InsightRow"})),l.createElement("div",{className:"row"}),l.createElement("div",{className:"accordion row padding-10",id:"accordionExample",style:{paddingLeft:"30px",border:"1px solid #80808066",margin:"10px",borderRadius:"7px"}},l.createElement("div",{className:"",id:"headingOne"},l.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne",style:{border:0,left:"-25px",position:"relative"},"aria-expanded":"true","aria-controls":"collapseOne",onClick:function(){e.setState({detailsExpanded:!i})}},l.createElement("i",{className:i?"fa fa-minus":"fa fa-plus","aria-hidden":"true"}))),l.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},l.createElement("div",{className:"col-md-6 col-xs-12 padding-10"},l.createElement("h5",{className:"title"},l.createElement("strong",null,"IP Address:")," ",a.wirelessConfig&&a.wirelessConfig.ipAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Controller IP Address:")," ",a.wirelessConfig.controllerIPAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Manufacturer:")," ",a.manufacturer),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Model:")," ",a.model),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Board Address:")," ",a.boardAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Device ID:")," ",a.deviceID?a.deviceID:""),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Last Data Synced At:")," ",s)))),l.createElement("div",{className:r?"InsightApplyChanges":"hidden"},l.createElement("h4",null,"Do you want to apply these changes?"),l.createElement("div",null,l.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){return e.cancelSend()}},"Cancel"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-danger",onClick:function(){return e.resetChanges(!0)}},"Reset"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){return e.applyChanges(a,n)}},"Apply Changes")))))))))},t}(l.Component);t.default=b},1786:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),l=n.n(a),r=n(568),i=n(946),c=n(1023),s=n(1022),o=n(1005),u=n(87),m=n(880),d=n(947),p=n(997),h=n(877),f=n(998),b=n(1106),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),y=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,r){function i(e){try{s(a.next(e))}catch(e){r(e)}}function c(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(i,c)}s((a=a.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,a,l,r,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(l=(l=i.trys).length>0&&l[l.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){i.label=r[1];break}if(6===r[0]&&i.label<l[1]){i.label=l[1],l=r;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(r);break}l[2]&&i.ops.pop(),i.trys.pop();continue}r=t.call(e,i)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}},O=function(e){function t(t){var n=e.call(this,t)||this;return n.state={solution:Object(),generatorDevice:Object(),currentEquipment:"",currentEquipmentIndex:0,currentTab:"GUI",showControllers:[],selectedAssetType:"",selectedAssetLabel:"",selectedComponnet:Object(),selectedDevice:Object(),selectedEquipment:Object(),selectedPoint:Object()},n.getSolutionInDetail=n.getSolutionInDetail.bind(n),n}return g(t,e),t.prototype.componentDidMount=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=this.props.solution,[4,this.getSolutionInDetail(e)];case 1:return t.sent(),[2]}})})},t.prototype.getSolutionInDetail=function(e){return y(this,void 0,void 0,function(){var t,n,a,l,r,i,c=this;return v(this,function(s){switch(s.label){case 0:return Object(u.a)(!0),t=this.props.buildingName,n=Object(),[4,Object(m.d)(t,e)];case 1:return a=s.sent(),(n=a&&a.length>0&&a[0]?a[0]:Object())&&n.equipmentTemplatesOntology&&(l=n.equipmentTemplatesOntology.split(","),r=[],i=[],n&&n.equipmentByTemplate&&n.equipmentByTemplate.length>0&&n.equipmentByTemplate[0]&&n.equipmentByTemplate.map(function(e,t){r.push({label:e.equipment.rdfsLabel,value:l[t]});var n=[];e.devices&&e.devices.map(function(e){return n.push(!1)}),i.push(n)}),this.setState({solution:n,currentEquipmentIndex:0,currentEquipment:e,showControllers:i},function(){c.setState({currentTab:"GUI"})}),this.fetchEquipmentTemplateFromSolution(0)),Object(u.a)(!1),[2]}})})},t.prototype.fetchEquipmentTemplateFromSolution=function(e){var t=this;Object(u.a)(!0);var n=this.state.solution;if(n&&n.equipmentByTemplate&&n.equipmentByTemplate.length>0){var a=Object(),l=n.equipmentByTemplate[e];"Generator"==l.equipment.subclassType&&(a=l.equipment),this.setState({generatorDevice:void 0},function(){t.setState({generatorDevice:a})})}Object(u.a)(!1)},t.prototype.setCollapseIcon=function(e){var t=e.currentTarget.children[0].className;e.currentTarget.children[0].className="fa fa-plus"==t?"fa fa-minus":"fa fa-plus"},t.prototype.getDeviceControllerData=function(e,t,n){var a=this.state,l=a.currentEquipmentIndex,r=a.showControllers;r[l][t]=!n,this.setState({showControllers:r})},t.prototype.showAssetProfile=function(e,t){var n=this,a=this.state,l=a.selectedAssetLabel,r=a.selectedComponnet,i=a.selectedDevice,c=a.selectedEquipment,s=a.selectedPoint;this.setState({selectedAssetType:""}),"Device"==t?(l=(i=e).rdfsLabel,this.setState({selectedAssetLabel:l,selectedDevice:i},function(){n.setState({selectedAssetType:t})})):"Point"==t?(l=(s=e).pointLabel,this.setState({selectedAssetLabel:l,selectedPoint:s},function(){n.setState({selectedAssetType:t})})):"Equipment"==t?(l=(c=e).rdfsLabel,this.setState({selectedAssetLabel:l,selectedEquipment:c},function(){n.setState({selectedAssetType:t})})):"Component"==t&&(l=(r=e).rdfsLabel,this.setState({selectedAssetLabel:l,selectedComponnet:r},function(){n.setState({selectedAssetType:t})})),document.getElementById("btnShowAssetProfile").click()},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,a=t.instance,u=this.state,m=u.solution,g=u.currentEquipmentIndex,y=u.generatorDevice,v=u.currentTab,O=u.showControllers,E=u.selectedAssetType,C=u.selectedAssetLabel,S=u.selectedComponnet,N=u.selectedDevice,_=u.selectedEquipment,I=u.selectedPoint,j=[];return m&&m.equipmentByTemplate&&m.equipmentByTemplate.length>0&&(j=m.equipmentByTemplate[g||0].devices),l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"card",style:{padding:"1vw"}},l.a.createElement("div",{className:"row m-0"},l.a.createElement("div",{className:"col-md-12 p-0"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-12 padding-5 margin-5"},l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn "+("GUI"==v?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"GUI"})}},l.a.createElement("span",{className:"vertical-align"},"GUI")),l.a.createElement("button",{className:"btn "+("SolutionDiagram"==v?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"SolutionDiagram"})}},l.a.createElement("span",{className:"vertical-align"},"Diagram")),l.a.createElement("button",{className:"btn "+("ADP"==v?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){e.setState({currentTab:"ADP"})}},l.a.createElement("span",{className:"vertical-align"},"ADP"))))),"GUI"==v&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-12 padding-5 margin-5"},l.a.createElement("div",{className:"btn-group"},m&&m.equipmentByTemplate&&m.equipmentByTemplate.map(function(t,n){return l.a.createElement("button",{className:"btn "+(g==n?"btn-custom-fill":"")+" btn-custom-secondary-dark",onClick:function(){var t=m.equipmentTemplatesOntology.split(",")[n];e.fetchEquipmentTemplateFromSolution(n),e.setState({currentEquipmentIndex:n,currentEquipment:t})}},l.a.createElement("span",{className:"vertical-align"},t.equipment.rdfsLabel))})))),l.a.createElement("div",{className:"row"},y&&y.equipmentName&&l.a.createElement(b.a,{building:n,instance:a,equipment:y.rdfsLabel,ontology:y.equipmentName})),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",{className:"row m-0"},l.a.createElement("div",{className:"col-md-12 p-0"},l.a.createElement("div",{className:"panel-heading",style:{backgroundColor:"#174b54",color:"white",borderRadius:"5px"}},l.a.createElement("h4",{className:"panel-title"},l.a.createElement("div",null,l.a.createElement("span",{style:{marginLeft:"15px"}},"Devices'"),l.a.createElement("a",{className:"icn-collapse pull-right color-white","data-toggle":"collapse",id:"btn-collapse1",href:"#collapse1",onClick:function(t){e.setCollapseIcon(t)}},l.a.createElement("i",{className:"fa fa-minus"}))))),l.a.createElement("div",{id:"collapse1",className:"panel-collapse collapse in"},l.a.createElement("div",{className:"panel-body"},l.a.createElement("div",{style:{height:"auto"}},l.a.createElement("div",{className:"padding-10",style:{border:"2px solid gainsboro"}},l.a.createElement("div",{className:"row no-padding"},l.a.createElement("div",{className:"col-md-12"},l.a.createElement("div",{className:"col-md-3 headingText"},"Device"),l.a.createElement("div",{className:"col-md-2 headingText"},"Device Type"),l.a.createElement("div",{className:"col-md-2 headingText"},"Moncon Type"),l.a.createElement("div",{className:"col-md-2 headingText"},"State"),l.a.createElement("div",{className:"col-md-1 headingText"},"ID")))),l.a.createElement("div",{style:{paddingBottom:"1%",border:"1px solid lightgray",padding:"20px"}},j&&j.length>0&&j.map(function(t,r){var i;return i=t.monitoringControlDeviceType&&(-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("relay")||-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("ceiling")||-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("thermo")||-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("intesis")),l.a.createElement("div",{key:r,style:{margin:"2px",border:"1px dotted lightgray",borderRadius:5}},l.a.createElement("div",{className:"padding-10",style:{marginBottom:"1px"},key:r},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-12"},l.a.createElement("div",{className:"col-md-3"},l.a.createElement("a",{title:t.rdfsLabel,style:{color:"slategrey"},onClick:function(){e.showAssetProfile(t,"Device")}},t.rdfsLabel)),l.a.createElement("div",{className:"col-md-2"},t.deviceType),l.a.createElement("div",{className:"col-md-2"},t.monitoringControlDeviceType),l.a.createElement("div",{className:"col-md-2"},t.deviceState),l.a.createElement("div",{className:"col-md-1"},t.deviceID),l.a.createElement("div",{className:"col-md-2"},i&&l.a.createElement("a",{className:"btn-xs btn-success btn active pull-right",style:{marginLeft:"5px"},title:"Show Controller",onClick:function(n){e.getDeviceControllerData(t.deviceName,r,O[g][r])},"data-toggle":"collapse",id:"btn-deviceCollapse"+r,href:"#deviceCollapse"+r}," ",l.a.createElement("i",{className:"fa fa-cogs","aria-hidden":"true"})," ",O[g][r]?"Hide":"Show"," Controller")))),l.a.createElement("div",{id:"deviceCollapse"+r,className:"panel-collapse collapse"},l.a.createElement("div",{className:"row"},O[g][r]&&l.a.createElement("div",{className:"col-md-12"},t.monitoringControlDeviceType&&-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("relay")&&l.a.createElement(s.default,{buildingName:n,instance:a,RelayDeviceName:t.deviceName,hideTabs:!0,type:"Relay"}),t.monitoringControlDeviceType&&-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("ceiling")&&l.a.createElement(c.default,{buildingName:n,instance:a,CeilingSensorBoardName:t.deviceName,type:"Ceiling"}),t.monitoringControlDeviceType&&(-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("thermo")||-1!=t.monitoringControlDeviceType.toLocaleLowerCase().indexOf("inte"))&&l.a.createElement(o.default,{buildingName:n,instance:a,InsightName:t.deviceName,type:"Equipment",hideTabs:!0}))))))})))))))),"SolutionDiagram"==v&&l.a.createElement("div",{style:{border:"1px solid rgb(21, 77, 87)",borderRadius:"1px 1px 8px 1px"}},l.a.createElement(i.a,{buildingName:n,instance:a,SolutionName:"",solution:m,isFullScreenHeight:!1,isRefreshButtonShow:!1})))),l.a.createElement("button",{type:"button",id:"btnShowAssetProfile",className:"btn btn-primary btn-fill","data-toggle":"modal","data-target":"#assetProfileDialog",style:{display:"none"}},"."),l.a.createElement(r.a,{id:"assetProfileDialog",showSaveButton:!1,showCancelButton:!0,isEditForm:!0,heading:C+" Selected"},l.a.createElement("div",{className:"row padding-10"},E&&l.a.createElement("div",{className:"col=md-12"},"Device"==E&&N.deviceName&&l.a.createElement(h.default,{deviceName:N.deviceName,isEdit:!1,isView:!0,instance:a,buildingName:n,deviceType:"Device"==N.deviceType?"Electronic":-1!=N.deviceType.indexOf("Network")?"Network":-1!=N.deviceType.indexOf("Computi")?"Computing":""}),"Point"==E&&I.point&&l.a.createElement(f.default,{isEdit:!1,isView:!0,instance:a,buildingName:n,PointName:I.point}),"Equipment"==E&&_.equipmentName&&l.a.createElement(p.default,{instance:a,buildingName:n,equipmentName:_.equipmentName,workFlowSpaceList:Object(),inspectionOntology:"",showEquipmentInfoOnly:!0}),"Component"==E&&S.name&&l.a.createElement(d.a,{instance:a,buildingName:n,isEdit:!1,component:S,isView:!0})))))))},t}(l.a.Component);t.default=O}});