webpackJsonp([49],{1259:function(e,t,a){"use strict";t.b=function(e,t,a,n){return l(this,void 0,void 0,function(){return c(this,function(l){switch(l.label){case 0:return[4,Object(o.e)({buildingName:e,getArchivedOnly:t,includeArchived:a,workOrderID:n},o.a.WORKORDER.FetchWorkOrders,r.b.WORKORDER)];case 1:return[2,l.sent()]}})})},t.d=function(e,t){return l(this,void 0,void 0,function(){return c(this,function(a){switch(a.label){case 0:return[4,Object(o.f)({workOrderID:e,newStatus:t},o.a.WORKORDER.SetNewStatus,r.b.WORKORDER).then(function(){Object(n.b)("Work Order Updated Successfully.")}).catch(function(e){Object(n.a)("Error occured while saving Work Order.")})];case 1:return[2,a.sent()]}})})},t.a=function(e){return l(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({workOrderID:e},o.a.WORKORDER.ArchiveWorkOrder,r.b.WORKORDER).then(function(){Object(n.b)("Work Order Updated Successfully.")}).catch(function(e){Object(n.a)("Error occured while saving Work Order.")})];case 1:return[2,t.sent()]}})})},t.c=function(e,t,a){return l(this,void 0,void 0,function(){return c(this,function(l){switch(l.label){case 0:return[4,Object(o.f)({buildingName:e,workOrderModel:t,isEdit:a},o.a.WORKORDER.SaveWorkOrder,r.b.WORKORDER).then(function(){Object(n.b)("Work Order "+(a?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(n.a)("Error occured while saving Work Order.")})];case 1:return[2,l.sent()]}})})};var r=a(7),n=a(4),o=a(5),l=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(e){o(e)}}function c(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,c)}s((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var a,r,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],r=0}finally{a=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}},791:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),n=(a.n(r),a(175)),o=a(1259),l=a(34),c=a(173),s=a(13),i=a(26),u=a(93),m=a(7),d=a(9),h=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),f=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))(function(n,o){function l(e){try{s(r.next(e))}catch(e){o(e)}}function c(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?n(e.value):new a(function(t){t(e.value)}).then(l,c)}s((r=r.apply(e,t||[])).next())})},p=this&&this.__generator||function(e,t){var a,r,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],r=0}finally{a=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},v=new Date,E=function(e){function t(t){var a=e.call(this,t)||this;return a.state={workOrder:Object(),locationList:[],assets:[],people:[],isEdit:!1},a._fetchWorkOrder=a._fetchWorkOrder.bind(a),a._getLocationsList=a._getLocationsList.bind(a),a._fetchPeople=a._fetchPeople.bind(a),a.handleFormChange=a.handleFormChange.bind(a),a.handleDueDateChange=a.handleDueDateChange.bind(a),a._getAssets=a._getAssets.bind(a),a}return h(t,e),t.prototype.componentDidMount=function(){return f(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchWorkOrder()]:[3,5];case 1:return e.sent(),[4,this._getLocationsList()];case 2:return e.sent(),[4,this._fetchPeople()];case 3:return e.sent(),[4,this._getAssets()];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.prototype._saveWorkOrder=function(){return f(this,void 0,void 0,function(){var e,t,a,r,n,l;return p(this,function(c){switch(c.label){case 0:return e=this.state,t=e.workOrder,a=e.isEdit,r=this.props,n=r.instance,l=r.buildingName,t&&t.workOrder?(Object(s.a)(!0),[4,Object(o.c)(l,t,a)]):[3,2];case 1:c.sent(),Object(s.a)(!1),window.location.hash=n+"/"+l+"/WorkOrders",c.label=2;case 2:return[2]}})})},t.prototype._getAssets=function(){return f(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,Object(u.e)(this.props.buildingName,m.b.WORKORDER)];case 1:return e=t.sent(),this.setState({assets:e}),[2]}})})},t.prototype._fetchPeople=function(){return f(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,Object(c.m)(this.props.buildingName)];case 1:return e=t.sent(),this.setState({people:e}),[2]}})})},t.prototype._getLocationsList=function(){return f(this,void 0,void 0,function(){var e,t=this;return p(this,function(a){switch(a.label){case 0:return e=this.props.buildingName,[4,Object(l.b)(e).then(function(e){t.setState({locationList:e})})];case 1:return a.sent(),[2]}})})},t.prototype.handleFormChange=function(e){if(!this.props.isView){var t=this.state.workOrder;t[""+e.target.name]=e.target.value,this.setState({workOrder:t})}},t.prototype._fetchWorkOrder=function(){return f(this,void 0,void 0,function(){var e,t;return p(this,function(a){return e=Object(),t=!(!this.props.workOrderNo||this.props.isView),e.workOrder=(new Date).WO_Number(),e.dueDate=(new Date).toString(),this.props.workOrderNo&&Object(o.b)(this.props.buildingName,!1,!0,this.props.workOrderNo).then(function(t){if(t&&t.length>0){var a=t[0];e.assignee=a.assignee?a.assignee.value:"",e.assigneeName=a.assigneeName?a.assigneeName.value:"",e.category=a.category?a.category.value:"",e.createdDate=a.createdDate?a.createdDate.value:"",e.description=a.description?a.description.value:"",e.dueDate=a.dueDate?a.dueDate.value:"",e.duration=a.duration?a.duration.value:"",e.lastEdit=a.lastEdit?a.lastEdit.value:"",e.location=a.location?a.location.value:"",e.priority=a.priority?a.priority.value:"",e.status=a.status?a.status.value:"",e.title=a.title?a.title.value:"",e.workOrder=a.workOrder?a.workOrder.value:"",e.isArchived=!(!a.workOrder||"true"!=a.workOrder.value),e.asset=a.asset?a.asset.value:"",e.additionalWorkers=a.additionalWorkers?a.additionalWorkers.value:""}}),this.setState({workOrder:e,isEdit:t}),[2]})})},t.prototype.handleDueDateChange=function(e){var t=this.state.workOrder;v=e,t.dueDate=e.toString(),this.setState({workOrder:t})},t.prototype.render=function(){var e=this,t=this.props,a=t.isView,o=t.instance,l=t.buildingName,c=t.workOrderNo,s=this.state,u=s.workOrder,m=s.locationList,h=s.people,f=s.assets,p=JSON.parse(d.a.getItem("user")),E=Object(i.b)(p,"work-wo","write"),b=u&&u.title&&u.status&&u.dueDate&&u.priority&&u.assignee&&u.location&&u.asset&&!0;return r.createElement("div",{className:"content "+(E&&a?"overlay":"")},r.createElement("div",{className:"card"},r.createElement("div",{className:"container-fluid"},r.createElement("div",{className:"header"},r.createElement("h4",{className:"title"},a?u.workOrder+" details":"Create Work Order")),r.createElement("br",null),r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"workOrder"},"Work Order #")),r.createElement("div",{className:"col-md-4 col-xs-12"},r.createElement("input",{disabled:!0,type:"text",className:"form-control",name:"title",value:u.workOrder}))),r.createElement("div",{className:"row form-group"},a&&r.createElement("div",{className:"col-md-6 col-xs-12 pull-right"},r.createElement("div",{className:"col-md-6 col-xs-12"},r.createElement("img",{src:"https://via.placeholder.com/200"})),r.createElement("div",{className:"col-md-3 col-xs-6"},E&&r.createElement("button",{className:"btn btn-primary",onClick:function(){return window.location.hash=o+"/"+l+"/WorkOrder/"+c+"/Edit"}},r.createElement("i",{className:"fa fa-edit"})," Edit")),r.createElement("div",{className:"col-md-3 col-xs-6"},r.createElement("button",{className:"btn btn-secondary",onClick:function(){return window.location.hash=o+"/"+l+"/PurchaseOrders/"+c}},"Related PO's"))),r.createElement("div",{className:a?"col-md-6 col-xs-12 ":"col-md-6 col-md-offset-right-5 col-xs-12 "},r.createElement("div",{className:"col-md-12 col-xs-12 no-padding"},r.createElement("div",{className:"col-md-12 col-xs-12 no-padding"},r.createElement("label",{htmlFor:"title"},"Title:")),r.createElement("div",{className:"col-md-11 col-xs-11 no-padding"},r.createElement("input",{type:"text",className:"form-control",name:"title",value:u.title,onChange:function(t){return e.handleFormChange(t)}})),r.createElement("div",{className:"col-md-1 col-xs-1"},r.createElement("label",null,r.createElement("i",{className:"fa fas fa-asterisk"}))))),r.createElement("div",{className:"col-md-6 col-xs-12 "},r.createElement("div",{className:"col-md-12 col-xs-12 no-padding"},r.createElement("label",{htmlFor:"description"},"Description")),r.createElement("div",{className:"col-md-11 col-xs-11 no-padding"},r.createElement("textarea",{className:"form-control",name:"description",value:u.description,onChange:function(t){return e.handleFormChange(t)}})))),!a&&r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-6 col-xs-12",id:"divAddImage"},r.createElement("label",{htmlFor:""},"Add image"),r.createElement("br",null),r.createElement("button",{className:"btn btn-primary btn-fill"},r.createElement("i",{className:"fa fa-camera"})," Take Photo or Video"),r.createElement("button",{className:"btn btn-primary btn-fill"},r.createElement("i",{className:"fa fa-image"})," Choose From"))),r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"status"},"Status")),r.createElement("div",{className:"col-md-3 col-xs-11"},r.createElement("select",{className:"form-control",value:u.status,id:"status",name:"status",onChange:function(t){return e.handleFormChange(t)}},r.createElement("option",{value:""},"Select Status"),r.createElement("option",{value:"open"},"Open"),r.createElement("option",{value:"inprogress"},"In Progress"),r.createElement("option",{value:"onhold"},"On Hold"),r.createElement("option",{value:"pending"},"Pending"),r.createElement("option",{value:"completed"},"Completed"),r.createElement("option",{value:"canceled"},"Canceled"))),r.createElement("div",{className:"col-md-1 col-xs-1"},r.createElement("label",null,r.createElement("i",{className:"fa fas fa-asterisk"}))),r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"dueDate"},"Due Date")),r.createElement("div",{className:"col-md-4 col-xs-12"},r.createElement(n.a,{disabled:a,id:"dueDate",className:"form-control",selected:v,onChange:function(t){return e.handleDueDateChange(t)},showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,dateFormat:"MMMM d, yyyy h:mm aa",timeCaption:"time",customInput:r.createElement("input",{type:"text",className:"form-control",placeholder:"Due Date","aria-label":"","aria-describedby":"button-addon4",value:u.dueDate})}))),r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"duration"},"Estimated Duration (hours)")),r.createElement("div",{className:"col-md-4 col-xs-12"},r.createElement("input",{type:"number",className:"form-control",min:0,name:"duration",value:u.duration,onChange:function(t){return e.handleFormChange(t)}})),r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"priority"},"Priority")),r.createElement("div",{className:"col-md-3 col-xs-11"},r.createElement("select",{className:"form-control",name:"priority",value:u.priority,onChange:function(t){return e.handleFormChange(t)}},r.createElement("option",{value:""},"None"),r.createElement("option",{value:"Low"},"Low"),r.createElement("option",{value:"Medium"},"Medium"),r.createElement("option",{value:"High"},"High"),r.createElement("option",{value:"Critical Path"},"Critical Path"))),r.createElement("div",{className:"col-md-1 col-xs-1"},r.createElement("label",null,r.createElement("i",{className:"fa fas fa-asterisk"})))),r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"category"},"Category")),r.createElement("div",{className:"col-md-4 col-xs-12"},r.createElement("input",{type:"text",className:"form-control",name:"category",value:u.category,onChange:function(t){return e.handleFormChange(t)}})),r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"assignee"},"Assigned To")),r.createElement("div",{className:"col-md-3 col-xs-11"},r.createElement("select",{className:"form-control",name:"assignee",value:u.assignee,onChange:function(t){return e.handleFormChange(t)}},r.createElement("option",{value:""},"Select Person"),h.map(function(e,t){return r.createElement("option",{key:t,value:e.contact.value},e.name.value," ",e.group&&"- ("+e.group.value+")"," ")}))),r.createElement("div",{className:"col-md-1 col-xs-1"},r.createElement("label",null,r.createElement("i",{className:"fa fas fa-asterisk"})))),r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"additionalWorkers"},"Additional Workers")),r.createElement("div",{className:"col-md-4 col-xs-12"},r.createElement("input",{type:"text",className:"form-control",name:"additionalWorkers",value:u.additionalWorkers,onChange:function(t){return e.handleFormChange(t)}}))),r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"location"},"Location")),r.createElement("div",{className:"col-md-3 col-xs-11"},r.createElement("select",{className:"form-control",name:"location",value:u.location,onChange:function(t){return e.handleFormChange(t)}},r.createElement("option",{value:""},"Select Location"),m.map(function(e,t){return r.createElement("option",{value:e.ontology.value,key:t},e.rdfsLabel.value," ")}))),r.createElement("div",{className:"col-md-1 col-xs-1"},r.createElement("label",null,r.createElement("i",{className:"fa fas fa-asterisk"}))),r.createElement("div",{className:"col-md-2 col-xs-12"},r.createElement("label",{htmlFor:"asset"},"Asset")),r.createElement("div",{className:"col-md-3 col-xs-11"},r.createElement("select",{className:"form-control",name:"asset",value:u.asset,onChange:function(t){return e.handleFormChange(t)}},r.createElement("option",{value:""},"Select Asset"),f.map(function(e,t){return r.createElement("option",{value:e.ontology.value,key:t},e.rdfsLabel.value," ")}))),r.createElement("div",{className:"col-md-1 col-xs-1"},r.createElement("label",null,r.createElement("i",{className:"fa fas fa-asterisk"})))),!a&&r.createElement("div",{className:"row form-group"},r.createElement("div",{className:"col-md-12 inline-flex"},r.createElement("button",{className:"btn btn-primary btn-fill",disabled:!b,onClick:function(){e._saveWorkOrder()}},r.createElement("i",{className:"fa fa-save"})," Save"),r.createElement("button",{className:"btn btn-secondary btn-fill",onClick:function(){window.location.hash=o+"/"+l+"/WorkOrders"}},r.createElement("i",{className:"fa fa-window-close"})," Cancel"))))))},t}(r.Component);t.default=E}});