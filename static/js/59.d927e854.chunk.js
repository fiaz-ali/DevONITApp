webpackJsonp([59],{1768:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),r=(n.n(a),n(600)),c=n(604),o=n(1082),i=n(21),s=n(99),l=n(29),d=n(612),m=n(22),u=n(10),b=n(607),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),p=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(r,c){function o(e){try{s(a.next(e))}catch(e){c(e)}}function i(e){try{s(a.throw(e))}catch(e){c(e)}}function s(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,i)}s((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,r,c,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&c[0]?a.return:c[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,c[1])).done)return r;switch(a=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,a=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===c[0]||2===c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],a=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={_vendors:[],isEdit:!1,vendorObj:Object(),vendorToDelete:Object()},n.createVendor=n.createVendor.bind(n),n.deleteVendor=n.deleteVendor.bind(n),n.onDeleteVendor=n.onDeleteVendor.bind(n),n.onEditVendor=n.onEditVendor.bind(n),n.fetchVendors=n.fetchVendors.bind(n),n.handleVendorChange=n.handleVendorChange.bind(n),n}return h(t,e),t.prototype.componentDidMount=function(){return p(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this.fetchVendors()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.fetchVendors=function(){return p(this,void 0,void 0,function(){var e=this;return f(this,function(t){switch(t.label){case 0:return Object(s.a)(!0),[4,Object(b.n)(this.props.buildingName).then(function(t){e.setState({_vendors:t&&t.filter(function(e){return"Vendor"==Object(i.g)(e.group)}),vendorObj:Object()})}).catch(function(e){return e})];case 1:return t.sent(),Object(s.a)(!1),[2]}})})},t.prototype.createVendor=function(){return p(this,void 0,void 0,function(){var e,t,n,a,r=this;return f(this,function(c){switch(c.label){case 0:return e=this.state,t=e.vendorObj,n=e.isEdit,[4,Object(l.s)(Object(l.v)(t.contact),["Vendor"])];case 1:return c.sent()&&!n?[3,5]:t?(Object(s.a)(!0),(a=this.state.vendorObj).role="3",a.group="Vendor",a.groups=[{label:"Vendor",value:"Vendor"}],a.facilityAssignedTo=[{value:this.props.buildingName,label:""}],a?[4,Object(b.g)(this.props.buildingName,a,!1).then(function(e){a.contact="",a.name="",a.mobile="",a.zipcode="",a.email="",a.streetAddress="",a.company="",a.city="",a.state=""})]:[3,3]):[3,4];case 2:c.sent(),c.label=3;case 3:this.setState({vendorObj:a},function(){r.fetchVendors()}),Object(s.a)(!1),c.label=4;case 4:return[3,6];case 5:alert("title already exists, please change title"),c.label=6;case 6:return[2]}})})},t.prototype.deleteVendor=function(){return p(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return e=this.state.vendorToDelete,[4,Object(l.e)(Object(i.g)(e.contact),m.b.VENDOR)];case 1:return t.sent(),[4,this.fetchVendors()];case 2:return t.sent(),[2]}})})},t.prototype.onDeleteVendor=function(e){this.setState({vendorToDelete:e})},t.prototype.onEditVendor=function(e){var t=this.state.vendorObj;t.contact=Object(i.g)(e.contact),t.name=Object(i.g)(e.name),t.streetAddress=Object(i.g)(e.street),t.city=Object(i.g)(e.city),t.state=Object(i.g)(e.state),t.zipcode=Object(i.g)(e.zipcode),t.company=Object(i.g)(e.company),t.role=Object(i.g)(e.role),t.contact=Object(i.g)(e.contact),t.notes=Object(i.g)(e.notes),t.email=Object(i.g)(e.email),this.setState({isEdit:!0,vendorObj:t},function(){document.getElementById("btnOpenVendorForm").click()})},t.prototype.handleVendorChange=function(e){},t.prototype.render=function(){var e=this,t=(this.props,this.state),n=t.isEdit,s=t._vendors,l=t.vendorObj,m=JSON.parse(u.a.getItem("user")),b=Object(d.b)(m,"work-vendor","write"),h=l&&l.name&&l.contact&&!0;return a.createElement("div",{className:"content"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},b&&a.createElement("button",{type:"button",className:"btn btn-dark pull-right",onClick:function(){var t=Object();e.setState({isEdit:!1,vendorObj:t},function(){document.getElementById("btnOpenVendorForm").click()})}},a.createElement("i",{className:"fa fa-plus"}),"  Create New Vendor "))),a.createElement("br",null),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"card",id:"VendorsList"},a.createElement("div",{className:"header"},a.createElement("h4",{className:"title"},"Vendors")),a.createElement("div",{className:"content"},a.createElement("div",{className:"dataCard"},a.createElement("button",{type:"button",id:"btnOpenVendorForm",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#vendorFormDialog"}," ."),a.createElement(r.a,{id:"vendorFormDialog",onSaveButtonClick:function(){e.createVendor()},saveButtonText:"Save",disableSaveButton:!h},a.createElement(o.a,{instance:this.props.instance,buildingName:this.props.buildingName,isEdit:n,handleVendorChange:this.handleVendorChange})),a.createElement("div",{className:"row hidden-xs"},a.createElement("div",{className:b?"col-sm-9":"col-sm-12"},a.createElement("div",{className:"col-sm-3 headingText"},"Name"),a.createElement("div",{className:"col-sm-3 headingText"},"Company "),a.createElement("div",{className:"col-sm-2 headingText"},"Street"),a.createElement("div",{className:"col-sm-2 headingText"},"City"),a.createElement("div",{className:"col-sm-2 headingText"},"State/Zip")),a.createElement("div",{className:"col-sm-3 headingText"})),a.createElement(c.a,{instance:this.props.instance,id:"ConfirmDeleteDialog",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this Vendor?",heading:"Confirm...",onConfirmButtonClick:function(){e.deleteVendor()}}),s.map(function(t,n){return a.createElement("div",{key:n,className:"row"},a.createElement("div",{className:b?"col-sm-9":"col-sm-12"},a.createElement("div",{className:"col-sm-3 trim-data",title:Object(i.g)(t.name)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Name")," ",Object(i.g)(t.name)),a.createElement("div",{className:"col-sm-3 trim-data",title:Object(i.g)(t.company)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Company"),Object(i.g)(t.company)),a.createElement("div",{className:"col-sm-2 trim-data",title:Object(i.g)(t.street)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"Street"),Object(i.g)(t.street)),a.createElement("div",{className:"col-sm-2 trim-data",title:Object(i.g)(t.city)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"City")," ",Object(i.g)(t.city)),a.createElement("div",{className:"col-sm-2 trim-data",title:Object(i.g)(t.state)+", "+Object(i.g)(t.zipcode)},a.createElement("span",{className:"hidden visible-xs-inline headingText"},"State")," ",Object(i.g)(t.state)+", "+Object(i.g)(t.zipcode))),b&&a.createElement("div",{className:"col-sm-3 col-xs-12"},a.createElement("button",{className:"btn-xs btn-danger btn-fill","data-toggle":"modal","data-target":"#ConfirmDeleteDialog",onClick:function(n){e.onDeleteVendor(t)}},a.createElement("i",{className:"fa fa-trash"})," Delete "),a.createElement("button",{className:"btn-xs btn-success btn-fill",onClick:function(){e.onEditVendor(t)}},a.createElement("i",{className:"fa fa-edit"})," Edit ")))}))))))))},t}(a.Component);t.default=v}});