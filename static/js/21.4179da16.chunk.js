webpackJsonp([21],{1027:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"rcxInspectionLabels",function(){return O}),n.d(t,"rcxCleanlinessLabels",function(){return E});var o,i,a=n(2),r=(n.n(a),n(747)),s=n(910),c=n(911),l=n(1076),u=n(11),d=n(122),p=n(706),m=n(738),h=n(740),f=n(756),b=n(20),C=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),g=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((o=o.apply(e,t||[])).next())})},v=this&&this.__generator||function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},y=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],r=0,s=a.length;r<s;r++,i++)o[i]=a[r];return o},O=["Appropriate Schedule","Sensors or Actuators Calibrated","Equal Load Distribution Across Equipment","Ventilation Rates are Appropriate","Automatic Reset Functioning","Adjustments Made to Compensate for Oversized/Undersized Equip","No Unintended Simultaneous Cooling/Heating Occurs","Economizer Controls Functioning Properly","Air/Water Distribution Balanced","Light Levels are Appropriate","Light Sensors and Controls are Function Properly","DHW Temp. Settings are Correct","Water Pumps Properly Functioning","There Are No Water/Air Leaks","Other","Vents/Ducts/Coils Are Clean","Filters/Steam Traps are Clean","Components in Good Condition (belts, bearings, pulleys, etc.)","Proper Insulation/Sealant Where Required"],E=["Vents/Ducts/Coils Are Clean","Filters/Steam Traps are Clean","Components in Good Condition (belts, bearings, pulleys, etc.)","Proper Insulation/Sealant Where Required","Other"],N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={activeTab:"Proposed RCX",rcxObj:{currentSchedule:[],adjustedSchedule:[],currentConditionsCleanliness:[],currentConditionsInspections:[],rcxtasksCleanliness:[],rcxtasksInspections:[]},isCompleted:!1,inspectionOntologies:[],SolutionList:[],newCCLabelCreated:!1},o=n,n._saveCurrentConditions=n._saveCurrentConditions.bind(n),n.handleCurrentScheduler=n.handleCurrentScheduler.bind(n),n.handleAdjustedScheduler=n.handleAdjustedScheduler.bind(n),n.handleCCItems=n.handleCCItems.bind(n),n.handleRcxIncpectionItems=n.handleRcxIncpectionItems.bind(n),n.handleAddNewCCNote=n.handleAddNewCCNote.bind(n),n.handleRcxCleanlinessItems=n.handleRcxCleanlinessItems.bind(n),n._saveRCXTaskList=n._saveRCXTaskList.bind(n),n._fetchPreRCX=n._fetchPreRCX.bind(n),n._fetchPostRCX=n._fetchPostRCX.bind(n),n.updateTaskChecklist=n.updateTaskChecklist.bind(n),n.fetchInspection_IsComplete=n.fetchInspection_IsComplete.bind(n),n.unComplete=n.unComplete.bind(n),n._getSolutionList=n._getSolutionList.bind(n),n.sortRCXObj=n.sortRCXObj.bind(n),n}return C(t,e),t.prototype.componentWillUnmount=function(){return g(this,void 0,void 0,function(){return v(this,function(e){return clearInterval(i),[2]})})},t.prototype.componentDidMount=function(){return g(this,void 0,void 0,function(){var e,t,n,o,a,r=this;return v(this,function(s){switch(s.label){case 0:return e=this.props,t=e.buildingName,n=e.infoEntity,o=e.entityName,t&&n&&o?[4,this.fetchInspection_IsComplete()]:[3,2];case 1:a=s.sent(),this.setState({isCompleted:a},function(){return g(r,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._fetchPreRCX()];case 1:return e.sent(),[4,this._fetchPostRCX()];case 2:return e.sent(),[2]}})})}),s.label=2;case 2:return this._getSolutionList(),i=setInterval(function(){var e=Object(f.a)("inspectionOntology");e!=Object(f.a)("inspectionOntology_Old")&&(Object(f.b)("inspectionOntology_Old",e),r._getSolutionList())},3e5),[2]}})})},t.prototype._getSolutionList=function(){return g(this,void 0,void 0,function(){var e,t=this;return v(this,function(n){switch(n.label){case 0:return e=Object(f.a)("inspectionOntology"),[4,Object(h.u)(e).then(function(e){t.setState({SolutionList:e})})];case 1:return n.sent(),[2]}})})},t.prototype.fetchInspection_IsComplete=function(){return g(this,void 0,void 0,function(){var e,t,n,o,i,a;return v(this,function(r){switch(r.label){case 0:return e=this.props.entityName,t=Object(f.a)("inspectionOntology"),[4,Object(m.h)(e,"RCX",t)];case 1:return n=r.sent(),o=this.state,i=o.isCompleted,a=o.inspectionOntologies,n?(i="true"==Object(u.g)(n.IsCompleted),a=Object(u.g)(n.inspectionOntology).split(","),this.setState({isCompleted:i,inspectionOntologies:a}),[2,i]):[2,!1]}})})},t.prototype._fetchPreRCX=function(){return g(this,void 0,void 0,function(){var e,t,n,i,a,r,s,c,d=this;return v(this,function(p){switch(p.label){case 0:return e=this.props,t=e.buildingName,n=e.infoEntity,i=e.entityName,a=Object(f.a)("inspectionOntology"),r=this.state.rcxObj,s=[],c=[],[4,Object(l.d)(t,i,n).then(function(e){if(e){var t=e.filter(function(e){return Object(u.g)(e.inspection)==a});t&&t.map(function(e){var t=Object(u.g)(e.type),n={ccBoolean:"true"==Object(u.g)(e.ccBoolean),ccLabel:Object(u.g)(e.ccLabel),photo:Object(u.g)(e.photo),preRCXName:Object(u.g)(e.preRCXName),entryTimeStamp:Object(u.g)(e.entryTimeStamp),proposedRCX:Object(u.g)(e.proposedRCX)};"cleanliness"!=t.toLocaleLowerCase()||s.find(function(e){return e.preRCXName==n.preRCXName})?"inspection"!=t.toLocaleLowerCase()||c.find(function(e){return e.preRCXName==n.preRCXName})||c.push(n):s.push(n)}),r.currentConditionsCleanliness=s,r.currentConditionsInspections=c,r=d.updateTaskChecklist(r),o.setState({rcxObj:r})}})];case 1:return p.sent(),[2]}})})},t.prototype._fetchPostRCX=function(){return g(this,void 0,void 0,function(){var e,t,n,i,a,r,s,c,d=this;return v(this,function(p){switch(p.label){case 0:return e=this.props,t=e.buildingName,n=e.infoEntity,i=e.entityName,a=this.state.rcxObj,r=a.rcxtasksCleanliness,s=a.rcxtasksInspections,(c=y(r.map(function(e){return e.preRCXName})))&&c.length>0?[4,Object(l.c)(t,i,n,c).then(function(e){e.map(function(e){var t=r.find(function(t){return t.preRCXName==Object(u.g)(e.preRCXName)});t&&(t.photo=Object(u.g)(e.photo),t.entryTimeStamp=Object(u.g)(e.entryTimeStamp),t.notesMeasurement=Object(u.g)(e.notesMeasurement),t.ccBoolean="true"==Object(u.g)(e.ccBoolean),r.splice(r.findIndex(function(t){return t.preRCXName==Object(u.g)(e.preRCXName)}),1),r.push(t))}),a.rcxtasksCleanliness=r,a=d.sortRCXObj(a),o.setState({rcxObj:a})})]:[3,2];case 1:p.sent(),p.label=2;case 2:return c=[],(c=y(s.map(function(e){return e.preRCXName})))&&c.length>0?[4,Object(l.c)(t,i,n,c).then(function(e){e.map(function(e){var t=s.find(function(t){return t.preRCXName==Object(u.g)(e.preRCXName)});t&&(t.photo=Object(u.g)(e.photo),t.entryTimeStamp=Object(u.g)(e.entryTimeStamp),t.notesMeasurement=Object(u.g)(e.notesMeasurement),t.ccBoolean="true"==Object(u.g)(e.ccBoolean),s.splice(s.findIndex(function(t){return t.preRCXName==Object(u.g)(e.preRCXName)}),1),s.push(t))}),a.rcxtasksInspections=s,a=d.sortRCXObj(a),o.setState({rcxObj:a})})]:[3,4];case 3:p.sent(),p.label=4;case 4:return[2]}})})},t.prototype.updateTaskChecklist=function(e){var t=y(e.rcxtasksInspections);e.rcxtasksInspections=[],e.currentConditionsInspections&&e.currentConditionsInspections.map(function(n){var o=t.find(function(e){return e.preRCXName==n.preRCXName});o&&n.preRCXName?(o.proposedRCX=n.proposedRCX,e.rcxtasksInspections.push(o)):e.rcxtasksInspections.push({postRCXName:Object(b.D)(8),preRCXName:n.preRCXName,proposedRCX:n.proposedRCX,ccLabel:n.ccLabel.toString(),entryTimeStamp:void 0,photo:"",notesMeasurement:"",ccBoolean:n.ccBoolean})});var n=y(e.rcxtasksCleanliness);return e.rcxtasksCleanliness=[],e.currentConditionsCleanliness&&e.currentConditionsCleanliness.map(function(t){var o=n.find(function(e){return e.preRCXName==t.preRCXName});o&&t.preRCXName?(o.proposedRCX=t.proposedRCX,e.rcxtasksCleanliness.push(o)):e.rcxtasksCleanliness.push({postRCXName:Object(b.D)(8),preRCXName:t.preRCXName,proposedRCX:t.proposedRCX,ccLabel:t.ccLabel.toString(),entryTimeStamp:void 0,photo:"",notesMeasurement:"",ccBoolean:t.ccBoolean})}),e=this.sortRCXObj(e)},t.prototype.sortRCXObj=function(e){return e.currentConditionsInspections.sort(function(e,t){return e.ccLabel>t.ccLabel?1:-1}),e.rcxtasksInspections.sort(function(e,t){return e.ccLabel>t.ccLabel?1:-1}),e.rcxtasksCleanliness.sort(function(e,t){return e.ccLabel>t.ccLabel?1:-1}),e},t.prototype.handleCurrentScheduler=function(e){var t=this.state.rcxObj;t.currentSchedule=e,this.setState({rcxObj:t})},t.prototype.handleAdjustedScheduler=function(e){var t=this.state.rcxObj;t.adjustedSchedule=e,this.setState({rcxObj:t})},t.prototype.handleCCItems=function(e,t){return g(this,void 0,void 0,function(){var n;return v(this,function(o){return n=this.state.rcxObj,"inspection"==t.toLocaleLowerCase()?n.currentConditionsInspections=e:n.currentConditionsCleanliness=e,n=this.updateTaskChecklist(n),this.setState({rcxObj:n}),[2]})})},t.prototype.handleAddNewCCNote=function(e,t){return g(this,void 0,void 0,function(){var n,o,i,a,r;return v(this,function(s){return n={preRCXName:Object(b.D)(8),ccBoolean:!1,ccLabel:e,proposedRCX:"",photo:"",entryTimeStamp:void 0},o=this.state.rcxObj,"inspection"==t.toLocaleLowerCase()?(o.currentConditionsInspections||(o.currentConditionsInspections=[]),(i=o.currentConditionsInspections.filter(function(e){return-1!=e.ccLabel.indexOf(n.ccLabel)}).length)>0&&(n.ccLabel=n.ccLabel+" - "+(i+1)),(a=o.currentConditionsInspections).push.apply(a,[n])):(o.currentConditionsCleanliness||(o.currentConditionsCleanliness=[]),(i=o.currentConditionsCleanliness.filter(function(e){return-1!=e.ccLabel.indexOf(n.ccLabel)}).length)>0&&(n.ccLabel=n.ccLabel+" - "+(i+1)),(r=o.currentConditionsCleanliness).push.apply(r,[n])),o=this.updateTaskChecklist(o),this.setState({rcxObj:o,newCCLabelCreated:!0}),[2]})})},t.prototype.handleRcxIncpectionItems=function(e,t){var n=this.state.rcxObj;"inspection"==t.toLocaleLowerCase()?n.rcxtasksInspections=e:n.rcxtasksCleanliness=e,this.setState({rcxObj:n})},t.prototype.handleRcxCleanlinessItems=function(e){var t=this.state.rcxObj;t.rcxtasksCleanliness=e,this.setState({rcxObj:t})},t.prototype._saveCurrentConditions=function(e){return g(this,void 0,void 0,function(){var t,n,o,i,a,r,s,c,u,p,h=this;return v(this,function(b){switch(b.label){case 0:return Object(d.a)(!0),t=this.state,n=t.rcxObj,o=t.inspectionOntologies,i=t.SolutionList,a=this.props,r=a.buildingName,s=a.infoEntity,c=a.entityName,u=a.instance,p=Object(f.a)("inspectionOntology"),[4,Object(l.f)(r,s,c,n,p,!0,i,e)];case 1:return b.sent(),this.setState({rcxObj:n},function(){return g(h,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?p?(o.push(p),[4,Object(m.c)(c,o,"RCX")]):[3,2]:[3,3];case 1:t.sent(),t.label=2;case 2:switch(s){case"Equip":window.location.hash=u+"/"+r+"/Assets";break;case"Space":window.location.hash=u+"/"+r+"/Space";break;default:return[2,!1]}t.label=3;case 3:return[2]}})})}),Object(d.a)(!1),[2]}})})},t.prototype._saveRCXTaskList=function(e){return g(this,void 0,void 0,function(){var t,n,o,i,a,r,s,c,u,p,h=this;return v(this,function(b){switch(b.label){case 0:return Object(d.a)(!0),t=this.state,n=t.rcxObj,o=t.inspectionOntologies,i=t.SolutionList,t.newCCLabelCreated?[4,this._saveCurrentConditions(!1)]:[3,2];case 1:b.sent(),b.label=2;case 2:return a=this.props,r=a.buildingName,s=a.infoEntity,c=a.entityName,u=a.instance,p=Object(f.a)("inspectionOntology"),[4,Object(l.e)(r,s,c,n,!0,i,e)];case 3:return b.sent(),this.setState({rcxObj:n,newCCLabelCreated:!1},function(){return g(h,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?p?(o.push(p),[4,Object(m.c)(c,o,"RCX")]):[3,2]:[3,3];case 1:t.sent(),t.label=2;case 2:switch(s){case"Equip":window.location.hash=u+"/"+r+"/Assets";break;case"Space":window.location.hash=u+"/"+r+"/Space";break;default:return[2,!1]}t.label=3;case 3:return[2]}})})}),Object(d.a)(!1),[2]}})})},t.prototype.unComplete=function(){return g(this,void 0,void 0,function(){var e,t,n,o;return v(this,function(i){switch(i.label){case 0:if(e=this.props.entityName,t=this.state.inspectionOntologies,n=Object(f.a)("inspectionOntology"),!(t&&t.length>0))return[3,2];if(!n)return[3,2];for(o=0;o<t.length;o++)t[o]==n&&t.splice(o,1);return[4,Object(m.k)(e,t,"RCX")];case 1:i.sent(),i.label=2;case 2:return this.setState({isCompleted:!1}),[2]}})})},t.prototype.render=function(){var e=this,t=this.props,n=t.buildingName,o=t.instance,i=t.entityName,l=t.infoEntity,u=t.viewOnly,d=this.state,m=d.activeTab,h=d.rcxObj,C=d.isCompleted,y=d.inspectionOntologies.find(function(e){return e==N}),N=Object(f.a)("inspectionOntology"),w=!!(y&&y.length>0);return a.createElement("div",{className:"content",style:{width:"100%"}},a.createElement("div",{className:"container-fluid",style:{width:"100%"}},a.createElement("div",{className:"row"},!u&&a.createElement("div",{className:"col-md-12"},a.createElement(r.a,{instance:this.props.instance,buildingName:n,tabName:l,showComponentButton:"Equip"==l,itemName:i,showAuditTypes:!0,showBIMButtons:!0})),a.createElement("div",{className:"card"},a.createElement("div",{className:"container-fluid padding-10"},!u&&a.createElement("div",{className:"col-md-12 padding-10"},a.createElement("div",{className:"btn-group"},a.createElement("button",{className:"btn "+("Proposed RCX"==m?"btn-fill":"")+" btn-dark",onClick:function(){e.setState({activeTab:"Proposed RCX"})}},"Proposed RCX"),a.createElement("button",{className:"btn "+("RCX Findings"==m?"btn-fill":"")+" btn-dark",onClick:function(){e.setState({activeTab:"RCX Findings"})}},"RCX Findings")),a.createElement("div",{className:"pull-right"},a.createElement(p.a,{ElementID:"retroCommissioning",data:this.state.rcxObj,filename:"Retro-Commissioning - "+Object(b.y)(i),beforeExportPdfClick:function(){$("#currentconditions").css("display","block"),$("#checklist").css("display","block")},afterExportPdfClick:function(){"Proposed RCX"==m?$("#currentconditions").css("display","block"):$("#currentconditions").css("display","none"),"RCX Findings"==m?$("#checklist").css("display","block"):$("#checklist").css("display","none")}}))),a.createElement("div",{className:"col-md-12 padding-10",id:"retroCommissioning"},a.createElement("div",{className:"col-md-12 padding-10"},a.createElement("h3",{style:{margin:10}},"Retro-Commissioning - ",Object(b.y)(i))),a.createElement("div",{style:{display:"Proposed RCX"==m||u?"block":"none"},id:"currentconditions",className:"col-md-12 padding-10"},a.createElement("div",{className:"col-md-12 padding-10"},a.createElement("h4",{className:"title"},a.createElement("u",null,"Proposed RCX"))),a.createElement("div",{className:"col-md-12 padding-10",style:{}},a.createElement("h4",{className:"title"},"Inspections"),a.createElement("div",{className:"col-md-12 padding-10"},a.createElement(s.a,{handleAdder:this.handleCCItems,isInspectionOrCleanliness:"inspection",buildingName:n,instance:o,rcxOf:l,currentConditions:h.currentConditionsInspections,labels:O.sort(function(e,t){return e>t?1:-1}),entityName:i,infoEntity:l,isView:u,isFromReport:u}))),a.createElement("div",{className:"col-md-12 padding-10 ",style:{}},a.createElement("h4",{className:"title"},"Cleanliness"),a.createElement("div",{className:"col-md-12 padding-10"},a.createElement(s.a,{handleAdder:this.handleCCItems,isInspectionOrCleanliness:"cleanliness",buildingName:n,instance:o,rcxOf:l,currentConditions:h.currentConditionsCleanliness,labels:E.sort(function(e,t){return e>t?1:-1}),entityName:i,infoEntity:l,isView:u,isFromReport:u}))),!u&&a.createElement("div",{className:"col-md-12 padding-10 ","data-html2canvas-ignore":"true"},a.createElement("div",{className:"form-group"},a.createElement("button",{className:"btn btn-primary btn-fill",type:"button",onClick:function(){return g(e,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._saveCurrentConditions(!1)];case 1:return e.sent(),[2]}})})}},a.createElement("i",{className:"fa fa-save"})," Save"),"\xa0",!C&&a.createElement("button",{className:"btn btn-primary btn-fill",type:"button",onClick:function(){e._saveCurrentConditions(!0)}},a.createElement("i",{className:"fa fa-save"})," Save & Complete"),C&&a.createElement("button",{className:"btn btn-fill btn-dark text-inspection-completed padding-10 margin-5",type:"button",onClick:function(){e.unComplete()}},a.createElement("b",null,"Remove Inspection Completion"))))),a.createElement("div",{style:{display:"RCX Findings"==m||u?"block":"none"},id:"checklist",className:"col-md-12 padding-10"},a.createElement("div",{className:"col-md-12 padding-10"},a.createElement("h4",{className:"title"},a.createElement("u",null,"RCX Findings"))),a.createElement("div",{className:"col-md-12 padding-10 "},a.createElement("h4",{className:"title"},"Inspections"),a.createElement("div",{className:"col-md-12 padding-10"},a.createElement(c.a,{handleAdder:this.handleRcxIncpectionItems,handleAddNewCCNote:this.handleAddNewCCNote,buildingName:n,instance:o,rcxOf:l,rcxItems:h.rcxtasksInspections,isInspectionOrCleanliness:"Inspection",entityName:i,infoEntity:l,isView:u,isFromReport:u}))),a.createElement("div",{className:"col-md-12 padding-10 "},a.createElement("h4",{className:"title"},"Cleanliness"),a.createElement("div",{className:"col-md-12 padding-10"},a.createElement(c.a,{handleAdder:this.handleRcxCleanlinessItems,handleAddNewCCNote:this.handleAddNewCCNote,buildingName:n,instance:o,rcxOf:l,rcxItems:h.rcxtasksCleanliness,isInspectionOrCleanliness:"Cleanliness",entityName:i,infoEntity:l,isView:u,isFromReport:u}))),!u&&a.createElement("div",{className:"col-md-12 padding-10 ","data-html2canvas-ignore":"true"},a.createElement("div",{className:"form-group"},a.createElement("button",{className:"btn btn-primary btn-fill",type:"button",onClick:function(){return g(e,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._saveRCXTaskList(!1)];case 1:return e.sent(),[2]}})})}},a.createElement("i",{className:"fa fa-save"})," Save"),"\xa0",(C||!C)&&a.createElement(a.Fragment,null," ",!w&&a.createElement("button",{className:"btn btn-primary btn-fill",type:"button",onClick:function(){e._saveRCXTaskList(!0)}},a.createElement("i",{className:"fa fa-save"})," Save & Complete")),C&&w&&a.createElement("button",{className:"btn btn-fill btn-dark text-inspection-completed padding-10 margin-5",type:"button",onClick:function(){e.unComplete()}},a.createElement("b",null,"Remove Inspection Completion"))))))))),a.createElement("br",null)))},t}(a.Component);t.default=N},740:function(e,t,n){"use strict";t.g=function(e,t,n,c){return r(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,Object(o.f)({model:e,buildingData:t,equipment:n,lightingEquipment:c},o.a.LIFE.SaveProject,a.b.LIFE).then(function(){Object(i.b)("Project saved Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Project.")})];case 1:return[2,r.sent()]}})})},t.r=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,instance:t},o.a.LIFE.GetProjectList,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.m=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({_id:e},o.a.LIFE.DeleteProject,a.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.h=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({model:e},o.a.LIFE.SaveProjectSolution,a.b.LIFE).then(function(){Object(i.b)("Solution saved Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Solution.")})];case 1:return[2,t.sent()]}})})},t.o=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({spreadSheetId:e,fileType:t},o.a.LIFE.ExportSheet,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.t=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return e?[4,Object(o.e)({projectId:e},o.a.LIFE.GetSolutionList,a.b.LIFE)]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}})})},t.u=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return e?[4,Object(o.e)({inspectionOntology:e},o.a.LIFE.GetSolutionListForInspection,a.b.LIFE)]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}})})},t.s=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.e)({solutionId:e},o.a.LIFE.GetSolution,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.n=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({_id:e},o.a.LIFE.DeleteSolution,a.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.v=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({manageFile:e,fileData:t},o.a.LIFE.ManageFile,a.b.LIFE).then(function(){Object(i.b)("Upload Successfully.")}).catch(function(e){Object(i.a)("Error occured while saving Upload.")})];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({communityFile:e,fileData:t},o.a.LIFE.SaveCommunityFile,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.p=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,instance:t},o.a.LIFE.GetManageFile,a.b.LIFE)];case 1:return[2,n.sent()]}})})},t.b=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.e)({instance:e},o.a.LIFE.GetCommunityFile,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.l=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({ManageFile:e},o.a.LIFE.DeleteManageFile,a.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.a=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({communityFile:e},o.a.LIFE.DeleteCommunityFile,a.b.LIFE).then(function(){Object(i.b)(" Deleted Successfully.")}).catch(function(e){Object(i.a)("Error occured while deleting.")})];case 1:return[2,t.sent()]}})})},t.q=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.e)({projectId:e},o.a.LIFE.GetProject,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.f=function(e,t,n){return r(this,void 0,void 0,function(){return s(this,function(i){switch(i.label){case 0:return[4,Object(o.f)({email:e,buildingName:t,instance:n},o.a.LIFE.SaveEmailAndDrive,a.b.LIFE)];case 1:return[2,i.sent()]}})})},t.j=function(e,t){return r(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({email:e,instance:t},o.a.LIFE.ShareCommunityFolder,a.b.LIFE).then(function(e){e.result?Object(i.b)("Successfully Share."):Object(i.a)("The user Email is not valid.")}).catch(function(e){Object(i.a)("Something Went Wrong!")})];case 1:return[2,n.sent()]}})})},t.k=function(e,t,n){return r(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,Object(o.f)({email:e,buildingName:t,instance:n},o.a.LIFE.ShareMMTemplateFolder,a.b.LIFE).then(function(e){e.result?Object(i.b)("Successfully Share."):Object(i.a)("The user Email is not valid.")}).catch(function(e){Object(i.a)("Something Went Wrong!")})];case 1:return[2,r.sent()]}})})},t.i=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({templatePurpose:e},o.a.LIFE.SaveTemplatePurpose,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.c=function(e){return r(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Object(o.e)({instance:e},o.a.LIFE.GetTemplatePurpose,a.b.LIFE)];case 1:return[2,t.sent()]}})})},t.d=function(e){var t=e.getFullYear().toString().slice(2,4),n=(e.getMonth()+1).toString().padStart(2,0),o=e.getDate().toString().padStart(2,0),i=e.getHours().toString().padStart(2,0),a=e.getMinutes().toString().padStart(2,0),r=e.getSeconds().toString().padStart(2,0);return t+n+o+i+a+r};var o=n(12),i=n(21),a=n(13),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((o=o.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}},910:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),n(698)),a=n(703),r=n(57),s=n(20),c=n(743),l=n(8),u=n(737),d=n(21),p=n(701),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((o=o.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},b=function(e){function t(t){var n=e.call(this,t)||this;return n.textareas=[],n.state={currentConditions:[],ccLabel:[],labelsDropDownList:[],selectedAttachment:void 0,onPageTextChanged:!1,newCCLabel:""},n.addItem=n.addItem.bind(n),n.handleItemChange=n.handleItemChange.bind(n),n.handleCurrentConditionLabelChange=n.handleCurrentConditionLabelChange.bind(n),n.handleCCLabelChange=n.handleCCLabelChange.bind(n),n.removeItem=n.removeItem.bind(n),n.handleFileAttachment=n.handleFileAttachment.bind(n),n.setImageURL_ForItems=n.setImageURL_ForItems.bind(n),n}return m(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){return h(this,void 0,void 0,function(){var t,n,o=this;return f(this,function(i){return e.buildingName&&e.instance&&(t=JSON.stringify(this.state.currentConditions),n=JSON.stringify(e.currentConditions),(!this.state.onPageTextChanged&&!this.props.isFromReport&&t!=n||this.props.isFromReport&&t!=n)&&this.setState({currentConditions:e.currentConditions},function(){o.textareas.map(function(e){Object(s.h)(e)}),o.setImageURL_ForItems()})),[2]})})},t.prototype.componentDidMount=function(){return h(this,void 0,void 0,function(){var e,t=this;return f(this,function(n){return e=this.state.labelsDropDownList,this.props.labels&&this.props.labels.length>0&&(e=this.props.labels.map(function(e){return{value:e,label:e}}),this.setState({labelsDropDownList:e})),this.props.buildingName&&this.props.instance&&this.setState({currentConditions:this.props.currentConditions},function(){t.setImageURL_ForItems(),t.state.onPageTextChanged||t.textareas.map(function(e){Object(s.h)(e)})}),[2]})})},t.prototype.setImageURL_ForItems=function(){return h(this,void 0,void 0,function(){var e,t,n,o;return f(this,function(i){for(e=this.state.currentConditions,t=0;t<e.length;t++)n="",o=new r.b,e[t].photo&&(e[t].photo.toLowerCase().indexOf(".mp4")>0&&(n="assets/img/video-file-icon.png"),e[t].photo.toLowerCase().indexOf(".mov")>0&&(n="assets/img/video-file-icon.png"),e[t].photo.toLowerCase().indexOf(".pdf")>0&&(n="assets/img/pdf-file-icon.png"),(e[t].photo.toLowerCase().indexOf(".xls")>0||e[t].photo.toLowerCase().indexOf(".csv")>0)&&(n="assets/img/excel-file-icon.png"),(e[t].photo.toLowerCase().indexOf(".docx")>0||e[t].photo.toLowerCase().indexOf(".txt")>0)&&(n="assets/img/doc-file-icon.png"),(e[t].photo.toLowerCase().indexOf(".png")>0||e[t].photo.toLowerCase().indexOf(".jpeg")>0||e[t].photo.toLowerCase().indexOf(".jpg")>0||e[t].photo.toLowerCase().indexOf(".tiff")>0)&&(n=o.GetSignedURL(r.a.DOCUMENT(),e[t].photo,6e5))),e[t].imageurl=n;return this.setState({currentConditions:e}),[2]})})},t.prototype.addItem=function(){return h(this,void 0,void 0,function(){var e,t,n,o,i=this;return f(this,function(a){return e=this.state,t=e.currentConditions,n=e.ccLabel,o=e.newCCLabel,n.map(function(e){var n={preRCXName:Object(s.D)(8),ccBoolean:!1,ccLabel:"Other"==e.value?o:e.value,proposedRCX:"",photo:"",entryTimeStamp:void 0};t||(t=[]);var i=t.filter(function(e){return-1!=e.ccLabel.indexOf(n.ccLabel)}).length;i>0&&(n.ccLabel=n.ccLabel+" - "+(i+1)),t.push.apply(t,[n])}),t=t.sort(function(e,t){return e.ccLabel>t.ccLabel?1:-1}),this.setState({currentConditions:t,ccLabel:[]},function(){return h(i,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this.props.handleAdder(t,this.props.isInspectionOrCleanliness)];case 1:return e.sent(),[2]}})})}),setTimeout(function(){i.textareas.map(function(e){Object(s.h)(e)})},1e3),[2]})})},t.prototype.removeItem=function(e){var t=this.state.currentConditions;t.splice(e,1),this.setState({currentConditions:t}),this.props.handleAdder(t,this.props.isInspectionOrCleanliness)},t.prototype.removeAttachment=function(e){var t=this.state.currentConditions;t[e].imageurl="",t[e].photo="",this.setState({currentConditions:t}),this.props.handleAdder(t,this.props.isInspectionOrCleanliness)},t.prototype.handleCurrentConditionLabelChange=function(e){var t=this.state.ccLabel;t=e,this.setState({ccLabel:t})},t.prototype.handleCCLabelChange=function(e){var t=this.state,n=t.labelsDropDownList,o=t.newCCLabel;-1!=e.findIndex(function(e){return"Other"==e.value})||(o=""),this.setState({ccLabel:e,labelsDropDownList:n,newCCLabel:o})},t.prototype.handleItemChange=function(e,t){var n=this,o=this.state.currentConditions,i=t.target.name,a=o&&o[e];a[""+i]="ccBoolean"==i?t.target.checked:t.target.value,this.setState({currentConditions:o,onPageTextChanged:!0},function(){"ccBoolean"!=i&&document.getElementById(n.props.isInspectionOrCleanliness+"rcxCC"+e).focus()}),this.props.handleAdder(o,this.props.isInspectionOrCleanliness)},t.prototype.handleFileAttachment=function(e,t){return h(this,void 0,void 0,function(){var n,o,i,a,c,p,m,h,b,C,g,v=this;return f(this,function(f){switch(f.label){case 0:n=this.props,o=n.buildingName,i=n.entityName,a=n.infoEntity,c=JSON.parse(l.a.getItem("user")),p=this.state.currentConditions,m=p[t],f.label=1;case 1:return f.trys.push([1,4,,5]),e&&e.name&&(e.file||e.length>0)&&m?(h=this.props.buildingName+"-_-"+Object(s.D)(10),b="",C=void 0,g=e.name.substring(e.name.indexOf(".")),b=""+h+g,C=e,p[t].photo=b,[4,(new r.b).UploadFile(r.a.DOCUMENT(),b,C,function(t,n){if(t)Object(d.a)("Attachment failed to upload");else{var r={building:o,docOntology:Object(s.D)(12),documentType:"InspectionDoc",documentSubtype:"InspectionDoc",enteredBy:c.contact,enteredByName:c.name,entityOntology:[{label:"",value:i}],entityType:a,rdfsLabel:e.name,s3FileName:b,entryTimeStamp:(new Date).toString(),linkToDocument:b};Object(u.f)(r).then(function(){})}})]):[3,3];case 2:f.sent(),this.setState({currentConditions:p,selectedAttachment:e},function(){v.props.handleAdder(p,v.props.isInspectionOrCleanliness),setTimeout(function(){v.setImageURL_ForItems()},1e3)}),f.label=3;case 3:return[3,5];case 4:return f.sent(),[3,5];case 5:return[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.currentConditions,l=t.ccLabel,u=t.labelsDropDownList,d=t.newCCLabel,m=this.props,b=m.hideAddButton,C=m.isView,g=m.isFromReport,v=new r.b;return o.createElement(o.Fragment,null,n&&n.map(function(t,n){var a="";return t.photo&&(a=v.GetSignedURL(r.a.DOCUMENT(),t.photo)),o.createElement("div",{key:n,className:"row padding-5",style:{borderBottom:"1px solid rgb(0 0 0 / 22%)",marginBottom:"5px",paddingBottom:"15px",minHeight:"100px"}},o.createElement("div",{className:"col-md-3"},o.createElement("label",{htmlFor:"ccBoolean"+n},t.ccLabel)),o.createElement("div",{className:"col-md-6"},o.createElement("div",{className:"col-md-4"},o.createElement("label",{className:"pull-right",htmlFor:t.proposedRCX},"Describe Proposed RCX:")),o.createElement("div",{className:"col-md-8"},o.createElement("textarea",{disabled:C,id:e.props.isInspectionOrCleanliness+"rcxCC"+n,className:"form-control",value:t.proposedRCX,name:"proposedRCX",ref:function(t){return e.textareas.push(t)},onChange:function(t){return h(e,void 0,void 0,function(){return f(this,function(e){return this.handleItemChange(n,t),Object(s.h)(t.target),[2]})})},style:{width:"100%",height:"content",minHeight:"60px",overflow:"hidden",resize:"none",wordWrap:"break-word"}}))),!g&&o.createElement(o.Fragment,null,o.createElement("div",{className:"col-md-1"},!(t.photo&&t.photo.length>0)&&o.createElement("button",{type:"button",disabled:C||g,className:"btn btn-dark",style:{fontWeight:"bold",fontSize:"12pt",width:t.photo&&t.photo.length>0&&t.imageurl?"204px":"60px",padding:0},"data-toggle":"modal","data-target":"#uploadImage"+e.props.isInspectionOrCleanliness+n,title:"Upload Attachment",onClick:function(){e.setState({selectedAttachment:void 0})}},o.createElement("i",{className:"fa fa-paperclip"})),t.photo&&t.photo.length>0&&o.createElement("img",{src:t.imageurl,style:{width:"100%"}}),o.createElement(i.a,{id:"uploadImage"+e.props.isInspectionOrCleanliness+n,onSaveButtonClick:function(){},saveButtonText:"Close",isEditForm:!1,showCancelButton:!1,cancelButtonText:"Cancel",heading:e.props.isInspectionOrCleanliness},o.createElement(c.a,{handleAttachedFile:function(t){t&&t[0]&&e.handleFileAttachment(t[0],n)},files:e.state.selectedAttachment?[e.state.selectedAttachment]:[],single:!0}))),o.createElement("div",{className:"col-md-2 btn-group"},t.photo&&t.photo.length>0&&o.createElement(o.Fragment,null,o.createElement("button",{type:"button",disabled:C||g,className:"btn btn-dark padding-5","data-toggle":"modal","data-target":"#uploadImage"+e.props.isInspectionOrCleanliness+n,title:"Replace Attachment",onClick:function(){e.setState({selectedAttachment:void 0})}},o.createElement("i",{className:"fa fa-paperclip"})),a&&o.createElement("a",{className:"btn padding-5",title:"Download Attachment",href:a},o.createElement("i",{className:"fa fa-download"})),o.createElement("button",{disabled:C,type:"button",className:"btn btn-danger padding-5",title:"Remove Attachment",onClick:function(){return document.getElementById("removedPropsedRCXAttacment"+t.preRCXName).click()}},o.createElement("i",{className:"fa fa-trash"})),o.createElement("button",{style:{display:"none"},id:"removedPropsedRCXAttacment"+t.preRCXName,"data-toggle":"modal","data-target":"#removedDialogPropsedRCXAttacment"+t.preRCXName},"."),o.createElement(p.a,{instance:e.props.instance,id:"removedDialogPropsedRCXAttacment"+t.preRCXName,showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure you want to delete this attachment for proposed RCX ?",heading:"Alert",onConfirmButtonClick:function(){return e.removeAttachment(n)}})),o.createElement("button",{disabled:C,type:"button",className:"btn ml-5 padding-5",title:"Remove Item",style:{color:"#f00"},onClick:function(){return document.getElementById("removeProposedRCX"+t.preRCXName).click()}},o.createElement("i",{className:"fa fa-remove"})),o.createElement("button",{style:{display:"none"},id:"removeProposedRCX"+t.preRCXName,"data-toggle":"modal","data-target":"#removeProposedRCXDialog"+t.preRCXName},"."),o.createElement(p.a,{instance:e.props.instance,id:"removeProposedRCXDialog"+t.preRCXName,showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure you want to delete this proposed RCX?",heading:"Alert",onConfirmButtonClick:function(){return e.removeItem(n)}}))),g&&t.photo&&t.imageurl&&t.photo.length>0&&o.createElement("div",{className:"col-md-4"},o.createElement("img",{crossOrigin:"anonymous",src:t.imageurl,className:"inspection-image-preview"})))}),!b&&!g&&o.createElement("div",{className:"row padding-10"},o.createElement("div",{className:"col-md-1"},o.createElement("label",null,"Add:")),o.createElement("div",{className:"col-md-11 col-xs-11"},o.createElement("button",{type:"button",className:"btn btn-dark btn-fill btn-sm","data-toggle":"modal","data-target":"#AddLabelDialog_"+this.props.isInspectionOrCleanliness,onClick:function(){e.setState({newCCLabel:""})}},o.createElement("i",{className:"fa fa-plus"}))),o.createElement(i.a,{disableSaveButton:!l||-1!=l.findIndex(function(e){return"Other"==e.value})&&!d,id:"AddLabelDialog_"+this.props.isInspectionOrCleanliness,onSaveButtonClick:function(){e.addItem()},saveButtonText:"Ok",isEditForm:!1,showCancelButton:!0,cancelButtonText:"Cancel",heading:"Inspection and Testing"},u&&u.length>0&&o.createElement("div",{className:"form-group"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement(a.a,{id:"lbl",isMulti:!0,closeMenuOnSelect:!1,onChange:this.handleCCLabelChange,placeholder:this.props.isInspectionOrCleanliness+" labels",options:u,value:l}))),o.createElement("div",{className:"row"},l&&-1!=l.findIndex(function(e){return"Other"==e.value})&&o.createElement("div",{className:"col-md-12",style:{paddingTop:10}},o.createElement("input",{type:"text",className:"form-control",value:d,placeholder:'Enter title for option "Other"',onChange:function(t){e.setState({newCCLabel:t.target.value})}})))))))},t}(o.Component);t.a=b},911:function(e,t,n){"use strict";var o=n(2),i=(n.n(o),n(698)),a=n(57),r=n(20),s=n(743),c=n(8),l=n(737),u=n(21),d=n(701),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,s)}c((o=o.apply(e,t||[])).next())})},h=this&&this.__generator||function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},f=!1,b=function(e){function t(t){var n=e.call(this,t)||this;return n.textareas=[],n.textareas2=[],n.state={rcxItems:[],selectedAttachment:void 0,newCCLabel:""},n.handleNotesChange=n.handleNotesChange.bind(n),n.handleFileAttachment=n.handleFileAttachment.bind(n),n.UNSAFE_componentWillReceiveProps=n.UNSAFE_componentWillReceiveProps.bind(n),n}return p(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){return m(this,void 0,void 0,function(){var t,n,o=this;return h(this,function(i){return t=JSON.stringify(this.state.rcxItems),n=JSON.stringify(e.rcxItems),(!this.props.isFromReport||e.isFromReport&&t!=n)&&this.setState({rcxItems:e.rcxItems},function(){o.setImageURL_ForItems(),f||(o.textareas.map(function(e){Object(r.h)(e)}),o.textareas2.map(function(e){Object(r.h)(e)}))}),[2]})})},t.prototype.setImageURL_ForItems=function(){return m(this,void 0,void 0,function(){var e,t,n,o;return h(this,function(i){for(e=this.state.rcxItems,t=0;t<e.length;t++)n="",o=new a.b,e[t].photo&&(e[t].photo.toLowerCase().indexOf(".mp4")>0&&(n="assets/img/video-file-icon.png"),e[t].photo.toLowerCase().indexOf(".mov")>0&&(n="assets/img/video-file-icon.png"),e[t].photo.toLowerCase().indexOf(".pdf")>0&&(n="assets/img/pdf-file-icon.png"),(e[t].photo.toLowerCase().indexOf(".xls")>0||e[t].photo.toLowerCase().indexOf(".csv")>0)&&(n="assets/img/excel-file-icon.png"),(e[t].photo.toLowerCase().indexOf(".docx")>0||e[t].photo.toLowerCase().indexOf(".txt")>0)&&(n="assets/img/doc-file-icon.png"),(e[t].photo.toLowerCase().indexOf(".png")>0||e[t].photo.toLowerCase().indexOf(".jpeg")>0||e[t].photo.toLowerCase().indexOf(".jpg")>0||e[t].photo.toLowerCase().indexOf(".tiff")>0)&&(n=o.GetSignedURL(a.a.DOCUMENT(),e[t].photo,6e5))),e[t].imageurl=n;return this.setState({rcxItems:e}),[2]})})},t.prototype.addItem=function(){var e=this,t=this.state.newCCLabel;this.props.handleAddNewCCNote(t,this.props.isInspectionOrCleanliness),setTimeout(function(){e.textareas.map(function(e){Object(r.h)(e)}),e.textareas2.map(function(e){Object(r.h)(e)})},1e3)},t.prototype.handleNotesChange=function(e,t){var n=this,o=this.state.rcxItems;o[e].notesMeasurement=t.target.value,f=!0,this.setState({rcxItems:o},function(){document.getElementById(n.props.isInspectionOrCleanliness+"rcxTask"+e).focus(),n.props.handleAdder(o,n.props.isInspectionOrCleanliness)})},t.prototype.handleToggleChange=function(e,t){var n=this,o=this.state.rcxItems;o[e].ccBoolean=t.target.checked,this.setState({rcxItems:o},function(){n.props.handleAdder(o,n.props.isInspectionOrCleanliness)})},t.prototype.removeAttachment=function(e){var t=this,n=this.state.rcxItems;n[e].imageurl="",n[e].photo="",this.setState({rcxItems:n},function(){t.props.handleAdder(n,t.props.isInspectionOrCleanliness)})},t.prototype.handleFileAttachment=function(e,t){return m(this,void 0,void 0,function(){var n,o,i,s,d,p,m,f,b,C,g,v,y=this;return h(this,function(h){switch(h.label){case 0:n=this.state.rcxItems,o=this.props,i=o.buildingName,s=o.entityName,d=o.infoEntity,p=JSON.parse(c.a.getItem("user")),m=n[t],f=new a.b,h.label=1;case 1:return h.trys.push([1,4,,5]),e&&(e.file||e.length>0)&&m?(b=this.props.buildingName+"-_-"+Object(r.D)(10),C="",g=void 0,n[t].photo=C,v=e.name.substring(e.name.indexOf(".")),C=""+b+v,g=e,n[t].photo=C,[4,f.UploadFile(a.a.DOCUMENT(),C,g,function(t,n){if(t)Object(u.a)("Attachment failed to upload");else{var o={building:i,docOntology:Object(r.D)(12),documentType:"InspectionDoc",documentSubtype:"InspectionDoc",enteredBy:p.contact,enteredByName:p.name,entityOntology:[{label:"",value:s}],entityType:d,rdfsLabel:e.name,s3FileName:C,entryTimeStamp:(new Date).toString(),linkToDocument:C};Object(l.f)(o).then(function(){})}})]):[3,3];case 2:h.sent(),this.setState({rcxItems:n,selectedAttachment:e},function(){y.props.handleAdder(n,y.props.isInspectionOrCleanliness),setTimeout(function(){y.setImageURL_ForItems()},1e3)}),h.label=3;case 3:return[3,5];case 4:return h.sent(),[3,5];case 5:return[2]}})})},t.prototype.render=function(){var e=this,t=this.state,n=t.rcxItems,c=t.newCCLabel,l=this.props,u=l.isView,p=l.isFromReport,m=l.hideAddButton,h=new a.b;return o.createElement(o.Fragment,null,n&&n.map(function(t,n){var c="";return t.photo&&(c=h.GetSignedURL(a.a.DOCUMENT(),t.photo)),o.createElement("div",{key:n,className:"row padding-5",style:{borderBottom:"1px solid rgb(0 0 0 / 22%)",marginBottom:"5px",paddingBottom:"5px"}},o.createElement("div",{className:"col-md-4"},o.createElement("textarea",{disabled:!0,className:"form-control",value:t.ccLabel+": \n"+t.proposedRCX,ref:function(t){return e.textareas.push(t)},onChange:function(e){Object(r.h)(e.target)},style:{width:"100%",height:"content",minHeight:"60px",overflow:"hidden",resize:"none",wordWrap:"break-word"}})),o.createElement("div",{className:"col-md-2"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-4"},o.createElement("label",{htmlFor:"ccBoolean"+n},"Inspection - Acceptable")),o.createElement("div",{className:"col-md-8"},o.createElement("div",{className:"switch-container"},o.createElement("label",{htmlFor:"ccBoolean"+n,className:"m-1"},"No / Yes"),o.createElement("label",null,o.createElement("input",{id:"ccBoolean"+n,disabled:u,name:"ccBoolean",checked:t.ccBoolean,onChange:function(t){e.handleToggleChange(n,t)},className:"switch",type:"checkbox"}),o.createElement("div",null,o.createElement("div",null))))))),o.createElement("div",{className:"col-md-3"},o.createElement("textarea",{disabled:u,id:e.props.isInspectionOrCleanliness+"rcxTask"+n,className:"form-control",value:t.notesMeasurement,placeholder:"Notes/Measurements",name:"proposedRCX",ref:function(t){return e.textareas2.push(t)},onChange:function(t){e.handleNotesChange(n,t),Object(r.h)(t.target)},style:{width:"100%",height:"content",minHeight:"60px",overflow:"hidden",resize:"none",wordWrap:"break-word"}})),!p&&o.createElement(o.Fragment,null,o.createElement("div",{className:"col-md-1"},!(t.photo&&t.photo.length>0)&&o.createElement("button",{disabled:u||p,type:"button",className:"btn btn-dark",style:{fontWeight:"bold",fontSize:"12pt",width:t.photo&&t.photo.length>0&&t.imageurl?"204px":"60px",padding:0},"data-toggle":"modal","data-target":"#uploadImage"+e.props.isInspectionOrCleanliness+n,title:"Upload Image",onClick:function(){e.setState({selectedAttachment:void 0})}},o.createElement("i",{className:"fa fa-image"})),t.photo&&t.photo.length>0&&o.createElement("img",{src:t.imageurl,style:{width:"100%"}}),o.createElement(i.a,{id:"uploadImage"+e.props.isInspectionOrCleanliness+n,onSaveButtonClick:function(){},saveButtonText:"Close",isEditForm:!1,showCancelButton:!1,cancelButtonText:"Cancel",heading:e.props.isInspectionOrCleanliness},o.createElement(s.a,{handleAttachedFile:function(t){t&&t[0]&&e.handleFileAttachment(t[0],n)},files:e.state.selectedAttachment?[e.state.selectedAttachment]:[],single:!0}))),o.createElement("div",{className:"col-md-2 btn-group"},t.photo&&t.photo.length>0&&o.createElement(o.Fragment,null,o.createElement("button",{type:"button",disabled:u||p,className:"btn btn-dark padding-5","data-toggle":"modal","data-target":"#uploadImage"+e.props.isInspectionOrCleanliness+n,title:"Replace Attachment",onClick:function(){e.setState({selectedAttachment:void 0})}},o.createElement("i",{className:"fa fa-image"})),c&&o.createElement("a",{className:"btn padding-5",title:"Download Attachment",href:c},o.createElement("i",{className:"fa fa-download"})),o.createElement("button",{disabled:u,type:"button",className:"btn btn-danger padding-5",title:"Remove Attachment",onClick:function(){return document.getElementById("removedFindingsRCXAttacment"+t.preRCXName).click()}},o.createElement("i",{className:"fa fa-trash"})),o.createElement("button",{style:{display:"none"},id:"removedFindingsRCXAttacment"+t.preRCXName,"data-toggle":"modal","data-target":"#removedDialogFindingsRCXAttacment"+t.preRCXName},"."),o.createElement(d.a,{instance:e.props.instance,id:"removedDialogFindingsRCXAttacment"+t.preRCXName,showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure you want to delete this attachment for RCX findings?",heading:"Alert",onConfirmButtonClick:function(){return e.removeAttachment(n)}})))),p&&t.photo&&t.imageurl&&t.photo.length>0&&o.createElement("div",{className:"col-md-3"}," ",o.createElement("img",{crossOrigin:"anonymous",src:t.imageurl,className:"inspection-image-preview"})))}),!m&&!p&&o.createElement("div",{className:"row padding-10"},o.createElement("div",{className:"col-md-1"},o.createElement("label",null,"Add:")),o.createElement("div",{className:"col-md-11 col-xs-11"},o.createElement("button",{type:"button",className:"btn btn-dark btn-fill btn-sm","data-toggle":"modal","data-target":"#AddLabelDialog_"+this.props.isInspectionOrCleanliness+"_Findings",onClick:function(){e.setState({newCCLabel:""})}},o.createElement("i",{className:"fa fa-plus"}))),o.createElement(i.a,{disableSaveButton:!c,id:"AddLabelDialog_"+this.props.isInspectionOrCleanliness+"_Findings",onSaveButtonClick:function(){e.addItem()},saveButtonText:"Ok",isEditForm:!1,showCancelButton:!0,cancelButtonText:"Cancel",heading:"RCX Findings"},o.createElement("div",{className:"form-group"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col-md-12"},o.createElement("div",{className:"col-md-12"},o.createElement("input",{type:"text",className:"form-control",value:c,placeholder:"New Label",name:"notes",onChange:function(t){e.setState({newCCLabel:t.target.value})}}))))))))},t}(o.Component);t.a=b}});