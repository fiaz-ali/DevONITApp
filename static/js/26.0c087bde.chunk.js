webpackJsonp([26],{1188:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,l=n(2),r=(n.n(l),n(682)),o=n(656),i=n(10),s=n(32),c=n(720),u=n(116),m=n(654),d=n(761),h=n(1122),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),y=this&&this.__assign||function(){return(y=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},b=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,r){function o(e){try{s(a.next(e))}catch(e){r(e)}}function i(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,i)}s((a=a.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,a,l,r,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){o.label=r[1];break}if(6===r[0]&&o.label<l[1]){o.label=l[1],l=r;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(r);break}l[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},g=0,v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={CeilingSensorBoardInfo:Object(),CeilingSensorBoard_MonconModel:Object(),Old_RelayBoardInfo:Object(),RelayBoardInfo:Object(),I1RelayBoardInfo:Object(),modelChanged:!1,Moncon:{monitoringControl:"",monitoringControlDeviceType:"",deviceName:"",floor:"",rdfsLabel:"",manufacturer:"",model:"",location:"",computingDevice:"",networkDevice:"",connectionType:"",notes:"",wirelessConfig:{ipAddress:"",controllerIPAddress:"",thermostatMacAddress:"",ssid:"",password:""},isSchedule:!1,relatedEquipment:[],deviceNumber:"",enclosure:""},EquipmentList:[],currentChange:"",detailsExpanded:!1,spaces:[],relayControlStatusDesc:"",scheduleSelected:!1,relayisOn:!1,relayisOnNo:0,relayCensorStatus:Object(),relay1Status:!1,relay2Status:!1,relay3Status:!1,relay4Status:!1,I1RelayStatus:!1,relayControlStatus:"Manual",relayControlType:"",isOptimizeControl:!1,isOptimizeControlStatus:"",RelayBoardControl:Object(),relayOptimizeSettings:"",I4RelayBoardInfo:Object(),relayNoOptimize:0,devices:[],callInterval:!0,openRelayControlDialog:!1},n,n.fetchDevices=n.fetchDevices.bind(n),n._fetchData=n._fetchData.bind(n),n._fetchCeilingSensorBoardInfo=n._fetchCeilingSensorBoardInfo.bind(n),n._fetchRelayCensorStatus=n._fetchRelayCensorStatus.bind(n),n._fetchV4RelayBoardInfo=n._fetchV4RelayBoardInfo.bind(n),n._fetchI1RelayBoardInfo=n._fetchI1RelayBoardInfo.bind(n),n._fetchI4RelayBoardInfo=n._fetchI4RelayBoardInfo.bind(n),n.fetchRelayControlSettings=n.fetchRelayControlSettings.bind(n),n.saveRelayStatusChanges=n.saveRelayStatusChanges.bind(n),n.setOptimizeSettings=n.setOptimizeSettings.bind(n),n.cancelSend=n.cancelSend.bind(n),n.resetChanges=n.resetChanges.bind(n),n.applyChanges=n.applyChanges.bind(n),n.handleChange=n.handleChange.bind(n),n.handleRelayOnOff=n.handleRelayOnOff.bind(n),n.handleRelayControlStatus=n.handleRelayControlStatus.bind(n),n.handleScheduleSelection=n.handleScheduleSelection.bind(n),n.setIntervalStart=n.setIntervalStart.bind(n),n.applyRule=n.applyRule.bind(n),n.onCloseRelayControlDialog=n.onCloseRelayControlDialog.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){return b(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return this.props.buildingName?[4,this._fetchData()]:[3,4];case 1:return e.sent(),[4,this.fetchDevices()];case 2:return e.sent(),[4,this.resetChanges(!0)];case 3:e.sent(),e.label=4;case 4:return this.setIntervalStart(),[2]}})})},t.prototype.setIntervalStart=function(){var e=this;a&&clearInterval(a),setInterval(function(){g++},1e3),a=setInterval(function(){var t=e.state,n=t.callInterval;!t.modelChanged&&n&&g>=15&&(e.resetChanges(!1),Object(u.a)(!1))},5e3)},t.prototype.componentWillUnmount=function(){return b(this,void 0,void 0,function(){return f(this,function(e){return clearInterval(a),[2]})})},t.prototype.fetchDevices=function(){return b(this,void 0,void 0,function(){var e,t;return f(this,function(n){switch(n.label){case 0:return(e=this.props.buildingName)?[4,Object(r.s)(e)]:[3,2];case 1:t=n.sent(),this.setState({devices:t}),n.label=2;case 2:return[2]}})})},t.prototype._fetchData=function(){return b(this,void 0,void 0,function(){var e,t,n,a,l,r,s,c,d,h,p,y,g,v=this;return f(this,function(C){switch(C.label){case 0:return e=this.state,t=e.scheduleSelected,n=e.relayControlType,a=this.props,l=a.RelayDeviceName,r=a.buildingName,l?(Object(u.a)(!0),[4,Object(m.j)(this.props.buildingName)]):[3,3];case 1:return s=C.sent(),c=s&&s.length>0&&s.map(function(e){return{value:Object(i.g)(e.ontology),label:Object(i.g)(e.rdfsLabel)}}),d=Object(),[4,Object(o.t)(l,r)];case 2:d=C.sent(),t=d.isSchedule,n=d.monitoringControlDeviceType,localStorage.getItem(d.deviceID)&&localStorage.getItem(d.deviceID).length>0&&(h=localStorage.getItem(d.deviceID))&&"undefined"!=h&&(n&&-1!=n.indexOf("OneRelay")?(p=JSON.parse(localStorage.getItem(d.deviceID)),this.setState({I1RelayBoardInfo:p,modelChanged:!1,currentChange:""})):-1!=n.toLowerCase().indexOf("i4")?(y=JSON.parse(localStorage.getItem(d.deviceID)),this.setState({I4RelayBoardInfo:y,modelChanged:!1,currentChange:""})):(g=JSON.parse(localStorage.getItem(d.deviceID)),this.setState({RelayBoardInfo:g,modelChanged:!1,currentChange:""}))),this.setState({Moncon:d,EquipmentList:c,scheduleSelected:t,relayControlType:n},function(){return b(v,void 0,void 0,function(){return f(this,function(e){return this._fetchRelayCensorStatus(!0),-1!=n.toLowerCase().indexOf("i1")?this._fetchI1RelayBoardInfo(!0):-1!=n.toLowerCase().indexOf("i4")?this._fetchI4RelayBoardInfo(!0):this._fetchV4RelayBoardInfo(!0),this._fetchCeilingSensorBoardInfo(!0),this.fetchRelayControlSettings(),[2]})})}),Object(u.a)(!1),C.label=3;case 3:return[2]}})})},t.prototype._fetchCeilingSensorBoardInfo=function(e){return b(this,void 0,void 0,function(){var t,n,a,l,i,c,m;return f(this,function(d){switch(d.label){case 0:e&&Object(u.a)(!0),t=this.state.Moncon,n=this.props.buildingName,a="",l=0,d.label=1;case 1:return l<t.sensors.length?(i=t.sensors[l],a=i.value,c=Object(),[4,Object(o.t)(a,n)]):[3,5];case 2:return"CeilingSensor"!=(c=d.sent()).monitoringControlDeviceType?[3,4]:[4,Object(r.l)(c).then(function(e){var t=e[0];return!t||t&&t.error?(Object(s.a)("Error occurred while fetching ceiling sensor board info."),Object()):t}).catch(function(e){return Object()})];case 3:return m=d.sent(),this.setState({CeilingSensorBoardInfo:m,CeilingSensorBoard_MonconModel:c,modelChanged:!1,currentChange:""}),[2];case 4:return l++,[3,1];case 5:return e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchI1RelayBoardInfo=function(e){return b(this,void 0,void 0,function(){var t,n,a;return f(this,function(l){switch(l.label){case 0:return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.state.I1RelayStatus,[4,Object(r.e)(t.topic,new Date,new Date,!0).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching relay board info."),Object()):(e[e.length-1]&&localStorage.setItem(t.deviceID,JSON.stringify(e[e.length-1])),e[e.length-1])}).catch(function(e){return Object()})];case 1:return(a=l.sent())&&a.i1relay_state&&a.i1relay_state[0]&&(n="1"==a.i1relay_state[0]),a&&a.i1relay_state&&0==a.i1relay_state[0]&&(n=!1),this.setState({I1RelayBoardInfo:a,modelChanged:!1,currentChange:"",I1RelayStatus:n}),e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchV4RelayBoardInfo=function(e){return b(this,void 0,void 0,function(){var t,n,a,l,o,i,c,m,d;return f(this,function(h){switch(h.label){case 0:return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.state,a=n.relay1Status,l=n.relay2Status,o=n.relay3Status,i=n.relay4Status,c=Object(),[4,Object(r.f)(t.topic,new Date,new Date,!0).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching relay board info."),Object()):(e[e.length-1]&&localStorage.setItem(t.deviceID,JSON.stringify(e[e.length-1])),e[e.length-1])}).catch(function(e){return Object()})];case 1:return(c=h.sent())&&c.v4relay_state&&(m=this.ConvertDecimalToBinary(parseInt(c.v4relay_state)),d=m.split(","),a="1"==d[0],l="1"==d[1],o="1"==d[2],i="1"==d[3]),this.setState({RelayBoardInfo:c,Old_RelayBoardInfo:y({},c),modelChanged:!1,currentChange:"",relay1Status:a,relay2Status:l,relay3Status:o,relay4Status:i}),e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchI4RelayBoardInfo=function(e){return b(this,void 0,void 0,function(){var t,n,a,l,o,i,c;return f(this,function(m){switch(m.label){case 0:return e&&Object(u.a)(!0),t=this.state.Moncon,n=this.state,a=n.relay1Status,l=n.relay2Status,o=n.relay3Status,i=n.relay4Status,c=Object(),[4,Object(r.o)(t).then(function(e){return!e||e&&e.error?(Object(s.a)("Error occurred while fetching relay board info."),Object()):(e&&localStorage.setItem(t.deviceID,JSON.stringify(e)),e)}).catch(function(e){return Object()})];case 1:return c=m.sent(),a=120==c.voltage_volts_Ch1,l=120==c.voltage_volts_Ch2,o=120==c.voltage_volts_Ch3,i=120==c.voltage_volts_Ch4,this.setState({modelChanged:!1,currentChange:"",relay1Status:a,relay2Status:l,relay3Status:o,relay4Status:i,I4RelayBoardInfo:c}),e&&Object(u.a)(!1),[2]}})})},t.prototype._fetchRelayCensorStatus=function(e){return b(this,void 0,void 0,function(){var t,n,a,l=this;return f(this,function(o){switch(o.label){case 0:return e&&Object(u.a)(!0),t=this.props,n=t.buildingName,a=t.RelayDeviceName,[4,Object(r.v)(n,a).then(function(e){var t=e[0];if(!t)return l.setState({relay1Status:!1,relay2Status:!1,relay3Status:!1,relay4Status:!1,relayOptimizeSettings:"Normal,Normal,Normal,Normal,"}),Object();var n=Object();n.relayStatus=[],n.controlStatus=Object(i.g)(t.controlStatus),n.deviceType=Object(i.g)(t.deviceType);var a=l.state,r=a.relay1Status,o=a.relay2Status,s=a.relay3Status,c=a.relay4Status,u=a.relayControlStatus,m=a.I1RelayStatus,d=a.relayOptimizeSettings,h=Object(i.g)(t.relayStatus).split(",");-1!=n.deviceType.indexOf("OneRelay")?(h&&(n.relayStatus=h),u=Object(i.g)(t.controlStatus),l.setState({I1RelayStatus:m,relayControlStatus:u})):(h&&(n.relayStatus=h),u=Object(i.g)(t.controlStatus),l.setState({relay1Status:r,relay2Status:o,relay3Status:s,relay4Status:c,relayControlStatus:u}));var p="Optimize"==n.controlStatus||"Normal"==n.controlStatus;(d=Object(i.g)(t.relayOptimizeSettings))&&",,,,"!=d&&""!=d||(d=-1==n.deviceType.indexOf("OneRelay")?"Normal,Normal,Normal,Normal,":"Normal"),l.setState({isOptimizeControl:p,isOptimizeControlStatus:p?n.controlStatus:"",relayOptimizeSettings:d})}).catch(function(e){return Object()})];case 1:return o.sent(),e&&Object(u.a)(!1),[2]}})})},t.prototype.fetchRelayControlSettings=function(){return b(this,void 0,void 0,function(){var e,t,n,a,l,o;return f(this,function(s){switch(s.label){case 0:return e=this.props.RelayDeviceName,t=this.state,n=t.relayControlType,a=t.RelayBoardControl,[4,Object(r.w)(e)];case 1:return(l=s.sent())[0]?(o=l[0],n&&-1==n.indexOf("OneRelay")?a.relays="1,2,3,4":a.relays="OneRelay",a.controlChoice=Object(i.g)(o.controlChoice),a.relayNames=Object(i.g)(o.relayNames),a.lightingTypes=Object(i.g)(o.lightingTypes),a.sensors=Object(i.g)(o.sensors),a.activeRelayStatus=Object(i.g)(o.activeRelayStatus)):n&&-1==n.indexOf("OneRelay")?(a.relays="1,2,3,4",a.controlChoice="0,0,0,0",a.relayNames="Relay 1,Relay 2,Relay 3,Relay 4",a.lightingTypes="0,0,0,0",a.sensors="0,0,0,0",a.activeRelayStatus="active,active,active,active"):(a.relays="OneRelay",a.controlChoice="0",a.relayNames="Relay",a.sensors="0",a.lightingTypes="0",a.activeRelayStatus="active"),this.setState({RelayBoardControl:a}),[2]}})})},t.prototype.ConvertDecimalToBinary=function(e){for(var t=[],n=e;n>0;)n%2==0?t.push("0"):t.push("1"),n=Math.floor(n/2);var a=this.state.relayControlType;if(a&&-1==a.indexOf("OneRelay"))for(var l=4-t.length,r=0;r<l;r++)t.push("0");return t.join(",")},t.prototype.handleRelayOnOff=function(e,t,n){var a=this.state,l=a.relay1Status,r=a.relay2Status,o=a.relay3Status,i=a.relay4Status;1==t&&(l=e),2==t&&(r=e),3==t&&(o=e),4==t&&(i=e),this.setState({modelChanged:n,relayisOnNo:t,relayisOn:e,relay1Status:l,relay2Status:r,relay3Status:o,relay4Status:i})},t.prototype.handleI1RelayOnOff=function(e){this.setState({I1RelayStatus:e,modelChanged:!0})},t.prototype.handleChange=function(e,t){var n=this.state.RelayBoardInfo;n[e]=t,this.setState({RelayBoardInfo:n,modelChanged:!0,currentChange:e})},t.prototype.handleRelayOptimizeSettings=function(e,t,n){return void 0===n&&(n=!0),b(this,void 0,void 0,function(){var a,l,r,o,i,s;return f(this,function(c){return a=this.state,l=a.relayOptimizeSettings,r=a.isOptimizeControl,o=a.modelChanged,i=a.relayNoOptimize,(s=l.split(","))[t]=e,r=!0,o=n,l=s.join(","),i=t+1,this.setState({isOptimizeControlStatus:e,relayOptimizeSettings:l,isOptimizeControl:r,modelChanged:o,relayNoOptimize:i}),[2]})})},t.prototype.handleRelayControlStatus=function(e){return b(this,void 0,void 0,function(){var t=this;return f(this,function(n){switch(n.label){case 0:return"Remote"==e&&"Local"!=this.state.relayControlStatus?[2]:("Remote"==e&&"Local"==this.state.relayControlStatus&&(e="Manual"),[4,this.saveRelayStatusChanges(e,!0).then(function(){return b(t,void 0,void 0,function(){var t,n,a;return f(this,function(l){return this.setState({relayControlStatus:e,isOptimizeControl:!1}),"Local"!=e&&"Schedule"!=e&&"Manual"!=e||(t=this.state,n=t.isOptimizeControl,a=t.modelChanged,n=!0,a=!0,this.setState({isOptimizeControlStatus:e,isOptimizeControl:n,modelChanged:a})),[2]})})})]);case 1:return n.sent(),[2]}})})},t.prototype.cancelSend=function(){var e=this.state,t=e.relay1Status,n=e.relay2Status,a=e.relay3Status,l=e.relay4Status,r=e.I1RelayStatus,o=e.relayCensorStatus,i=e.relayControlType,s=e.relayOptimizeSettings,c=e.isOptimizeControl,u=e.relayNoOptimize;if(i&&-1!=i.indexOf("OneRelay"))r=!r,this.setState({I1RelayStatus:r,modelChanged:!1,isOptimizeControl:!1});else{if(o&&o.relayStatus&&o.relayStatus.length>0&&(t="1"==o.relayStatus[0],n="1"==o.relayStatus[1],a="1"==o.relayStatus[2],l="1"==o.relayStatus[3],this.setState({relay1Status:t,relay2Status:n,relay3Status:a,relay4Status:l})),c){var m=s.split(",");m[u]="Normal"==m[u]?"Optimize":"Normal",s=m.join(",")}this.setState({modelChanged:!1,isOptimizeControl:!1,currentChange:"",relayOptimizeSettings:s,relayNoOptimize:0})}},t.prototype.onCloseRelayControlDialog=function(e){this.setState({openRelayControlDialog:e})},t.prototype.setOptimizeSettings=function(e,t){return b(this,void 0,void 0,function(){var n,a,l,o=this;return f(this,function(c){switch(c.label){case 0:return n=this.props,a=n.buildingName,l=n.RelayDeviceName,[4,Object(r.b)(a,l).then(function(n){return b(o,void 0,void 0,function(){var a,o,c,u,m,d,h,p,y,g,v,C,O,_,E,S,N,R=this;return f(this,function(w){switch(w.label){case 0:return a=Object(),n[0]?(a.device=Object(i.g)(n[0].device),a.A1=Object(i.g)(n[0].A1)?Object(i.g)(n[0].A1):"0",a.A2=Object(i.g)(n[0].A2)?Object(i.g)(n[0].A2):"0",a.B1=Object(i.g)(n[0].B1)?Object(i.g)(n[0].B1):"0",a.B2=Object(i.g)(n[0].B2)?Object(i.g)(n[0].B2):"0",a.C1=Object(i.g)(n[0].C1)?Object(i.g)(n[0].C1):"0",a.C2=Object(i.g)(n[0].C2)?Object(i.g)(n[0].C2):"0",a.D1=Object(i.g)(n[0].D1)?Object(i.g)(n[0].D1):"0",a.D2=Object(i.g)(n[0].D2)?Object(i.g)(n[0].D2):"0",a.E1=Object(i.g)(n[0].E1)?Object(i.g)(n[0].E1):"0",a.E2=Object(i.g)(n[0].E2)?Object(i.g)(n[0].E2):"0",a.F1=Object(i.g)(n[0].F1)?Object(i.g)(n[0].F1):"0",a.F2=Object(i.g)(n[0].F2)?Object(i.g)(n[0].F2):"0",a.G1=Object(i.g)(n[0].G1)?Object(i.g)(n[0].G1):"0",a.G2=Object(i.g)(n[0].G2)?Object(i.g)(n[0].G2):"0"):(a.device=l,a.A1="0",a.A2="0",a.B1="0",a.B2="0",a.C1="0",a.C2="0",a.D1="0",a.D2="0",a.E1="0",a.E2="0",a.F1="0",a.F2="0",a.G1="0",a.G2="0"),o=Object(),c=Object(),u=this.state,m=u.Moncon,d=u.relayNoOptimize,h=u.relayControlType,p=u.relayOptimizeSettings,y=u.RelayBoardControl,g=u.devices,v=u.relayControlStatus,C=e?e.split(","):p.split(","),o.isOptimize="Optimize"==C[(t||d)-1],o.isOptimize?(o.varA=parseInt(a.A2),o.varB=parseInt(a.B2),o.varC=parseInt(a.C2),o.varD=parseInt(a.D2),o.varE=parseInt(a.E2),o.varF=parseInt(a.F2),o.varG=parseInt(a.G2)):(o.varA=parseInt(a.A1),o.varB=parseInt(a.B1),o.varC=parseInt(a.C1),o.varD=parseInt(a.D1),o.varE=parseInt(a.E1),o.varF=parseInt(a.F1),o.varG=parseInt(a.G1)),o.deviceID=m.deviceName,o.relaynum=""+d,o.rlb_add=m.boardAddress,m.wirelessConfig.ipAddress&&(o.controllerPI=m.wirelessConfig.ipAddress,c.controllerPI=m.wirelessConfig.ipAddress),m.wirelessConfig.controllerIPAddress&&(o.controllerPI=m.wirelessConfig.controllerIPAddress,c.controllerPI=m.wirelessConfig.controllerIPAddress),-1!=h.toLowerCase().indexOf("v1")?o.rlb_ver="v1":-1!=h.toLowerCase().indexOf("v4")?o.rlb_ver="v4":-1!=h.toLowerCase().indexOf("i1")?o.rlb_ver="i1":-1!=h.toLowerCase().indexOf("i4")&&(o.rlb_ver="i4"),O=[],_=[],E=[],S=[],O=y.controlChoice&&y.controlChoice.split(","),_=y.lightingTypes&&y.lightingTypes.split(","),E=y.sensors&&y.sensors.split(","),S=y.relayNames&&y.relayNames.split(","),c.sched="Schedule"==v,c.controltype=c.sched?O[d-1]:"10",c.lighting_type=_[d-1],c.relaynum=""+d,c.rlb_ver=o.rlb_ver,c.rlb_add=m.boardAddress,c.deviceID=m.deviceName,E&&E[d-1]?(N=g.find(function(e){return Object(i.g)(e.moncondevice)==E[d-1]}),c.csb_add=N?Object(i.g)(N.boardAddress):"9999"):c.csb_add="9999",c.lighting_type&&"0"!=c.lighting_type&&c.controltype&&"0"!=c.controltype?[4,Object(r.I)(c,o)]:(Object(s.a)("Save the control settings for "+S[d-1]+" before posting settings"),[2]);case 1:return w.sent(),"A"!=_[d-1]?[3,11]:"0"!=E[d-1]?[3,11]:o.isOptimize?[4,this.handleRelayOnOff(!1,d,!1)]:[3,11];case 2:return w.sent(),[4,this.saveRelayStatusChanges(v,!1)];case 3:return w.sent(),h&&-1!=h.indexOf("OneRelay")?h&&-1!=h.indexOf("V1")?[3,6]:[3,4]:[3,7];case 4:return[4,Object(r.E)(m,!1).then(function(e){return b(R,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 5:w.sent(),w.label=6;case 6:return[3,11];case 7:return h&&-1!=h.indexOf("V4")?[4,Object(r.K)(m,!1,!1,d).then(function(e){return b(R,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})]:[3,9];case 8:return w.sent(),[3,11];case 9:return[4,Object(r.F)(m,!1,!1,d).then(function(e){return b(R,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 10:w.sent(),w.label=11;case 11:return[2]}})})})];case 1:return c.sent(),[2]}})})},t.prototype.resetChanges=function(e){return b(this,void 0,void 0,function(){var t=this;return f(this,function(n){return this.setState({modelChanged:!1,isOptimizeControl:!1,currentChange:"",callInterval:!1},function(){return b(t,void 0,void 0,function(){var t;return f(this,function(n){switch(n.label){case 0:return t=this.state.relayControlType,[4,this._fetchRelayCensorStatus(e)];case 1:return n.sent(),-1!=t.toLowerCase().indexOf("i1")?this._fetchI1RelayBoardInfo(e):-1!=t.toLowerCase().indexOf("i4")?this._fetchI4RelayBoardInfo(e):this._fetchV4RelayBoardInfo(e),[4,this._fetchCeilingSensorBoardInfo(e)];case 2:return n.sent(),this.setState({callInterval:!0}),[2]}})})}),[2]})})},t.prototype.handleScheduleSelection=function(e){return b(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,Object(r.R)(this.props.RelayDeviceName,e)];case 1:return t.sent(),e?Object(s.b)("Successfully Selected Schedule"):Object(s.b)("Successfully unSelected Schedule"),[2]}})})},t.prototype.saveRelayStatusChanges=function(e,t){return b(this,void 0,void 0,function(){var n,a,l,o,i,c,m,d,h,p,y,b,g;return f(this,function(f){switch(f.label){case 0:return t&&Object(u.a)(!0),n=this.props,a=n.buildingName,l=n.RelayDeviceName,o=this.state,i=o.relay1Status,c=o.relay2Status,m=o.relay3Status,d=o.relay4Status,h=o.relayCensorStatus,p=o.relayControlType,y=o.I1RelayStatus,b=o.relayOptimizeSettings,g=[],p&&-1!=p.indexOf("OneRelay")?g.push(y?"1":"0"):(g.push(i?"1":"0"),g.push(c?"1":"0"),g.push(m?"1":"0"),g.push(d?"1":"0")),h.relayStatus=g,h.controlStatus=e,h.deviceType=p,h.device=l,h.relayOptimizeSettings=b.split(","),[4,Object(r.P)(a,h).then(function(e){}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 1:return f.sent(),t&&Object(u.a)(!1),[2]}})})},t.prototype.applyChanges=function(){return b(this,void 0,void 0,function(){var e=this;return f(this,function(t){return Object(u.a)(!0),this.setState({modelChanged:!1,currentChange:""},function(){return b(e,void 0,void 0,function(){var e,t,n,l,o,i,c,m,d,h,p,y,v,C,O,_,E=this;return f(this,function(S){switch(S.label){case 0:if(g=0,a&&clearInterval(a),Object(u.a)(!0),e=this.state,t=e.Moncon,n=e.relayisOnNo,l=e.relayisOn,o=e.relayControlStatus,i=e.I1RelayStatus,c=e.relayControlType,m=e.isOptimizeControl,d=e.isOptimizeControlStatus,h=e.relayOptimizeSettings,p=e.RelayBoardControl,"Local"!=d&&"Schedule"!=d&&"Manual"!=d)return[3,6];"Schedule"==d&&this.handleScheduleSelection(!0),y=c&&-1==c.indexOf("OneRelay")?4:1,v=h.split(","),C=p.activeRelayStatus&&p.activeRelayStatus.split(","),O=0,S.label=1;case 1:return O<y?"active"!=C[O]?[3,4]:[4,this.handleRelayOptimizeSettings(v[O],O,!1)]:[3,5];case 2:return S.sent(),h=v.join(","),_=O+1,[4,this.setOptimizeSettings(h,_)];case 3:S.sent(),S.label=4;case 4:return O++,[3,1];case 5:return"Local"==o&&"Local"==d?(Object(u.a)(!1),[2]):[3,18];case 6:return"Schedule"!=o&&"Schedule"!=d&&this.handleScheduleSelection(!1),[4,this.saveRelayStatusChanges(o,!1)];case 7:return S.sent(),m?[3,16]:c&&-1!=c.indexOf("OneRelay")?c&&-1!=c.indexOf("V1")?[3,10]:[3,8]:[3,11];case 8:return[4,Object(r.E)(t,i).then(function(e){return b(E,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 9:S.sent(),S.label=10;case 10:return[3,15];case 11:return c&&-1!=c.indexOf("V4")?[4,Object(r.K)(t,!1,l,n).then(function(e){return b(E,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})]:[3,13];case 12:return S.sent(),[3,15];case 13:return[4,Object(r.F)(t,!1,l,n).then(function(e){return b(E,void 0,void 0,function(){return f(this,function(t){return e.error?Object(s.a)(e.error):e&&Object(s.b)("Changes applied successfully. "),[2]})})}).catch(function(e){Object(s.a)("Some error orccured. ")})];case 14:S.sent(),S.label=15;case 15:return[3,18];case 16:return[4,this.setOptimizeSettings()];case 17:S.sent(),S.label=18;case 18:return this.setState({isOptimizeControl:!1}),this.setIntervalStart(),Object(u.a)(!1),[2]}})})}),[2]})})},t.prototype.applyRule=function(e,t,n){return e?t?e<n?0:e:e>n?0:e:0},t.prototype.render=function(){var e,t,n,a,r=this,o=this.state,i=o.CeilingSensorBoardInfo,s=o.CeilingSensorBoard_MonconModel,u=o.Moncon,m=o.modelChanged,p=o.currentChange,y=o.detailsExpanded,b=o.RelayBoardInfo,f=o.relayControlStatus,g=o.relayisOn,v=o.relayisOnNo,C=o.relay1Status,O=o.relay2Status,_=o.relay3Status,E=o.relay4Status,S=o.relayControlType,N=o.I1RelayBoardInfo,R=o.I1RelayStatus,w=o.isOptimizeControl,j=o.isOptimizeControlStatus,I=o.RelayBoardControl,k=o.relayOptimizeSettings,x=o.I4RelayBoardInfo,A=o.openRelayControlDialog,L=this.props,z=L.instance,D=L.buildingName,F=L.RelayDeviceName,B=L.type,W=L.hideTabs,T="Local"!=f;e=I.relayNames&&I.relayNames.split(","),t=I.lightingTypes&&I.lightingTypes.split(","),n=k&&k.split(","),a=I.activeRelayStatus&&I.activeRelayStatus.split(",");var M="not refreshed";return S&&(-1!=S.toLowerCase().indexOf("i1")?N&&N.timestamp&&(M=new Date(N.timestamp).toLocaleString()):-1!=S.toLowerCase().indexOf("i4")?x&&x.timestamp&&(M=new Date(x.timestamp).toLocaleString()):-1!=S.toLowerCase().indexOf("v4")&&b&&b.timestamp&&(M=new Date(b.timestamp).toLocaleString())),l.createElement("div",{className:"content"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-12"},!W&&l.createElement(c.a,{InsightName:F,ControlName:"RelayControl",buildingName:D,instance:z,type:B}),l.createElement("div",{className:"card",id:"InsightsList"},l.createElement("div",{className:"container-fluid"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-9"},l.createElement("div",{className:"header"},l.createElement("h3",{className:"title"},l.createElement("strong",null,u.rdfsLabel)," "),l.createElement("h4",{className:"title"},l.createElement("strong",null,this.props.type.toUpperCase(),":",u&&u.relatedEquipment&&u.relatedEquipment.map(function(e,t){return l.createElement("span",{key:t},t+1==u.relatedEquipment.length?"":",")}))))),l.createElement("div",{className:"col-md-3"},S&&-1!=S.indexOf("OneRelay")&&l.createElement("button",{className:"btn btn-success active pull-right custom-outline-btn",title:"Control Settings",onClick:function(e){r.setState({openRelayControlDialog:!0},function(){document.getElementById("btnDialogRelayControl").click()})}}," ",l.createElement("i",{className:"fa fa-sliders"})," Control Settings",l.createElement("span",{className:"hidden visible-sm-inline visible-xs-inline headingText"},"Controls Settings"))))),l.createElement("div",{className:"content"},l.createElement("div",{className:"row"},S&&-1!=S.indexOf("OneRelay")&&l.createElement(l.Fragment,null,l.createElement("div",{className:"col-md-8 InsightRow"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-6 col-xs-12"},l.createElement("h4",{className:"padding-5 margin-5"},"Power Watts: ",l.createElement("b",null,N&&N.active_power_Watts?N.active_power_Watts:0," ")),l.createElement("h4",{className:"padding-5 margin-5"},"Amperes: ",l.createElement("b",null,N&&N.current_Amperes?N.current_Amperes:0)),l.createElement("h4",{className:"padding-5 margin-5"},"Frequency Hz: ",l.createElement("b",null,N&&N.frequency_Hz?this.applyRule(N.frequency_Hz,!0,55):0))),l.createElement("div",{className:"col-md-6 col-xs-12"},l.createElement("h4",{className:"padding-5 margin-5"},"Energy Watt/Hour: ",l.createElement("b",null,N&&N.import_active_energy_Wh?N.import_active_energy_Wh:0," ")),l.createElement("h4",{className:"padding-5 margin-5"},"Power Factor: ",l.createElement("b",null,N&&N.power_factor?N.power_factor:0)),l.createElement("h4",{className:"padding-5 margin-5"},"Voltage volts: ",l.createElement("b",null,N&&N.voltage_volts?N.voltage_volts:0))))),l.createElement("div",{className:"col-md-4 col-xs-12 InsightRow"},l.createElement("h4",{className:"padding-5 margin-5"},"Control Type: ",l.createElement("b",null,I&&I.controlChoice?I.controlChoice:"Not selected"," ")),l.createElement("h4",{className:"padding-5 margin-5"},"Illuminance: ",l.createElement("b",null,i&&i.illuminance_lux?i.illuminance_lux:0," Lumens")),l.createElement("h4",{className:"padding-5 margin-5"},"Motion Sensed: ",l.createElement("b",null,i&&i.motion_sensed&&i.motion_sensed>0?"True":"False")))),S&&-1==S.indexOf("OneRelay")&&l.createElement("div",{className:"col-md-12 InsightRow"},l.createElement("table",{className:"table table-striped"},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",null),l.createElement("th",null,l.createElement("b",null,"Amperes")),l.createElement("th",null,l.createElement("b",null,"Power Watt")),-1!=S.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("th",null,l.createElement("b",null,"Frequency")),l.createElement("th",null,l.createElement("b",null,"Energy")),l.createElement("th",null,l.createElement("b",null,"Power Factor")),l.createElement("th",null,l.createElement("b",null,"Voltage"))),l.createElement("th",null,"Manual"==f?"Status":""),t&&t.length>0&&(1==t.length?"0"!=t[0]:"0"!=t[0]&&"0"!=t[1]&&"0"!=t[2]&&"0"!=t[3])&&l.createElement("th",null,"Optimize Settings"))),l.createElement("tbody",null,a&&"inactive"!=a[0]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[0])),-1!=S.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,b&&b.mAmps_relay1?this.applyRule(parseFloat(b.mAmps_relay1)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,b&&b.power_Wt_relay1?this.applyRule(parseFloat(b.power_Wt_relay1)/1e3,!0,3):0," W"))),-1!=S.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,x&&x.current_Amperes_Ch1?this.applyRule(x.current_Amperes_Ch1,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,x&&x.active_power_Watts_Ch1?this.applyRule(parseFloat(x.active_power_Watts_Ch1)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,x&&x.frequency_Hz_Ch1?x.frequency_Hz_Ch1:0," Hz")),l.createElement("td",null,l.createElement("b",null,x&&x.import_active_energy_Wh_Ch1?x.import_active_energy_Wh_Ch1:0," Wh")),l.createElement("td",null,l.createElement("b",null,x&&x.power_factor_Ch1?x.power_factor_Ch1:0)),l.createElement("td",null,l.createElement("b",null,x&&x.voltage_volts_Ch1?this.applyRule(x.voltage_volts_Ch1,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:C?"btn":"btn btn-fill",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!1,1,!0)}},"Off"),l.createElement("button",{type:"button",className:C?"btn btn-fill":"btn",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!0,1,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[0]&&"C"!=t[0]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[0]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Normal",0)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[0]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Optimize",0)}},"Optimize")))),a&&"inactive"!=a[1]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[1])),-1!=S.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,b&&b.mAmps_relay2?this.applyRule(parseFloat(b.mAmps_relay2)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,b&&b.power_Wt_relay2?this.applyRule(parseFloat(b.power_Wt_relay2)/1e3,!0,3):0," W"))),-1!=S.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,x&&x.current_Amperes_Ch2?this.applyRule(x.current_Amperes_Ch2,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,x&&x.active_power_Watts_Ch2?this.applyRule(parseFloat(x.active_power_Watts_Ch2)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,x&&x.frequency_Hz_Ch2?x.frequency_Hz_Ch2:0," Hz")),l.createElement("td",null,l.createElement("b",null,x&&x.import_active_energy_Wh_Ch2?x.import_active_energy_Wh_Ch2:0," Wh")),l.createElement("td",null,l.createElement("b",null,x&&x.power_factor_Ch2?x.power_factor_Ch2:0)),l.createElement("td",null,l.createElement("b",null,x&&x.voltage_volts_Ch2?this.applyRule(x.voltage_volts_Ch2,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:O?"btn":"btn btn-fill",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!1,2,!0)}},"Off"),l.createElement("button",{type:"button",className:O?"btn btn-fill":"btn",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!0,2,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[1]&&"C"!=t[1]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[1]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Normal",1)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[1]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Optimize",1)}},"Optimize")))),a&&"inactive"!=a[2]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[2])),-1!=S.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,b&&b.mAmps_relay3?this.applyRule(parseFloat(b.mAmps_relay3)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,b&&b.power_Wt_relay3?this.applyRule(parseFloat(b.power_Wt_relay3)/1e3,!0,3):0," W"))),-1!=S.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,x&&x.current_Amperes_Ch3?this.applyRule(x.current_Amperes_Ch3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,x&&x.active_power_Watts_Ch3?this.applyRule(parseFloat(x.active_power_Watts_Ch3)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,x&&x.frequency_Hz_Ch3?x.frequency_Hz_Ch3:0," Hz")),l.createElement("td",null,l.createElement("b",null,x&&x.import_active_energy_Wh_Ch3?x.import_active_energy_Wh_Ch3:0," Wh")),l.createElement("td",null,l.createElement("b",null,x&&x.power_factor_Ch3?x.power_factor_Ch3:0)),l.createElement("td",null,l.createElement("b",null,x&&x.voltage_volts_Ch3?this.applyRule(x.voltage_volts_Ch3,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:_?"btn":"btn btn-fill",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!1,3,!0)}},"Off"),l.createElement("button",{type:"button",className:_?"btn btn-fill":"btn",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!0,3,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[2]&&"C"!=t[2]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[2]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Normal",2)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[2]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Optimize",2)}},"Optimize")))),a&&"inactive"!=a[3]&&l.createElement("tr",null,l.createElement("td",null,l.createElement("b",null,e&&e[3])),-1!=S.toLowerCase().indexOf("v4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,b&&b.mAmps_relay4?this.applyRule(parseFloat(b.mAmps_relay4)/1e3,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,"-"))),-1!=S.toLowerCase().indexOf("i4")&&l.createElement(l.Fragment,null,l.createElement("td",null,l.createElement("b",null,x&&x.current_Amperes_Ch4?this.applyRule(x.current_Amperes_Ch4,!0,.05):0," A")),l.createElement("td",null,l.createElement("b",null,x&&x.active_power_Watts_Ch4?this.applyRule(parseFloat(x.active_power_Watts_Ch4)/1e3,!0,3):0," W")),l.createElement("td",null,l.createElement("b",null,x&&x.frequency_Hz_Ch4?x.frequency_Hz_Ch4:0," Hz")),l.createElement("td",null,l.createElement("b",null,x&&x.import_active_energy_Wh_Ch4?x.import_active_energy_Wh_Ch4:0," Wh")),l.createElement("td",null,l.createElement("b",null,x&&x.power_factor_Ch4?x.power_factor_Ch4:0)),l.createElement("td",null,l.createElement("b",null,x&&x.voltage_volts_Ch4?this.applyRule(x.voltage_volts_Ch4,!0,80):0," volts"))),l.createElement("td",null,l.createElement(l.Fragment,null,l.createElement("button",{type:"button",className:E?"btn":"btn btn-fill",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!1,4,!0)}},"Off"),l.createElement("button",{type:"button",className:E?"btn btn-fill":"btn",disabled:m||"Manual"!=f,onClick:function(){r.handleRelayOnOff(!0,4,!0)}},"On"))),l.createElement("td",null,t&&"0"!=t[3]&&"C"!=t[3]&&l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[3]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Normal",3)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[3]?"btn btn-fill":"btn",disabled:w,onClick:function(){r.handleRelayOptimizeSettings("Optimize",3)}},"Optimize"))))))),l.createElement("div",{className:"col-md-8 col-xs-12 InsightRow"},S&&-1!=S.indexOf("OneRelay")&&l.createElement(l.Fragment,null,l.createElement("div",{className:"col-md-6"},l.createElement(l.Fragment,null,l.createElement("div",{className:"RelayHeading"},"Relay Status"),l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:R?"btn":"btn btn-fill",disabled:m||"Manual"!=f,onClick:function(){r.handleI1RelayOnOff(!1)}},"Off"),l.createElement("button",{type:"button",className:R?"btn btn-fill":"btn",disabled:m||"Manual"!=f,onClick:function(){r.handleI1RelayOnOff(!0)}},"On")))),t&&"0"!=t[0]&&"C"!=t[0]&&l.createElement("div",{className:"col-md-6"},l.createElement("div",{className:"RelayHeading"},"Optimize Settings"),l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:n&&"Normal"==n[0]?"btn btn-fill":"btn",onClick:function(){r.handleRelayOptimizeSettings("Normal",0)}},"Normal"),l.createElement("button",{type:"button",className:n&&"Optimize"==n[0]?"btn btn-fill":"btn",onClick:function(){r.handleRelayOptimizeSettings("Optimize",0)}},"Optimize")))),S&&-1==S.indexOf("OneRelay")&&l.createElement(l.Fragment,null,l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"padding-5 margin-5"},"Source Volts: ",l.createElement("b",null,b&&b.nominal_src_volts?b.nominal_src_volts:0," "))),l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"padding-5 margin-5"},"Illuminance: ",l.createElement("b",null,i&&i.illuminance_lux?i.illuminance_lux:0," Lumens"))),l.createElement("div",{className:"col-md-4"},l.createElement("h4",{className:"padding-5 margin-5"},"Motion Sensed: ",l.createElement("b",null,i&&i.motion_sensed&&i.motion_sensed>0?"True":"False"))))),l.createElement("div",{className:"col-md-4 col-xs-12 InsightRow"},l.createElement("div",{className:"btn-group"},l.createElement("button",{type:"button",className:"Local"==f?"btn btn-success btn-fill":"btn btn-success",disabled:""!=p&&"state"!=p,onClick:function(){r.handleRelayControlStatus("Local")}},"Local"),l.createElement("button",{type:"button",className:T?"btn btn-success btn-fill":"btn btn-success",disabled:""!=p&&"state"!=p,onClick:function(){r.handleRelayControlStatus("Remote")}},"Remote"),l.createElement("button",{type:"button",className:"Manual"==f?"btn btn-success btn-fill":"btn btn-success",disabled:!T,onClick:function(){r.handleRelayControlStatus("Manual")}},"Manual"),l.createElement("button",{type:"button",className:"Schedule"==f?"btn btn-success btn-fill":"btn btn-success",disabled:!T,onClick:function(){r.handleRelayControlStatus("Schedule")}},"Schedule")))),S&&l.createElement(d.a,{instance:z,buildingName:D,monconType:S,moncon:u.monitoringControl,deviceId:u.deviceID,monconRDFsLabel:u.rdfsLabel}),s&&s.monitoringControl&&l.createElement(d.a,{instance:z,buildingName:D,monconType:"CeilingSensor",moncon:s.monitoringControl,deviceId:s.deviceID,monconRDFsLabel:s.rdfsLabel}),l.createElement("div",{className:"accordion row padding-10",id:"accordionExample",style:{paddingLeft:"30px",border:"1px solid #80808066",margin:"10px",borderRadius:"7px"}},l.createElement("div",{className:"",id:"headingOne"},l.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne",style:{border:0,left:"-25px",position:"relative"},"aria-expanded":"true","aria-controls":"collapseOne",onClick:function(){r.setState({detailsExpanded:!y})}},l.createElement("i",{className:y?"fa fa-minus":"fa fa-plus","aria-hidden":"true"}),"\xa0 Device Info")),l.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},l.createElement("div",{className:"col-md-6 col-xs-12 padding-10"},l.createElement("h5",{className:"title"},l.createElement("strong",null,"IP Address:")," ",u.wirelessConfig&&u.wirelessConfig.ipAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Controller IP Address:")," ",u.wirelessConfig&&u.wirelessConfig.controllerIPAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Manufacturer:")," ",u.manufacturer),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Model:")," ",u.model),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Board Address:")," ",u.boardAddress),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Device ID:")," ",u.deviceID?u.deviceID:""),l.createElement("h5",{className:"title"},l.createElement("strong",null,"Last Data Synced At:")," ",M)))),l.createElement("div",{className:m?"InsightApplyChanges":"hidden"},w?l.createElement("h4",null,"Do you want to apply these changes (Optimize Settings: ",j,") ?"):l.createElement("h4",null,"Do you want to apply these changes (Relay ",S&&-1!=S.indexOf("OneRelay")?" : "+(R?"on":"off"):v+" : "+(g?"on":"off"),")?"),l.createElement("div",null,l.createElement("button",{type:"button",className:"btn btn-fill btn-secondary",onClick:function(){return r.cancelSend()}},"Cancel"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-danger",onClick:function(){return r.resetChanges(!0)}},"Reset"),"\xa0",l.createElement("button",{type:"button",className:"btn btn-fill btn-primary",onClick:function(){return r.applyChanges()}},"Apply Changes"))))))),A&&l.createElement(l.Fragment,null,l.createElement("button",{type:"button",id:"btnDialogRelayControl",className:"btn btn-dark pull-right",style:{display:"none"},"data-toggle":"modal","data-target":"#dialogRelayControl"}," . "),l.createElement(h.a,{id:"dialogRelayControl",relayDeviceName:F,buildingName:D,onCloseRelayControlDialog:this.onCloseRelayControlDialog}))))},t}(l.Component);t.default=v},761:function(e,t,n){"use strict";var a=n(2),l=(n.n(a),n(809)),r=n(656),o=n(652),i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(l,r){function o(e){try{s(a.next(e))}catch(e){r(e)}}function i(e){try{s(a.throw(e))}catch(e){r(e)}}function s(e){e.done?l(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,i)}s((a=a.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,a,l,r,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function i(r){return function(i){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(l=2&r[0]?a.return:r[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,r[1])).done)return l;switch(a=0,l&&(r=[2&r[0],l.value]),r[0]){case 0:case 1:l=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!l||r[1]>l[0]&&r[1]<l[3])){o.label=r[1];break}if(6===r[0]&&o.label<l[1]){o.label=l[1],l=r;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(r);break}l[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=l=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,i])}}},u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={deviceSensedList:[],addNew:!1,customAlarms:[Object(),Object(),Object()],newCustomAlarm:Object(),idToDelete:"",detailsExpanded:!1},n.getData=n.getData.bind(n),n.handleNewCustomAlarmChange=n.handleNewCustomAlarmChange.bind(n),n.handleSave=n.handleSave.bind(n),n.handleDelete=n.handleDelete.bind(n),n.handleEdit=n.handleEdit.bind(n),n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.getData()];case 1:return e.sent(),[2]}})})},t.prototype.getData=function(){return s(this,void 0,void 0,function(){var e,t,n,a,l;return c(this,function(o){switch(o.label){case 0:return e=this.props,t=e.moncon,n=e.monconType,a=this.state.customAlarms,n&&t?[4,Object(r.h)(n)]:[3,3];case 1:return l=o.sent(),[4,Object(r.f)(t)];case 2:a=o.sent(),this.setState({deviceSensedList:l,customAlarms:a}),o.label=3;case 3:return[2]}})})},t.prototype.handleNewCustomAlarmChange=function(e){var t=this.state.newCustomAlarm;t[e.target.name]=e.target.value,t.instance=this.props.instance,t.buildingName=this.props.buildingName,t.moncon=this.props.moncon,t.deviceId=this.props.deviceId,this.setState({newCustomAlarm:t})},t.prototype.handleSave=function(){return s(this,void 0,void 0,function(){var e,t=this;return c(this,function(n){switch(n.label){case 0:return e=this.state.newCustomAlarm,[4,Object(r.m)(e)];case 1:return n.sent(),this.setState({newCustomAlarm:Object(),addNew:!1},function(){t.getData()}),[2]}})})},t.prototype.handleDelete=function(){return s(this,void 0,void 0,function(){var e,t=this;return c(this,function(n){switch(n.label){case 0:return e=this.state.idToDelete,[4,Object(r.c)(e)];case 1:return n.sent(),this.setState({newCustomAlarm:Object(),addNew:!1,idToDelete:""},function(){t.getData()}),[2]}})})},t.prototype.handleEdit=function(e){return s(this,void 0,void 0,function(){var t,n,a;return c(this,function(l){return t=this.state,n=t.customAlarms,a=t.newCustomAlarm,(a=n.find(function(t){return t._id==e}))&&a._id&&this.setState({newCustomAlarm:a,addNew:!0}),[2]})})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,r=t.monconRDFsLabel,i=t.moncon,s=this.state,c=s.deviceSensedList,u=s.addNew,m=s.customAlarms,d=s.newCustomAlarm,h=s.detailsExpanded;return a.createElement(a.Fragment,null,a.createElement("div",{className:"accordion row padding-10",id:"accordionCustomerSensedAlarms"+i,style:{paddingLeft:"30px",border:"1px solid #80808066",margin:"10px",borderRadius:"7px"}},a.createElement("div",{className:"",id:"headingOne"},a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseCustomerSensedAlarms"+i,style:{border:0,left:"-25px",position:"relative"},"aria-expanded":"true","aria-controls":"collapseCustomerSensedAlarms"+i,onClick:function(){e.setState({detailsExpanded:!h})}},a.createElement("i",{className:h?"fa fa-minus":"fa fa-plus","aria-hidden":"true"}),"\xa0 Setup Custom Alarms for ",r)),a.createElement("div",{id:"collapseCustomerSensedAlarms"+i,className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionCustomerSensedAlarms"+i},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},!u&&a.createElement("div",{className:"row padding-10"},a.createElement("div",{className:"col-md-6 col-xs-12",style:{paddingLeft:25}},a.createElement("button",{type:"button",className:"btn btn-sm btn-fill btn-primary",onClick:function(){e.setState({addNew:!0})}},a.createElement("i",{className:"fa fa-plus"})))),u&&a.createElement("div",{className:"row padding-5"},a.createElement("div",{className:"col-md-4 col-xs-12"},a.createElement("div",{className:"col-md-4"},a.createElement("label",{htmlFor:"sensedKey"},"Sensed Value:")),a.createElement("div",{className:"col-md-8"},a.createElement("select",{className:"form-control "+(d.sensedKey?"":"addFieldValidate"),name:"sensedKey",id:"sensedKey",disabled:!1,value:d.sensedKey,onChange:this.handleNewCustomAlarmChange},a.createElement("option",{value:""},"Select Attribute"),c&&c.map(function(e,t){return a.createElement("option",{value:e.sensedValue,key:t},l.a.find(function(t){return t.key==e.sensedValue})?l.a.find(function(t){return t.key==e.sensedValue}).Label:e.sensedValue)})))),a.createElement("div",{className:"col-md-3 col-xs-12"},a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"minimumValue"},"Minimum Value:")),a.createElement("div",{className:"col-md-6"},a.createElement("input",{type:"number",className:"form-control "+(d.minimumValue>=0?"":"addFieldValidate"),name:"minimumValue",disabled:!1,value:d.minimumValue,onChange:this.handleNewCustomAlarmChange}))),a.createElement("div",{className:"col-md-3 col-xs-12"},a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"maximumValue"},"Maximum Value:")),a.createElement("div",{className:"col-md-6"},a.createElement("input",{type:"number",className:"form-control "+(d.maximumValue>=0?"":"addFieldValidate"),name:"maximumValue",disabled:!1,value:d.maximumValue,onChange:this.handleNewCustomAlarmChange}))),a.createElement("div",{className:"col-md-2 col-xs-12"},a.createElement("div",{className:"col-md-6"},a.createElement("button",{type:"button",className:"btn btn-sm btn-secondary",disabled:!(d.sensedKey&&d.minimumValue&&d.maximumValue),onClick:function(){e.handleSave()}},"Save")),a.createElement("div",{className:"col-md-6"},a.createElement("button",{type:"button",className:"btn btn-sm btn-danger",onClick:function(){e.setState({newCustomAlarm:Object(),addNew:!1},function(){e.getData()})}},"Cancel")))),m&&m.map(function(t){if(t._id!=d._id)return a.createElement("div",{className:"row padding-5"},a.createElement("div",{className:"col-md-5 col-xs-12"},a.createElement("div",{className:"col-md-4"},a.createElement("label",{htmlFor:"sensedValue"},"Sensed Value:")),a.createElement("div",{className:"col-md-8"},l.a.find(function(e){return e.key==t.sensedKey})?l.a.find(function(e){return e.key==t.sensedKey}).Label:t.sensedKey)),a.createElement("div",{className:"col-md-3 col-xs-12"},a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"minimumExtremeValue"},"Minimum Value:")),a.createElement("div",{className:"col-md-6"},t.minimumValue)),a.createElement("div",{className:"col-md-3 col-xs-12"},a.createElement("div",{className:"col-md-6"},a.createElement("label",{htmlFor:"minimumNormalValue"},"Maximum Value:")),a.createElement("div",{className:"col-md-6"},t.maximumValue)),a.createElement("div",{className:"col-md-1 col-xs-12"},a.createElement("button",{type:"button",className:"btn btn-xs btn-primary",onClick:function(){e.handleEdit(t._id)}},a.createElement("i",{className:"fa fa-edit"})),"\xa0",a.createElement("button",{type:"button",className:"btn btn-xs btn-danger",onClick:function(){e.setState({idToDelete:t._id},function(){document.getElementById("btnConfirmCustom").click()})}},a.createElement("i",{className:"fa fa-trash"}))))}))))),a.createElement("button",{id:"btnConfirmCustom",style:{display:"none"},"data-toggle":"modal","data-target":"#ConfirmDeleteDialogCustom"},"."),a.createElement(o.a,{instance:n,id:"ConfirmDeleteDialogCustom",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"Yes",confirmationText:"Are you sure to delete this alarm?",heading:"Confirm...",onConfirmButtonClick:function(){e.handleDelete()}}))},t}(a.Component);t.a=u},809:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=[{key:"altitude_m",Label:"Altitude (meter)"},{key:"equiCO2_ppm",Label:"CO2 (ppm)"},{key:"gasResistance_kOhm",Label:"Gas Resistance (KOhm)"},{key:"illuminance_lux",Label:"Illuminance (lux)"},{key:"motion_sensed",Label:"Motion Sensed"},{key:"pressure_hPa",Label:"Pressure (hPa)"},{key:"relhumidity_pct",Label:"Humidity (%)"},{key:"temp_celsius",Label:"Temperature"},{key:"tvoc_ppm",Label:"TVOC (ppm)"},{key:"wifiTemp1_celsius",Label:"Wifi Temp 1"},{key:"wifiTemp2_celsius",Label:"Wifi Temp 2"},{key:"wifiTemp3_celsius",Label:"Wifi Temp 3"},{key:"censor_adrs",Label:"Censor Address"},{key:"fan",Label:"Fan"},{key:"fanstate",Label:"Fan State"},{key:"heattemp",Label:"Heat Temperature Setpoint"},{key:"cooltemp",Label:"Cool Temperature Setpoint"},{key:"setpoint",Label:"Setpoint"},{key:"roomtemp",Label:"Room Temperature"},{key:"i1relay_state",Label:"Relay State"},{key:"active_power_Watts",Label:"Active Power (Watts)"},{key:"current_Amperes",Label:"Current (Ampares)"},{key:"frequency_Hz",Label:"Frequency (Hz)"},{key:"import_active_energy_Wh",Label:"Active Energy (Wh)"},{key:"power_factor",Label:"Power Factor"},{key:"voltage_volts",Label:"Voltage (Volts)"},{key:"active_power_Watts_Ch1",Label:"Power Ch1 (Watts)"},{key:"active_power_Watts_Ch2",Label:"Power Ch2 (Watts)"},{key:"active_power_Watts_Ch3",Label:"Power Ch3 (Watts)"},{key:"active_power_Watts_Ch4",Label:"Power Ch4 (Watts)"},{key:"current_Amperes_Ch1",Label:"Current Ch1 (Amperes)"},{key:"current_Amperes_Ch2",Label:"Current Ch2 (Amperes)"},{key:"current_Amperes_Ch3",Label:"Current Ch3 (Amperes)"},{key:"current_Amperes_Ch4",Label:"Current Ch4 (Amperes)"},{key:"frequency_Hz_Ch1",Label:"Frequency Ch1 (Hz)"},{key:"frequency_Hz_Ch2",Label:"Frequency Ch2 (Hz)"},{key:"frequency_Hz_Ch3",Label:"Frequency Ch3 (Hz)"},{key:"frequency_Hz_Ch4",Label:"Frequency Ch4 (Hz)"},{key:"import_active_energy_Wh_Ch1",Label:"Active Energy Ch1 (Wh)"},{key:"import_active_energy_Wh_Ch2",Label:"Active Energy Ch2 (Wh)"},{key:"import_active_energy_Wh_Ch3",Label:"Active Energy Ch3 (Wh)"},{key:"import_active_energy_Wh_Ch4",Label:"Active Energy Ch4 (Wh)"},{key:"power_factor_Ch1",Label:"Power Factor Ch1"},{key:"power_factor_Ch2",Label:"Power Factor Ch2"},{key:"power_factor_Ch3",Label:"Power Factor Ch3"},{key:"power_factor_Ch4",Label:"Power Factor Ch4"},{key:"voltage_volts_Ch1",Label:"Voltage Ch1 (volts)"},{key:"voltage_volts_Ch2",Label:"Voltage Ch2 (volts)"},{key:"voltage_volts_Ch3",Label:"Voltage Ch3 (volts)"},{key:"voltage_volts_Ch4",Label:"Voltage Ch4 (volts)"},{key:"",Label:""},{key:"",Label:""},{key:"",Label:""},{key:"",Label:""}]}});