webpackJsonp([15],{1017:function(e,t,n){"use strict";var a=n(3),s=(n.n(a),n(995)),o=n(568),r=n(656),l=n(17),i=n(592),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),u=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,o){function r(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,l)}i((a=a.apply(e,t||[])).next())})},d=this&&this.__generator||function(e,t){var n,a,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=2&o[0]?a.return:o[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,o[1])).done)return s;switch(a=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isStarted:!1,isTourSelected:!1,selectedSteps:n.props.sweeps,modelDetails:Object(),mapModelDetails:Object(),spaceDetails:[],currentSweep:Object(),matterTags:[],floorDetails:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:n.props.isViewForm,prevSweepIndex:0,prevSweepModel:Object(),onPropsReceivedStateChanged:!1,linkBimism:n.props.bimURL,routes:n.props.routes,locationDropdownList:[],destinationSpace:n.props.selectedSpace,destinationSweeps:n.props.sweeps,isTaskView:n.props.isTaskView,currentView:"TaskRoute",floor:Object(),hideMap:!0,hideInBuildingRoutes:!0,allSweeps:[],inBuildingRoutes:[],space:n.props.space,currentFloor:"",floorsBimList:[]},n.loadSDK=n.loadSDK.bind(n),n.loadFrame=n.loadFrame.bind(n),n.toggleTourStartStop=n.toggleTourStartStop.bind(n),n.toggleTourSweepsStartStop=n.toggleTourSweepsStartStop.bind(n),n.addCurrentSweep=n.addCurrentSweep.bind(n),n.toggleAddingSweep=n.toggleAddingSweep.bind(n),n.removeSweep=n.removeSweep.bind(n),n.setDialogState=n.setDialogState.bind(n),n.onSaveHandle=n.onSaveHandle.bind(n),n.handleRouteChange=n.handleRouteChange.bind(n),n.getRoutes=n.getRoutes.bind(n),n.checkPreviousRoutesWithCurrentRoutes=n.checkPreviousRoutesWithCurrentRoutes.bind(n),n.fetchFloorListImages=n.fetchFloorListImages.bind(n),n.getFloorsList=n.getFloorsList.bind(n),n}return c(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this;if((0==this.state.selectedSteps.length&&e.sweeps.length>0||e.isSweepChangeable)&&(this.setState({selectedSteps:JSON.parse(JSON.stringify(e.sweeps)),hasStartSweep:!0,startSweep:e.sweeps.find(function(e){return 0==e.stepNo}),onPropsReceivedStateChanged:!0},function(){t.state.sdk&&t.loadFrame(t.state.sdk,t.setDialogState,t.state)}),e.isSweepChangeable&&this.props.onSweepChangeable(e.isSweepChangeable)),e.bimURL&&this.state.linkBimism!=e.bimURL&&this.setState({linkBimism:e.bimURL}),e.locationDropdownList&&this.setState({locationDropdownList:e.locationDropdownList}),e.sweeps&&e.sweeps.length>0&&this.state.destinationSweeps!=e.sweeps){var n=e.sweeps.sort(function(e){return e.stepNo});this.setState({destinationSweeps:e.sweeps,hasStartSweep:!0,startSweep:n[0]})}if(e.selectedSpace&&this.state.destinationSpace.value!=e.selectedSpace.value&&this.setState({destinationSpace:e.selectedSpace}),e.routes&&e.routes.length>0){var a=this.state.selectedSteps;e.routes.forEach(function(e){e.sweeps.forEach(function(e){null==e&&""+e=="undefined"||a.push(e)})}),this.setState({routes:e.routes,onPropsReceivedStateChanged:!0,selectedSteps:a}),this.state.sdk&&this.loadFrame(this.state.sdk,this.setDialogState,this.state)}e.floor&&e.floor.bimSid&&this.setState({floor:e.floor,floorsBimList:[]},function(){t.getFloorsList(e.floor)}),e.space&&e.space!=this.state.space&&(this.setState({space:e.space}),this.state.sdk&&this.loadFrame(this.state.sdk,this.setDialogState,this.state))},t.prototype.componentDidUpdate=function(){this.state.onPropsReceivedStateChanged&&this.setState({onPropsReceivedStateChanged:!1})},t.prototype.getRoutes=function(e){return u(this,void 0,void 0,function(){var t,n,a,s,o,i,c,m=this;return d(this,function(p){switch(p.label){case 0:return t=this.props.buildingName,n=this.state,a=n.space,s=n.selectedSteps,o=[],i=[],c=[],a?[4,Object(r.a)(t,a).then(function(t){return u(m,void 0,void 0,function(){var n,r,u,m,p,f,b,h;return d(this,function(d){for(n=0;n<t.length;n++){for(r=t[n],(u=Object()).description=Object(l.g)(r.description),u.ontology=Object(l.g)(r.ontology),u.space=Object(l.g)(r.space),u.routeName=Object(l.g)(r.routeName),i=Object(l.g)(r.sweeps).split(","),c=Object(l.g)(r.stepNo).split(","),m=Object(),p=[],f=function(t){var n=i[t],o=Object();(m=e.find(function(e){return e.uuid==n}))&&(o.uuid=m.uuid,o.assignedSpace=a,o.stepNo=c[t],p.push(o),s.push(o))},b=0;b<i.length;b++)f(b);u.sweeps=p,o.push(u)}return h=this.state.inBuildingRoutes,this.setState({inBuildingRoutes:o,selectedSteps:s}),o.length>0&&(this.checkPreviousRoutesWithCurrentRoutes(o,h)||this.loadFrame(this.state.sdk,this.setDialogState,this.state)),[2]})})}).catch(function(e){return e})]:[2];case 1:return p.sent(),[2]}})})},t.prototype.checkPreviousRoutesWithCurrentRoutes=function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++){if(e[n].description!=t[n].description||e[n].floorBimUrl!=t[n].floorBimUrl||e[n].hideRoutesView!=t[n].hideRoutesView||e[n].ontology!=t[n].ontology||e[n].routeName!=t[n].routeName||e[n].space!=t[n].space)return!1;if(e[n].sweeps.length!=t[n].sweeps.length)return!1;for(var a=0;a<e[n].sweeps.length;a++)if(e[n].sweeps[a].assignedSpace!=t[n].sweeps[a].assignedSpace||e[n].sweeps[a].buildingName!=t[n].sweeps[a].buildingName||e[n].sweeps[a].ontology!=t[n].sweeps[a].ontology||e[n].sweeps[a].stepNo!=t[n].sweeps[a].stepNo||e[n].sweeps[a].uuid!=t[n].sweeps[a].uuid||e[n].sweeps[a].uuidIndex!=t[n].sweeps[a].uuidIndex)return!1}},t.prototype.getFloorsList=function(e){return u(this,void 0,void 0,function(){var t,n,a=this;return d(this,function(s){switch(s.label){case 0:return t=this.props.buildingName,n=this.state.floorsBimList,(n=[]).push({floor:e.floor,linkBimism:e.linkBimism,rdfsLabel:e.rdfsLabel+" (Default)",bimFloor:e.bimFloor,bimSid:e.bimSid,xScaleMap:e.xScaleMap,yOffsetMap:e.yOffsetMap,xOffsetMap:e.xOffsetMap,yScaleMap:e.yScaleMap}),this.setState({floorsBimList:n},function(){return u(a,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this.fetchFloorListImages()];case 1:return e.sent(),[2]}})})}),e.bimSid?[4,Object(i.a)(t,"",e.bimSid).then(function(t){return u(a,void 0,void 0,function(){var n,a,s,o=this;return d(this,function(r){for(n=this.state.floorsBimList,a=function(a){var s=t[a];if(Object(l.g)(s.bimFloor)==e.bimFloor)return"continue";if(n.find(function(e){return e.bimFloor==Object(l.g)(s.bimFloor)}))return"continue";var o=Object();o.floor=Object(l.g)(s.zone),o.linkBimism=Object(l.g)(s.linkBimism),o.rdfsLabel=Object(l.g)(s.rdfsLabel),o.bimFloor=Object(l.g)(s.bimFloor),o.bimSid=Object(l.g)(s.bimSid),o.xScaleMap=Object(l.g)(s.xScaleMap),o.yOffsetMap=Object(l.g)(s.yOffsetMap),o.xOffsetMap=Object(l.g)(s.xOffsetMap),o.yScaleMap=Object(l.g)(s.yScaleMap),o.imgFloorMap="",n.push(o)},s=0;s<t.length;s++)a(s);return this.setState({floorsBimList:n},function(){return u(o,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this.fetchFloorListImages()];case 1:return e.sent(),[2]}})})}),[2]})})})]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},t.prototype.fetchFloorListImages=function(){return u(this,void 0,void 0,function(){var e,t,a,s,o,l;return d(this,function(i){switch(i.label){case 0:e=this.state.floorsBimList,t=this.props.buildingName,a=0,i.label=1;case 1:return a<e.length?(s=e[a],[4,Object(r.b)(t,s.floor)]):[3,4];case 2:o=i.sent(),l=o&&o[0]?""+o[0].bimImageBase:n(661),s.imgFloorMap=l,e[a]=s,i.label=3;case 3:return a++,[3,1];case 4:return this.setState({floorsBimList:e},function(){console.log("floor bim list with images loaded")}),[2]}})})},t.prototype.onFloorChange=function(e){return u(this,void 0,void 0,function(){var t,n,a,s,o,r,l;return d(this,function(i){return t=this.state,n=t.currentFloor,a=t.floor,s=t.floorsBimList,o=t.currentSweep,r=s.find(function(t){return t.bimFloor==e}),a=r,l=parseInt(e.split(" ")[1]),l-=1,window.moveToFloor(l),n="Floor "+(l+1),this.setState({currentFloor:n,floor:a},function(){window.sweepsMappingFloor(a,o.uuid)}),[2]})})},t.prototype.onSaveHandle=function(){if(this.props.isTaskForm){var e=this.state.routes;this.props.onSaveRouteClickButton(e)}else{var t=this.state.selectedSteps;this.props.onSaveClickButton(t)}},t.prototype.toggleAddingSweep=function(){window.toggleStartStopAddingSweep()},t.prototype.toggleTourStartStop=function(){window.toggleTourSelectedSweep()},t.prototype.toggleTourSweepsStartStop=function(e,t){window.toggleTourSweepsSelectedSweepNew(e,t)},t.prototype.addCurrentSweep=function(){window.addCurrentSweep()},t.prototype.removeSweep=function(e){window.removeSweep(e)},t.prototype.setDialogState=function(e,t,n,a,s,o,r,l,i,c,m,p){var f=this;null!=e&&this.setState({isStarted:e}),null!=t&&this.setState({isTourSelected:t}),null!=n&&this.setState({selectedSteps:n}),null!=a&&(this.setState({modelDetails:a}),this.getRoutes(a.sweeps)),null!=m&&this.setState({mapModelDetails:m}),null!=s&&this.setState({currentSweep:s}),null!=o&&this.setState({logMessage:o}),null!=l&&this.setState({prevSweepIndex:l}),null!=i&&this.setState({prevSweepModel:i}),null!=p&&this.state.currentFloor!=p&&this.setState({currentFloor:p},function(){return u(f,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return[4,this.onFloorChange(p)];case 1:return e.sent(),[2]}})})}),null!=r&&this.setState({sdkReady:r}),null!=c&&(this.setState({sdk:c}),this.loadFrame(this.state.sdk,this.setDialogState,this.state))},t.prototype.loadSDK=function(e){var t=n(706),a=t.APIKey,s=t.Version,o=document.getElementById("showcase");window.MP_SDK.connect(o,a,s).then(function(t){console.log("SDK Connected!"),e(null,null,null,null,null,null,null,null,null,t)}).catch(function(e){console.log("Error while connecting with Matterport SDK")})},t.prototype.loadFrame=function(e,t,n){var a,s,o,r=document.getElementById("map"),l=0,i={sweep:"",mode:"INSIDE",transition:"FLY"},c=this.state,m=c.modelDetails,p=c.currentSweep,f=c.isStarted,b=c.isTourSelected,h=c.selectedSteps,g=c.sdkReady,v=c.startSweep,w=c.hasStartSweep,S=c.prevSweepIndex,N=c.prevSweepModel,E=c.isTaskView,k=c.mapModelDetails,y=c.currentFloor;function O(){return u(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,e.Model.getData().then(function(n){e.Camera.getPose().then(function(a){e.Renderer.getWorldPositionData(a.position).then(function(e){console.log("Model data loaded for sid:",n.sid),console.log("Current floor:",e.floor),y="Floor "+(parseInt(e.floor)+1),m=n,k.sweeps=n.sweeps.filter(function(t){return t.floor==parseInt(e.floor)}),p.uuid=a.sweep,t(null,null,null,m,p,null,null,null,null,null,null,y)})})})];case 1:return n.sent(),[2]}})})}function T(n,a){f?console.log("Tour Stopped"):(a.length>0&&a.length>n?(b=!0,e.Sweep.moveTo(a[n].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+a[n].uuidIndex;console.log(t),T(n+=1,a)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(b=!1,console.log("Tour Ended")),t(null,b))}function j(e,t){var n=document.getElementById("p"+t),a=document.getElementById("p"+e)||n;i.sweep=n&&n.value||"",function(e,t){t&&t.classList.remove("active");e&&(e.classList+=" active")}(n,a)}function x(e,t,n,a,s){return(e-t)/(n-t)*a+s}g||e.App.state.subscribe(function(n){return u(this,void 0,void 0,function(){return d(this,function(a){switch(a.label){case 0:return n.phase===e.App.Phase.LOADING&&console.log("The app has started loading!"),n.phase===e.App.Phase.STARTING&&console.log("The transition into the start location begins!"),n.phase!==e.App.Phase.PLAYING?[3,2]:(console.log("The app is ready to take user input now!"),g=!0,t(null,null,null,null,null,null,!0),[4,function e(t){return u(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return n.sent(),m.sweeps&&m.sweeps.length>0&&y?[2]:[3,2];case 2:return[4,e(O)];case 3:n.sent(),n.label=4;case 4:return[2]}})})}(O)]);case 1:a.sent(),w&&window.goToSweep(v.uuid),a.label=2;case 2:return[2]}})})}),window.sweepsMappingFloor=function(e,t){if(k.sweeps&&k.sweeps.length>0){a=0,o=0,s=0,l=0;var n=k.sweeps.map(function(e){if(e.position){var t={pid:e.uuid,x:e.position.x||0,y:e.position.z||0};return function(e,t){a=Math.min(a,e),o=Math.max(o,e),s=Math.min(s,t),l=Math.max(o,t)}(t.x,t.y),0==t.x&&0==t.y&&(i.sweep=e.uuid),t}});r.innerHTML="",n.map(function(t){return function(e,t){if(e){var n=document.createElement("BUTTON"),i=0,c=0,u=0,d=0,m=0,p=0;if(!t)return;u=t.xScaleMap&&parseInt(t.xScaleMap)?parseInt(t.xScaleMap):70,d=t.xOffsetMap&&parseInt(t.xOffsetMap)?parseInt(t.xOffsetMap):13,m=t.yScaleMap&&parseInt(t.yScaleMap)?parseInt(t.yScaleMap):70,p=t.yOffsetMap&&parseInt(t.yOffsetMap)?parseInt(t.yOffsetMap):45,i=x(e.x,a,o,u,d),c=x(e.y,s,l,m,p),n.setAttribute("id","p"+e.pid),n.setAttribute("value",e.pid),n.style.left=i+"%",n.style.top=c+"%",n.setAttribute("class","sweep z-depth-3"),n.addEventListener("click",function(e){window.goToSweep(e.target.value),e.stopPropagation()}),r.appendChild(n)}}(t,e)})}},window.toggleStartStopAddingSweep=function(){t(f=!f),f&&window.addCurrentSweep()},window.toggleTourSelectedSweep=function(){(t(null,b=!0),b)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),T(0,h.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,b))},window.toggleTourSweepsSelectedSweep=function(e){(t(null,b=!0),b)?(console.log("Tour Started"),t(null,null,null,null,null,"Tour Started"),T(0,e.sort(function(e,t){return e.stepNo-t.stepNo}))):(console.log("Tour Stopped"),t(null,b))},window.toggleTourSweepsSelectedSweepNew=function(n,a){for(var s=1;s<=n.length;s++){var o=document.getElementById(a+"_chkstep_"+s);o&&(o.checked=!1)}(0==a&&++a,t(null,b=!0),b)?(t(null,null,null,null,null,"Tour Started"),function n(a,s,o){f?console.log("Tour Stopped"):(s.length>0&&s.length>a?(b=!0,e.Sweep.moveTo(s[a].uuid,{transition:e.Sweep.Transition.FLY}).then(function(e){var t="Arrived at sweep "+e+"at index "+s[a].uuidIndex;console.log(t),a+=1;var r=document.getElementById(o+"_chkstep_"+a);r&&(r.checked=!0),n(a,s,o)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})):(b=!1,console.log("Tour Ended")),t(null,b))}(0,n.sort(function(e,t){return e.stepNo-t.stepNo}),a)):t(null,b)},window.addCurrentSweep=function(){e.Camera.getPose().then(function(e){var n=m.sweeps.find(function(t){return t.uuid==e.sweep});t(null,null,null,null,p=n);var a=m.sweeps.indexOf(n);if(!function(e){if(h.length>0){var t=h.find(function(t){return t.uuid==e});if(null!=t||""+t!="undefined"){var n="Sweep "+t.uuid+" of index "+t.uuidIndex+" is already added in the current list";return console.log(n),!0}}return!1}(p.uuid)){h.push({uuid:p.uuid,uuidIndex:a,stepNo:h.length}),t(null,null,h);var s="Sweep "+p.uuid+" of index "+a+" is added in the current list";console.log(s)}})},window.removeSweep=function(e){var n=h.find(function(t){return t.uuid==e}),a=h.indexOf(n);if(a>-1){h.splice(a,1),t(null,null,h);var s="Sweep "+n.uuid+" of index "+n.uuidIndex+" is removed from the current list";console.log(s)}},window.goToSweep=function(t){e.Sweep.moveTo(t,{transition:e.Sweep.Transition.FLY}).then(function(e){var n="Moved to sweep "+t;console.log(n)}).catch(function(e){console.log("Error: "+JSON.stringify(e))})},window.moveToFloor=function(t){e.Floor.moveTo(t).then(function(e){console.log("Current floor: "+e),y="Floor "+(-1==e?1:e+1)}).catch(function(e){})},e.on(e.Sweep.Event.ENTER,function(){if(b)return!1;e.Camera.getPose().then(function(n){if("mode.inside"==n.mode||"mode.outside"==n.mode){if(h.length>0){var a=h.find(function(e){return e.uuid==n.sweep});if(null!=a&&""+a!="undefined"){var s="Moved to sweep "+a.uuid;console.log(s),E?(j(N.uuid,n.sweep),N=a):(j(h[S].uuid,n.sweep),S=h.indexOf(a)),t(null,null,null,null,null,null,null,S)}else{s="Not allowed in the current step ";console.log(s),E&&N.uuid?window.goToSweep(N.uuid):window.goToSweep(h[S].uuid)}}e.Renderer.getWorldPositionData(n.position).then(function(e){return u(this,void 0,void 0,function(){var a;return d(this,function(s){return a="Floor "+(parseInt(e.floor)+1),y&&y!=a&&(y=a,p.uuid=n.sweep,m.sweeps&&(k.sweeps=m.sweeps.filter(function(t){return t.floor==parseInt(e.floor)}),t(null,null,null,null,p,null,null,null,null,null,k,y))),[2]})})})}})})},t.prototype.handleRouteChange=function(e){for(var t=[],n=0;n<e.length;n++)for(var a=e[n].sweeps,s=0;s<a.length;s++){var o=a[s];t.push(o)}this.setState({routes:e,selectedSteps:t});var r=this.state,l=r.floor,i=r.currentSweep;window.sweepsMappingFloor(l,i.uuid)},t.prototype.render=function(){var e=this;this.props.isRefreshDialog&&(this.setState({isStarted:!1,isTourSelected:!1,selectedSteps:[],modelDetails:Object(),spaceDetails:[],currentSweep:Object(),matterTags:[],floorDetails:Object(),logMessage:"",sdkReady:!1,hasStartSweep:!1,startSweep:Object(),isViewForm:this.props.isViewForm,prevSweepIndex:0,onPropsReceivedStateChanged:!1,linkBimism:this.props.bimURL,destinationSpace:{label:"",value:""},destinationSweeps:[],routes:[],locationDropdownList:[],hideInBuildingRoutes:!0,hideMap:!0}),this.props.onRefreshMatterport(!1),document.getElementById("map").innerHTML="");var t=this.props,r=t.id,l=t.heading,i=t.isViewForm,c=t.isTaskForm,u=t.isTaskView,d=t.sweeps,m=t.selectedSpace,p=t.showSaveButton,f=this.state,b=f.isStarted,h=f.selectedSteps,g=f.isTourSelected,v=f.logMessage,w=f.sdkReady,S=f.linkBimism,N=f.routes,E=f.locationDropdownList,k=f.currentView,y=f.floor,O=f.hideMap,T=f.inBuildingRoutes,j=f.hideInBuildingRoutes,x=0,D=0,A=!1,M=!1;w?(A=g,M=b):(A=!0,M=!0);var C=y&&y.imgFloorMap?y.imgFloorMap:n(661);return a.createElement(o.a,{id:r,saveButtonText:"Save",heading:l,showSaveButton:p,showCancelButton:i,onSaveButtonClick:function(){e.onSaveHandle()},isFullWidth:!0},"TaskRoute"==k&&a.createElement("div",{className:"card dataCard no-margin"},a.createElement("div",{className:"container-fluid"},a.createElement("div",{className:""},c&&a.createElement("div",{className:"col-md-7 col-xs-12 matterport-dialog-task-margin-bottom"},!c&&!u&&a.createElement(a.Fragment,null,!i&&a.createElement("button",{type:"button",id:"btnStartStop",disabled:A,title:1==b?"Stop":"Start",className:"btn btn-primary btn-fill",onClick:this.toggleAddingSweep},a.createElement("i",{className:1==b?"fa fa-stop":"fa fa-plus"})),!i&&a.createElement("button",{type:"button",id:"btnAddCurrentStep",disabled:A&&M,title:"Add current step",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:this.addCurrentSweep},a.createElement("i",{className:"fa fa-thumb-tack"})),a.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:M,title:1==b?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill ",onClick:this.toggleTourStartStop},a.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})),a.createElement("br",null),a.createElement("br",null)),!c&&!u&&a.createElement("span",{className:"small-font-list"},v),c&&a.createElement(s.a,{building:this.props.buildingName,items:N,onItemChange:this.handleRouteChange,isView:!1,spaces:E,destinationSpace:m,destinationSweeps:d})),!u&&a.createElement("div",{className:"col-md-5 col-xs-12"},a.createElement("table",null,a.createElement("tr",null,a.createElement("th",null,"Steps"),a.createElement("th",null)),h&&h.map(function(t){return x+=1,a.createElement("tr",null,a.createElement("td",{className:"link",onClick:function(){w&&window.goToSweep(t.uuid)}},"Step ",x,": ",t.uuid),a.createElement("td",null,!i&&w&&a.createElement("button",{type:"button",title:"Remove step",onClick:function(){e.removeSweep(t.uuid)},className:"btn btn-light matterport-dialog-btn-no-border"},a.createElement("i",{className:"fa fa-times"}))))}))),u&&a.createElement("div",{className:"col-md-5 col-xs-12"},N&&N.map(function(t,n){return x=0,D+=1,a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-6"},a.createElement("b",null,"Route ",D)),a.createElement("div",{className:"col-md-6"},a.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:M,title:1==b?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill btn-sm float-right matterport-dialog-btn-play-sm",onClick:function(){e.toggleTourSweepsStartStop(t.sweeps,n+1)}},a.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})))),a.createElement("span",{className:"small-font-list"},t.description),c&&a.createElement("table",null,a.createElement("tr",null,a.createElement("th",null,"Steps")),t.sweeps.map(function(e){return x+=1,a.createElement("tr",null,a.createElement("td",{className:"link",onClick:function(){w&&window.goToSweep(e.uuid)}}," Step ",x,": ",a.createElement("input",{type:"checkbox",disabled:!0,style:{cursor:"pointer"},id:D+"_chkstep_"+x.toString()})))})),a.createElement("br",null),a.createElement("br",null))}))),a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-2"},a.createElement("button",{type:"button",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin",onClick:function(){e.setState({hideMap:!O})}},O?"Show Map":"Hide Map")),T&&T.length>0&&a.createElement("div",{className:"col-md-3"},a.createElement("button",{type:"button",className:"btn btn-primary btn-fill matterport-dialog-btn-tour-margin pull-left",onClick:function(){e.setState({hideInBuildingRoutes:!j})}},j?"Show In Building Routes":"Hide In Building Routes"))),a.createElement("br",null),!j&&T.map(function(t,n){return a.createElement(a.Fragment,null,a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-3"},a.createElement("b",null,t.routeName)),a.createElement("div",{className:"col-md-1"},a.createElement("button",{type:"button",id:"btnTourSelectedSteps",disabled:M,title:1==b?"Tour selected steps stopped":"Tour selected steps started",className:"btn btn-primary btn-fill btn-sm float-right matterport-dialog-btn-play-sm",onClick:function(){e.toggleTourSweepsStartStop(t.sweeps,n)}},a.createElement("i",{className:1==g?"fa fa-stop":"fa fa-play"})))),a.createElement("br",null))})),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12 col-xs-12"},a.createElement("iframe",{id:"showcase",src:S,onLoad:function(){e.loadSDK(e.setDialogState)},width:"100%",height:"500",frameBorder:"0",allowFullScreen:!0})),a.createElement("div",{className:O?"col-md-12 display-none":"col-md-12"},a.createElement("div",{className:"map-container"},a.createElement("img",{className:"responsive-img",src:C,alt:""}),a.createElement("div",{id:"map",className:"map"})))))))},t}(a.Component);t.a=m},1537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=n(3),o=(n.n(s),n(629)),r=n(17),l=n(87),i=n(649),c=n(872),u=n(627),d=n(1538),m=n(18),p=n(578),f=n(1017),b=n(592),h=n(656),g=n(579),v=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),w=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,o){function r(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,l)}i((a=a.apply(e,t||[])).next())})},S=this&&this.__generator||function(e,t){var n,a,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=2&o[0]?a.return:o[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,o[1])).done)return s;switch(a=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={subTask:Object(),workerNotes:"",actions:[],people:[],floorDetails:Object(),refreshMatterportDialog:!1,onSweepChangeableStatus:!1,bimSweeps:[],locations:[],routeSpaces:[],showDialog:!1},a=n,n.handleWorkerNotesChange=n.handleWorkerNotesChange.bind(n),n._getFloorDetails=n._getFloorDetails.bind(n),n._getSweeps=n._getSweeps.bind(n),n.handleRefreshMatterport=n.handleRefreshMatterport.bind(n),n.onSweepChangeable=n.onSweepChangeable.bind(n),n._fetchPeople=n._fetchPeople.bind(n),n}return v(t,e),t.prototype.componentWillMount=function(){return w(this,void 0,void 0,function(){return S(this,function(e){return this.props.buildingName&&(a=a),[2]})})},t.prototype.componentDidMount=function(){return w(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return Object(l.a)(!0),this.props.buildingName?[4,this._fetchPeople()]:[3,3];case 1:return e=t.sent(),this.setState({people:e}),[4,this._fetchSubTask()];case 2:t.sent(),t.label=3;case 3:return this.state.subTask.floor&&this.state.subTask.floor.length>0&&(this._getFloorDetails(),this._getLocations()),""!=this.state.subTask.spaceSubject&&this._getSweeps(this.state.subTask.buildingName,this.state.subTask.spaceSubject),Object(l.a)(!1),[2]}})})},t.prototype._fetchPeople=function(){return w(this,void 0,void 0,function(){return S(this,function(e){switch(e.label){case 0:return[4,Object(p.n)(this.props.buildingName)];case 1:return[2,e.sent()]}})})},t.prototype._getLocations=function(){return w(this,void 0,void 0,function(){var e,t;return S(this,function(n){switch(n.label){case 0:return e=this.state.subTask,[4,Object(g.c)(e.floor,e.building,!0)];case 1:return t=n.sent(),this.setState({locations:t}),[2]}})})},t.prototype._getFloorDetails=function(){return w(this,void 0,void 0,function(){var e,t,a=this;return S(this,function(s){switch(s.label){case 0:return e=this.state.subTask,t=this.state.floorDetails,[4,Object(b.a)(e.building,e.floor).then(function(s){return w(a,void 0,void 0,function(){var a=this;return S(this,function(o){switch(o.label){case 0:return[4,Object(h.b)(e.building,e.floor).then(function(e){if(s&&s.length>0){var o=e&&e[0]?""+e[0].bimImageBase:n(661);t.linkBimism=Object(r.g)(s[0].linkBimism),t.xOffsetMap=Object(r.g)(s[0].xOffsetMap),t.yOffsetMap=Object(r.g)(s[0].yOffsetMap),t.xScaleMap=Object(r.g)(s[0].xScaleMap),t.yScaleMap=Object(r.g)(s[0].yScaleMap),t.bimFloor=Object(r.g)(s[0].bimFloor),t.bimSid=Object(r.g)(s[0].bimSid),t.floor=Object(r.g)(s[0].zone),t.rdfsLabel=Object(r.g)(s[0].rdfsLabel),t.imgFloorMap=o,a.setState({floorDetails:t,refreshMatterportDialog:!0})}})];case 1:return o.sent(),[2]}})})}).catch(function(e){return e})];case 1:return s.sent(),[2]}})})},t.prototype._fetchSubTask=function(){return w(this,void 0,void 0,function(){var e,t,n,a=this;return S(this,function(s){switch(s.label){case 0:return e=this.props.subTaskID,t=this.state.subTask,n=this.state.workerNotes,Object(l.a)(!0),[4,Object(o.j)(this.props.buildingName,"",e).then(function(e){var s=e[0];t.subTask=Object(r.g)(s.subTask),t.taskNumber=Object(r.g)(s.taskNumber),t.floor=Object(r.g)(s.floor),t.description=Object(r.g)(s.description),t.action=Object(r.g)(s.action),t.assignedTo=Object(r.g)(s.assignedTo),t.assignedDepartment=Object(r.g)(s.assignedDepartment),t.index=parseInt(Object(r.g)(s.index)),t.parentTask=Object(r.g)(s.parentTask),t.entryTimeStamp=Object(r.g)(s.entryTimeStamp),t.workOrder=Object(r.g)(s.workOrder),t.note=Object(r.g)(s.note),t.workerNote=Object(r.g)(s.workerNote),n=Object(r.g)(s.workerNote),t.relatedLink=s.relatedLink?s.relatedLink.value.indexOf(",")>0?s.relatedLink.value.split(","):[s.relatedLink.value]:[""],t.duration=s.duration&&-1!=s.duration.value.indexOf("-")?s.duration.value.split("-")[0]:"1",t.durationUnit=s.duration&&-1!=s.duration.value.indexOf("-")?s.duration.value.split("-")[1]:"Hours",t.workerDuration=s.workerDuration&&-1!=s.workerDuration.value.indexOf("-")?s.workerDuration.value.split("-")[0]:"1",t.workerDurationUnit=s.workerDurationUnit&&-1!=s.workerDurationUnit.value.indexOf("-")?s.workerDurationUnit.value.split("-")[1]:"Hours",t.fileName=Object(r.g)(s.fileName).split(","),t.oldFileName=Object(r.g)(s.fileName).split(","),t.enteredBy=Object(r.g)(s.enteredBy),t.enteredByName=Object(r.g)(s.enteredByName),t.startTime=Object(r.g)(s.startTime),t.workType=Object(r.g)(s.workType),t.status=Object(r.g)(s.status),t.checklistID=Object(r.g)(s.checklistID),t.isQRTask="true"==Object(r.g)(s.isQRTask),t.QRTag=Object(r.g)(s.QRTag),t.notifyViaEmail="true"==Object(r.g)(s.notifyViaEmail),t.notifyViaSMS="true"==Object(r.g)(s.notifyViaSMS),t.estimatedStartTime=""!=Object(r.g)(s.estimatedStartTime)?new Date(Object(r.g)(s.estimatedStartTime)):void 0,t.estimatedEndTime=""!=Object(r.g)(s.estimatedEndTime)?new Date(Object(r.g)(s.estimatedEndTime)):void 0,t.equipRdfsLabel=Object(r.g)(s.equipRdfsLabel),t.spaceSubject=Object(r.g)(s.spaceSubject),t.spaceRdfsLabel=Object(r.g)(s.spaceRdfsLabel),t.building=Object(r.g)(s.building),t.buildingName=Object(r.g)(s.buildingName),t.buildingAddress=Object(r.g)(s.buildingAddress),t.workflowType=Object(r.g)(s.workflowType),t.redirectionLink=Object(r.g)(s.redirectionLink),t.isStage="true"==Object(r.g)(s.isStage),t.isActivated="true"==Object(r.g)(s.isActivated),t.acknowledged="true"==Object(r.g)(s.acknowledged),t.archived="true"==Object(r.g)(s.archived),Object(u.b)(a.props.buildingName,[t.subTask]).then(function(e){return w(a,void 0,void 0,function(){var t,n,a;return S(this,function(s){switch(s.label){case 0:t=function(t){var a,s,o,l,i;return S(this,function(c){switch(c.label){case 0:if("done"!=e[t].directiveType)return[3,5];a=e[t].pointOntology.split(","),e[t].pointOntology="",s="",o=0,c.label=1;case 1:return o<a.length?(l=s,[4,Object(m.m)(a[o])]):[3,4];case 2:s=l+c.sent()+", ",c.label=3;case 3:return o++,[3,1];case 4:return s=s.substring(0,s.length-2),e[t].pointOntology=s,[3,8];case 5:return"customer"!=e[t].directiveType?[3,6]:(n.state.people.length>0&&(e[t].pointOntology=Object(r.g)(n.state.people.find(function(n){return Object(r.g)(n.contact)==e[t].pointOntology}).name)),[3,8]);case 6:return i=e[t],[4,Object(m.m)(e[t].pointOntology)];case 7:i.pointOntology=c.sent(),c.label=8;case 8:return e[t].directiveType=d.a.find(function(n){return n.value==e[t].directiveType}).name?d.a.find(function(n){return n.value==e[t].directiveType}).name:e[t].directiveType,[2]}})},n=this,a=0,s.label=1;case 1:return a<e.length?[5,t(a)]:[3,4];case 2:s.sent(),s.label=3;case 3:return a++,[3,1];case 4:return this.setState({actions:e}),[2]}})})}),a.setState({subTask:t,workerNotes:n})}).catch(function(e){return e})];case 1:return s.sent(),Object(l.a)(!1),[2]}})})},t.prototype._getSweeps=function(e,t){return w(this,void 0,void 0,function(){var n,a=this;return S(this,function(s){switch(s.label){case 0:return n=[],[4,Object(h.c)(e,t).then(function(e){return w(a,void 0,void 0,function(){var t,a,s,o,l,i,c;return S(this,function(u){for(t=0;t<e.length;t++)a=e[t],(s=Object()).assignedSpace=Object(r.g)(a.assignedSpace),s.buildingName=Object(r.g)(a.buildingName),s.ontology=Object(r.g)(a.ontology),s.uuid=Object(r.g)(a.uuid),s.uuidIndex=parseInt(Object(r.g)(a.uuidIndex)),s.stepNo=parseInt(Object(r.g)(a.stepNo)),n.push(s);if((o=this.state.bimSweeps).length==n.length){for(l=0,i=0;i<o.length;i++)(c=o[i]).assignedSpace==n[i].assignedSpace&&c.buildingName==n[i].buildingName&&c.ontology==n[i].ontology&&c.stepNo==n[i].stepNo&&c.uuid==n[i].uuid&&c.uuidIndex==n[i].uuidIndex&&(l+=1);l!=o.length&&this.setState({bimSweeps:n,onSweepChangeableStatus:!0,refreshMatterportDialog:!0})}else this.setState({bimSweeps:n,onSweepChangeableStatus:!0,refreshMatterportDialog:!0});return[2]})})}).catch(function(e){return e})];case 1:return s.sent(),[2]}})})},t.prototype.onSweepChangeable=function(e){this.setState({onSweepChangeableStatus:!e})},t.prototype.handleWorkerNotesChange=function(e){this.setState({workerNotes:e})},t.prototype.handleRefreshMatterport=function(e){this.setState({refreshMatterportDialog:e})},t.prototype.render=function(){var e=this,t=this.props,n=t.instance,a=t.buildingName,r=this.state,u=r.subTask,d=r.floorDetails,m=r.onSweepChangeableStatus,p=r.bimSweeps,b=r.locations,h=r.refreshMatterportDialog,g=d.linkBimism?d.linkBimism:localStorage.getItem("BIMURL"),v={value:"",label:""};if(u.spaceSubject){var N=u.spaceRdfsLabel?u.spaceRdfsLabel:b&&b.length>0&&b.find(function(e){return e.ontology.value==u.spaceSubject})?b.find(function(e){return e.ontology.value==u.spaceSubject}).rdfsLabel.value:"";v={value:u.spaceSubject,label:N}}return s.createElement("div",{className:"content"},s.createElement("div",{className:"padding-20 card"},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Task Number:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.taskNumber)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Building:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.buildingName,u.buildingAddress&&s.createElement("img",{className:"icon-img",style:{cursor:"pointer"},src:"assets/img/googlemaplinkicon.png",width:"3px",height:"3px",onClick:function(){window.open(""+u.buildingAddress,"_blank")}}))))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("p",{className:"label-black"},"Matter Port:")),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("button",{className:"btn-xs btn-object-form-view btn-fill",title:"Matter Port","data-toggle":"modal","data-target":"#showMatterPortDialog"+u.taskNumber,onClick:function(){e.setState({showDialog:!0})}},s.createElement("img",{style:{width:20,height:17},src:"assets/img/virtual-bim.png"})))),s.createElement(f.a,{id:"showMatterPortDialog"+u.taskNumber,heading:"Virtual BIM Routes",bimURL:g,isViewForm:!1,isSweepChangeable:m,sweeps:p,isTaskForm:!1,isTaskView:!0,onSweepChangeable:this.onSweepChangeable,isRefreshDialog:h,buildingName:this.props.buildingName,onRefreshMatterport:this.handleRefreshMatterport,locationDropdownList:b,showSaveButton:!1,selectedSpace:v,floor:d,space:u.spaceSubject})),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Space:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.spaceRdfsLabel)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Asset:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.equipRdfsLabel)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Action:"))),s.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.action)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Descripiton:"))),s.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.description)))),u.criticality&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Concern:"))),s.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},u.criticality," - ",c.c&&c.c[""+parseInt(u.criticality)].name)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Work Type:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},u.workType)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," Department:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.assignedDepartment)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Assigned By:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},u.enteredByName)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Estimated Duration Length:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.duration," Hours")))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Estimated Start Time:"))),s.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",new Date(u.estimatedStartTime).toString())))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Worker Estimation:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.workerDuration," Hours")))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Related Work Order:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.workOrder)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Instructions:"))),s.createElement("div",{className:"col-md-6 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",u.note)))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12"},s.createElement(i.a,{showUploader:!1,buildingName:a,assetOntology:this.props.subTaskID,entityType:"Task"}))),u.relatedLink&&u.relatedLink.length&&""!=u.relatedLink[0]&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Related Links:"))),s.createElement("div",{className:"col-md-8 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},u.relatedLink&&u.relatedLink.map(function(e,t){return s.createElement(s.Fragment,null,s.createElement(s.Fragment,null,s.createElement("a",{href:e.indexOf("ttp")>0?e:"http://"+e,target:"_blank"},s.createElement("p",{className:"label-black"}," Link ",t+1,": ",s.createElement("span",{style:{color:"blue"}},e))),s.createElement("br",null)))})))),"Done"==u.status&&s.createElement("div",{className:"row form-group"},s.createElement("div",{className:"col-md-9 col-md-offset-2"},s.createElement("h4",{style:{color:"#33cc66"}},s.createElement("i",{className:"fa fa-check",style:{margin:8}}),"Done"))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Worker Notes:"))),s.createElement("div",{className:"col-md-8"},s.createElement("div",{className:"form-group"},s.createElement("textarea",{className:"form-control",id:"note",name:"note",rows:4,value:this.state.workerNotes,onChange:function(t){e.handleWorkerNotesChange(t.target.value)}}))),s.createElement("div",{className:"col-md-2"},s.createElement("div",{className:"form-group"},s.createElement("button",{className:"btn btn-primary btn-fill",onClick:function(){return w(e,void 0,void 0,function(){var e,t=this;return S(this,function(n){switch(n.label){case 0:return e=this.state.workerNotes,Object(l.a)(!0),[4,Object(o.b)(this.props.subTaskID,e).then(function(){t._fetchSubTask()})];case 1:return n.sent(),Object(l.a)(!1),[2]}})})}},s.createElement("i",{className:"fa fa-save"})," Save")))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12"},s.createElement(i.a,{showUploader:!0,buildingName:a,assetOntology:this.props.subTaskID,entityType:"WorkerTaskAttachment"}))),s.createElement("div",{className:"row"},s.createElement("h3",{className:"text-center"},"Do What Tasks"),s.createElement("div",{className:"row mx-1 p-2"},this.state.actions&&this.state.actions.map(function(e,t){return s.createElement("div",{key:t,className:"content"},s.createElement("div",{className:"padding-20 card"},""!=e.directive&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Do What:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.directive)))),""!=e.directiveType&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"What Type:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.directiveType)))),""!=e.floorLabel&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Floor:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.floorLabel)))),""!=e.spaceLabel&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Space:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.spaceLabel)))),""!=e.assetLabel&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Asset:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.assetLabel)))),""!=e.componentLabel&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Component:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.componentLabel)))),""!=e.pointOntology&&s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-2 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"},"Point/Tenant:"))),s.createElement("div",{className:"col-md-4 col-sm-6 col-xs-6"},s.createElement("div",{className:"form-group"},s.createElement("p",{className:"label-black"}," ",e.pointOntology))))))}))),s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-12"},s.createElement("button",{className:"btn btn-secondary btn-fill",onClick:function(){window.location.hash=n+"/"+a+"/Tasks"}},s.createElement("i",{className:"fa fa-angle-double-left"}),"  Back to Task list")))))},t}(s.Component);t.default=N},1538:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=[{value:"scan",name:"Scan QR"},{value:"enter",name:"Enter Form Data"},{value:"numeric",name:"Enter Numeric Data"},{value:"upload",name:"Upload Attachment"},{value:"email",name:"Send Email"},{value:"customer",name:"Customer"},{value:"done",name:"Check Done"}]},627:function(e,t,n){"use strict";t.b=function(e,t,n){return r(this,void 0,void 0,function(){return l(this,function(a){switch(a.label){case 0:return[4,Object(o.e)({buildingName:e,tasks:t,ontologies:n},o.a.OBJECTFORM.GetObjectFormActions,s.b.TASK,!0)];case 1:return[2,a.sent()]}})})},t.c=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,ObjectActionTemplates:t},o.a.OBJECTFORM.SaveObjectFormActions,s.b.TASK).then(function(){Object(a.b)(" Assigned Successfully.")}).catch(function(e){Object(a.a)("Error occured while saving.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({buildingName:e,ontology:t},o.a.OBJECTFORM.DeleteObjectFormActions,s.b.TASK).then(function(){Object(a.b)("All Actions Deleted Successfully.")}).catch(function(e){Object(a.a)("Error occured while saving.")})];case 1:return[2,n.sent()]}})})};var a=n(44),s=n(26),o=n(19),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,o){function r(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,l)}i((a=a.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var n,a,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=2&o[0]?a.return:o[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,o[1])).done)return s;switch(a=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}},629:function(e,t,n){"use strict";t.k=function(){return r(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,Object(o.e)({},o.a.TASKS.GetTaskTypeList,a.b.TASK)];case 1:return[2,e.sent()]}})})},t.l=function(){return r(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,Object(o.e)({},o.a.TASKS.GetWorkTypeList,a.b.TASK)];case 1:return[2,e.sent()]}})})},t.h=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.e)({buildingName:e,getArchivedOnly:t},o.a.CHATS.GetChats,a.b.TASK)];case 1:return[2,n.sent()]}})})},t.f=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,chatName:t},o.a.CHATS.DeleteChat,a.b.TASK).then(function(){Object(s.b)("Chat Deleted Successfully.")}).catch(function(e){Object(s.a)("Error occured while deleting Chat.")})];case 1:return[2,n.sent()]}})})},t.p=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,chatName:t},o.a.TASKS.UpdateLastMessageOn,a.b.CHAT)];case 1:return[2,n.sent()]}})})},t.u=function(e){return r(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({chatName:e},o.a.TASKS.UpdateUnreadCount,a.b.TASK)];case 1:return[2,t.sent()]}})})},t.n=function(e,t,n){return r(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,Object(o.f)({buildingName:e,model:t,isEdit:n},o.a.TASKS.UpdateRootTask,a.b.TASK).then(function(){Object(s.b)("Task "+(n?"Updated":"Added")+" Successfully.")}).catch(function(e){Object(s.a)("Error occured while saving Task.")})];case 1:return[2,r.sent()]}})})},t.i=function(e,t,n){return r(this,void 0,void 0,function(){return l(this,function(s){switch(s.label){case 0:return[4,Object(o.e)({buildingName:e,taskNumber:t,isArchived:n},o.a.TASKS.GETTASKS,a.b.TASK,!0)];case 1:return[2,s.sent()]}})})},t.j=function(e,t,n){return r(this,void 0,void 0,function(){return l(this,function(s){switch(s.label){case 0:return[4,Object(o.e)({buildingName:e,parentTask:t,subTaskNumber:n},o.a.TASKS.GetSubTask,a.b.TASK)];case 1:return[2,s.sent()]}})})},t.r=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,isDeleted:t},o.a.TASKS.UpdateRootTaskDeleteStatus,a.b.TASK).then(function(){Object(s.b)("Task Deleted Successfully.")}).catch(function(e){Object(s.a)("Error occured while deleting Task.")})];case 1:return[2,n.sent()]}})})},t.t=function(e,t,n){return r(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,Object(o.f)({taskID:e,status:t},o.a.TASKS.UpdateTaskStatus,a.b.TASK).then(function(){n||Object(s.b)("Status Updated Successfully.")}).catch(function(e){Object(s.a)("Error occured while saving Task.")})];case 1:return[2,r.sent()]}})})},t.s=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,startTime:t},o.a.TASKS.UpdateTaskStartTime,a.b.TASK).then(function(){Object(s.b)("Start Time Updated Successfully.")}).catch(function(e){Object(s.a)("Error occured while saving Task.")})];case 1:return[2,n.sent()]}})})},t.d=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,isArchived:t},o.a.TASKS.ArchiveTask,a.b.TASK).then(function(){Object(s.b)((t?"Archived":"Unarchived")+" Successfully.")}).catch(function(e){Object(s.a)("Error occured while Archiving Task.")})];case 1:return[2,n.sent()]}})})},t.c=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,note:t},o.a.TASKS.AddPauseNote,a.b.TASK).then(function(){}).catch(function(e){Object(s.a)("Error occured while saving Task.")})];case 1:return[2,n.sent()]}})})},t.g=function(e){return r(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({taskID:e},o.a.TASKS.DeletePauseNote,a.b.TASK).then(function(){}).catch(function(e){Object(s.a)("Error occured while saving Task.")})];case 1:return[2,t.sent()]}})})},t.b=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,note:t},o.a.TASKS.AddNote,a.b.TASK).then(function(){Object(s.b)("Note Added Successfully.")}).catch(function(e){Object(s.a)("Error occured while saving Task.")})];case 1:return[2,n.sent()]}})})},t.a=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,isAcknowledged:t},o.a.TASKS.AcknowledgeRootTask,a.b.TASK).then(function(){Object(s.b)(t?"Acknowledged Successfully.":"Unacknowledged Successfully.")}).catch(function(e){Object(s.a)("Error occured while Acknowledging.")})];case 1:return[2,n.sent()]}})})},t.e=function(e,t){return r(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,Object(o.f)({taskID:e,checklistID:t},o.a.TASKS.AssignChecklist,a.b.TASK).then(function(){Object(s.b)("Checklist Assigned Successfully.")}).catch(function(e){Object(s.a)("Error occured while Assigning Checklist.")})];case 1:return[2,n.sent()]}})})},t.q=function(e,t,n){return r(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,Object(o.f)({email:e,roles:t,fileName:n},o.a.ONEDRIVE.UPDATEPERMISSION,a.b.TASK,"",!0).then(function(e){return e}).catch(function(e){Object(s.a)("Error occured while update Permission.")})];case 1:return[2,r.sent()]}})})},t.m=function(e){return r(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({fileName:e},o.a.ONEDRIVE.REMOVEPERMISSION,a.b.TASK,"",!0).then(function(e){return e}).catch(function(e){Object(s.a)("Error occured while removing Permission.")})];case 1:return[2,t.sent()]}})})},t.o=function(e){return r(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,Object(o.f)({buildingName:e},o.a.TASKS.TriggerTaskManagement,a.b.TASK,"").then(function(e){return e}).catch(function(e){Object(s.a)("Error occured while triggering task automation.")})];case 1:return[2,t.sent()]}})})};var a=n(26),s=n(44),o=n(19),r=(n(14),this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(s,o){function r(e){try{i(a.next(e))}catch(e){o(e)}}function l(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){e.done?s(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(r,l)}i((a=a.apply(e,t||[])).next())})}),l=this&&this.__generator||function(e,t){var n,a,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(s=2&o[0]?a.return:o[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,o[1])).done)return s;switch(a=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,a=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=t.call(e,r)}catch(e){o=[6,e],a=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}}});